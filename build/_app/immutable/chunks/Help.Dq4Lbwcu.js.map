{"version":3,"file":"Help.Dq4Lbwcu.js","sources":["../../../../../../node_modules/d3-selection/src/sourceEvent.js","../../../../../../node_modules/d3-selection/src/pointer.js","../../../../../../node_modules/d3-drag/src/noevent.js","../../../../../../node_modules/d3-drag/src/nodrag.js","../../../../../../node_modules/d3-drag/src/constant.js","../../../../../../node_modules/d3-drag/src/event.js","../../../../../../node_modules/d3-drag/src/drag.js","../../../../../../node_modules/d3-interpolate/src/zoom.js","../../../../../../node_modules/d3-zoom/src/constant.js","../../../../../../node_modules/d3-zoom/src/event.js","../../../../../../node_modules/d3-zoom/src/noevent.js","../../../../../../node_modules/d3-zoom/src/zoom.js","../../../../../../node_modules/bits-ui/dist/bits/menu/components/menu-sub.svelte","../../../../../../node_modules/bits-ui/dist/bits/menu/components/menu-sub-content.svelte","../../../../../../node_modules/bits-ui/dist/bits/menu/components/menu-sub-trigger.svelte","../../../../../../node_modules/paneforge/dist/internal/utils/lifecycle.js","../../../../../../node_modules/paneforge/dist/internal/utils/store.js","../../../../../../node_modules/paneforge/dist/internal/utils/style.js","../../../../../../node_modules/paneforge/dist/internal/utils/aria.js","../../../../../../node_modules/paneforge/dist/internal/utils/id.js","../../../../../../node_modules/paneforge/dist/internal/constants.js","../../../../../../node_modules/paneforge/dist/internal/utils/storage.js","../../../../../../node_modules/paneforge/dist/internal/utils/object.js","../../../../../../node_modules/paneforge/dist/internal/utils/chain.js","../../../../../../node_modules/paneforge/dist/internal/utils/event.js","../../../../../../node_modules/paneforge/dist/internal/utils/compare.js","../../../../../../node_modules/paneforge/dist/internal/utils/assert.js","../../../../../../node_modules/paneforge/dist/internal/utils/resize.js","../../../../../../node_modules/paneforge/dist/internal/utils/adjust-layout.js","../../../../../../node_modules/paneforge/dist/internal/utils/is.js","../../../../../../node_modules/paneforge/dist/internal/paneforge.js","../../../../../../node_modules/paneforge/dist/components/ctx.js","../../../../../../node_modules/paneforge/dist/components/pane-group.svelte","../../../../../../node_modules/paneforge/dist/components/pane.svelte","../../../../../../node_modules/paneforge/dist/components/pane-resizer.js","../../../../../../node_modules/paneforge/dist/components/pane-resizer.svelte","../../../../../../node_modules/eventsource-parser/dist/index.js","../../../../../../node_modules/eventsource-parser/dist/stream.js","../../../../../../src/lib/apis/streaming/index.ts","../../../../../../src/lib/components/common/Banner.svelte","../../../../../../src/lib/components/icons/DocumentArrowUpSolid.svelte","../../../../../../src/lib/components/icons/GlobeAltSolid.svelte","../../../../../../src/lib/components/icons/WrenchSolid.svelte","../../../../../../src/lib/components/chat/MessageInput/InputMenu.svelte","../../../../../../src/lib/components/icons/Headphone.svelte","../../../../../../src/lib/components/chat/MessageInput/VoiceRecording.svelte","../../../../../../src/lib/components/chat/MessageInput/FilesOverlay.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands/Prompts.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands/Documents.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands/Models.svelte","../../../../../../src/lib/components/chat/MessageInput/Commands.svelte","../../../../../../src/lib/components/chat/MessageInput.svelte","../../../../../../src/lib/components/chat/ModelSelector.svelte","../../../../../../src/lib/components/icons/Map.svelte","../../../../../../src/lib/components/icons/Clipboard.svelte","../../../../../../src/lib/components/icons/AdjustmentsHorizontal.svelte","../../../../../../src/lib/components/layout/Navbar/Menu.svelte","../../../../../../src/lib/components/layout/Navbar.svelte","../../../../../../node_modules/classcat/index.js","../../../../../../node_modules/@xyflow/system/dist/esm/index.mjs","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/Handle/Handle.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/nodes/DefaultNode.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/nodes/InputNode.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/nodes/OutputNode.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/actions/portal/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/EdgeLabelRenderer/EdgeLabelRenderer.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useHandleEdgeSelect.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/EdgeLabel/EdgeLabel.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/BaseEdge/BaseEdge.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/BezierEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/SmoothStepEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/StraightEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/edges/StepEdgeInternal.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/utils.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/initial-store.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/visible-edges.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/visible-nodes.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/store/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/actions/zoom/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Zoom/Zoom.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Pane/Pane.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Viewport/Viewport.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/actions/drag/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/NodeWrapper/utils.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/NodeWrapper/NodeWrapper.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/NodeRenderer/NodeRenderer.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/EdgeWrapper/EdgeWrapper.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/CallOnMount/CallOnMount.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/EdgeRenderer/MarkerDefinition/MarkerDefinition.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/EdgeRenderer/MarkerDefinition/Marker.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/EdgeRenderer/EdgeRenderer.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/Selection/Selection.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/UserSelection/UserSelection.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/NodeSelection/NodeSelection.svelte","../../../../../../node_modules/@svelte-put/shortcut/src/shortcut.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/KeyHandler/KeyHandler.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/ConnectionLine/ConnectionLine.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/Panel/Panel.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/Attribution/Attribution.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/SvelteFlow/utils.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useColorModeClass.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/container/SvelteFlow/SvelteFlow.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/components/SvelteFlowProvider/SvelteFlowProvider.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/ControlButton.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Plus.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Minus.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Fit.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Lock.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Icons/Unlock.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Controls/Controls.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/types.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/DotPattern.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/LinePattern.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/plugins/Background/Background.svelte","../../../../../../node_modules/@xyflow/svelte/dist/lib/utils/index.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useSvelteFlow.js","../../../../../../node_modules/@xyflow/svelte/dist/lib/hooks/useInitialized.js","../../../../../../src/lib/components/chat/Controls/Valves.svelte","../../../../../../src/lib/components/chat/Controls/Controls.svelte","../../../../../../src/lib/components/chat/MessageInput/CallOverlay/VideoInputMenu.svelte","../../../../../../src/lib/components/chat/MessageInput/CallOverlay.svelte","../../../../../../src/lib/components/common/Drawer.svelte","../../../../../../src/lib/components/chat/Overview/Node.svelte","../../../../../../src/lib/components/chat/Overview/Flow.svelte","../../../../../../src/lib/components/chat/Overview.svelte","../../../../../../src/lib/components/icons/EllipsisVertical.svelte","../../../../../../src/lib/components/chat/ChatControls.svelte","../../../../../../src/lib/components/chat/Chat.svelte","../../../../../../src/lib/components/chat/ShortcutsModal.svelte","../../../../../../src/lib/components/icons/QuestionMarkCircle.svelte","../../../../../../src/lib/components/icons/Keyboard.svelte","../../../../../../src/lib/components/layout/Help/HelpMenu.svelte","../../../../../../src/lib/components/layout/Help.svelte"],"sourcesContent":["export default function(event) {\n  let sourceEvent;\n  while (sourceEvent = event.sourceEvent) event = sourceEvent;\n  return event;\n}\n","import sourceEvent from \"./sourceEvent.js\";\n\nexport default function(event, node) {\n  event = sourceEvent(event);\n  if (node === undefined) node = event.currentTarget;\n  if (node) {\n    var svg = node.ownerSVGElement || node;\n    if (svg.createSVGPoint) {\n      var point = svg.createSVGPoint();\n      point.x = event.clientX, point.y = event.clientY;\n      point = point.matrixTransform(node.getScreenCTM().inverse());\n      return [point.x, point.y];\n    }\n    if (node.getBoundingClientRect) {\n      var rect = node.getBoundingClientRect();\n      return [event.clientX - rect.left - node.clientLeft, event.clientY - rect.top - node.clientTop];\n    }\n  }\n  return [event.pageX, event.pageY];\n}\n","// These are typically used in conjunction with noevent to ensure that we can\n// preventDefault on the event.\nexport const nonpassive = {passive: false};\nexport const nonpassivecapture = {capture: true, passive: false};\n\nexport function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {select} from \"d3-selection\";\nimport noevent, {nonpassivecapture} from \"./noevent.js\";\n\nexport default function(view) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", noevent, nonpassivecapture);\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", noevent, nonpassivecapture);\n  } else {\n    root.__noselect = root.style.MozUserSelect;\n    root.style.MozUserSelect = \"none\";\n  }\n}\n\nexport function yesdrag(view, noclick) {\n  var root = view.document.documentElement,\n      selection = select(view).on(\"dragstart.drag\", null);\n  if (noclick) {\n    selection.on(\"click.drag\", noevent, nonpassivecapture);\n    setTimeout(function() { selection.on(\"click.drag\", null); }, 0);\n  }\n  if (\"onselectstart\" in root) {\n    selection.on(\"selectstart.drag\", null);\n  } else {\n    root.style.MozUserSelect = root.__noselect;\n    delete root.__noselect;\n  }\n}\n","export default x => () => x;\n","export default function DragEvent(type, {\n  sourceEvent,\n  subject,\n  target,\n  identifier,\n  active,\n  x, y, dx, dy,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    subject: {value: subject, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    identifier: {value: identifier, enumerable: true, configurable: true},\n    active: {value: active, enumerable: true, configurable: true},\n    x: {value: x, enumerable: true, configurable: true},\n    y: {value: y, enumerable: true, configurable: true},\n    dx: {value: dx, enumerable: true, configurable: true},\n    dy: {value: dy, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n\nDragEvent.prototype.on = function() {\n  var value = this._.on.apply(this._, arguments);\n  return value === this._ ? this : value;\n};\n","import {dispatch} from \"d3-dispatch\";\nimport {select, pointer} from \"d3-selection\";\nimport nodrag, {yesdrag} from \"./nodrag.js\";\nimport noevent, {nonpassive, nonpassivecapture, nopropagation} from \"./noevent.js\";\nimport constant from \"./constant.js\";\nimport DragEvent from \"./event.js\";\n\n// Ignore right-click, since that should open the context menu.\nfunction defaultFilter(event) {\n  return !event.ctrlKey && !event.button;\n}\n\nfunction defaultContainer() {\n  return this.parentNode;\n}\n\nfunction defaultSubject(event, d) {\n  return d == null ? {x: event.x, y: event.y} : d;\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      container = defaultContainer,\n      subject = defaultSubject,\n      touchable = defaultTouchable,\n      gestures = {},\n      listeners = dispatch(\"start\", \"drag\", \"end\"),\n      active = 0,\n      mousedownx,\n      mousedowny,\n      mousemoving,\n      touchending,\n      clickDistance2 = 0;\n\n  function drag(selection) {\n    selection\n        .on(\"mousedown.drag\", mousedowned)\n      .filter(touchable)\n        .on(\"touchstart.drag\", touchstarted)\n        .on(\"touchmove.drag\", touchmoved, nonpassive)\n        .on(\"touchend.drag touchcancel.drag\", touchended)\n        .style(\"touch-action\", \"none\")\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  function mousedowned(event, d) {\n    if (touchending || !filter.call(this, event, d)) return;\n    var gesture = beforestart(this, container.call(this, event, d), event, d, \"mouse\");\n    if (!gesture) return;\n    select(event.view)\n      .on(\"mousemove.drag\", mousemoved, nonpassivecapture)\n      .on(\"mouseup.drag\", mouseupped, nonpassivecapture);\n    nodrag(event.view);\n    nopropagation(event);\n    mousemoving = false;\n    mousedownx = event.clientX;\n    mousedowny = event.clientY;\n    gesture(\"start\", event);\n  }\n\n  function mousemoved(event) {\n    noevent(event);\n    if (!mousemoving) {\n      var dx = event.clientX - mousedownx, dy = event.clientY - mousedowny;\n      mousemoving = dx * dx + dy * dy > clickDistance2;\n    }\n    gestures.mouse(\"drag\", event);\n  }\n\n  function mouseupped(event) {\n    select(event.view).on(\"mousemove.drag mouseup.drag\", null);\n    yesdrag(event.view, mousemoving);\n    noevent(event);\n    gestures.mouse(\"end\", event);\n  }\n\n  function touchstarted(event, d) {\n    if (!filter.call(this, event, d)) return;\n    var touches = event.changedTouches,\n        c = container.call(this, event, d),\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = beforestart(this, c, event, d, touches[i].identifier, touches[i])) {\n        nopropagation(event);\n        gesture(\"start\", event, touches[i]);\n      }\n    }\n  }\n\n  function touchmoved(event) {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        noevent(event);\n        gesture(\"drag\", event, touches[i]);\n      }\n    }\n  }\n\n  function touchended(event) {\n    var touches = event.changedTouches,\n        n = touches.length, i, gesture;\n\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, 500); // Ghost clicks are delayed!\n    for (i = 0; i < n; ++i) {\n      if (gesture = gestures[touches[i].identifier]) {\n        nopropagation(event);\n        gesture(\"end\", event, touches[i]);\n      }\n    }\n  }\n\n  function beforestart(that, container, event, d, identifier, touch) {\n    var dispatch = listeners.copy(),\n        p = pointer(touch || event, container), dx, dy,\n        s;\n\n    if ((s = subject.call(that, new DragEvent(\"beforestart\", {\n        sourceEvent: event,\n        target: drag,\n        identifier,\n        active,\n        x: p[0],\n        y: p[1],\n        dx: 0,\n        dy: 0,\n        dispatch\n      }), d)) == null) return;\n\n    dx = s.x - p[0] || 0;\n    dy = s.y - p[1] || 0;\n\n    return function gesture(type, event, touch) {\n      var p0 = p, n;\n      switch (type) {\n        case \"start\": gestures[identifier] = gesture, n = active++; break;\n        case \"end\": delete gestures[identifier], --active; // falls through\n        case \"drag\": p = pointer(touch || event, container), n = active; break;\n      }\n      dispatch.call(\n        type,\n        that,\n        new DragEvent(type, {\n          sourceEvent: event,\n          subject: s,\n          target: drag,\n          identifier,\n          active: n,\n          x: p[0] + dx,\n          y: p[1] + dy,\n          dx: p[0] - p0[0],\n          dy: p[1] - p0[1],\n          dispatch\n        }),\n        d\n      );\n    };\n  }\n\n  drag.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), drag) : filter;\n  };\n\n  drag.container = function(_) {\n    return arguments.length ? (container = typeof _ === \"function\" ? _ : constant(_), drag) : container;\n  };\n\n  drag.subject = function(_) {\n    return arguments.length ? (subject = typeof _ === \"function\" ? _ : constant(_), drag) : subject;\n  };\n\n  drag.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), drag) : touchable;\n  };\n\n  drag.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? drag : value;\n  };\n\n  drag.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, drag) : Math.sqrt(clickDistance2);\n  };\n\n  return drag;\n}\n","var epsilon2 = 1e-12;\n\nfunction cosh(x) {\n  return ((x = Math.exp(x)) + 1 / x) / 2;\n}\n\nfunction sinh(x) {\n  return ((x = Math.exp(x)) - 1 / x) / 2;\n}\n\nfunction tanh(x) {\n  return ((x = Math.exp(2 * x)) - 1) / (x + 1);\n}\n\nexport default (function zoomRho(rho, rho2, rho4) {\n\n  // p0 = [ux0, uy0, w0]\n  // p1 = [ux1, uy1, w1]\n  function zoom(p0, p1) {\n    var ux0 = p0[0], uy0 = p0[1], w0 = p0[2],\n        ux1 = p1[0], uy1 = p1[1], w1 = p1[2],\n        dx = ux1 - ux0,\n        dy = uy1 - uy0,\n        d2 = dx * dx + dy * dy,\n        i,\n        S;\n\n    // Special case for u0 ≅ u1.\n    if (d2 < epsilon2) {\n      S = Math.log(w1 / w0) / rho;\n      i = function(t) {\n        return [\n          ux0 + t * dx,\n          uy0 + t * dy,\n          w0 * Math.exp(rho * t * S)\n        ];\n      }\n    }\n\n    // General case.\n    else {\n      var d1 = Math.sqrt(d2),\n          b0 = (w1 * w1 - w0 * w0 + rho4 * d2) / (2 * w0 * rho2 * d1),\n          b1 = (w1 * w1 - w0 * w0 - rho4 * d2) / (2 * w1 * rho2 * d1),\n          r0 = Math.log(Math.sqrt(b0 * b0 + 1) - b0),\n          r1 = Math.log(Math.sqrt(b1 * b1 + 1) - b1);\n      S = (r1 - r0) / rho;\n      i = function(t) {\n        var s = t * S,\n            coshr0 = cosh(r0),\n            u = w0 / (rho2 * d1) * (coshr0 * tanh(rho * s + r0) - sinh(r0));\n        return [\n          ux0 + u * dx,\n          uy0 + u * dy,\n          w0 * coshr0 / cosh(rho * s + r0)\n        ];\n      }\n    }\n\n    i.duration = S * 1000 * rho / Math.SQRT2;\n\n    return i;\n  }\n\n  zoom.rho = function(_) {\n    var _1 = Math.max(1e-3, +_), _2 = _1 * _1, _4 = _2 * _2;\n    return zoomRho(_1, _2, _4);\n  };\n\n  return zoom;\n})(Math.SQRT2, 2, 4);\n","export default x => () => x;\n","export default function ZoomEvent(type, {\n  sourceEvent,\n  target,\n  transform,\n  dispatch\n}) {\n  Object.defineProperties(this, {\n    type: {value: type, enumerable: true, configurable: true},\n    sourceEvent: {value: sourceEvent, enumerable: true, configurable: true},\n    target: {value: target, enumerable: true, configurable: true},\n    transform: {value: transform, enumerable: true, configurable: true},\n    _: {value: dispatch}\n  });\n}\n","export function nopropagation(event) {\n  event.stopImmediatePropagation();\n}\n\nexport default function(event) {\n  event.preventDefault();\n  event.stopImmediatePropagation();\n}\n","import {dispatch} from \"d3-dispatch\";\nimport {dragDisable, dragEnable} from \"d3-drag\";\nimport {interpolateZoom} from \"d3-interpolate\";\nimport {select, pointer} from \"d3-selection\";\nimport {interrupt} from \"d3-transition\";\nimport constant from \"./constant.js\";\nimport ZoomEvent from \"./event.js\";\nimport {Transform, identity} from \"./transform.js\";\nimport noevent, {nopropagation} from \"./noevent.js\";\n\n// Ignore right-click, since that should open the context menu.\n// except for pinch-to-zoom, which is sent as a wheel+ctrlKey event\nfunction defaultFilter(event) {\n  return (!event.ctrlKey || event.type === 'wheel') && !event.button;\n}\n\nfunction defaultExtent() {\n  var e = this;\n  if (e instanceof SVGElement) {\n    e = e.ownerSVGElement || e;\n    if (e.hasAttribute(\"viewBox\")) {\n      e = e.viewBox.baseVal;\n      return [[e.x, e.y], [e.x + e.width, e.y + e.height]];\n    }\n    return [[0, 0], [e.width.baseVal.value, e.height.baseVal.value]];\n  }\n  return [[0, 0], [e.clientWidth, e.clientHeight]];\n}\n\nfunction defaultTransform() {\n  return this.__zoom || identity;\n}\n\nfunction defaultWheelDelta(event) {\n  return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * (event.ctrlKey ? 10 : 1);\n}\n\nfunction defaultTouchable() {\n  return navigator.maxTouchPoints || (\"ontouchstart\" in this);\n}\n\nfunction defaultConstrain(transform, extent, translateExtent) {\n  var dx0 = transform.invertX(extent[0][0]) - translateExtent[0][0],\n      dx1 = transform.invertX(extent[1][0]) - translateExtent[1][0],\n      dy0 = transform.invertY(extent[0][1]) - translateExtent[0][1],\n      dy1 = transform.invertY(extent[1][1]) - translateExtent[1][1];\n  return transform.translate(\n    dx1 > dx0 ? (dx0 + dx1) / 2 : Math.min(0, dx0) || Math.max(0, dx1),\n    dy1 > dy0 ? (dy0 + dy1) / 2 : Math.min(0, dy0) || Math.max(0, dy1)\n  );\n}\n\nexport default function() {\n  var filter = defaultFilter,\n      extent = defaultExtent,\n      constrain = defaultConstrain,\n      wheelDelta = defaultWheelDelta,\n      touchable = defaultTouchable,\n      scaleExtent = [0, Infinity],\n      translateExtent = [[-Infinity, -Infinity], [Infinity, Infinity]],\n      duration = 250,\n      interpolate = interpolateZoom,\n      listeners = dispatch(\"start\", \"zoom\", \"end\"),\n      touchstarting,\n      touchfirst,\n      touchending,\n      touchDelay = 500,\n      wheelDelay = 150,\n      clickDistance2 = 0,\n      tapDistance = 10;\n\n  function zoom(selection) {\n    selection\n        .property(\"__zoom\", defaultTransform)\n        .on(\"wheel.zoom\", wheeled, {passive: false})\n        .on(\"mousedown.zoom\", mousedowned)\n        .on(\"dblclick.zoom\", dblclicked)\n      .filter(touchable)\n        .on(\"touchstart.zoom\", touchstarted)\n        .on(\"touchmove.zoom\", touchmoved)\n        .on(\"touchend.zoom touchcancel.zoom\", touchended)\n        .style(\"-webkit-tap-highlight-color\", \"rgba(0,0,0,0)\");\n  }\n\n  zoom.transform = function(collection, transform, point, event) {\n    var selection = collection.selection ? collection.selection() : collection;\n    selection.property(\"__zoom\", defaultTransform);\n    if (collection !== selection) {\n      schedule(collection, transform, point, event);\n    } else {\n      selection.interrupt().each(function() {\n        gesture(this, arguments)\n          .event(event)\n          .start()\n          .zoom(null, typeof transform === \"function\" ? transform.apply(this, arguments) : transform)\n          .end();\n      });\n    }\n  };\n\n  zoom.scaleBy = function(selection, k, p, event) {\n    zoom.scaleTo(selection, function() {\n      var k0 = this.__zoom.k,\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return k0 * k1;\n    }, p, event);\n  };\n\n  zoom.scaleTo = function(selection, k, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t0 = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p,\n          p1 = t0.invert(p0),\n          k1 = typeof k === \"function\" ? k.apply(this, arguments) : k;\n      return constrain(translate(scale(t0, k1), p0, p1), e, translateExtent);\n    }, p, event);\n  };\n\n  zoom.translateBy = function(selection, x, y, event) {\n    zoom.transform(selection, function() {\n      return constrain(this.__zoom.translate(\n        typeof x === \"function\" ? x.apply(this, arguments) : x,\n        typeof y === \"function\" ? y.apply(this, arguments) : y\n      ), extent.apply(this, arguments), translateExtent);\n    }, null, event);\n  };\n\n  zoom.translateTo = function(selection, x, y, p, event) {\n    zoom.transform(selection, function() {\n      var e = extent.apply(this, arguments),\n          t = this.__zoom,\n          p0 = p == null ? centroid(e) : typeof p === \"function\" ? p.apply(this, arguments) : p;\n      return constrain(identity.translate(p0[0], p0[1]).scale(t.k).translate(\n        typeof x === \"function\" ? -x.apply(this, arguments) : -x,\n        typeof y === \"function\" ? -y.apply(this, arguments) : -y\n      ), e, translateExtent);\n    }, p, event);\n  };\n\n  function scale(transform, k) {\n    k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], k));\n    return k === transform.k ? transform : new Transform(k, transform.x, transform.y);\n  }\n\n  function translate(transform, p0, p1) {\n    var x = p0[0] - p1[0] * transform.k, y = p0[1] - p1[1] * transform.k;\n    return x === transform.x && y === transform.y ? transform : new Transform(transform.k, x, y);\n  }\n\n  function centroid(extent) {\n    return [(+extent[0][0] + +extent[1][0]) / 2, (+extent[0][1] + +extent[1][1]) / 2];\n  }\n\n  function schedule(transition, transform, point, event) {\n    transition\n        .on(\"start.zoom\", function() { gesture(this, arguments).event(event).start(); })\n        .on(\"interrupt.zoom end.zoom\", function() { gesture(this, arguments).event(event).end(); })\n        .tween(\"zoom\", function() {\n          var that = this,\n              args = arguments,\n              g = gesture(that, args).event(event),\n              e = extent.apply(that, args),\n              p = point == null ? centroid(e) : typeof point === \"function\" ? point.apply(that, args) : point,\n              w = Math.max(e[1][0] - e[0][0], e[1][1] - e[0][1]),\n              a = that.__zoom,\n              b = typeof transform === \"function\" ? transform.apply(that, args) : transform,\n              i = interpolate(a.invert(p).concat(w / a.k), b.invert(p).concat(w / b.k));\n          return function(t) {\n            if (t === 1) t = b; // Avoid rounding error on end.\n            else { var l = i(t), k = w / l[2]; t = new Transform(k, p[0] - l[0] * k, p[1] - l[1] * k); }\n            g.zoom(null, t);\n          };\n        });\n  }\n\n  function gesture(that, args, clean) {\n    return (!clean && that.__zooming) || new Gesture(that, args);\n  }\n\n  function Gesture(that, args) {\n    this.that = that;\n    this.args = args;\n    this.active = 0;\n    this.sourceEvent = null;\n    this.extent = extent.apply(that, args);\n    this.taps = 0;\n  }\n\n  Gesture.prototype = {\n    event: function(event) {\n      if (event) this.sourceEvent = event;\n      return this;\n    },\n    start: function() {\n      if (++this.active === 1) {\n        this.that.__zooming = this;\n        this.emit(\"start\");\n      }\n      return this;\n    },\n    zoom: function(key, transform) {\n      if (this.mouse && key !== \"mouse\") this.mouse[1] = transform.invert(this.mouse[0]);\n      if (this.touch0 && key !== \"touch\") this.touch0[1] = transform.invert(this.touch0[0]);\n      if (this.touch1 && key !== \"touch\") this.touch1[1] = transform.invert(this.touch1[0]);\n      this.that.__zoom = transform;\n      this.emit(\"zoom\");\n      return this;\n    },\n    end: function() {\n      if (--this.active === 0) {\n        delete this.that.__zooming;\n        this.emit(\"end\");\n      }\n      return this;\n    },\n    emit: function(type) {\n      var d = select(this.that).datum();\n      listeners.call(\n        type,\n        this.that,\n        new ZoomEvent(type, {\n          sourceEvent: this.sourceEvent,\n          target: zoom,\n          type,\n          transform: this.that.__zoom,\n          dispatch: listeners\n        }),\n        d\n      );\n    }\n  };\n\n  function wheeled(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var g = gesture(this, args).event(event),\n        t = this.__zoom,\n        k = Math.max(scaleExtent[0], Math.min(scaleExtent[1], t.k * Math.pow(2, wheelDelta.apply(this, arguments)))),\n        p = pointer(event);\n\n    // If the mouse is in the same location as before, reuse it.\n    // If there were recent wheel events, reset the wheel idle timeout.\n    if (g.wheel) {\n      if (g.mouse[0][0] !== p[0] || g.mouse[0][1] !== p[1]) {\n        g.mouse[1] = t.invert(g.mouse[0] = p);\n      }\n      clearTimeout(g.wheel);\n    }\n\n    // If this wheel event won’t trigger a transform change, ignore it.\n    else if (t.k === k) return;\n\n    // Otherwise, capture the mouse point and location at the start.\n    else {\n      g.mouse = [p, t.invert(p)];\n      interrupt(this);\n      g.start();\n    }\n\n    noevent(event);\n    g.wheel = setTimeout(wheelidled, wheelDelay);\n    g.zoom(\"mouse\", constrain(translate(scale(t, k), g.mouse[0], g.mouse[1]), g.extent, translateExtent));\n\n    function wheelidled() {\n      g.wheel = null;\n      g.end();\n    }\n  }\n\n  function mousedowned(event, ...args) {\n    if (touchending || !filter.apply(this, arguments)) return;\n    var currentTarget = event.currentTarget,\n        g = gesture(this, args, true).event(event),\n        v = select(event.view).on(\"mousemove.zoom\", mousemoved, true).on(\"mouseup.zoom\", mouseupped, true),\n        p = pointer(event, currentTarget),\n        x0 = event.clientX,\n        y0 = event.clientY;\n\n    dragDisable(event.view);\n    nopropagation(event);\n    g.mouse = [p, this.__zoom.invert(p)];\n    interrupt(this);\n    g.start();\n\n    function mousemoved(event) {\n      noevent(event);\n      if (!g.moved) {\n        var dx = event.clientX - x0, dy = event.clientY - y0;\n        g.moved = dx * dx + dy * dy > clickDistance2;\n      }\n      g.event(event)\n       .zoom(\"mouse\", constrain(translate(g.that.__zoom, g.mouse[0] = pointer(event, currentTarget), g.mouse[1]), g.extent, translateExtent));\n    }\n\n    function mouseupped(event) {\n      v.on(\"mousemove.zoom mouseup.zoom\", null);\n      dragEnable(event.view, g.moved);\n      noevent(event);\n      g.event(event).end();\n    }\n  }\n\n  function dblclicked(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var t0 = this.__zoom,\n        p0 = pointer(event.changedTouches ? event.changedTouches[0] : event, this),\n        p1 = t0.invert(p0),\n        k1 = t0.k * (event.shiftKey ? 0.5 : 2),\n        t1 = constrain(translate(scale(t0, k1), p0, p1), extent.apply(this, args), translateExtent);\n\n    noevent(event);\n    if (duration > 0) select(this).transition().duration(duration).call(schedule, t1, p0, event);\n    else select(this).call(zoom.transform, t1, p0, event);\n  }\n\n  function touchstarted(event, ...args) {\n    if (!filter.apply(this, arguments)) return;\n    var touches = event.touches,\n        n = touches.length,\n        g = gesture(this, args, event.changedTouches.length === n).event(event),\n        started, i, t, p;\n\n    nopropagation(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      p = [p, this.__zoom.invert(p), t.identifier];\n      if (!g.touch0) g.touch0 = p, started = true, g.taps = 1 + !!touchstarting;\n      else if (!g.touch1 && g.touch0[2] !== p[2]) g.touch1 = p, g.taps = 0;\n    }\n\n    if (touchstarting) touchstarting = clearTimeout(touchstarting);\n\n    if (started) {\n      if (g.taps < 2) touchfirst = p[0], touchstarting = setTimeout(function() { touchstarting = null; }, touchDelay);\n      interrupt(this);\n      g.start();\n    }\n  }\n\n  function touchmoved(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t, p, l;\n\n    noevent(event);\n    for (i = 0; i < n; ++i) {\n      t = touches[i], p = pointer(t, this);\n      if (g.touch0 && g.touch0[2] === t.identifier) g.touch0[0] = p;\n      else if (g.touch1 && g.touch1[2] === t.identifier) g.touch1[0] = p;\n    }\n    t = g.that.__zoom;\n    if (g.touch1) {\n      var p0 = g.touch0[0], l0 = g.touch0[1],\n          p1 = g.touch1[0], l1 = g.touch1[1],\n          dp = (dp = p1[0] - p0[0]) * dp + (dp = p1[1] - p0[1]) * dp,\n          dl = (dl = l1[0] - l0[0]) * dl + (dl = l1[1] - l0[1]) * dl;\n      t = scale(t, Math.sqrt(dp / dl));\n      p = [(p0[0] + p1[0]) / 2, (p0[1] + p1[1]) / 2];\n      l = [(l0[0] + l1[0]) / 2, (l0[1] + l1[1]) / 2];\n    }\n    else if (g.touch0) p = g.touch0[0], l = g.touch0[1];\n    else return;\n\n    g.zoom(\"touch\", constrain(translate(t, p, l), g.extent, translateExtent));\n  }\n\n  function touchended(event, ...args) {\n    if (!this.__zooming) return;\n    var g = gesture(this, args).event(event),\n        touches = event.changedTouches,\n        n = touches.length, i, t;\n\n    nopropagation(event);\n    if (touchending) clearTimeout(touchending);\n    touchending = setTimeout(function() { touchending = null; }, touchDelay);\n    for (i = 0; i < n; ++i) {\n      t = touches[i];\n      if (g.touch0 && g.touch0[2] === t.identifier) delete g.touch0;\n      else if (g.touch1 && g.touch1[2] === t.identifier) delete g.touch1;\n    }\n    if (g.touch1 && !g.touch0) g.touch0 = g.touch1, delete g.touch1;\n    if (g.touch0) g.touch0[1] = this.__zoom.invert(g.touch0[0]);\n    else {\n      g.end();\n      // If this was a dbltap, reroute to the (optional) dblclick.zoom handler.\n      if (g.taps === 2) {\n        t = pointer(t, this);\n        if (Math.hypot(touchfirst[0] - t[0], touchfirst[1] - t[1]) < tapDistance) {\n          var p = select(this).on(\"dblclick.zoom\");\n          if (p) p.apply(this, arguments);\n        }\n      }\n    }\n  }\n\n  zoom.wheelDelta = function(_) {\n    return arguments.length ? (wheelDelta = typeof _ === \"function\" ? _ : constant(+_), zoom) : wheelDelta;\n  };\n\n  zoom.filter = function(_) {\n    return arguments.length ? (filter = typeof _ === \"function\" ? _ : constant(!!_), zoom) : filter;\n  };\n\n  zoom.touchable = function(_) {\n    return arguments.length ? (touchable = typeof _ === \"function\" ? _ : constant(!!_), zoom) : touchable;\n  };\n\n  zoom.extent = function(_) {\n    return arguments.length ? (extent = typeof _ === \"function\" ? _ : constant([[+_[0][0], +_[0][1]], [+_[1][0], +_[1][1]]]), zoom) : extent;\n  };\n\n  zoom.scaleExtent = function(_) {\n    return arguments.length ? (scaleExtent[0] = +_[0], scaleExtent[1] = +_[1], zoom) : [scaleExtent[0], scaleExtent[1]];\n  };\n\n  zoom.translateExtent = function(_) {\n    return arguments.length ? (translateExtent[0][0] = +_[0][0], translateExtent[1][0] = +_[1][0], translateExtent[0][1] = +_[0][1], translateExtent[1][1] = +_[1][1], zoom) : [[translateExtent[0][0], translateExtent[0][1]], [translateExtent[1][0], translateExtent[1][1]]];\n  };\n\n  zoom.constrain = function(_) {\n    return arguments.length ? (constrain = _, zoom) : constrain;\n  };\n\n  zoom.duration = function(_) {\n    return arguments.length ? (duration = +_, zoom) : duration;\n  };\n\n  zoom.interpolate = function(_) {\n    return arguments.length ? (interpolate = _, zoom) : interpolate;\n  };\n\n  zoom.on = function() {\n    var value = listeners.on.apply(listeners, arguments);\n    return value === listeners ? zoom : value;\n  };\n\n  zoom.clickDistance = function(_) {\n    return arguments.length ? (clickDistance2 = (_ = +_) * _, zoom) : Math.sqrt(clickDistance2);\n  };\n\n  zoom.tapDistance = function(_) {\n    return arguments.length ? (tapDistance = +_, zoom) : tapDistance;\n  };\n\n  return zoom;\n}\n","<script>import { derived } from \"svelte/store\";\nimport { setSubMenuCtx } from \"../ctx.js\";\nexport let disabled = void 0;\nexport let open = void 0;\nexport let onOpenChange = void 0;\nconst {\n  updateOption,\n  ids,\n  states: { subOpen }\n} = setSubMenuCtx({\n  disabled,\n  onOpenChange: ({ next }) => {\n    if (open !== next) {\n      onOpenChange?.(next);\n      open = next;\n    }\n    return next;\n  }\n});\nconst idValues = derived([ids.menu, ids.trigger], ([$menuId, $triggerId]) => ({\n  menu: $menuId,\n  trigger: $triggerId\n}));\n$:\n  open !== void 0 && subOpen.set(open);\n$:\n  updateOption(\"disabled\", disabled);\n</script>\n\n<slot subIds={$idValues} />\n","<script>import { melt } from \"@melt-ui/svelte\";\nimport { createDispatcher } from \"../../../internal/index.js\";\nimport { getSubmenuCtx, updateSubPositioning } from \"../ctx.js\";\nexport let transition = void 0;\nexport let transitionConfig = void 0;\nexport let inTransition = void 0;\nexport let inTransitionConfig = void 0;\nexport let outTransition = void 0;\nexport let outTransitionConfig = void 0;\nexport let asChild = false;\nexport let id = void 0;\nexport let side = \"right\";\nexport let align = \"start\";\nexport let sideOffset = 0;\nexport let alignOffset = 0;\nexport let collisionPadding = 8;\nexport let avoidCollisions = true;\nexport let collisionBoundary = void 0;\nexport let sameWidth = false;\nexport let fitViewport = false;\nexport let strategy = \"absolute\";\nexport let overlap = false;\nexport let el = void 0;\nconst {\n  elements: { subMenu },\n  states: { subOpen },\n  ids,\n  getAttrs\n} = getSubmenuCtx();\nconst dispatch = createDispatcher();\nconst attrs = getAttrs(\"sub-content\");\n$:\n  if (id) {\n    ids.menu.set(id);\n  }\n$:\n  builder = $subMenu;\n$:\n  Object.assign(builder, attrs);\n$:\n  updateSubPositioning({\n    side,\n    align,\n    sideOffset,\n    alignOffset,\n    collisionPadding,\n    avoidCollisions,\n    collisionBoundary,\n    sameWidth,\n    fitViewport,\n    strategy,\n    overlap\n  });\n</script>\n\n{#if asChild && $subOpen}\n\t<slot {builder} />\n{:else if transition && $subOpen}\n\t<div\n\t\tbind:this={el}\n\t\ttransition:transition={transitionConfig}\n\t\t{...builder} use:builder.action\n\t\t{...$$restProps}\n\t\ton:m-focusout={dispatch}\n\t\ton:m-keydown={dispatch}\n\t\ton:m-pointermove={dispatch}\n\t>\n\t\t<slot {builder} />\n\t</div>\n{:else if inTransition && outTransition && $subOpen}\n\t<div\n\t\tbind:this={el}\n\t\tin:inTransition={inTransitionConfig}\n\t\tout:outTransition={outTransitionConfig}\n\t\t{...builder} use:builder.action\n\t\t{...$$restProps}\n\t\ton:m-focusout={dispatch}\n\t\ton:m-keydown={dispatch}\n\t\ton:m-pointermove={dispatch}\n\t>\n\t\t<slot {builder} />\n\t</div>\n{:else if inTransition && $subOpen}\n\t<div\n\t\tbind:this={el}\n\t\tin:inTransition={inTransitionConfig}\n\t\t{...builder} use:builder.action\n\t\t{...$$restProps}\n\t\ton:m-focusout={dispatch}\n\t\ton:m-keydown={dispatch}\n\t\ton:m-pointermove={dispatch}\n\t>\n\t\t<slot {builder} />\n\t</div>\n{:else if outTransition && $subOpen}\n\t<div\n\t\tbind:this={el}\n\t\tout:outTransition={outTransitionConfig}\n\t\t{...builder} use:builder.action\n\t\t{...$$restProps}\n\t\ton:m-focusout={dispatch}\n\t\ton:m-keydown={dispatch}\n\t\ton:m-pointermove={dispatch}\n\t>\n\t\t<slot {builder} />\n\t</div>\n{:else if $subOpen}\n\t<div\n\t\tbind:this={el}\n\t\t{...builder} use:builder.action\n\t\t{...$$restProps}\n\t\ton:m-focusout={dispatch}\n\t\ton:m-keydown={dispatch}\n\t\ton:m-pointermove={dispatch}\n\t>\n\t\t<slot {builder} />\n\t</div>\n{/if}\n","<script>import { melt } from \"@melt-ui/svelte\";\nimport { disabledAttrs } from \"../../../internal/index.js\";\nimport { getSubTrigger } from \"../ctx.js\";\nimport { createDispatcher } from \"../../../internal/events.js\";\nexport let disabled = false;\nexport let asChild = false;\nexport let id = void 0;\nexport let el = void 0;\nconst {\n  elements: { subTrigger },\n  ids,\n  getAttrs,\n  options\n} = getSubTrigger();\nconst { disabled: disabledStore } = options;\nconst dispatch = createDispatcher();\n$:\n  if (id) {\n    ids.trigger.set(id);\n  }\n$:\n  builder = $subTrigger;\n$:\n  attrs = {\n    ...getAttrs(\"sub-trigger\"),\n    ...disabledAttrs(disabled || $disabledStore)\n  };\n$:\n  Object.assign(builder, attrs);\n</script>\n\n{#if asChild}\n\t<slot {builder} />\n{:else}\n\t<div\n\t\tbind:this={el}\n\t\t{...builder} use:builder.action\n\t\t{...$$restProps}\n\t\ton:m-click={dispatch}\n\t\ton:m-focusin={dispatch}\n\t\ton:m-focusout={dispatch}\n\t\ton:m-keydown={dispatch}\n\t\ton:m-pointerleave={dispatch}\n\t\ton:m-pointermove={dispatch}\n\t>\n\t\t<slot {builder} />\n\t</div>\n{/if}\n","import { onDestroy } from \"svelte\";\n/**\n * Safely calls `onDestroy` and catches any errors that occur.\n */\nexport function safeOnDestroy(fn) {\n    try {\n        onDestroy(fn);\n    }\n    catch {\n        return fn();\n    }\n}\n","import { isBrowser, safeOnDestroy } from \"./index.js\";\nimport { derived, writable, } from \"svelte/store\";\n/**\n * A utility function that creates a derived store that automatically\n * unsubscribes from its dependencies.\n *\n * Originally written by @tglide for use in Melt UI. <3\n *\n * @template S - The type of the stores object\n * @template T - The type of the derived store\n * @param stores - The stores object to derive from\n * @param fn - The function to derive the store from\n * @returns A derived store that automatically unsubscribes from its dependencies\n */\nexport function derivedWithUnsubscribe(stores, fn) {\n    let unsubscribers = [];\n    const onUnsubscribe = (cb) => {\n        unsubscribers.push(cb);\n    };\n    const unsubscribe = () => {\n        // Call all of the unsubscribe functions from the previous run of the function\n        unsubscribers.forEach((fn) => fn());\n        // Clear the list of unsubscribe functions\n        unsubscribers = [];\n    };\n    const derivedStore = derived(stores, ($storeValues) => {\n        unsubscribe();\n        return fn($storeValues, onUnsubscribe);\n    });\n    safeOnDestroy(unsubscribe);\n    const subscribe = (...args) => {\n        const unsub = derivedStore.subscribe(...args);\n        return () => {\n            unsub();\n            unsubscribe();\n        };\n    };\n    return {\n        ...derivedStore,\n        subscribe,\n    };\n}\n/**\n * A utility function that creates an effect from a set of stores and a function.\n * The effect is automatically cleaned up when the component is destroyed.\n *\n * Originally written by @tglide for use in Melt UI. <3\n *\n * @template S - The type of the stores object\n * @param stores - The stores object to derive from\n * @param fn - The function to run when the stores change\n * @returns A function that can be used to unsubscribe the effect\n */\nexport function clientEffect(stores, fn) {\n    if (!isBrowser)\n        return () => { };\n    // Create a derived store that contains the stores object and an onUnsubscribe function\n    const unsub = derivedWithUnsubscribe(stores, (stores, onUnsubscribe) => {\n        return {\n            stores,\n            onUnsubscribe,\n        };\n    }).subscribe(({ stores, onUnsubscribe }) => {\n        const returned = fn(stores);\n        // If the function returns a cleanup function, call it when the effect is unsubscribed\n        if (returned) {\n            onUnsubscribe(returned);\n        }\n    });\n    // Automatically unsubscribe the effect when the component is destroyed\n    safeOnDestroy(unsub);\n    return unsub;\n}\n/**\n * Given an object of properties, returns an object of writable stores\n * with the same properties and values.\n */\nexport function toWritableStores(properties) {\n    const result = {};\n    Object.keys(properties).forEach((key) => {\n        const propertyKey = key;\n        const value = properties[propertyKey];\n        result[propertyKey] = writable(value);\n    });\n    return result;\n}\n/**\n * Returns a function that can be used to update the values of options\n * in a store based on the modification of a prop.\n */\nexport function getOptionUpdater(options) {\n    return function (key, value) {\n        if (value === undefined)\n            return;\n        const store = options[key];\n        if (store) {\n            store.set(value);\n        }\n    };\n}\n","/**\n * A utility function that converts a style object to a string,\n * which can be used as the value of the `style` attribute for\n * an element.\n *\n * @param style - The style object to convert\n * @returns The style object as a string\n */\nexport function styleToString(style) {\n    return Object.keys(style).reduce((str, key) => {\n        if (style[key] === undefined)\n            return str;\n        return str + `${key}:${style[key]};`;\n    }, \"\");\n}\n/* Global cursor state */\nlet currentState = null;\n/* Global cursor element */\nlet element = null;\n/**\n * Returns the cursor style for a given cursor state.\n */\nexport function getCursorStyle(state) {\n    switch (state) {\n        case \"horizontal\":\n            return \"ew-resize\";\n        case \"horizontal-max\":\n            return \"w-resize\";\n        case \"horizontal-min\":\n            return \"e-resize\";\n        case \"vertical\":\n            return \"ns-resize\";\n        case \"vertical-max\":\n            return \"n-resize\";\n        case \"vertical-min\":\n            return \"s-resize\";\n    }\n}\n/**\n * Resets the global cursor style to the default.\n */\nexport function resetGlobalCursorStyle() {\n    if (element === null)\n        return;\n    document.head.removeChild(element);\n    currentState = null;\n    element = null;\n}\n/**\n * Sets the global cursor style to the given state.\n */\nexport function setGlobalCursorStyle(state) {\n    if (currentState === state)\n        return;\n    currentState = state;\n    const style = getCursorStyle(state);\n    if (element === null) {\n        element = document.createElement(\"style\");\n        document.head.appendChild(element);\n    }\n    element.innerHTML = `*{cursor: ${style}!important;}`;\n}\n/**\n * Computes the flexbox style for a pane given its layout and drag state.\n */\nexport function computePaneFlexBoxStyle({ defaultSize, dragState, layout, paneData, paneIndex, precision = 3, }) {\n    const size = layout[paneIndex];\n    let flexGrow;\n    if (size == null) {\n        // Initial render (before panes have registered themselves)\n        // To support server rendering, fallback to default size\n        flexGrow = defaultSize ?? \"1\";\n    }\n    else if (paneData.length === 1) {\n        //  Single pane group should always fill full width/height\n        flexGrow = \"1\";\n    }\n    else {\n        flexGrow = size.toPrecision(precision);\n    }\n    return styleToString({\n        \"flex-basis\": 0,\n        \"flex-grow\": flexGrow,\n        \"flex-shrink\": 1,\n        // Without this, pane sizes may be unintentionally overridden by their content\n        overflow: \"hidden\",\n        // Disable pointer events inside of a pane during resize\n        // This avoid edge cases like nested iframes\n        \"pointer-events\": dragState !== null ? \"none\" : undefined,\n    });\n}\n","/**\n * A utility function that calculates the `aria-valuemax`, `aria-valuemin`,\n * and `aria-valuenow` values for a pane based on its layout and constraints.\n */\nexport function calculateAriaValues({ layout, panesArray, pivotIndices, }) {\n    let currentMinSize = 0;\n    let currentMaxSize = 100;\n    let totalMinSize = 0;\n    let totalMaxSize = 0;\n    const firstIndex = pivotIndices[0];\n    // A pane's effective min/max sizes also need to account for other pane's sizes.\n    for (let i = 0; i < panesArray.length; i++) {\n        const { constraints } = panesArray[i];\n        const { maxSize = 100, minSize = 0 } = constraints;\n        if (i === firstIndex) {\n            currentMinSize = minSize;\n            currentMaxSize = maxSize;\n        }\n        else {\n            totalMinSize += minSize;\n            totalMaxSize += maxSize;\n        }\n    }\n    const valueMax = Math.min(currentMaxSize, 100 - totalMinSize);\n    const valueMin = Math.max(currentMinSize, 100 - totalMaxSize);\n    const valueNow = layout[firstIndex];\n    return {\n        valueMax,\n        valueMin,\n        valueNow,\n    };\n}\n","import { nanoid } from \"nanoid/non-secure\";\n/**\n * If an id is provided return it, otherwise generate a new id and return that.\n */\nexport function generateId(idFromProps = null) {\n    if (idFromProps == null)\n        return nanoid(10);\n    return idFromProps;\n}\n","export const LOCAL_STORAGE_DEBOUNCE_INTERVAL = 100;\nexport const PRECISION = 10;\n","import { get } from \"svelte/store\";\nimport { LOCAL_STORAGE_DEBOUNCE_INTERVAL } from \"../constants.js\";\n/**\n * Initializes the storage object with the appropriate getItem\n *  and setItem functions depending on the environment (browser or not).\n */\nexport function initializeStorage(storageObject) {\n    try {\n        if (typeof localStorage === \"undefined\") {\n            throw new Error(\"localStorage is not supported in this environment\");\n        }\n        storageObject.getItem = (name) => localStorage.getItem(name);\n        storageObject.setItem = (name, value) => localStorage.setItem(name, value);\n    }\n    catch (err) {\n        // eslint-disable-next-line no-console\n        console.error(err);\n        storageObject.getItem = () => null;\n        storageObject.setItem = () => { };\n    }\n}\n/**\n * Returns the key to use for storing the pane group state in local storage.\n */\nfunction getPaneGroupKey(autoSaveId) {\n    return `paneforge:${autoSaveId}`;\n}\n/**\n * Returns a key to use for storing the pane state in local storage.\n * The key is based on the pane order and constraints.\n */\nfunction getPaneKey(panes) {\n    const sortedPaneIds = panes\n        .map((pane) => {\n        const { constraints, id, idIsFromProps, order } = pane;\n        return idIsFromProps\n            ? id\n            : order\n                ? `${order}:${JSON.stringify(constraints)}`\n                : JSON.stringify(constraints);\n    })\n        .sort()\n        .join(\",\");\n    return sortedPaneIds;\n}\n/**\n * Loads the serialized pane group state from local storage.\n * If the state is not found, returns null.\n */\nfunction loadSerializedPaneGroupState(autoSaveId, storage) {\n    try {\n        const paneGroupKey = getPaneGroupKey(autoSaveId);\n        const serialized = storage.getItem(paneGroupKey);\n        const parsed = JSON.parse(serialized || \"\");\n        if (typeof parsed === \"object\" && parsed !== null) {\n            return parsed;\n        }\n    }\n    catch {\n        // noop\n    }\n    return null;\n}\n/**\n * Loads the pane group state from local storage.\n * If the state is not found, returns null.\n */\nexport function loadPaneGroupState(autoSaveId, panes, storage) {\n    const state = loadSerializedPaneGroupState(autoSaveId, storage) || {};\n    const paneKey = getPaneKey(panes);\n    return state[paneKey] || null;\n}\n/**\n * Saves the pane group state to local storage.\n */\nexport function savePaneGroupState(autoSaveId, panes, paneSizesBeforeCollapse, sizes, storage) {\n    const paneGroupKey = getPaneGroupKey(autoSaveId);\n    const paneKey = getPaneKey(panes);\n    const state = loadSerializedPaneGroupState(autoSaveId, storage) || {};\n    state[paneKey] = {\n        expandToSizes: Object.fromEntries(paneSizesBeforeCollapse.entries()),\n        layout: sizes,\n    };\n    try {\n        storage.setItem(paneGroupKey, JSON.stringify(state));\n    }\n    catch (error) {\n        // eslint-disable-next-line no-console\n        console.error(error);\n    }\n}\nconst debounceMap = {};\n/**\n * Returns a debounced version of the given function.\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nfunction debounce(callback, durationMs = 10) {\n    let timeoutId = null;\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    const callable = (...args) => {\n        if (timeoutId !== null) {\n            clearTimeout(timeoutId);\n        }\n        timeoutId = setTimeout(() => {\n            callback(...args);\n        }, durationMs);\n    };\n    return callable;\n}\n/**\n * Updates the values in local storage based on the current state of\n * the pane group.\n * This function is debounced to limit the frequency of local storage writes.\n */\nexport function updateStorageValues({ autoSaveId, layout, storage, paneDataArrayStore, paneSizeBeforeCollapseStore, }) {\n    const $paneDataArray = get(paneDataArrayStore);\n    // If this pane has been configured to persist sizing\n    // information, save sizes to local storage.\n    if (layout.length === 0 || layout.length !== $paneDataArray.length)\n        return;\n    let debouncedSave = debounceMap[autoSaveId];\n    // Limit frequency of local storage writes.\n    if (debouncedSave == null) {\n        debouncedSave = debounce(savePaneGroupState, LOCAL_STORAGE_DEBOUNCE_INTERVAL);\n        debounceMap[autoSaveId] = debouncedSave;\n    }\n    // Clone mutable data before passing to the debounced function,\n    // else we run the risk of saving an incorrect combination of mutable and immutable values to state.\n    const clonedPaneDataArray = [...$paneDataArray];\n    const $paneSizeBeforeCollapse = get(paneSizeBeforeCollapseStore);\n    const clonedPaneSizesBeforeCollapse = new Map($paneSizeBeforeCollapse);\n    debouncedSave(autoSaveId, clonedPaneDataArray, clonedPaneSizesBeforeCollapse, layout, storage);\n}\n","/**\n * Removes all undefined properties from the given object.\n */\nexport function removeUndefined(obj) {\n    const result = {};\n    for (const key in obj) {\n        const value = obj[key];\n        if (value !== undefined) {\n            result[key] = value;\n        }\n    }\n    return result;\n}\n","/**\n * Executes an array of callback functions with the same arguments.\n * @template T The types of the arguments that the callback functions take.\n * @param n array of callback functions to execute.\n * @returns A new function that executes all of the original callback functions with the same arguments.\n */\nexport function chain(...callbacks) {\n    return (...args) => {\n        for (const callback of callbacks) {\n            if (typeof callback === \"function\") {\n                callback(...args);\n            }\n        }\n    };\n}\n","/**\n * Adds an event listener to the specified target element(s) for the given event(s), and returns a function to remove it.\n * @param target The target element(s) to add the event listener to.\n * @param event The event(s) to listen for.\n * @param handler The function to be called when the event is triggered.\n * @param options An optional object that specifies characteristics about the event listener.\n * @returns A function that removes the event listener from the target element(s).\n */\nexport function addEventListener(target, event, handler, options) {\n    const events = Array.isArray(event) ? event : [event];\n    // Add the event listener to each specified event for the target element(s).\n    events.forEach((_event) => target.addEventListener(_event, handler, options));\n    // Return a function that removes the event listener from the target element(s).\n    return () => {\n        events.forEach((_event) => target.removeEventListener(_event, handler, options));\n    };\n}\n","import { PRECISION } from \"../constants.js\";\n/**\n * Compares two numbers for equality with a given fractional precision.\n */\nexport function areNumbersAlmostEqual(actual, expected, fractionDigits = PRECISION) {\n    return compareNumbersWithTolerance(actual, expected, fractionDigits) === 0;\n}\n/**\n * Compares two numbers with a given tolerance.\n *\n * @returns `-1` if `actual` is less than `expected`, `0` if they are equal,\n * and `1` if `actual` is greater than `expected`.\n */\nexport function compareNumbersWithTolerance(actual, expected, fractionDigits = PRECISION) {\n    const roundedActual = roundTo(actual, fractionDigits);\n    const roundedExpected = roundTo(expected, fractionDigits);\n    return Math.sign(roundedActual - roundedExpected);\n}\n/**\n * Compares two arrays for equality.\n */\nexport function areArraysEqual(arrA, arrB) {\n    if (arrA.length !== arrB.length)\n        return false;\n    for (let index = 0; index < arrA.length; index++) {\n        if (arrA[index] !== arrB[index])\n            return false;\n    }\n    return true;\n}\n/**\n * Rounds a number to a given number of decimal places.\n */\nfunction roundTo(value, decimals) {\n    return parseFloat(value.toFixed(decimals));\n}\n","export function assert(\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexpectedCondition, message = \"Assertion failed!\") {\n    if (!expectedCondition) {\n        // eslint-disable-next-line no-console\n        console.error(message);\n        throw Error(message);\n    }\n}\n","import { PRECISION } from \"../constants.js\";\nimport { assert } from \"./assert.js\";\nimport { compareNumbersWithTolerance } from \"./compare.js\";\n/**\n * Resizes a pane based on its constraints.\n */\nexport function resizePane({ paneConstraints: paneConstraintsArray, paneIndex, initialSize, }) {\n    const paneConstraints = paneConstraintsArray[paneIndex];\n    assert(paneConstraints != null, \"Pane constraints should not be null.\");\n    const { collapsedSize = 0, collapsible, maxSize = 100, minSize = 0 } = paneConstraints;\n    let newSize = initialSize;\n    if (compareNumbersWithTolerance(newSize, minSize) < 0) {\n        newSize = getAdjustedSizeForCollapsible(newSize, collapsible, collapsedSize, minSize);\n    }\n    newSize = Math.min(maxSize, newSize);\n    return parseFloat(newSize.toFixed(PRECISION));\n}\n/**\n * Adjusts the size of a pane based on its collapsible state.\n *\n * If the pane is collapsible, the size will be snapped to the collapsed size\n * or the minimum size based on the halfway point.\n */\nfunction getAdjustedSizeForCollapsible(size, collapsible, collapsedSize, minSize) {\n    if (!collapsible)\n        return minSize;\n    // Snap collapsible panes closed or open based on the halfway point.\n    const halfwayPoint = (collapsedSize + minSize) / 2;\n    return compareNumbersWithTolerance(size, halfwayPoint) < 0 ? collapsedSize : minSize;\n}\n","import { assert } from \"./assert.js\";\nimport { compareNumbersWithTolerance, areNumbersAlmostEqual, resizePane, } from \"./index.js\";\n/**\n * Adjusts the layout of panes based on the delta of the resize handle.\n * All units must be in percentages; pixel values should be pre-converted.\n *\n * Credit: https://github.com/bvaughn/react-resizable-panels\n */\nexport function adjustLayoutByDelta({ delta, layout: prevLayout, paneConstraints: paneConstraintsArray, pivotIndices, trigger, }) {\n    if (areNumbersAlmostEqual(delta, 0))\n        return prevLayout;\n    const nextLayout = [...prevLayout];\n    const [firstPivotIndex, secondPivotIndex] = pivotIndices;\n    let deltaApplied = 0;\n    // A resizing pane affects the panes before or after it.\n    //\n    // A negative delta means the pane(s) immediately after the resize handle should grow/expand by decreasing its offset.\n    // Other panes may also need to shrink/contract (and shift) to make room, depending on the min weights.\n    //\n    // A positive delta means the pane(s) immediately before the resize handle should \"expand\".\n    // This is accomplished by shrinking/contracting (and shifting) one or more of the panes after the resize handle.\n    {\n        // If this is a resize triggered by a keyboard event, our logic for expanding/collapsing is different.\n        // We no longer check the halfway threshold because this may prevent the pane from expanding at all.\n        if (trigger === \"keyboard\") {\n            {\n                // Check if we should expand a collapsed pane\n                const index = delta < 0 ? secondPivotIndex : firstPivotIndex;\n                const paneConstraints = paneConstraintsArray[index];\n                assert(paneConstraints);\n                if (paneConstraints.collapsible) {\n                    const prevSize = prevLayout[index];\n                    assert(prevSize != null);\n                    const paneConstraints = paneConstraintsArray[index];\n                    assert(paneConstraints);\n                    const { collapsedSize = 0, minSize = 0 } = paneConstraints;\n                    if (areNumbersAlmostEqual(prevSize, collapsedSize)) {\n                        const localDelta = minSize - prevSize;\n                        //DEBUG.push(`  -> expand delta: ${localDelta}`);\n                        if (compareNumbersWithTolerance(localDelta, Math.abs(delta)) > 0) {\n                            delta = delta < 0 ? 0 - localDelta : localDelta;\n                            //DEBUG.push(`  -> delta: ${delta}`);\n                        }\n                    }\n                }\n            }\n            {\n                // Check if we should collapse a pane at its minimum size\n                const index = delta < 0 ? firstPivotIndex : secondPivotIndex;\n                const paneConstraints = paneConstraintsArray[index];\n                assert(paneConstraints);\n                const { collapsible } = paneConstraints;\n                if (collapsible) {\n                    const prevSize = prevLayout[index];\n                    assert(prevSize != null);\n                    const paneConstraints = paneConstraintsArray[index];\n                    assert(paneConstraints);\n                    const { collapsedSize = 0, minSize = 0 } = paneConstraints;\n                    if (areNumbersAlmostEqual(prevSize, minSize)) {\n                        const localDelta = prevSize - collapsedSize;\n                        if (compareNumbersWithTolerance(localDelta, Math.abs(delta)) > 0) {\n                            delta = delta < 0 ? 0 - localDelta : localDelta;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    {\n        // Pre-calculate max available delta in the opposite direction of our pivot.\n        // This will be the maximum amount we're allowed to expand/contract the panes in the primary direction.\n        // If this amount is less than the requested delta, adjust the requested delta.\n        // If this amount is greater than the requested delta, that's useful information too–\n        // as an expanding pane might change from collapsed to min size.\n        const increment = delta < 0 ? 1 : -1;\n        let index = delta < 0 ? secondPivotIndex : firstPivotIndex;\n        let maxAvailableDelta = 0;\n        // eslint-disable-next-line no-constant-condition\n        while (true) {\n            const prevSize = prevLayout[index];\n            assert(prevSize != null);\n            const maxSafeSize = resizePane({\n                paneConstraints: paneConstraintsArray,\n                paneIndex: index,\n                initialSize: 100,\n            });\n            const delta = maxSafeSize - prevSize;\n            maxAvailableDelta += delta;\n            index += increment;\n            if (index < 0 || index >= paneConstraintsArray.length) {\n                break;\n            }\n        }\n        const minAbsDelta = Math.min(Math.abs(delta), Math.abs(maxAvailableDelta));\n        delta = delta < 0 ? 0 - minAbsDelta : minAbsDelta;\n    }\n    {\n        // Delta added to a pane needs to be subtracted from other panes (within the constraints that those panes allow).\n        const pivotIndex = delta < 0 ? firstPivotIndex : secondPivotIndex;\n        let index = pivotIndex;\n        while (index >= 0 && index < paneConstraintsArray.length) {\n            const deltaRemaining = Math.abs(delta) - Math.abs(deltaApplied);\n            const prevSize = prevLayout[index];\n            assert(prevSize != null);\n            const unsafeSize = prevSize - deltaRemaining;\n            const safeSize = resizePane({\n                paneConstraints: paneConstraintsArray,\n                paneIndex: index,\n                initialSize: unsafeSize,\n            });\n            if (!areNumbersAlmostEqual(prevSize, safeSize)) {\n                deltaApplied += prevSize - safeSize;\n                nextLayout[index] = safeSize;\n                if (deltaApplied.toPrecision(3).localeCompare(Math.abs(delta).toPrecision(3), undefined, {\n                    numeric: true,\n                }) >= 0) {\n                    break;\n                }\n            }\n            if (delta < 0) {\n                index--;\n            }\n            else {\n                index++;\n            }\n        }\n    }\n    // If we were unable to resize any of the panes, return the previous state.\n    // This will essentially bailout and ignore e.g. drags past a pane's boundaries\n    if (areNumbersAlmostEqual(deltaApplied, 0)) {\n        return prevLayout;\n    }\n    {\n        // Now distribute the applied delta to the panes in the other direction\n        const pivotIndex = delta < 0 ? secondPivotIndex : firstPivotIndex;\n        const prevSize = prevLayout[pivotIndex];\n        assert(prevSize != null);\n        const unsafeSize = prevSize + deltaApplied;\n        const safeSize = resizePane({\n            paneConstraints: paneConstraintsArray,\n            paneIndex: pivotIndex,\n            initialSize: unsafeSize,\n        });\n        // Adjust the pivot pane before, but only by the amount that surrounding panes were able to shrink/contract.\n        nextLayout[pivotIndex] = safeSize;\n        // Edge case where expanding or contracting one pane caused another one to change collapsed state\n        if (!areNumbersAlmostEqual(safeSize, unsafeSize)) {\n            let deltaRemaining = unsafeSize - safeSize;\n            const pivotIndex = delta < 0 ? secondPivotIndex : firstPivotIndex;\n            let index = pivotIndex;\n            while (index >= 0 && index < paneConstraintsArray.length) {\n                const prevSize = nextLayout[index];\n                assert(prevSize != null);\n                const unsafeSize = prevSize + deltaRemaining;\n                const safeSize = resizePane({\n                    paneConstraints: paneConstraintsArray,\n                    paneIndex: index,\n                    initialSize: unsafeSize,\n                });\n                if (!areNumbersAlmostEqual(prevSize, safeSize)) {\n                    deltaRemaining -= safeSize - prevSize;\n                    nextLayout[index] = safeSize;\n                }\n                if (areNumbersAlmostEqual(deltaRemaining, 0))\n                    break;\n                delta > 0 ? index-- : index++;\n            }\n        }\n    }\n    const totalSize = nextLayout.reduce((total, size) => size + total, 0);\n    if (!areNumbersAlmostEqual(totalSize, 100))\n        return prevLayout;\n    return nextLayout;\n}\n","export const isBrowser = typeof document !== \"undefined\";\nexport function isHTMLElement(element) {\n    return element instanceof HTMLElement;\n}\nexport function isKeyDown(event) {\n    return event.type === \"keydown\";\n}\nexport function isMouseEvent(event) {\n    return event.type.startsWith(\"mouse\");\n}\nexport function isTouchEvent(event) {\n    return event.type.startsWith(\"touch\");\n}\n","import { initializeStorage, loadPaneGroupState, resizePane, resetGlobalCursorStyle, setGlobalCursorStyle, updateStorageValues, adjustLayoutByDelta, areNumbersAlmostEqual, areArraysEqual, generateId, removeUndefined, clientEffect, toWritableStores, calculateAriaValues, addEventListener, computePaneFlexBoxStyle, styleToString, isBrowser, isHTMLElement, isKeyDown, isMouseEvent, isTouchEvent, } from \"./utils/index.js\";\nimport { derived, get, writable } from \"svelte/store\";\nimport { assert } from \"./utils/assert.js\";\nimport { onMount } from \"svelte\";\nexport const defaultStorage = {\n    getItem: (name) => {\n        initializeStorage(defaultStorage);\n        return defaultStorage.getItem(name);\n    },\n    setItem: (name, value) => {\n        initializeStorage(defaultStorage);\n        defaultStorage.setItem(name, value);\n    },\n};\nconst defaultProps = {\n    id: null,\n    onLayout: null,\n    keyboardResizeBy: null,\n    autoSaveId: null,\n    direction: \"horizontal\",\n    storage: defaultStorage,\n};\nexport function createPaneForge(props) {\n    const withDefaults = {\n        ...defaultProps,\n        ...removeUndefined(props),\n    };\n    const options = toWritableStores(withDefaults);\n    const { autoSaveId, direction, keyboardResizeBy, storage, onLayout } = options;\n    const groupId = writable(generateId());\n    const dragState = writable(null);\n    const layout = writable([]);\n    const paneDataArray = writable([]);\n    const paneDataArrayChanged = writable(false);\n    const paneIdToLastNotifiedSizeMap = writable({});\n    const paneSizeBeforeCollapseMap = writable(new Map());\n    const prevDelta = writable(0);\n    clientEffect([groupId, layout, paneDataArray], ([$groupId, $layout, $paneDataArray]) => {\n        const unsub = updateResizeHandleAriaValues({\n            groupId: $groupId,\n            layout: $layout,\n            paneDataArray: $paneDataArray,\n        });\n        return unsub;\n    });\n    onMount(() => {\n        const unsub = setResizeHandlerEventListeners();\n        return unsub;\n    });\n    clientEffect([autoSaveId, layout, storage], ([$autoSaveId, $layout, $storage]) => {\n        if (!$autoSaveId)\n            return;\n        updateStorageValues({\n            autoSaveId: $autoSaveId,\n            layout: $layout,\n            storage: $storage,\n            paneDataArrayStore: paneDataArray,\n            paneSizeBeforeCollapseStore: paneSizeBeforeCollapseMap,\n        });\n    });\n    function collapsePane(paneData) {\n        const $prevLayout = get(layout);\n        const $paneDataArray = get(paneDataArray);\n        if (!paneData.constraints.collapsible)\n            return;\n        const paneConstraintsArray = $paneDataArray.map((paneData) => paneData.constraints);\n        const { collapsedSize = 0, paneSize, pivotIndices, } = paneDataHelper($paneDataArray, paneData, $prevLayout);\n        assert(paneSize != null);\n        if (paneSize === collapsedSize)\n            return;\n        // Store the size before collapse, which is returned when `expand()` is called\n        paneSizeBeforeCollapseMap.update((curr) => {\n            curr.set(paneData.id, paneSize);\n            return curr;\n        });\n        const isLastPane = findPaneDataIndex($paneDataArray, paneData) === $paneDataArray.length - 1;\n        const delta = isLastPane ? paneSize - collapsedSize : collapsedSize - paneSize;\n        const nextLayout = adjustLayoutByDelta({\n            delta,\n            layout: $prevLayout,\n            paneConstraints: paneConstraintsArray,\n            pivotIndices,\n            trigger: \"imperative-api\",\n        });\n        if (areArraysEqual($prevLayout, nextLayout))\n            return;\n        layout.set(nextLayout);\n        const $onLayout = get(onLayout);\n        if ($onLayout) {\n            $onLayout(nextLayout);\n        }\n        callPaneCallbacks($paneDataArray, nextLayout, get(paneIdToLastNotifiedSizeMap));\n    }\n    function getPaneSize(paneData) {\n        const $layout = get(layout);\n        const $paneDataArray = get(paneDataArray);\n        const { paneSize } = paneDataHelper($paneDataArray, paneData, $layout);\n        return paneSize;\n    }\n    const getPaneStyle = derived([paneDataArray, layout, dragState], ([$paneDataArray, $layout, $dragState]) => {\n        return (paneData, defaultSize) => {\n            const paneIndex = findPaneDataIndex($paneDataArray, paneData);\n            return computePaneFlexBoxStyle({\n                defaultSize,\n                dragState: $dragState,\n                layout: $layout,\n                paneData: $paneDataArray,\n                paneIndex,\n            });\n        };\n    });\n    function isPaneExpanded(paneData) {\n        const $paneDataArray = get(paneDataArray);\n        const $layout = get(layout);\n        const { collapsedSize = 0, collapsible, paneSize, } = paneDataHelper($paneDataArray, paneData, $layout);\n        return !collapsible || paneSize > collapsedSize;\n    }\n    function registerPane(paneData) {\n        paneDataArray.update((curr) => {\n            const newArr = [...curr, paneData];\n            newArr.sort((paneA, paneB) => {\n                const orderA = paneA.order;\n                const orderB = paneB.order;\n                if (orderA == null && orderB == null) {\n                    return 0;\n                }\n                else if (orderA == null) {\n                    return -1;\n                }\n                else if (orderB == null) {\n                    return 1;\n                }\n                else {\n                    return orderA - orderB;\n                }\n            });\n            return newArr;\n        });\n        paneDataArrayChanged.set(true);\n    }\n    clientEffect([paneDataArrayChanged], ([$paneDataArrayChanged]) => {\n        if (!$paneDataArrayChanged)\n            return;\n        paneDataArrayChanged.set(false);\n        const $autoSaveId = get(autoSaveId);\n        const $storage = get(storage);\n        const $prevLayout = get(layout);\n        const $paneDataArray = get(paneDataArray);\n        // If this pane has been configured to persist sizing information,\n        // default size should be restored from local storage if possible.\n        let unsafeLayout = null;\n        if ($autoSaveId) {\n            const state = loadPaneGroupState($autoSaveId, $paneDataArray, $storage);\n            if (state) {\n                paneSizeBeforeCollapseMap.set(new Map(Object.entries(state.expandToSizes)));\n                unsafeLayout = state.layout;\n            }\n        }\n        if (unsafeLayout == null) {\n            unsafeLayout = getUnsafeDefaultLayout({\n                paneDataArray: $paneDataArray,\n            });\n        }\n        // Validate even saved layouts in case something has changed since last render\n        const nextLayout = validatePaneGroupLayout({\n            layout: unsafeLayout,\n            paneConstraints: $paneDataArray.map((paneData) => paneData.constraints),\n        });\n        if (areArraysEqual($prevLayout, nextLayout))\n            return;\n        layout.set(nextLayout);\n        const $onLayout = get(onLayout);\n        if ($onLayout) {\n            $onLayout(nextLayout);\n        }\n        callPaneCallbacks($paneDataArray, nextLayout, get(paneIdToLastNotifiedSizeMap));\n    });\n    function registerResizeHandle(dragHandleId) {\n        return function resizeHandler(event) {\n            event.preventDefault();\n            const $direction = get(direction);\n            const $dragState = get(dragState);\n            const $groupId = get(groupId);\n            const $keyboardResizeBy = get(keyboardResizeBy);\n            const $prevLayout = get(layout);\n            const $paneDataArray = get(paneDataArray);\n            const { initialLayout } = $dragState ?? {};\n            const pivotIndices = getPivotIndices($groupId, dragHandleId);\n            let delta = getDeltaPercentage(event, dragHandleId, $direction, $dragState, $keyboardResizeBy);\n            if (delta === 0)\n                return;\n            // support RTL\n            const isHorizontal = $direction === \"horizontal\";\n            if (document.dir === \"rtl\" && isHorizontal) {\n                delta = -delta;\n            }\n            const paneConstraints = $paneDataArray.map((paneData) => paneData.constraints);\n            const nextLayout = adjustLayoutByDelta({\n                delta,\n                layout: initialLayout ?? $prevLayout,\n                paneConstraints: paneConstraints,\n                pivotIndices,\n                trigger: isKeyDown(event) ? \"keyboard\" : \"mouse-or-touch\",\n            });\n            const layoutChanged = !areArraysEqual($prevLayout, nextLayout);\n            // Only update the cursor for layout changes triggered by touch/mouse events (not keyboard)\n            // Update the cursor even if the layout hasn't changed (we may need to show an invalid cursor state)\n            if (isMouseEvent(event) || isTouchEvent(event)) {\n                // Watch for multiple subsequent deltas; this might occur for tiny cursor movements.\n                // In this case, Pane sizes might not change–\n                // but updating cursor in this scenario would cause a flicker.\n                const $prevDelta = get(prevDelta);\n                if ($prevDelta != delta) {\n                    prevDelta.set(delta);\n                    if (!layoutChanged) {\n                        // If the pointer has moved too far to resize the pane any further,\n                        // update the cursor style for a visual clue.\n                        // This mimics VS Code behavior.\n                        if (isHorizontal) {\n                            setGlobalCursorStyle(delta < 0 ? \"horizontal-min\" : \"horizontal-max\");\n                        }\n                        else {\n                            setGlobalCursorStyle(delta < 0 ? \"vertical-min\" : \"vertical-max\");\n                        }\n                    }\n                    else {\n                        setGlobalCursorStyle(isHorizontal ? \"horizontal\" : \"vertical\");\n                    }\n                }\n            }\n            if (layoutChanged) {\n                layout.set(nextLayout);\n                const $onLayout = get(onLayout);\n                if ($onLayout) {\n                    $onLayout(nextLayout);\n                }\n                callPaneCallbacks($paneDataArray, nextLayout, get(paneIdToLastNotifiedSizeMap));\n            }\n        };\n    }\n    function resizePane(paneData, unsafePaneSize) {\n        const $prevLayout = get(layout);\n        const $paneDataArray = get(paneDataArray);\n        const paneConstraintsArr = $paneDataArray.map((paneData) => paneData.constraints);\n        const { paneSize, pivotIndices } = paneDataHelper($paneDataArray, paneData, $prevLayout);\n        assert(paneSize != null);\n        const isLastPane = findPaneDataIndex($paneDataArray, paneData) === $paneDataArray.length - 1;\n        const delta = isLastPane ? paneSize - unsafePaneSize : unsafePaneSize - paneSize;\n        const nextLayout = adjustLayoutByDelta({\n            delta,\n            layout: $prevLayout,\n            paneConstraints: paneConstraintsArr,\n            pivotIndices,\n            trigger: \"imperative-api\",\n        });\n        if (areArraysEqual($prevLayout, nextLayout))\n            return;\n        layout.set(nextLayout);\n        const $onLayout = get(onLayout);\n        $onLayout?.(nextLayout);\n        callPaneCallbacks($paneDataArray, nextLayout, get(paneIdToLastNotifiedSizeMap));\n    }\n    function startDragging(dragHandleId, event) {\n        const $direction = get(direction);\n        const $layout = get(layout);\n        const handleElement = getResizeHandleElement(dragHandleId);\n        assert(handleElement);\n        const initialCursorPosition = getResizeEventCursorPosition($direction, event);\n        dragState.set({\n            dragHandleId,\n            dragHandleRect: handleElement.getBoundingClientRect(),\n            initialCursorPosition,\n            initialLayout: $layout,\n        });\n    }\n    function stopDragging() {\n        resetGlobalCursorStyle();\n        dragState.set(null);\n    }\n    function unregisterPane(paneData) {\n        const $paneDataArray = get(paneDataArray);\n        const index = findPaneDataIndex($paneDataArray, paneData);\n        if (index < 0)\n            return;\n        paneDataArray.update((curr) => {\n            curr.splice(index, 1);\n            paneIdToLastNotifiedSizeMap.update((curr) => {\n                delete curr[paneData.id];\n                return curr;\n            });\n            paneDataArrayChanged.set(true);\n            return curr;\n        });\n    }\n    function isPaneCollapsed(paneData) {\n        const $paneDataArray = get(paneDataArray);\n        const $layout = get(layout);\n        const { collapsedSize = 0, collapsible, paneSize, } = paneDataHelper($paneDataArray, paneData, $layout);\n        return collapsible === true && paneSize === collapsedSize;\n    }\n    function expandPane(paneData) {\n        const $prevLayout = get(layout);\n        const $paneDataArray = get(paneDataArray);\n        if (!paneData.constraints.collapsible)\n            return;\n        const paneConstraintsArray = $paneDataArray.map((paneData) => paneData.constraints);\n        const { collapsedSize = 0, paneSize, minSize = 0, pivotIndices, } = paneDataHelper($paneDataArray, paneData, $prevLayout);\n        if (paneSize !== collapsedSize)\n            return;\n        // Restore this pane to the size it was before it was collapsed, if possible.\n        const prevPaneSize = get(paneSizeBeforeCollapseMap).get(paneData.id);\n        const baseSize = prevPaneSize != null && prevPaneSize >= minSize ? prevPaneSize : minSize;\n        const isLastPane = findPaneDataIndex($paneDataArray, paneData) === $paneDataArray.length - 1;\n        const delta = isLastPane ? paneSize - baseSize : baseSize - paneSize;\n        const nextLayout = adjustLayoutByDelta({\n            delta,\n            layout: $prevLayout,\n            paneConstraints: paneConstraintsArray,\n            pivotIndices,\n            trigger: \"imperative-api\",\n        });\n        if (areArraysEqual($prevLayout, nextLayout))\n            return;\n        layout.set(nextLayout);\n        const $onLayout = get(onLayout);\n        $onLayout?.(nextLayout);\n        callPaneCallbacks($paneDataArray, nextLayout, get(paneIdToLastNotifiedSizeMap));\n    }\n    const paneGroupStyle = derived([direction], ([$direction]) => {\n        return styleToString({\n            display: \"flex\",\n            \"flex-direction\": $direction === \"horizontal\" ? \"row\" : \"column\",\n            height: \"100%\",\n            overflow: \"hidden\",\n            width: \"100%\",\n        });\n    });\n    const paneGroupSelectors = derived([direction, groupId], ([$direction, $groupId]) => {\n        return {\n            \"data-pane-group\": \"\",\n            \"data-direction\": $direction,\n            \"data-pane-group-id\": $groupId,\n        };\n    });\n    const paneGroupAttrs = derived([paneGroupStyle, paneGroupSelectors], ([$style, $selectors]) => {\n        return {\n            style: $style,\n            ...$selectors,\n        };\n    });\n    function setResizeHandlerEventListeners() {\n        const $groupId = get(groupId);\n        const handles = getResizeHandleElementsForGroup($groupId);\n        const unsubHandlers = handles.map((handle) => {\n            const handleId = handle.getAttribute(\"data-pane-resizer-id\");\n            if (!handleId)\n                return noop;\n            const [idBefore, idAfter] = getResizeHandlePaneIds($groupId, handleId, get(paneDataArray));\n            if (idBefore == null || idAfter == null)\n                return noop;\n            const onKeydown = (e) => {\n                if (e.defaultPrevented || e.key !== \"Enter\")\n                    return;\n                e.preventDefault();\n                const $paneDataArray = get(paneDataArray);\n                const index = $paneDataArray.findIndex((paneData) => paneData.id === idBefore);\n                if (index < 0)\n                    return;\n                const paneData = $paneDataArray[index];\n                assert(paneData);\n                const $layout = get(layout);\n                const size = $layout[index];\n                const { collapsedSize = 0, collapsible, minSize = 0 } = paneData.constraints;\n                if (!(size != null && collapsible))\n                    return;\n                const nextLayout = adjustLayoutByDelta({\n                    delta: areNumbersAlmostEqual(size, collapsedSize) ? minSize - size : collapsedSize - size,\n                    layout: $layout,\n                    paneConstraints: $paneDataArray.map((paneData) => paneData.constraints),\n                    pivotIndices: getPivotIndices($groupId, handleId),\n                    trigger: \"keyboard\",\n                });\n                if ($layout !== nextLayout) {\n                    layout.set(nextLayout);\n                }\n            };\n            const unsubListener = addEventListener(handle, \"keydown\", onKeydown);\n            return () => {\n                unsubListener();\n            };\n        });\n        return () => {\n            unsubHandlers.forEach((unsub) => unsub());\n        };\n    }\n    function setLayout(newLayout) {\n        layout.set(newLayout);\n    }\n    function getLayout() {\n        return get(layout);\n    }\n    return {\n        methods: {\n            collapsePane,\n            expandPane,\n            getSize: getPaneSize,\n            getPaneStyle,\n            isCollapsed: isPaneCollapsed,\n            isExpanded: isPaneExpanded,\n            registerPane,\n            registerResizeHandle,\n            resizePane,\n            startDragging,\n            stopDragging,\n            unregisterPane,\n            setLayout,\n            getLayout,\n        },\n        states: {\n            direction,\n            dragState,\n            groupId,\n            paneGroupAttrs,\n            paneGroupSelectors,\n            paneGroupStyle,\n            layout,\n        },\n        options,\n    };\n}\nfunction updateResizeHandleAriaValues({ groupId, layout, paneDataArray, }) {\n    const resizeHandleElements = getResizeHandleElementsForGroup(groupId);\n    for (let index = 0; index < paneDataArray.length - 1; index++) {\n        const { valueMax, valueMin, valueNow } = calculateAriaValues({\n            layout,\n            panesArray: paneDataArray,\n            pivotIndices: [index, index + 1],\n        });\n        const resizeHandleEl = resizeHandleElements[index];\n        if (isHTMLElement(resizeHandleEl)) {\n            const paneData = paneDataArray[index];\n            resizeHandleEl.setAttribute(\"aria-controls\", paneData.id);\n            resizeHandleEl.setAttribute(\"aria-valuemax\", \"\" + Math.round(valueMax));\n            resizeHandleEl.setAttribute(\"aria-valuemin\", \"\" + Math.round(valueMin));\n            resizeHandleEl.setAttribute(\"aria-valuenow\", valueNow != null ? \"\" + Math.round(valueNow) : \"\");\n        }\n    }\n    return () => {\n        resizeHandleElements.forEach((resizeHandleElement) => {\n            resizeHandleElement.removeAttribute(\"aria-controls\");\n            resizeHandleElement.removeAttribute(\"aria-valuemax\");\n            resizeHandleElement.removeAttribute(\"aria-valuemin\");\n            resizeHandleElement.removeAttribute(\"aria-valuenow\");\n        });\n    };\n}\nexport function getResizeHandleElementsForGroup(groupId) {\n    if (!isBrowser)\n        return [];\n    return Array.from(document.querySelectorAll(`[data-pane-resizer-id][data-pane-group-id=\"${groupId}\"]`));\n}\nfunction getPaneGroupElement(id) {\n    if (!isBrowser)\n        return null;\n    const element = document.querySelector(`[data-pane-group][data-pane-group-id=\"${id}\"]`);\n    if (element) {\n        return element;\n    }\n    return null;\n}\nfunction noop() {\n    // do nothing\n}\nexport function getResizeHandlePaneIds(groupId, handleId, panesArray) {\n    const handle = getResizeHandleElement(handleId);\n    const handles = getResizeHandleElementsForGroup(groupId);\n    const index = handle ? handles.indexOf(handle) : -1;\n    const idBefore = panesArray[index]?.id ?? null;\n    const idAfter = panesArray[index + 1]?.id ?? null;\n    return [idBefore, idAfter];\n}\nexport function getResizeHandleElement(id) {\n    if (!isBrowser)\n        return null;\n    const element = document.querySelector(`[data-pane-resizer-id=\"${id}\"]`);\n    if (element) {\n        return element;\n    }\n    return null;\n}\nexport function getResizeHandleElementIndex(groupId, id) {\n    if (!isBrowser)\n        return null;\n    const handles = getResizeHandleElementsForGroup(groupId);\n    const index = handles.findIndex((handle) => handle.getAttribute(\"data-pane-resizer-id\") === id);\n    return index ?? null;\n}\nfunction getPivotIndices(groupId, dragHandleId) {\n    const index = getResizeHandleElementIndex(groupId, dragHandleId);\n    return index != null ? [index, index + 1] : [-1, -1];\n}\nfunction paneDataHelper(paneDataArray, paneData, layout) {\n    const paneConstraintsArray = paneDataArray.map((paneData) => paneData.constraints);\n    const paneIndex = findPaneDataIndex(paneDataArray, paneData);\n    const paneConstraints = paneConstraintsArray[paneIndex];\n    const isLastPane = paneIndex === paneDataArray.length - 1;\n    const pivotIndices = isLastPane ? [paneIndex - 1, paneIndex] : [paneIndex, paneIndex + 1];\n    const paneSize = layout[paneIndex];\n    return {\n        ...paneConstraints,\n        paneSize,\n        pivotIndices,\n    };\n}\nfunction findPaneDataIndex(paneDataArray, paneData) {\n    return paneDataArray.findIndex((prevPaneData) => prevPaneData.id === paneData.id);\n}\n// Layout should be pre-converted into percentages\nfunction callPaneCallbacks(paneArray, layout, paneIdToLastNotifiedSizeMap) {\n    layout.forEach((size, index) => {\n        const paneData = paneArray[index];\n        assert(paneData);\n        const { callbacks, constraints, id: paneId } = paneData;\n        const { collapsedSize = 0, collapsible } = constraints;\n        const lastNotifiedSize = paneIdToLastNotifiedSizeMap[paneId];\n        // invert the logic from below\n        if (!(lastNotifiedSize == null || size !== lastNotifiedSize))\n            return;\n        paneIdToLastNotifiedSizeMap[paneId] = size;\n        const { onCollapse, onExpand, onResize } = callbacks;\n        onResize?.(size, lastNotifiedSize);\n        if (collapsible && (onCollapse || onExpand)) {\n            if (onExpand &&\n                (lastNotifiedSize == null || lastNotifiedSize === collapsedSize) &&\n                size !== collapsedSize) {\n                onExpand();\n            }\n            if (onCollapse &&\n                (lastNotifiedSize == null || lastNotifiedSize !== collapsedSize) &&\n                size === collapsedSize) {\n                onCollapse();\n            }\n        }\n    });\n}\nfunction getUnsafeDefaultLayout({ paneDataArray }) {\n    const layout = Array(paneDataArray.length);\n    const paneConstraintsArray = paneDataArray.map((paneData) => paneData.constraints);\n    let numPanesWithSizes = 0;\n    let remainingSize = 100;\n    // Distribute default sizes first\n    for (let index = 0; index < paneDataArray.length; index++) {\n        const paneConstraints = paneConstraintsArray[index];\n        assert(paneConstraints);\n        const { defaultSize } = paneConstraints;\n        if (defaultSize != null) {\n            numPanesWithSizes++;\n            layout[index] = defaultSize;\n            remainingSize -= defaultSize;\n        }\n    }\n    // Remaining size should be distributed evenly between panes without default sizes\n    for (let index = 0; index < paneDataArray.length; index++) {\n        const paneConstraints = paneConstraintsArray[index];\n        assert(paneConstraints);\n        const { defaultSize } = paneConstraints;\n        if (defaultSize != null) {\n            continue;\n        }\n        const numRemainingPanes = paneDataArray.length - numPanesWithSizes;\n        const size = remainingSize / numRemainingPanes;\n        numPanesWithSizes++;\n        layout[index] = size;\n        remainingSize -= size;\n    }\n    return layout;\n}\n// All units must be in percentages\nfunction validatePaneGroupLayout({ layout: prevLayout, paneConstraints, }) {\n    const nextLayout = [...prevLayout];\n    const nextLayoutTotalSize = nextLayout.reduce((accumulated, current) => accumulated + current, 0);\n    // Validate layout expectations\n    if (nextLayout.length !== paneConstraints.length) {\n        throw Error(`Invalid ${paneConstraints.length} pane layout: ${nextLayout\n            .map((size) => `${size}%`)\n            .join(\", \")}`);\n    }\n    else if (!areNumbersAlmostEqual(nextLayoutTotalSize, 100)) {\n        for (let index = 0; index < paneConstraints.length; index++) {\n            const unsafeSize = nextLayout[index];\n            assert(unsafeSize != null);\n            const safeSize = (100 / nextLayoutTotalSize) * unsafeSize;\n            nextLayout[index] = safeSize;\n        }\n    }\n    let remainingSize = 0;\n    // First pass: Validate the proposed layout given each pane's constraints\n    for (let index = 0; index < paneConstraints.length; index++) {\n        const unsafeSize = nextLayout[index];\n        assert(unsafeSize != null);\n        const safeSize = resizePane({\n            paneConstraints,\n            paneIndex: index,\n            initialSize: unsafeSize,\n        });\n        if (unsafeSize != safeSize) {\n            remainingSize += unsafeSize - safeSize;\n            nextLayout[index] = safeSize;\n        }\n    }\n    // If there is additional, left over space, assign it to any pane(s) that permits it\n    // (It's not worth taking multiple additional passes to evenly distribute)\n    if (!areNumbersAlmostEqual(remainingSize, 0)) {\n        for (let index = 0; index < paneConstraints.length; index++) {\n            const prevSize = nextLayout[index];\n            assert(prevSize != null);\n            const unsafeSize = prevSize + remainingSize;\n            const safeSize = resizePane({\n                paneConstraints,\n                paneIndex: index,\n                initialSize: unsafeSize,\n            });\n            if (prevSize !== safeSize) {\n                remainingSize -= safeSize - prevSize;\n                nextLayout[index] = safeSize;\n                // Once we've used up the remainder, bail\n                if (areNumbersAlmostEqual(remainingSize, 0)) {\n                    break;\n                }\n            }\n        }\n    }\n    return nextLayout;\n}\n// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/movementX\nfunction getDeltaPercentage(e, dragHandleId, dir, initialDragState, keyboardResizeBy) {\n    if (isKeyDown(e)) {\n        const isHorizontal = dir === \"horizontal\";\n        let delta = 0;\n        if (e.shiftKey) {\n            delta = 100;\n        }\n        else if (keyboardResizeBy != null) {\n            delta = keyboardResizeBy;\n        }\n        else {\n            delta = 10;\n        }\n        let movement = 0;\n        switch (e.key) {\n            case \"ArrowDown\":\n                movement = isHorizontal ? 0 : delta;\n                break;\n            case \"ArrowLeft\":\n                movement = isHorizontal ? -delta : 0;\n                break;\n            case \"ArrowRight\":\n                movement = isHorizontal ? delta : 0;\n                break;\n            case \"ArrowUp\":\n                movement = isHorizontal ? 0 : -delta;\n                break;\n            case \"End\":\n                movement = 100;\n                break;\n            case \"Home\":\n                movement = -100;\n                break;\n        }\n        return movement;\n    }\n    else {\n        if (initialDragState == null)\n            return 0;\n        return getDragOffsetPercentage(e, dragHandleId, dir, initialDragState);\n    }\n}\nfunction getDragOffsetPercentage(e, dragHandleId, dir, initialDragState) {\n    const isHorizontal = dir === \"horizontal\";\n    const handleElement = getResizeHandleElement(dragHandleId);\n    assert(handleElement);\n    const groupId = handleElement.getAttribute(\"data-pane-group-id\");\n    assert(groupId);\n    const { initialCursorPosition } = initialDragState;\n    const cursorPosition = getResizeEventCursorPosition(dir, e);\n    const groupElement = getPaneGroupElement(groupId);\n    assert(groupElement);\n    const groupRect = groupElement.getBoundingClientRect();\n    const groupSizeInPixels = isHorizontal ? groupRect.width : groupRect.height;\n    const offsetPixels = cursorPosition - initialCursorPosition;\n    const offsetPercentage = (offsetPixels / groupSizeInPixels) * 100;\n    return offsetPercentage;\n}\nfunction getResizeEventCursorPosition(dir, e) {\n    const isHorizontal = dir === \"horizontal\";\n    if (isMouseEvent(e)) {\n        return isHorizontal ? e.clientX : e.clientY;\n    }\n    else if (isTouchEvent(e)) {\n        const firstTouch = e.touches[0];\n        assert(firstTouch);\n        return isHorizontal ? firstTouch.screenX : firstTouch.screenY;\n    }\n    else {\n        throw Error(`Unsupported event type \"${e.type}\"`);\n    }\n}\n","import { createPaneForge } from \"../internal/paneforge.js\";\nimport { getContext, hasContext, setContext } from \"svelte\";\nimport { removeUndefined, getOptionUpdater } from \"../internal/utils/index.js\";\nconst PF_GROUP_CTX = Symbol(\"PF_GROUP_CTX\");\nexport function setCtx(props) {\n    const paneForge = createPaneForge(removeUndefined(props));\n    const updateOption = getOptionUpdater(paneForge.options);\n    const ctxValue = { ...paneForge, updateOption };\n    setContext(PF_GROUP_CTX, ctxValue);\n    return ctxValue;\n}\nexport function getCtx(componentName) {\n    if (!hasContext(PF_GROUP_CTX)) {\n        throw new Error(`${componentName} components must be rendered with a <PaneGroup> container`);\n    }\n    return getContext(PF_GROUP_CTX);\n}\n","<script>import { setCtx } from \"./ctx.js\";\nimport {} from \"../internal/utils/index.js\";\nimport { defaultStorage } from \"../internal/paneforge.js\";\nexport let autoSaveId = null;\nexport let direction;\nexport let id = null;\nexport let keyboardResizeBy = null;\nexport let onLayoutChange = null;\nexport let storage = defaultStorage;\nexport let el = void 0;\nexport let paneGroup = void 0;\nlet styleFromProps = void 0;\nexport { styleFromProps as style };\nconst {\n  states: { paneGroupStyle, paneGroupSelectors, groupId },\n  methods: { setLayout, getLayout },\n  updateOption\n} = setCtx({\n  autoSaveId,\n  direction,\n  id,\n  keyboardResizeBy,\n  onLayout: onLayoutChange,\n  storage\n});\n$:\n  updateOption(\"autoSaveId\", autoSaveId);\n$:\n  updateOption(\"direction\", direction);\n$:\n  updateOption(\"id\", id);\n$:\n  updateOption(\"keyboardResizeBy\", keyboardResizeBy);\n$:\n  updateOption(\"onLayout\", onLayoutChange);\n$:\n  updateOption(\"storage\", storage);\npaneGroup = {\n  getLayout,\n  setLayout,\n  getId: () => $groupId\n};\n$:\n  style = $paneGroupStyle + (styleFromProps ?? \"\");\n</script>\n\n<div bind:this={el} id={$groupId} {...$paneGroupSelectors} {style} {...$$restProps}>\n\t<slot />\n</div>\n","<script>import { generateId } from \"../internal/utils/index.js\";\nimport { onMount } from \"svelte\";\nimport { getCtx } from \"./ctx.js\";\nexport let collapsedSize = void 0;\nexport let collapsible = void 0;\nexport let defaultSize = void 0;\nexport let maxSize = void 0;\nexport let minSize = void 0;\nexport let onCollapse = void 0;\nexport let onExpand = void 0;\nexport let onResize = void 0;\nexport let order = void 0;\nexport let el = void 0;\nexport let pane = void 0;\nlet idFromProps = void 0;\nexport { idFromProps as id };\nlet styleFromProps = void 0;\nexport { styleFromProps as style };\nconst {\n  methods: {\n    getPaneStyle,\n    registerPane,\n    unregisterPane,\n    collapsePane,\n    expandPane,\n    getSize,\n    isCollapsed,\n    isExpanded,\n    resizePane\n  },\n  states: { groupId }\n} = getCtx(\"Pane\");\nconst paneId = generateId(idFromProps);\nlet paneData;\n$:\n  paneData = {\n    callbacks: {\n      onCollapse,\n      onExpand,\n      onResize\n    },\n    constraints: {\n      collapsedSize,\n      collapsible,\n      defaultSize,\n      maxSize,\n      minSize\n    },\n    id: paneId,\n    idIsFromProps: idFromProps !== void 0,\n    order\n  };\npane = {\n  collapse: () => {\n    collapsePane(paneData);\n  },\n  expand: () => expandPane(paneData),\n  getSize: () => getSize(paneData),\n  isCollapsed: () => isCollapsed(paneData),\n  isExpanded: () => isExpanded(paneData),\n  resize: (size) => resizePane(paneData, size),\n  getId: () => paneId\n};\nonMount(() => {\n  registerPane(paneData);\n  return () => {\n    unregisterPane(paneData);\n  };\n});\n$:\n  style = $getPaneStyle(paneData, defaultSize) + (styleFromProps ?? \"\");\n$:\n  attrs = {\n    \"data-pane\": \"\",\n    \"data-pane-id\": paneId,\n    \"data-pane-group-id\": $groupId\n  };\n</script>\n\n<div bind:this={el} {style} {...attrs} {...$$restProps}>\n\t<slot />\n</div>\n","import { chain } from \"../internal/utils/chain.js\";\nimport { addEventListener } from \"../internal/utils/event.js\";\n/**\n * A Svelte action that adds resize handle functionality to an element.\n * This action is used to handle the dragging of a resize handle.\n */\nexport function resizeHandleAction(node, params) {\n    let unsub = () => { };\n    function update(params) {\n        unsub();\n        const { disabled, resizeHandler, isDragging, stopDragging, onDragging = undefined } = params;\n        if (disabled || resizeHandler === null || !isDragging)\n            return;\n        const onMove = (event) => {\n            resizeHandler(event);\n        };\n        const onMouseLeave = (event) => {\n            resizeHandler(event);\n        };\n        const stopDraggingAndBlur = () => {\n            node.blur();\n            stopDragging();\n            if (onDragging) {\n                onDragging(false);\n            }\n        };\n        unsub = chain(addEventListener(document.body, \"contextmenu\", stopDraggingAndBlur), addEventListener(document.body, \"mousemove\", onMove), addEventListener(document.body, \"touchmove\", onMove, { passive: false }), addEventListener(document.body, \"mouseleave\", onMouseLeave), addEventListener(window, \"mouseup\", stopDraggingAndBlur), addEventListener(window, \"touchend\", stopDraggingAndBlur));\n    }\n    update(params);\n    return {\n        update,\n        onDestroy() {\n            unsub();\n        },\n    };\n}\n","<script>import {\n  getResizeHandleElementIndex,\n  getResizeHandleElementsForGroup\n} from \"../internal/paneforge.js\";\nimport { generateId, getCursorStyle, styleToString } from \"../internal/utils/index.js\";\nimport { onMount } from \"svelte\";\nimport { getCtx } from \"./ctx.js\";\nimport { resizeHandleAction } from \"./pane-resizer.js\";\nexport let disabled = false;\nexport let onDraggingChange = void 0;\nexport let tabIndex = 0;\nexport let el = null;\nexport let idFromProps = void 0;\nexport { idFromProps as id };\nexport let styleFromProps = void 0;\nexport { styleFromProps as style };\nconst {\n  methods: { registerResizeHandle, startDragging, stopDragging },\n  states: { direction, dragState, groupId }\n} = getCtx(\"PaneResizer\");\nconst resizeHandleId = generateId(idFromProps);\n$:\n  isDragging = $dragState?.dragHandleId === resizeHandleId;\nlet isFocused = false;\nlet resizeHandler = null;\nfunction stopDraggingAndBlur() {\n  const element = el;\n  if (!element)\n    return;\n  element.blur();\n  stopDragging();\n  onDraggingChange?.(false);\n}\nonMount(() => {\n  if (disabled) {\n    resizeHandler = null;\n  } else {\n    resizeHandler = registerResizeHandle(resizeHandleId);\n  }\n});\n$:\n  if (disabled) {\n    resizeHandler = null;\n  } else {\n    resizeHandler = registerResizeHandle(resizeHandleId);\n  }\nfunction handleKeydown(event) {\n  if (disabled || !resizeHandler || event.defaultPrevented)\n    return;\n  const resizeKeys = [\"ArrowDown\", \"ArrowLeft\", \"ArrowRight\", \"ArrowUp\", \"End\", \"Home\"];\n  if (resizeKeys.includes(event.key)) {\n    event.preventDefault();\n    resizeHandler(event);\n    return;\n  }\n  if (event.key !== \"F6\")\n    return;\n  event.preventDefault();\n  const handles = getResizeHandleElementsForGroup($groupId);\n  const index = getResizeHandleElementIndex($groupId, resizeHandleId);\n  if (index === null)\n    return;\n  const nextIndex = event.shiftKey ? index > 0 ? index - 1 : handles.length - 1 : index + 1 < handles.length ? index + 1 : 0;\n  const nextHandle = handles[nextIndex];\n  nextHandle.focus();\n}\n$:\n  style = styleToString({\n    cursor: getCursorStyle($direction),\n    \"touch-action\": \"none\",\n    \"user-select\": \"none\",\n    \"-webkit-user-select\": \"none\",\n    \"-webkit-touch-callout\": \"none\"\n  }) + styleFromProps;\n$:\n  attrs = {\n    \"data-direction\": $direction,\n    \"data-pane-group-id\": $groupId,\n    \"data-active\": isDragging ? \"pointer\" : isFocused ? \"keyboard\" : void 0,\n    \"data-enabled\": !disabled,\n    \"data-pane-resizer-id\": resizeHandleId,\n    \"data-pane-resizer\": \"\"\n  };\n</script>\n\n<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n<!-- eslint-disable-next-line svelte/valid-compile -->\n<!-- svelte-ignore a11y-no-noninteractive-tabindex -->\n<div\n\tbind:this={el}\n\trole=\"separator\"\n\t{style}\n\tuse:resizeHandleAction={{\n\t\tdisabled,\n\t\tresizeHandler,\n\t\tstopDragging,\n\t\tisDragging,\n\t\tonDragging: onDraggingChange,\n\t}}\n\ton:keydown={handleKeydown}\n\ton:blur={() => (isFocused = false)}\n\ton:focus={() => (isFocused = true)}\n\ton:mousedown={(e) => {\n\t\te.preventDefault();\n\t\tstartDragging(resizeHandleId, e);\n\t\tonDraggingChange?.(true);\n\t}}\n\ton:mouseup={stopDraggingAndBlur}\n\ton:touchcancel={stopDraggingAndBlur}\n\ton:touchend={stopDraggingAndBlur}\n\ton:touchstart={(e) => {\n\t\te.preventDefault();\n\t\tstartDragging(resizeHandleId, e);\n\t\tonDraggingChange?.(true);\n\t}}\n\ttabindex={tabIndex}\n\t{...attrs}\n\t{...$$restProps}\n>\n\t<slot />\n</div>\n","function createParser(onParse) {\n  let isFirstChunk;\n  let buffer;\n  let startingPosition;\n  let startingFieldLength;\n  let eventId;\n  let eventName;\n  let data;\n  reset();\n  return {\n    feed,\n    reset\n  };\n  function reset() {\n    isFirstChunk = true;\n    buffer = \"\";\n    startingPosition = 0;\n    startingFieldLength = -1;\n    eventId = void 0;\n    eventName = void 0;\n    data = \"\";\n  }\n  function feed(chunk) {\n    buffer = buffer ? buffer + chunk : chunk;\n    if (isFirstChunk && hasBom(buffer)) {\n      buffer = buffer.slice(BOM.length);\n    }\n    isFirstChunk = false;\n    const length = buffer.length;\n    let position = 0;\n    let discardTrailingNewline = false;\n    while (position < length) {\n      if (discardTrailingNewline) {\n        if (buffer[position] === \"\\n\") {\n          ++position;\n        }\n        discardTrailingNewline = false;\n      }\n      let lineLength = -1;\n      let fieldLength = startingFieldLength;\n      let character;\n      for (let index = startingPosition; lineLength < 0 && index < length; ++index) {\n        character = buffer[index];\n        if (character === \":\" && fieldLength < 0) {\n          fieldLength = index - position;\n        } else if (character === \"\\r\") {\n          discardTrailingNewline = true;\n          lineLength = index - position;\n        } else if (character === \"\\n\") {\n          lineLength = index - position;\n        }\n      }\n      if (lineLength < 0) {\n        startingPosition = length - position;\n        startingFieldLength = fieldLength;\n        break;\n      } else {\n        startingPosition = 0;\n        startingFieldLength = -1;\n      }\n      parseEventStreamLine(buffer, position, fieldLength, lineLength);\n      position += lineLength + 1;\n    }\n    if (position === length) {\n      buffer = \"\";\n    } else if (position > 0) {\n      buffer = buffer.slice(position);\n    }\n  }\n  function parseEventStreamLine(lineBuffer, index, fieldLength, lineLength) {\n    if (lineLength === 0) {\n      if (data.length > 0) {\n        onParse({\n          type: \"event\",\n          id: eventId,\n          event: eventName || void 0,\n          data: data.slice(0, -1)\n          // remove trailing newline\n        });\n\n        data = \"\";\n        eventId = void 0;\n      }\n      eventName = void 0;\n      return;\n    }\n    const noValue = fieldLength < 0;\n    const field = lineBuffer.slice(index, index + (noValue ? lineLength : fieldLength));\n    let step = 0;\n    if (noValue) {\n      step = lineLength;\n    } else if (lineBuffer[index + fieldLength + 1] === \" \") {\n      step = fieldLength + 2;\n    } else {\n      step = fieldLength + 1;\n    }\n    const position = index + step;\n    const valueLength = lineLength - step;\n    const value = lineBuffer.slice(position, position + valueLength).toString();\n    if (field === \"data\") {\n      data += value ? \"\".concat(value, \"\\n\") : \"\\n\";\n    } else if (field === \"event\") {\n      eventName = value;\n    } else if (field === \"id\" && !value.includes(\"\\0\")) {\n      eventId = value;\n    } else if (field === \"retry\") {\n      const retry = parseInt(value, 10);\n      if (!Number.isNaN(retry)) {\n        onParse({\n          type: \"reconnect-interval\",\n          value: retry\n        });\n      }\n    }\n  }\n}\nconst BOM = [239, 187, 191];\nfunction hasBom(buffer) {\n  return BOM.every((charCode, index) => buffer.charCodeAt(index) === charCode);\n}\nexport { createParser };\n//# sourceMappingURL=index.js.map\n","import { createParser } from './index.js';\nclass EventSourceParserStream extends TransformStream {\n  constructor() {\n    let parser;\n    super({\n      start(controller) {\n        parser = createParser(event => {\n          if (event.type === \"event\") {\n            controller.enqueue(event);\n          }\n        });\n      },\n      transform(chunk) {\n        parser.feed(chunk);\n      }\n    });\n  }\n}\nexport { EventSourceParserStream };\n//# sourceMappingURL=stream.js.map\n","import { EventSourceParserStream } from 'eventsource-parser/stream';\r\nimport type { ParsedEvent } from 'eventsource-parser';\r\n\r\ntype TextStreamUpdate = {\r\n\tdone: boolean;\r\n\tvalue: string;\r\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n\tcitations?: any;\r\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n\terror?: any;\r\n\tusage?: ResponseUsage;\r\n};\r\n\r\ntype ResponseUsage = {\r\n\t/** Including images and tools if any */\r\n\tprompt_tokens: number;\r\n\t/** The tokens generated */\r\n\tcompletion_tokens: number;\r\n\t/** Sum of the above two fields */\r\n\ttotal_tokens: number;\r\n};\r\n\r\n// createOpenAITextStream takes a responseBody with a SSE response,\r\n// and returns an async generator that emits delta updates with large deltas chunked into random sized chunks\r\nexport async function createOpenAITextStream(\r\n\tresponseBody: ReadableStream<Uint8Array>,\r\n\tsplitLargeDeltas: boolean\r\n): Promise<AsyncGenerator<TextStreamUpdate>> {\r\n\tconst eventStream = responseBody\r\n\t\t.pipeThrough(new TextDecoderStream())\r\n\t\t.pipeThrough(new EventSourceParserStream())\r\n\t\t.getReader();\r\n\tlet iterator = openAIStreamToIterator(eventStream);\r\n\tif (splitLargeDeltas) {\r\n\t\titerator = streamLargeDeltasAsRandomChunks(iterator);\r\n\t}\r\n\treturn iterator;\r\n}\r\n\r\nasync function* openAIStreamToIterator(\r\n\treader: ReadableStreamDefaultReader<ParsedEvent>\r\n): AsyncGenerator<TextStreamUpdate> {\r\n\twhile (true) {\r\n\t\tconst { value, done } = await reader.read();\r\n\t\tif (done) {\r\n\t\t\tyield { done: true, value: '' };\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (!value) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tconst data = value.data;\r\n\t\tif (data.startsWith('[DONE]')) {\r\n\t\t\tyield { done: true, value: '' };\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst parsedData = JSON.parse(data);\r\n\t\t\tconsole.log(parsedData);\r\n\r\n\t\t\tif (parsedData.error) {\r\n\t\t\t\tyield { done: true, value: '', error: parsedData.error };\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tif (parsedData.citations) {\r\n\t\t\t\tyield { done: false, value: '', citations: parsedData.citations };\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tyield {\r\n\t\t\t\tdone: false,\r\n\t\t\t\tvalue: parsedData.choices?.[0]?.delta?.content ?? '',\r\n\t\t\t\tusage: parsedData.usage\r\n\t\t\t};\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error('Error extracting delta from SSE event:', e);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// streamLargeDeltasAsRandomChunks will chunk large deltas (length > 5) into random sized chunks between 1-3 characters\r\n// This is to simulate a more fluid streaming, even though some providers may send large chunks of text at once\r\nasync function* streamLargeDeltasAsRandomChunks(\r\n\titerator: AsyncGenerator<TextStreamUpdate>\r\n): AsyncGenerator<TextStreamUpdate> {\r\n\tfor await (const textStreamUpdate of iterator) {\r\n\t\tif (textStreamUpdate.done) {\r\n\t\t\tyield textStreamUpdate;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (textStreamUpdate.citations) {\r\n\t\t\tyield textStreamUpdate;\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tlet content = textStreamUpdate.value;\r\n\t\tif (content.length < 5) {\r\n\t\t\tyield { done: false, value: content };\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\twhile (content != '') {\r\n\t\t\tconst chunkSize = Math.min(Math.floor(Math.random() * 3) + 1, content.length);\r\n\t\t\tconst chunk = content.slice(0, chunkSize);\r\n\t\t\tyield { done: false, value: chunk };\r\n\t\t\t// Do not sleep if the tab is hidden\r\n\t\t\t// Timers are throttled to 1s in hidden tabs\r\n\t\t\tif (document?.visibilityState !== 'hidden') {\r\n\t\t\t\tawait sleep(5);\r\n\t\t\t}\r\n\t\t\tcontent = content.slice(chunkSize);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst sleep = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms));\r\n","<script lang=\"ts\">\r\n\timport type { Banner } from '$lib/types';\r\n\timport { onMount, createEventDispatcher } from 'svelte';\r\n\timport { fade } from 'svelte/transition';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let banner: Banner = {\r\n\t\tid: '',\r\n\t\ttype: 'info',\r\n\t\ttitle: '',\r\n\t\tcontent: '',\r\n\t\turl: '',\r\n\t\tdismissable: true,\r\n\t\ttimestamp: Math.floor(Date.now() / 1000)\r\n\t};\r\n\r\n\texport let dismissed = false;\r\n\r\n\tlet mounted = false;\r\n\r\n\tconst classNames: Record<string, string> = {\r\n\t\tinfo: 'bg-blue-500/20 text-blue-700 dark:text-blue-200 ',\r\n\t\tsuccess: 'bg-green-500/20 text-green-700 dark:text-green-200',\r\n\t\twarning: 'bg-yellow-500/20 text-yellow-700 dark:text-yellow-200',\r\n\t\terror: 'bg-red-500/20 text-red-700 dark:text-red-200'\r\n\t};\r\n\r\n\tconst dismiss = (id) => {\r\n\t\tdismissed = true;\r\n\t\tdispatch('dismiss', id);\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\tmounted = true;\r\n\t});\r\n</script>\r\n\r\n{#if !dismissed}\r\n\t{#if mounted}\r\n\t\t<div\r\n\t\t\tclass=\" top-0 left-0 right-0 p-2 mx-4 px-3 flex justify-center items-center relative rounded-xl border border-gray-50 dark:border-gray-850 text-gray-800 dark:text-gary-100 bg-white dark:bg-gray-900 backdrop-blur-xl z-30\"\r\n\t\t\ttransition:fade={{ delay: 100, duration: 300 }}\r\n\t\t>\r\n\t\t\t<div class=\" flex flex-col md:flex-row md:items-center flex-1 text-sm w-fit gap-1.5\">\r\n\t\t\t\t<div class=\"flex justify-between self-start\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" text-xs font-bold {classNames[banner.type] ??\r\n\t\t\t\t\t\t\tclassNames['info']}  w-fit px-2 rounded uppercase line-clamp-1 mr-0.5\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{banner.type}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if banner.url}\r\n\t\t\t\t\t\t<div class=\"flex md:hidden group w-fit md:items-center\">\r\n\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\tclass=\"text-gray-700 dark:text-white text-xs font-semibold underline\"\r\n\t\t\t\t\t\t\t\thref=\"/assets/files/whitepaper.pdf\"\r\n\t\t\t\t\t\t\t\ttarget=\"_blank\">Learn More</a\r\n\t\t\t\t\t\t\t>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<!--  -->\r\n\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\r\n\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"flex-1 text-xs text-gray-700 dark:text-white\">\r\n\t\t\t\t\t{banner.content}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#if banner.url}\r\n\t\t\t\t<div class=\"hidden md:flex group w-fit md:items-center\">\r\n\t\t\t\t\t<a\r\n\t\t\t\t\t\tclass=\"text-gray-700 dark:text-white text-xs font-semibold underline\"\r\n\t\t\t\t\t\thref=\"/\"\r\n\t\t\t\t\t\ttarget=\"_blank\">Learn More</a\r\n\t\t\t\t\t>\r\n\r\n\t\t\t\t\t<div class=\" ml-1 text-gray-400 group-hover:text-gray-600 dark:group-hover:text-white\">\r\n\t\t\t\t\t\t<!--  -->\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\td=\"M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z\"\r\n\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t\t<div class=\"flex self-start\">\r\n\t\t\t\t{#if banner.dismissible}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tdismiss(banner.id);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclass=\"  -mt-1 -mb-2 -translate-y-[1px] ml-1.5 mr-1 text-gray-400 dark:hover:text-white\"\r\n\t\t\t\t\t\t>&times;</button\r\n\t\t\t\t\t>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t{/if}\r\n{/if}\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n</script>\r\n\r\n<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" class={className}>\r\n\t<path\r\n\t\tfill-rule=\"evenodd\"\r\n\t\td=\"M5.625 1.5H9a3.75 3.75 0 0 1 3.75 3.75v1.875c0 1.036.84 1.875 1.875 1.875H16.5a3.75 3.75 0 0 1 3.75 3.75v7.875c0 1.035-.84 1.875-1.875 1.875H5.625a1.875 1.875 0 0 1-1.875-1.875V3.375c0-1.036.84-1.875 1.875-1.875Zm6.905 9.97a.75.75 0 0 0-1.06 0l-3 3a.75.75 0 1 0 1.06 1.06l1.72-1.72V18a.75.75 0 0 0 1.5 0v-4.19l1.72 1.72a.75.75 0 1 0 1.06-1.06l-3-3Z\"\r\n\t\tclip-rule=\"evenodd\"\r\n\t/>\r\n\t<path\r\n\t\td=\"M14.25 5.25a5.23 5.23 0 0 0-1.279-3.434 9.768 9.768 0 0 1 6.963 6.963A5.23 5.23 0 0 0 16.5 7.5h-1.875a.375.375 0 0 1-.375-.375V5.25Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n</script>\r\n\r\n<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" class={className}>\r\n\t<path\r\n\t\td=\"M21.721 12.752a9.711 9.711 0 0 0-.945-5.003 12.754 12.754 0 0 1-4.339 2.708 18.991 18.991 0 0 1-.214 4.772 17.165 17.165 0 0 0 5.498-2.477ZM14.634 15.55a17.324 17.324 0 0 0 .332-4.647c-.952.227-1.945.347-2.966.347-1.021 0-2.014-.12-2.966-.347a17.515 17.515 0 0 0 .332 4.647 17.385 17.385 0 0 0 5.268 0ZM9.772 17.119a18.963 18.963 0 0 0 4.456 0A17.182 17.182 0 0 1 12 21.724a17.18 17.18 0 0 1-2.228-4.605ZM7.777 15.23a18.87 18.87 0 0 1-.214-4.774 12.753 12.753 0 0 1-4.34-2.708 9.711 9.711 0 0 0-.944 5.004 17.165 17.165 0 0 0 5.498 2.477ZM21.356 14.752a9.765 9.765 0 0 1-7.478 6.817 18.64 18.64 0 0 0 1.988-4.718 18.627 18.627 0 0 0 5.49-2.098ZM2.644 14.752c1.682.971 3.53 1.688 5.49 2.099a18.64 18.64 0 0 0 1.988 4.718 9.765 9.765 0 0 1-7.478-6.816ZM13.878 2.43a9.755 9.755 0 0 1 6.116 3.986 11.267 11.267 0 0 1-3.746 2.504 18.63 18.63 0 0 0-2.37-6.49ZM12 2.276a17.152 17.152 0 0 1 2.805 7.121c-.897.23-1.837.353-2.805.353-.968 0-1.908-.122-2.805-.353A17.151 17.151 0 0 1 12 2.276ZM10.122 2.43a18.629 18.629 0 0 0-2.37 6.49 11.266 11.266 0 0 1-3.746-2.504 9.754 9.754 0 0 1 6.116-3.985Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n</script>\r\n\r\n<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" class={className}>\r\n\t<path\r\n\t\tfill-rule=\"evenodd\"\r\n\t\td=\"M12 6.75a5.25 5.25 0 0 1 6.775-5.025.75.75 0 0 1 .313 1.248l-3.32 3.319c.063.475.276.934.641 1.299.365.365.824.578 1.3.64l3.318-3.319a.75.75 0 0 1 1.248.313 5.25 5.25 0 0 1-5.472 6.756c-1.018-.086-1.87.1-2.309.634L7.344 21.3A3.298 3.298 0 1 1 2.7 16.657l8.684-7.151c.533-.44.72-1.291.634-2.309A5.342 5.342 0 0 1 12 6.75ZM4.117 19.125a.75.75 0 0 1 .75-.75h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75h-.008a.75.75 0 0 1-.75-.75v-.008Z\"\r\n\t\tclip-rule=\"evenodd\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\timport { getContext } from 'svelte';\r\n\r\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport DocumentArrowUpSolid from '$lib/components/icons/DocumentArrowUpSolid.svelte';\r\n\timport Switch from '$lib/components/common/Switch.svelte';\r\n\timport GlobeAltSolid from '$lib/components/icons/GlobeAltSolid.svelte';\r\n\timport { config } from '$lib/stores';\r\n\timport WrenchSolid from '$lib/components/icons/WrenchSolid.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let uploadFilesHandler: Function;\r\n\r\n\texport let selectedToolIds: string[] = [];\r\n\texport let webSearchEnabled: boolean;\r\n\r\n\texport let tools = {};\r\n\texport let onClose: Function;\r\n\r\n\t$: tools = Object.fromEntries(\r\n\t\tObject.keys(tools).map((toolId) => [\r\n\t\t\ttoolId,\r\n\t\t\t{\r\n\t\t\t\t...tools[toolId],\r\n\t\t\t\tenabled: selectedToolIds.includes(toolId)\r\n\t\t\t}\r\n\t\t])\r\n\t);\r\n\r\n\tlet show = false;\r\n</script>\r\n\r\n<Dropdown\r\n\tbind:show\r\n\ton:change={(e) => {\r\n\t\tif (e.detail === false) {\r\n\t\t\tonClose();\r\n\t\t}\r\n\t}}\r\n>\r\n\t<Tooltip content={$i18n.t('More')}>\r\n\t\t<slot />\r\n\t</Tooltip>\r\n\r\n\t<div slot=\"content\">\r\n\t\t<DropdownMenu.Content\r\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1  border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow\"\r\n\t\t\tsideOffset={15}\r\n\t\t\talignOffset={-8}\r\n\t\t\tside=\"top\"\r\n\t\t\talign=\"start\"\r\n\t\t\ttransition={flyAndScale}\r\n\t\t>\r\n\t\t\t{#if Object.keys(tools).length > 0}\r\n\t\t\t\t<div class=\"  max-h-28 overflow-y-auto scrollbar-hidden\">\r\n\t\t\t\t\t{#each Object.keys(tools) as toolId}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\"flex-1 flex items-center gap-2\">\r\n\t\t\t\t\t\t\t\t<WrenchSolid />\r\n\t\t\t\t\t\t\t\t<Tooltip content={tools[toolId]?.description ?? ''} className=\"flex-1\">\r\n\t\t\t\t\t\t\t\t\t<div class=\" line-clamp-1\">{tools[toolId].name}</div>\r\n\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<Switch\r\n\t\t\t\t\t\t\t\tbind:state={tools[toolId].enabled}\r\n\t\t\t\t\t\t\t\ton:change={(e) => {\r\n\t\t\t\t\t\t\t\t\tselectedToolIds = e.detail\r\n\t\t\t\t\t\t\t\t\t\t? [...selectedToolIds, toolId]\r\n\t\t\t\t\t\t\t\t\t\t: selectedToolIds.filter((id) => id !== toolId);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-800 my-1\" />\r\n\t\t\t{/if}\r\n\r\n\t\t\t{#if $config?.features?.enable_web_search}\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm font-medium cursor-pointer rounded-xl\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\"flex-1 flex items-center gap-2\">\r\n\t\t\t\t\t\t<GlobeAltSolid />\r\n\t\t\t\t\t\t<div class=\" line-clamp-1\">{$i18n.t('Web Search')}</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<Switch bind:state={webSearchEnabled} />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<hr class=\"border-gray-100 dark:border-gray-800 my-1\" />\r\n\t\t\t{/if}\r\n\r\n\t\t\t<DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  font-medium cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800  rounded-xl\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tuploadFilesHandler();\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<DocumentArrowUpSolid />\r\n\t\t\t\t<div class=\" line-clamp-1\">{$i18n.t('Upload Files')}</div>\r\n\t\t\t</DropdownMenu.Item>\r\n\t\t</DropdownMenu.Content>\r\n\t</div>\r\n</Dropdown>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '0';\r\n</script>\r\n\r\n<svg\r\n\taria-hidden=\"true\"\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"currentColor\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tfill-rule=\"evenodd\"\r\n\t\td=\"M12 5a7 7 0 0 0-7 7v1.17c.313-.11.65-.17 1-.17h2a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H6a3 3 0 0 1-3-3v-6a9 9 0 0 1 18 0v6a3 3 0 0 1-3 3h-2a1 1 0 0 1-1-1v-6a1 1 0 0 1 1-1h2c.35 0 .687.06 1 .17V12a7 7 0 0 0-7-7Z\"\r\n\t\tclip-rule=\"evenodd\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { createEventDispatcher, tick, getContext } from 'svelte';\r\n\timport { config, settings } from '$lib/stores';\r\n\timport { blobToFile, calculateSHA256, findWordIndices } from '$lib/utils';\r\n\r\n\timport { transcribeAudio } from '$lib/apis/audio';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let recording = false;\r\n\r\n\tlet loading = false;\r\n\tlet confirmed = false;\r\n\r\n\tlet durationSeconds = 0;\r\n\tlet durationCounter = null;\r\n\r\n\tlet transcription = '';\r\n\r\n\tconst startDurationCounter = () => {\r\n\t\tdurationCounter = setInterval(() => {\r\n\t\t\tdurationSeconds++;\r\n\t\t}, 1000);\r\n\t};\r\n\r\n\tconst stopDurationCounter = () => {\r\n\t\tclearInterval(durationCounter);\r\n\t\tdurationSeconds = 0;\r\n\t};\r\n\r\n\t$: if (recording) {\r\n\t\tstartRecording();\r\n\t} else {\r\n\t\tstopRecording();\r\n\t}\r\n\r\n\tconst formatSeconds = (seconds) => {\r\n\t\tconst minutes = Math.floor(seconds / 60);\r\n\t\tconst remainingSeconds = seconds % 60;\r\n\t\tconst formattedSeconds = remainingSeconds < 10 ? `0${remainingSeconds}` : remainingSeconds;\r\n\t\treturn `${minutes}:${formattedSeconds}`;\r\n\t};\r\n\r\n\tlet stream;\r\n\tlet speechRecognition;\r\n\r\n\tlet mediaRecorder;\r\n\tlet audioChunks = [];\r\n\r\n\tconst MIN_DECIBELS = -45;\r\n\tconst VISUALIZER_BUFFER_LENGTH = 300;\r\n\r\n\tlet visualizerData = Array(VISUALIZER_BUFFER_LENGTH).fill(0);\r\n\r\n\t// Function to calculate the RMS level from time domain data\r\n\tconst calculateRMS = (data: Uint8Array) => {\r\n\t\tlet sumSquares = 0;\r\n\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\tconst normalizedValue = (data[i] - 128) / 128; // Normalize the data\r\n\t\t\tsumSquares += normalizedValue * normalizedValue;\r\n\t\t}\r\n\t\treturn Math.sqrt(sumSquares / data.length);\r\n\t};\r\n\r\n\tconst normalizeRMS = (rms) => {\r\n\t\trms = rms * 10;\r\n\t\tconst exp = 1.5; // Adjust exponent value; values greater than 1 expand larger numbers more and compress smaller numbers more\r\n\t\tconst scaledRMS = Math.pow(rms, exp);\r\n\r\n\t\t// Scale between 0.01 (1%) and 1.0 (100%)\r\n\t\treturn Math.min(1.0, Math.max(0.01, scaledRMS));\r\n\t};\r\n\r\n\tconst analyseAudio = (stream) => {\r\n\t\tconst audioContext = new AudioContext();\r\n\t\tconst audioStreamSource = audioContext.createMediaStreamSource(stream);\r\n\r\n\t\tconst analyser = audioContext.createAnalyser();\r\n\t\tanalyser.minDecibels = MIN_DECIBELS;\r\n\t\taudioStreamSource.connect(analyser);\r\n\r\n\t\tconst bufferLength = analyser.frequencyBinCount;\r\n\r\n\t\tconst domainData = new Uint8Array(bufferLength);\r\n\t\tconst timeDomainData = new Uint8Array(analyser.fftSize);\r\n\r\n\t\tlet lastSoundTime = Date.now();\r\n\r\n\t\tconst detectSound = () => {\r\n\t\t\tconst processFrame = () => {\r\n\t\t\t\tif (!recording || loading) return;\r\n\r\n\t\t\t\tif (recording && !loading) {\r\n\t\t\t\t\tanalyser.getByteTimeDomainData(timeDomainData);\r\n\t\t\t\t\tanalyser.getByteFrequencyData(domainData);\r\n\r\n\t\t\t\t\t// Calculate RMS level from time domain data\r\n\t\t\t\t\tconst rmsLevel = calculateRMS(timeDomainData);\r\n\t\t\t\t\t// Push the calculated decibel level to visualizerData\r\n\t\t\t\t\tvisualizerData.push(normalizeRMS(rmsLevel));\r\n\r\n\t\t\t\t\t// Ensure visualizerData array stays within the buffer length\r\n\t\t\t\t\tif (visualizerData.length >= VISUALIZER_BUFFER_LENGTH) {\r\n\t\t\t\t\t\tvisualizerData.shift();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvisualizerData = visualizerData;\r\n\r\n\t\t\t\t\t// if (domainData.some((value) => value > 0)) {\r\n\t\t\t\t\t// \tlastSoundTime = Date.now();\r\n\t\t\t\t\t// }\r\n\r\n\t\t\t\t\t// if (recording && Date.now() - lastSoundTime > 3000) {\r\n\t\t\t\t\t// \tif ($settings?.speechAutoSend ?? false) {\r\n\t\t\t\t\t// \t\tconfirmRecording();\r\n\t\t\t\t\t// \t}\r\n\t\t\t\t\t// }\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.requestAnimationFrame(processFrame);\r\n\t\t\t};\r\n\r\n\t\t\twindow.requestAnimationFrame(processFrame);\r\n\t\t};\r\n\r\n\t\tdetectSound();\r\n\t};\r\n\r\n\tconst transcribeHandler = async (audioBlob) => {\r\n\t\t// Create a blob from the audio chunks\r\n\r\n\t\tawait tick();\r\n\t\tconst file = blobToFile(audioBlob, 'recording.wav');\r\n\r\n\t\tconst res = await transcribeAudio(localStorage.token, file).catch((error) => {\r\n\t\t\ttoast.error(error);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (res) {\r\n\t\t\tconsole.log(res.text);\r\n\t\t\tdispatch('confirm', res.text);\r\n\t\t}\r\n\t};\r\n\r\n\tconst saveRecording = (blob) => {\r\n\t\tconst url = URL.createObjectURL(blob);\r\n\t\tconst a = document.createElement('a');\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.style = 'display: none';\r\n\t\ta.href = url;\r\n\t\ta.download = 'recording.wav';\r\n\t\ta.click();\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t};\r\n\r\n\tconst startRecording = async () => {\r\n\t\tstartDurationCounter();\r\n\r\n\t\tstream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n\t\tmediaRecorder = new MediaRecorder(stream);\r\n\t\tmediaRecorder.onstart = () => {\r\n\t\t\tconsole.log('Recording started');\r\n\t\t\taudioChunks = [];\r\n\t\t\tanalyseAudio(stream);\r\n\t\t};\r\n\t\tmediaRecorder.ondataavailable = (event) => audioChunks.push(event.data);\r\n\t\tmediaRecorder.onstop = async () => {\r\n\t\t\tconsole.log('Recording stopped');\r\n\t\t\tif (($settings?.audio?.stt?.engine ?? '') === 'web') {\r\n\t\t\t\taudioChunks = [];\r\n\t\t\t} else {\r\n\t\t\t\tif (confirmed) {\r\n\t\t\t\t\tconst audioBlob = new Blob(audioChunks, { type: 'audio/wav' });\r\n\r\n\t\t\t\t\tawait transcribeHandler(audioBlob);\r\n\r\n\t\t\t\t\tconfirmed = false;\r\n\t\t\t\t\tloading = false;\r\n\t\t\t\t}\r\n\t\t\t\taudioChunks = [];\r\n\t\t\t\trecording = false;\r\n\t\t\t}\r\n\t\t};\r\n\t\tmediaRecorder.start();\r\n\t\tif ($config.audio.stt.engine === 'web' || ($settings?.audio?.stt?.engine ?? '') === 'web') {\r\n\t\t\tif ('SpeechRecognition' in window || 'webkitSpeechRecognition' in window) {\r\n\t\t\t\t// Create a SpeechRecognition object\r\n\t\t\t\tspeechRecognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();\r\n\r\n\t\t\t\t// Set continuous to true for continuous recognition\r\n\t\t\t\tspeechRecognition.continuous = true;\r\n\r\n\t\t\t\t// Set the timeout for turning off the recognition after inactivity (in milliseconds)\r\n\t\t\t\tconst inactivityTimeout = 2000; // 3 seconds\r\n\r\n\t\t\t\tlet timeoutId;\r\n\t\t\t\t// Start recognition\r\n\t\t\t\tspeechRecognition.start();\r\n\r\n\t\t\t\t// Event triggered when speech is recognized\r\n\t\t\t\tspeechRecognition.onresult = async (event) => {\r\n\t\t\t\t\t// Clear the inactivity timeout\r\n\t\t\t\t\tclearTimeout(timeoutId);\r\n\r\n\t\t\t\t\t// Handle recognized speech\r\n\t\t\t\t\tconsole.log(event);\r\n\t\t\t\t\tconst transcript = event.results[Object.keys(event.results).length - 1][0].transcript;\r\n\r\n\t\t\t\t\ttranscription = `${transcription}${transcript}`;\r\n\r\n\t\t\t\t\tawait tick();\r\n\t\t\t\t\tdocument.getElementById('chat-textarea')?.focus();\r\n\r\n\t\t\t\t\t// Restart the inactivity timeout\r\n\t\t\t\t\ttimeoutId = setTimeout(() => {\r\n\t\t\t\t\t\tconsole.log('Speech recognition turned off due to inactivity.');\r\n\t\t\t\t\t\tspeechRecognition.stop();\r\n\t\t\t\t\t}, inactivityTimeout);\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Event triggered when recognition is ended\r\n\t\t\t\tspeechRecognition.onend = function () {\r\n\t\t\t\t\t// Restart recognition after it ends\r\n\t\t\t\t\tconsole.log('recognition ended');\r\n\r\n\t\t\t\t\tconfirmRecording();\r\n\t\t\t\t\tdispatch('confirm', transcription);\r\n\r\n\t\t\t\t\tconfirmed = false;\r\n\t\t\t\t\tloading = false;\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Event triggered when an error occurs\r\n\t\t\t\tspeechRecognition.onerror = function (event) {\r\n\t\t\t\t\tconsole.log(event);\r\n\t\t\t\t\ttoast.error($i18n.t(`Speech recognition error: {{error}}`, { error: event.error }));\r\n\t\t\t\t\tdispatch('cancel');\r\n\r\n\t\t\t\t\tstopRecording();\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst stopRecording = async () => {\r\n\t\tif (recording && mediaRecorder) {\r\n\t\t\tawait mediaRecorder.stop();\r\n\t\t}\r\n\t\tstopDurationCounter();\r\n\t\taudioChunks = [];\r\n\r\n\t\tif (stream) {\r\n\t\t\tconst tracks = stream.getTracks();\r\n\t\t\ttracks.forEach((track) => track.stop());\r\n\t\t}\r\n\r\n\t\tstream = null;\r\n\t};\r\n\r\n\tconst confirmRecording = async () => {\r\n\t\tloading = true;\r\n\t\tconfirmed = true;\r\n\r\n\t\tif (recording && mediaRecorder) {\r\n\t\t\tawait mediaRecorder.stop();\r\n\t\t}\r\n\t\tclearInterval(durationCounter);\r\n\t};\r\n</script>\r\n\r\n<div\r\n\tclass=\"{loading\r\n\t\t? ' bg-gray-100/50 dark:bg-gray-850/50'\r\n\t\t: 'bg-indigo-300/10 dark:bg-indigo-500/10 '} rounded-full flex p-2.5\"\r\n>\r\n\t<div class=\"flex items-center mr-1\">\r\n\t\t<button\r\n\t\t\ttype=\"button\"\r\n\t\t\tclass=\"p-1.5\r\n\r\n            {loading\r\n\t\t\t\t? ' bg-gray-200 dark:bg-gray-700/50'\r\n\t\t\t\t: 'bg-indigo-400/20 text-indigo-600 dark:text-indigo-300 '} \r\n\r\n\r\n             rounded-full\"\r\n\t\t\ton:click={async () => {\r\n\t\t\t\tdispatch('cancel');\r\n\t\t\t\tstopRecording();\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\tstroke-width=\"3\"\r\n\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\tclass=\"size-4\"\r\n\t\t\t>\r\n\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18 18 6M6 6l12 12\" />\r\n\t\t\t</svg>\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t<div\r\n\t\tclass=\"flex flex-1 self-center items-center justify-between ml-2 mx-1 overflow-hidden h-6\"\r\n\t\tdir=\"rtl\"\r\n\t>\r\n\t\t<div class=\"flex-1 flex items-center gap-0.5 h-6\">\r\n\t\t\t{#each visualizerData.slice().reverse() as rms}\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"w-[2px]\r\n                    \r\n                    {loading\r\n\t\t\t\t\t\t? ' bg-gray-500 dark:bg-gray-400   '\r\n\t\t\t\t\t\t: 'bg-indigo-500 dark:bg-indigo-400  '} \r\n                    \r\n                    inline-block h-full\"\r\n\t\t\t\t\tstyle=\"height: {Math.min(100, Math.max(14, rms * 100))}%;\"\r\n\t\t\t\t/>\r\n\t\t\t{/each}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"  mx-1.5 pr-1 flex justify-center items-center\">\r\n\t\t<div\r\n\t\t\tclass=\"text-sm\r\n        \r\n        \r\n        {loading ? ' text-gray-500  dark:text-gray-400  ' : ' text-indigo-400 '} \r\n       font-medium flex-1 mx-auto text-center\"\r\n\t\t>\r\n\t\t\t{formatSeconds(durationSeconds)}\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"flex items-center mr-1\">\r\n\t\t{#if loading}\r\n\t\t\t<div class=\" text-gray-500 rounded-full cursor-not-allowed\">\r\n\t\t\t\t<svg\r\n\t\t\t\t\twidth=\"24\"\r\n\t\t\t\t\theight=\"24\"\r\n\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t><style>\r\n\t\t\t\t\t\t.spinner_OSmW {\r\n\t\t\t\t\t\t\ttransform-origin: center;\r\n\t\t\t\t\t\t\tanimation: spinner_T6mA 0.75s step-end infinite;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t@keyframes spinner_T6mA {\r\n\t\t\t\t\t\t\t8.3% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(30deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t16.6% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(60deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t25% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(90deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t33.3% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(120deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t41.6% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(150deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t50% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(180deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t58.3% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(210deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t66.6% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(240deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t75% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(270deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t83.3% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(300deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t91.6% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(330deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\ttransform: rotate(360deg);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</style><g class=\"spinner_OSmW\"\r\n\t\t\t\t\t\t><rect x=\"11\" y=\"1\" width=\"2\" height=\"5\" opacity=\".14\" /><rect\r\n\t\t\t\t\t\t\tx=\"11\"\r\n\t\t\t\t\t\t\ty=\"1\"\r\n\t\t\t\t\t\t\twidth=\"2\"\r\n\t\t\t\t\t\t\theight=\"5\"\r\n\t\t\t\t\t\t\ttransform=\"rotate(30 12 12)\"\r\n\t\t\t\t\t\t\topacity=\".29\"\r\n\t\t\t\t\t\t/><rect\r\n\t\t\t\t\t\t\tx=\"11\"\r\n\t\t\t\t\t\t\ty=\"1\"\r\n\t\t\t\t\t\t\twidth=\"2\"\r\n\t\t\t\t\t\t\theight=\"5\"\r\n\t\t\t\t\t\t\ttransform=\"rotate(60 12 12)\"\r\n\t\t\t\t\t\t\topacity=\".43\"\r\n\t\t\t\t\t\t/><rect\r\n\t\t\t\t\t\t\tx=\"11\"\r\n\t\t\t\t\t\t\ty=\"1\"\r\n\t\t\t\t\t\t\twidth=\"2\"\r\n\t\t\t\t\t\t\theight=\"5\"\r\n\t\t\t\t\t\t\ttransform=\"rotate(90 12 12)\"\r\n\t\t\t\t\t\t\topacity=\".57\"\r\n\t\t\t\t\t\t/><rect\r\n\t\t\t\t\t\t\tx=\"11\"\r\n\t\t\t\t\t\t\ty=\"1\"\r\n\t\t\t\t\t\t\twidth=\"2\"\r\n\t\t\t\t\t\t\theight=\"5\"\r\n\t\t\t\t\t\t\ttransform=\"rotate(120 12 12)\"\r\n\t\t\t\t\t\t\topacity=\".71\"\r\n\t\t\t\t\t\t/><rect\r\n\t\t\t\t\t\t\tx=\"11\"\r\n\t\t\t\t\t\t\ty=\"1\"\r\n\t\t\t\t\t\t\twidth=\"2\"\r\n\t\t\t\t\t\t\theight=\"5\"\r\n\t\t\t\t\t\t\ttransform=\"rotate(150 12 12)\"\r\n\t\t\t\t\t\t\topacity=\".86\"\r\n\t\t\t\t\t\t/><rect x=\"11\" y=\"1\" width=\"2\" height=\"5\" transform=\"rotate(180 12 12)\" /></g\r\n\t\t\t\t\t></svg\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<button\r\n\t\t\t\ttype=\"button\"\r\n\t\t\t\tclass=\"p-1.5 bg-indigo-500 text-white dark:bg-indigo-500 dark:text-blue-950 rounded-full\"\r\n\t\t\t\ton:click={async () => {\r\n\t\t\t\t\tawait confirmRecording();\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\tstroke-width=\"2.5\"\r\n\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"m4.5 12.75 6 6 9-13.5\" />\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t{/if}\r\n\t</div>\r\n</div>\r\n\r\n<style>\r\n\t.visualizer {\r\n\t\tdisplay: flex;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t.visualizer-bar {\r\n\t\twidth: 2px;\r\n\t\tbackground-color: #4a5aba; /* or whatever color you need */\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\timport { showSidebar } from '$lib/stores';\r\n\timport AddFilesPlaceholder from '$lib/components/AddFilesPlaceholder.svelte';\r\n\r\n\texport let show = false;\r\n\tlet overlayElement = null;\r\n\r\n\t$: if (show && overlayElement) {\r\n\t\tdocument.body.appendChild(overlayElement);\r\n\t\tdocument.body.style.overflow = 'hidden';\r\n\t} else if (overlayElement) {\r\n\t\tdocument.body.removeChild(overlayElement);\r\n\t\tdocument.body.style.overflow = 'unset';\r\n\t}\r\n</script>\r\n\r\n{#if show}\r\n\t<div\r\n\t\tbind:this={overlayElement}\r\n\t\tclass=\"fixed {$showSidebar\r\n\t\t\t? 'left-0 md:left-[260px] md:w-[calc(100%-260px)]'\r\n\t\t\t: 'left-0'}  fixed top-0 right-0 bottom-0 w-full h-full flex z-[9999] touch-none pointer-events-none\"\r\n\t\tid=\"dropzone\"\r\n\t\trole=\"region\"\r\n\t\taria-label=\"Drag and Drop Container\"\r\n\t>\r\n\t\t<div class=\"absolute w-full h-full backdrop-blur bg-gray-800/40 flex justify-center\">\r\n\t\t\t<div class=\"m-auto pt-64 flex flex-col justify-center\">\r\n\t\t\t\t<div class=\"max-w-md\">\r\n\t\t\t\t\t<AddFilesPlaceholder />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { prompts } from '$lib/stores';\r\n\timport {\r\n\t\tfindWordIndices,\r\n\t\tgetUserPosition,\r\n\t\tgetFormattedDate,\r\n\t\tgetFormattedTime,\r\n\t\tgetCurrentDateTime,\r\n\t\tgetUserTimezone,\r\n\t\tgetWeekday\r\n\t} from '$lib/utils';\r\n\timport { tick, getContext } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let files;\r\n\r\n\texport let prompt = '';\r\n\texport let command = '';\r\n\r\n\tlet selectedPromptIdx = 0;\r\n\tlet filteredPrompts = [];\r\n\r\n\t$: filteredPrompts = $prompts\r\n\t\t.filter((p) => p.command.toLowerCase().includes(command.toLowerCase()))\r\n\t\t.sort((a, b) => a.title.localeCompare(b.title));\r\n\r\n\t$: if (command) {\r\n\t\tselectedPromptIdx = 0;\r\n\t}\r\n\r\n\texport const selectUp = () => {\r\n\t\tselectedPromptIdx = Math.max(0, selectedPromptIdx - 1);\r\n\t};\r\n\r\n\texport const selectDown = () => {\r\n\t\tselectedPromptIdx = Math.min(selectedPromptIdx + 1, filteredPrompts.length - 1);\r\n\t};\r\n\r\n\tconst confirmPrompt = async (command) => {\r\n\t\tlet text = command.content;\r\n\r\n\t\tif (command.content.includes('{{CLIPBOARD}}')) {\r\n\t\t\tconst clipboardText = await navigator.clipboard.readText().catch((err) => {\r\n\t\t\t\ttoast.error($i18n.t('Failed to read clipboard contents'));\r\n\t\t\t\treturn '{{CLIPBOARD}}';\r\n\t\t\t});\r\n\r\n\t\t\tconst clipboardItems = await navigator.clipboard.read();\r\n\r\n\t\t\tlet imageUrl = null;\r\n\t\t\tfor (const item of clipboardItems) {\r\n\t\t\t\t// Check for known image types\r\n\t\t\t\tfor (const type of item.types) {\r\n\t\t\t\t\tif (type.startsWith('image/')) {\r\n\t\t\t\t\t\tconst blob = await item.getType(type);\r\n\t\t\t\t\t\timageUrl = URL.createObjectURL(blob);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (imageUrl) {\r\n\t\t\t\tfiles = [\r\n\t\t\t\t\t...files,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: 'image',\r\n\t\t\t\t\t\turl: imageUrl\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\t\t\t}\r\n\r\n\t\t\ttext = text.replaceAll('{{CLIPBOARD}}', clipboardText);\r\n\t\t}\r\n\r\n\t\tif (command.content.includes('{{USER_LOCATION}}')) {\r\n\t\t\tconst location = await getUserPosition();\r\n\t\t\ttext = text.replaceAll('{{USER_LOCATION}}', String(location));\r\n\t\t}\r\n\r\n\t\tif (command.content.includes('{{USER_LANGUAGE}}')) {\r\n\t\t\tconst language = localStorage.getItem('locale') || 'en-US';\r\n\t\t\ttext = text.replaceAll('{{USER_LANGUAGE}}', language);\r\n\t\t}\r\n\r\n\t\tif (command.content.includes('{{CURRENT_DATE}}')) {\r\n\t\t\tconst date = getFormattedDate();\r\n\t\t\ttext = text.replaceAll('{{CURRENT_DATE}}', date);\r\n\t\t}\r\n\r\n\t\tif (command.content.includes('{{CURRENT_TIME}}')) {\r\n\t\t\tconst time = getFormattedTime();\r\n\t\t\ttext = text.replaceAll('{{CURRENT_TIME}}', time);\r\n\t\t}\r\n\r\n\t\tif (command.content.includes('{{CURRENT_DATETIME}}')) {\r\n\t\t\tconst dateTime = getCurrentDateTime();\r\n\t\t\ttext = text.replaceAll('{{CURRENT_DATETIME}}', dateTime);\r\n\t\t}\r\n\r\n\t\tif (command.content.includes('{{CURRENT_TIMEZONE}}')) {\r\n\t\t\tconst timezone = getUserTimezone();\r\n\t\t\ttext = text.replaceAll('{{CURRENT_TIMEZONE}}', timezone);\r\n\t\t}\r\n\r\n\t\tif (command.content.includes('{{CURRENT_WEEKDAY}}')) {\r\n\t\t\tconst weekday = getWeekday();\r\n\t\t\ttext = text.replaceAll('{{CURRENT_WEEKDAY}}', weekday);\r\n\t\t}\r\n\r\n\t\tprompt = text;\r\n\r\n\t\tconst chatInputElement = document.getElementById('chat-textarea');\r\n\r\n\t\tawait tick();\r\n\r\n\t\tchatInputElement.style.height = '';\r\n\t\tchatInputElement.style.height = Math.min(chatInputElement.scrollHeight, 200) + 'px';\r\n\r\n\t\tchatInputElement?.focus();\r\n\r\n\t\tawait tick();\r\n\r\n\t\tconst words = findWordIndices(prompt);\r\n\t\tif (words.length > 0) {\r\n\t\t\tconst word = words.at(0);\r\n\t\t\tchatInputElement.setSelectionRange(word?.startIndex, word.endIndex + 1);\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n{#if filteredPrompts.length > 0}\r\n\t<div\r\n\t\tid=\"commands-container\"\r\n\t\tclass=\"pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\r\n\t>\r\n\t\t<div class=\"flex w-full dark:border dark:border-gray-850 rounded-lg\">\r\n\t\t\t<div class=\"  bg-gray-50 dark:bg-gray-850 w-10 rounded-l-lg text-center\">\r\n\t\t\t\t<div class=\" text-lg font-semibold mt-2\">/</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-r-lg bg-white dark:bg-gray-900 dark:text-gray-100\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden\">\r\n\t\t\t\t\t{#each filteredPrompts as prompt, promptIdx}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\" px-3 py-1.5 rounded-xl w-full text-left {promptIdx === selectedPromptIdx\r\n\t\t\t\t\t\t\t\t? '  bg-gray-50 dark:bg-gray-850 selected-command-option-button'\r\n\t\t\t\t\t\t\t\t: ''}\"\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tconfirmPrompt(prompt);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ton:mousemove={() => {\r\n\t\t\t\t\t\t\t\tselectedPromptIdx = promptIdx;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ton:focus={() => {}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100\">\r\n\t\t\t\t\t\t\t\t{prompt.command}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 dark:text-gray-100\">\r\n\t\t\t\t\t\t\t\t{prompt.title}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\" px-2 pb-1 text-xs text-gray-600 dark:text-gray-100 bg-white dark:bg-gray-900 rounded-br-xl flex items-center space-x-1\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\tclass=\"w-3 h-3\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\td=\"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"line-clamp-1\">\r\n\t\t\t\t\t\t{$i18n.t(\r\n\t\t\t\t\t\t\t'Tip: Update multiple variable slots consecutively by pressing the tab key in the chat input after each replacement.'\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { createEventDispatcher } from 'svelte';\r\n\r\n\timport { documents } from '$lib/stores';\r\n\timport { removeLastWordFromString, isValidHttpUrl } from '$lib/utils';\r\n\timport { tick, getContext } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let prompt = '';\r\n\texport let command = '';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\tlet selectedIdx = 0;\r\n\r\n\tlet filteredItems = [];\r\n\tlet filteredDocs = [];\r\n\r\n\tlet collections = [];\r\n\r\n\t$: collections = [\r\n\t\t...($documents.length > 0\r\n\t\t\t? [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: 'All Documents',\r\n\t\t\t\t\t\ttype: 'collection',\r\n\t\t\t\t\t\ttitle: $i18n.t('All Documents'),\r\n\t\t\t\t\t\tcollection_names: $documents.map((doc) => doc.collection_name)\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t: []),\r\n\t\t...$documents\r\n\t\t\t.reduce((a, e, i, arr) => {\r\n\t\t\t\treturn [...new Set([...a, ...(e?.content?.tags ?? []).map((tag) => tag.name)])];\r\n\t\t\t}, [])\r\n\t\t\t.map((tag) => ({\r\n\t\t\t\tname: tag,\r\n\t\t\t\ttype: 'collection',\r\n\t\t\t\tcollection_names: $documents\r\n\t\t\t\t\t.filter((doc) => (doc?.content?.tags ?? []).map((tag) => tag.name).includes(tag))\r\n\t\t\t\t\t.map((doc) => doc.collection_name)\r\n\t\t\t}))\r\n\t];\r\n\r\n\t$: filteredCollections = collections\r\n\t\t.filter((collection) => findByName(collection, command))\r\n\t\t.sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n\t$: filteredDocs = $documents\r\n\t\t.filter((doc) => findByName(doc, command))\r\n\t\t.sort((a, b) => a.title.localeCompare(b.title));\r\n\r\n\t$: filteredItems = [...filteredCollections, ...filteredDocs];\r\n\r\n\t$: if (command) {\r\n\t\tselectedIdx = 0;\r\n\r\n\t\tconsole.log(filteredCollections);\r\n\t}\r\n\r\n\ttype ObjectWithName = {\r\n\t\tname: string;\r\n\t};\r\n\r\n\tconst findByName = (obj: ObjectWithName, command: string) => {\r\n\t\tconst name = obj.name.toLowerCase();\r\n\t\treturn name.includes(command.toLowerCase().split(' ')?.at(0)?.substring(1) ?? '');\r\n\t};\r\n\r\n\texport const selectUp = () => {\r\n\t\tselectedIdx = Math.max(0, selectedIdx - 1);\r\n\t};\r\n\r\n\texport const selectDown = () => {\r\n\t\tselectedIdx = Math.min(selectedIdx + 1, filteredItems.length - 1);\r\n\t};\r\n\r\n\tconst confirmSelect = async (doc) => {\r\n\t\tdispatch('select', doc);\r\n\r\n\t\tprompt = removeLastWordFromString(prompt, command);\r\n\t\tconst chatInputElement = document.getElementById('chat-textarea');\r\n\r\n\t\tawait tick();\r\n\t\tchatInputElement?.focus();\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst confirmSelectWeb = async (url) => {\r\n\t\tdispatch('url', url);\r\n\r\n\t\tprompt = removeLastWordFromString(prompt, command);\r\n\t\tconst chatInputElement = document.getElementById('chat-textarea');\r\n\r\n\t\tawait tick();\r\n\t\tchatInputElement?.focus();\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst confirmSelectYoutube = async (url) => {\r\n\t\tdispatch('youtube', url);\r\n\r\n\t\tprompt = removeLastWordFromString(prompt, command);\r\n\t\tconst chatInputElement = document.getElementById('chat-textarea');\r\n\r\n\t\tawait tick();\r\n\t\tchatInputElement?.focus();\r\n\t\tawait tick();\r\n\t};\r\n</script>\r\n\r\n{#if filteredItems.length > 0 || prompt.split(' ')?.at(0)?.substring(1).startsWith('http')}\r\n\t<div\r\n\t\tid=\"commands-container\"\r\n\t\tclass=\"pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\r\n\t>\r\n\t\t<div class=\"flex w-full dark:border dark:border-gray-850 rounded-lg\">\r\n\t\t\t<div class=\" bg-gray-50 dark:bg-gray-850 w-10 rounded-l-lg text-center\">\r\n\t\t\t\t<div class=\" text-lg font-semibold mt-2\">#</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-r-xl bg-white dark:bg-gray-900 dark:text-gray-100\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"m-1 overflow-y-auto p-1 rounded-r-xl space-y-0.5 scrollbar-hidden\">\r\n\t\t\t\t\t{#each filteredItems as doc, docIdx}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\" px-3 py-1.5 rounded-xl w-full text-left {docIdx === selectedIdx\r\n\t\t\t\t\t\t\t\t? ' bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button'\r\n\t\t\t\t\t\t\t\t: ''}\"\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tconsole.log(doc);\r\n\r\n\t\t\t\t\t\t\t\tconfirmSelect(doc);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ton:mousemove={() => {\r\n\t\t\t\t\t\t\t\tselectedIdx = docIdx;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ton:focus={() => {}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{#if doc.type === 'collection'}\r\n\t\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100 line-clamp-1\">\r\n\t\t\t\t\t\t\t\t\t{doc?.title ?? `#${doc.name}`}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 dark:text-gray-100 line-clamp-1\">\r\n\t\t\t\t\t\t\t\t\t{$i18n.t('Collection')}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100 line-clamp-1\">\r\n\t\t\t\t\t\t\t\t\t#{doc.name} ({doc.filename})\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 dark:text-gray-100 line-clamp-1\">\r\n\t\t\t\t\t\t\t\t\t{doc.title}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t{/each}\r\n\r\n\t\t\t\t\t{#if prompt\r\n\t\t\t\t\t\t.split(' ')\r\n\t\t\t\t\t\t.some((s) => s.substring(1).startsWith('https://www.youtube.com') || s\r\n\t\t\t\t\t\t\t\t\t.substring(1)\r\n\t\t\t\t\t\t\t\t\t.startsWith('https://youtu.be'))}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\"px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button\"\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tconst url = prompt.split(' ')?.at(0)?.substring(1);\r\n\t\t\t\t\t\t\t\tif (isValidHttpUrl(url)) {\r\n\t\t\t\t\t\t\t\t\tconfirmSelectYoutube(url);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\t\t\t\t\t$i18n.t(\r\n\t\t\t\t\t\t\t\t\t\t\t'Oops! Looks like the URL is invalid. Please double-check and try again.'\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100 line-clamp-1\">\r\n\t\t\t\t\t\t\t\t{prompt.split(' ')?.at(0)?.substring(1)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 line-clamp-1\">{$i18n.t('Youtube')}</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t{:else if prompt.split(' ')?.at(0)?.substring(1).startsWith('http')}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\"px-3 py-1.5 rounded-xl w-full text-left bg-gray-50 dark:bg-gray-850 dark:text-gray-100 selected-command-option-button\"\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tconst url = prompt.split(' ')?.at(0)?.substring(1);\r\n\t\t\t\t\t\t\t\tif (isValidHttpUrl(url)) {\r\n\t\t\t\t\t\t\t\t\tconfirmSelectWeb(url);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\t\t\t\t\t$i18n.t(\r\n\t\t\t\t\t\t\t\t\t\t\t'Oops! Looks like the URL is invalid. Please double-check and try again.'\r\n\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\" font-medium text-black dark:text-gray-100 line-clamp-1\">\r\n\t\t\t\t\t\t\t\t{prompt.split(' ')?.at(0)?.substring(1)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div class=\" text-xs text-gray-600 line-clamp-1\">{$i18n.t('Web')}</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { createEventDispatcher, onMount } from 'svelte';\r\n\timport { tick, getContext } from 'svelte';\r\n\r\n\timport { models } from '$lib/stores';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let command = '';\r\n\r\n\tlet selectedIdx = 0;\r\n\tlet filteredModels = [];\r\n\r\n\t$: filteredModels = $models\r\n\t\t.filter((p) =>\r\n\t\t\tp.name.toLowerCase().includes(command.toLowerCase().split(' ')?.at(0)?.substring(1) ?? '')\r\n\t\t)\r\n\t\t.sort((a, b) => a.name.localeCompare(b.name));\r\n\r\n\t$: if (command) {\r\n\t\tselectedIdx = 0;\r\n\t}\r\n\r\n\texport const selectUp = () => {\r\n\t\tselectedIdx = Math.max(0, selectedIdx - 1);\r\n\t};\r\n\r\n\texport const selectDown = () => {\r\n\t\tselectedIdx = Math.min(selectedIdx + 1, filteredModels.length - 1);\r\n\t};\r\n\r\n\tconst confirmSelect = async (model) => {\r\n\t\tcommand = '';\r\n\t\tdispatch('select', model);\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\tawait tick();\r\n\t\tconst chatInputElement = document.getElementById('chat-textarea');\r\n\t\tawait tick();\r\n\t\tchatInputElement?.focus();\r\n\t\tawait tick();\r\n\t});\r\n</script>\r\n\r\n{#if filteredModels.length > 0}\r\n\t<div\r\n\t\tid=\"commands-container\"\r\n\t\tclass=\"pl-1 pr-12 mb-3 text-left w-full absolute bottom-0 left-0 right-0 z-10\"\r\n\t>\r\n\t\t<div class=\"flex w-full dark:border dark:border-gray-850 rounded-lg\">\r\n\t\t\t<div class=\" bg-gray-50 dark:bg-gray-850 w-10 rounded-l-lg text-center\">\r\n\t\t\t\t<div class=\" text-lg font-semibold mt-2\">@</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\"max-h-60 flex flex-col w-full rounded-r-lg bg-white dark:bg-gray-900 dark:text-gray-100\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"m-1 overflow-y-auto p-1 rounded-r-lg space-y-0.5 scrollbar-hidden\">\r\n\t\t\t\t\t{#each filteredModels as model, modelIdx}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\"px-3 py-1.5 rounded-xl w-full text-left {modelIdx === selectedIdx\r\n\t\t\t\t\t\t\t\t? 'bg-gray-50 dark:bg-gray-850 selected-command-option-button'\r\n\t\t\t\t\t\t\t\t: ''}\"\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tconfirmSelect(model);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ton:mousemove={() => {\r\n\t\t\t\t\t\t\t\tselectedIdx = modelIdx;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ton:focus={() => {}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\"flex font-medium text-black dark:text-gray-100 line-clamp-1\">\r\n\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\tsrc={model?.info?.meta?.profile_image_url ?? '/static/favicon.png'}\r\n\t\t\t\t\t\t\t\t\talt={model?.name ?? model.id}\r\n\t\t\t\t\t\t\t\t\tclass=\"rounded-full size-6 items-center mr-2\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{model.name}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n","<script>\r\n\timport { createEventDispatcher } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport Prompts from './Commands/Prompts.svelte';\r\n\timport Documents from './Commands/Documents.svelte';\r\n\timport Models from './Commands/Models.svelte';\r\n\r\n\timport { removeLastWordFromString } from '$lib/utils';\r\n\timport { uploadWebToVectorDB, uploadYoutubeTranscriptionToVectorDB } from '$lib/apis/rag';\r\n\r\n\texport let prompt = '';\r\n\texport let files = [];\r\n\r\n\tlet commandElement = null;\r\n\r\n\texport const selectUp = () => {\r\n\t\tcommandElement?.selectUp();\r\n\t};\r\n\r\n\texport const selectDown = () => {\r\n\t\tcommandElement?.selectDown();\r\n\t};\r\n\r\n\tlet command = '';\r\n\t$: command = (prompt?.trim() ?? '').split(' ')?.at(-1) ?? '';\r\n\r\n\tconst uploadWeb = async (url) => {\r\n\t\tconsole.log(url);\r\n\r\n\t\tconst doc = {\r\n\t\t\ttype: 'doc',\r\n\t\t\tname: url,\r\n\t\t\tcollection_name: '',\r\n\t\t\tstatus: false,\r\n\t\t\turl: url,\r\n\t\t\terror: ''\r\n\t\t};\r\n\r\n\t\ttry {\r\n\t\t\tfiles = [...files, doc];\r\n\t\t\tconst res = await uploadWebToVectorDB(localStorage.token, '', url);\r\n\r\n\t\t\tif (res) {\r\n\t\t\t\tdoc.status = 'processed';\r\n\t\t\t\tdoc.collection_name = res.collection_name;\r\n\t\t\t\tfiles = files;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\t// Remove the failed doc from the files array\r\n\t\t\tfiles = files.filter((f) => f.name !== url);\r\n\t\t\ttoast.error(e);\r\n\t\t}\r\n\t};\r\n\r\n\tconst uploadYoutubeTranscription = async (url) => {\r\n\t\tconsole.log(url);\r\n\r\n\t\tconst doc = {\r\n\t\t\ttype: 'doc',\r\n\t\t\tname: url,\r\n\t\t\tcollection_name: '',\r\n\t\t\tstatus: false,\r\n\t\t\turl: url,\r\n\t\t\terror: ''\r\n\t\t};\r\n\r\n\t\ttry {\r\n\t\t\tfiles = [...files, doc];\r\n\t\t\tconst res = await uploadYoutubeTranscriptionToVectorDB(localStorage.token, url);\r\n\r\n\t\t\tif (res) {\r\n\t\t\t\tdoc.status = 'processed';\r\n\t\t\t\tdoc.collection_name = res.collection_name;\r\n\t\t\t\tfiles = files;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\t// Remove the failed doc from the files array\r\n\t\t\tfiles = files.filter((f) => f.name !== url);\r\n\t\t\ttoast.error(e);\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n{#if ['/', '#', '@'].includes(command?.charAt(0))}\r\n\t{#if command?.charAt(0) === '/'}\r\n\t\t<Prompts bind:this={commandElement} bind:prompt bind:files {command} />\r\n\t{:else if command?.charAt(0) === '#'}\r\n\t\t<Documents\r\n\t\t\tbind:this={commandElement}\r\n\t\t\tbind:prompt\r\n\t\t\t{command}\r\n\t\t\ton:youtube={(e) => {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t\tuploadYoutubeTranscription(e.detail);\r\n\t\t\t}}\r\n\t\t\ton:url={(e) => {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t\tuploadWeb(e.detail);\r\n\t\t\t}}\r\n\t\t\ton:select={(e) => {\r\n\t\t\t\tconsole.log(e);\r\n\t\t\t\tfiles = [\r\n\t\t\t\t\t...files,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\ttype: e?.detail?.type ?? 'file',\r\n\t\t\t\t\t\t...e.detail,\r\n\t\t\t\t\t\tstatus: 'processed'\r\n\t\t\t\t\t}\r\n\t\t\t\t];\r\n\r\n\t\t\t\tdispatch('select');\r\n\t\t\t}}\r\n\t\t/>\r\n\t{:else if command?.charAt(0) === '@'}\r\n\t\t<Models\r\n\t\t\tbind:this={commandElement}\r\n\t\t\t{command}\r\n\t\t\ton:select={(e) => {\r\n\t\t\t\tprompt = removeLastWordFromString(prompt, command);\r\n\r\n\t\t\t\tdispatch('select', {\r\n\t\t\t\t\ttype: 'model',\r\n\t\t\t\t\tdata: e.detail\r\n\t\t\t\t});\r\n\t\t\t}}\r\n\t\t/>\r\n\t{/if}\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { onMount, tick, getContext, createEventDispatcher } from 'svelte';\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport {\r\n\t\ttype Model,\r\n\t\tmobile,\r\n\t\tsettings,\r\n\t\tshowSidebar,\r\n\t\tmodels,\r\n\t\tconfig,\r\n\t\tshowCallOverlay,\r\n\t\ttools,\r\n\t\tuser as _user\r\n\t} from '$lib/stores';\r\n\timport { blobToFile, findWordIndices } from '$lib/utils';\r\n\r\n\timport { transcribeAudio } from '$lib/apis/audio';\r\n\timport { processDocToVectorDB } from '$lib/apis/rag';\r\n\timport { uploadFile } from '$lib/apis/files';\r\n\r\n\timport {\r\n\t\tSUPPORTED_FILE_TYPE,\r\n\t\tSUPPORTED_FILE_EXTENSIONS,\r\n\t\tWEBUI_BASE_URL,\r\n\t\tWEBUI_API_BASE_URL\r\n\t} from '$lib/constants';\r\n\r\n\timport Tooltip from '../common/Tooltip.svelte';\r\n\timport InputMenu from './MessageInput/InputMenu.svelte';\r\n\timport Headphone from '../icons/Headphone.svelte';\r\n\timport VoiceRecording from './MessageInput/VoiceRecording.svelte';\r\n\timport FileItem from '../common/FileItem.svelte';\r\n\timport FilesOverlay from './MessageInput/FilesOverlay.svelte';\r\n\timport Commands from './MessageInput/Commands.svelte';\r\n\timport XMark from '../icons/XMark.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let transparentBackground = false;\r\n\r\n\texport let submitPrompt: Function;\r\n\texport let createMessagePair: Function;\r\n\texport let stopResponse: Function;\r\n\r\n\texport let autoScroll = false;\r\n\r\n\texport let atSelectedModel: Model | undefined;\r\n\texport let selectedModels: [''];\r\n\r\n\tlet recording = false;\r\n\r\n\tlet chatTextAreaElement: HTMLTextAreaElement;\r\n\tlet filesInputElement;\r\n\r\n\tlet commandsElement;\r\n\r\n\tlet inputFiles;\r\n\tlet dragged = false;\r\n\r\n\tlet user = null;\r\n\tlet chatInputPlaceholder = '';\r\n\r\n\texport let history;\r\n\r\n\texport let prompt = '';\r\n\texport let files = [];\r\n\texport let availableToolIds = [];\r\n\texport let selectedToolIds = [];\r\n\texport let webSearchEnabled = false;\r\n\r\n\tlet visionCapableModels = [];\r\n\t$: visionCapableModels = [...(atSelectedModel ? [atSelectedModel] : selectedModels)].filter(\r\n\t\t(model) => $models.find((m) => m.id === model)?.info?.meta?.capabilities?.vision ?? true\r\n\t);\r\n\r\n\t$: if (prompt) {\r\n\t\tif (chatTextAreaElement) {\r\n\t\t\tchatTextAreaElement.style.height = '';\r\n\t\t\tchatTextAreaElement.style.height = Math.min(chatTextAreaElement.scrollHeight, 200) + 'px';\r\n\t\t}\r\n\t}\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tconst element = document.getElementById('messages-container');\r\n\t\telement.scrollTo({\r\n\t\t\ttop: element.scrollHeight,\r\n\t\t\tbehavior: 'smooth'\r\n\t\t});\r\n\t};\r\n\r\n\tconst uploadFileHandler = async (file) => {\r\n\t\tconsole.log(file);\r\n\r\n\t\tconst fileItem = {\r\n\t\t\ttype: 'file',\r\n\t\t\tfile: '',\r\n\t\t\tid: null,\r\n\t\t\turl: '',\r\n\t\t\tname: file.name,\r\n\t\t\tcollection_name: '',\r\n\t\t\tstatus: '',\r\n\t\t\tsize: file.size,\r\n\t\t\terror: ''\r\n\t\t};\r\n\t\tfiles = [...files, fileItem];\r\n\r\n\t\t// Check if the file is an audio file and transcribe/convert it to text file\r\n\t\tif (['audio/mpeg', 'audio/wav', 'audio/ogg', 'audio/x-m4a'].includes(file['type'])) {\r\n\t\t\tconst res = await transcribeAudio(localStorage.token, file).catch((error) => {\r\n\t\t\t\ttoast.error(error);\r\n\t\t\t\treturn null;\r\n\t\t\t});\r\n\r\n\t\t\tif (res) {\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tconst blob = new Blob([res.text], { type: 'text/plain' });\r\n\t\t\t\tfile = blobToFile(blob, `${file.name}.txt`);\r\n\r\n\t\t\t\tfileItem.name = file.name;\r\n\t\t\t\tfileItem.size = file.size;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst uploadedFile = await uploadFile(localStorage.token, file);\r\n\r\n\t\t\tif (uploadedFile) {\r\n\t\t\t\tfileItem.status = 'uploaded';\r\n\t\t\t\tfileItem.file = uploadedFile;\r\n\t\t\t\tfileItem.id = uploadedFile.id;\r\n\t\t\t\tfileItem.url = `${WEBUI_API_BASE_URL}/files/${uploadedFile.id}`;\r\n\r\n\t\t\t\t// TODO: Check if tools & functions have files support to skip this step to delegate file processing\r\n\t\t\t\t// Default Upload to VectorDB\r\n\t\t\t\tif (\r\n\t\t\t\t\tSUPPORTED_FILE_TYPE.includes(file['type']) ||\r\n\t\t\t\t\tSUPPORTED_FILE_EXTENSIONS.includes(file.name.split('.').at(-1))\r\n\t\t\t\t) {\r\n\t\t\t\t\tprocessFileItem(fileItem);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\t$i18n.t(`Unknown file type '{{file_type}}'. Proceeding with the file upload anyway.`, {\r\n\t\t\t\t\t\t\tfile_type: file['type']\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t\tprocessFileItem(fileItem);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfiles = files.filter((item) => item.status !== null);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\ttoast.error(e);\r\n\t\t\tfiles = files.filter((item) => item.status !== null);\r\n\t\t}\r\n\t};\r\n\r\n\tconst processFileItem = async (fileItem) => {\r\n\t\ttry {\r\n\t\t\tconst res = await processDocToVectorDB(localStorage.token, fileItem.id);\r\n\r\n\t\t\tif (res) {\r\n\t\t\t\tfileItem.status = 'processed';\r\n\t\t\t\tfileItem.collection_name = res.collection_name;\r\n\t\t\t\tfiles = files;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\t// Remove the failed doc from the files array\r\n\t\t\t// files = files.filter((f) => f.id !== fileItem.id);\r\n\t\t\ttoast.error(e);\r\n\t\t\tfileItem.status = 'processed';\r\n\t\t\tfiles = files;\r\n\t\t}\r\n\t};\r\n\r\n\tconst inputFilesHandler = async (inputFiles) => {\r\n\t\tinputFiles.forEach((file) => {\r\n\t\t\tconsole.log(file, file.name.split('.').at(-1));\r\n\r\n\t\t\tif (\r\n\t\t\t\t($config?.file?.max_size ?? null) !== null &&\r\n\t\t\t\tfile.size > ($config?.file?.max_size ?? 0) * 1024 * 1024\r\n\t\t\t) {\r\n\t\t\t\ttoast.error(\r\n\t\t\t\t\t$i18n.t(`File size should not exceed {{maxSize}} MB.`, {\r\n\t\t\t\t\t\tmaxSize: $config?.file?.max_size\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (['image/gif', 'image/webp', 'image/jpeg', 'image/png'].includes(file['type'])) {\r\n\t\t\t\tif (visionCapableModels.length === 0) {\r\n\t\t\t\t\ttoast.error($i18n.t('Selected model(s) do not support image inputs'));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet reader = new FileReader();\r\n\t\t\t\treader.onload = (event) => {\r\n\t\t\t\t\tfiles = [\r\n\t\t\t\t\t\t...files,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype: 'image',\r\n\t\t\t\t\t\t\turl: `${event.target.result}`\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t];\r\n\t\t\t\t};\r\n\t\t\t\treader.readAsDataURL(file);\r\n\t\t\t} else {\r\n\t\t\t\tuploadFileHandler(file);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\twindow.setTimeout(() => chatTextAreaElement?.focus(), 0);\r\n\r\n\t\tconst dropZone = document.querySelector('body');\r\n\r\n\t\tconst handleKeyDown = (event: KeyboardEvent) => {\r\n\t\t\tif (event.key === 'Escape') {\r\n\t\t\t\tconsole.log('Escape');\r\n\t\t\t\tdragged = false;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst onDragOver = (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tdragged = true;\r\n\t\t};\r\n\r\n\t\tconst onDragLeave = () => {\r\n\t\t\tdragged = false;\r\n\t\t};\r\n\r\n\t\tconst onDrop = async (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tconsole.log(e);\r\n\r\n\t\t\tif (e.dataTransfer?.files) {\r\n\t\t\t\tconst inputFiles = Array.from(e.dataTransfer?.files);\r\n\t\t\t\tif (inputFiles && inputFiles.length > 0) {\r\n\t\t\t\t\tconsole.log(inputFiles);\r\n\t\t\t\t\tinputFilesHandler(inputFiles);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoast.error($i18n.t(`File not found.`));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tdragged = false;\r\n\t\t};\r\n\r\n\t\twindow.addEventListener('keydown', handleKeyDown);\r\n\r\n\t\tdropZone?.addEventListener('dragover', onDragOver);\r\n\t\tdropZone?.addEventListener('drop', onDrop);\r\n\t\tdropZone?.addEventListener('dragleave', onDragLeave);\r\n\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('keydown', handleKeyDown);\r\n\r\n\t\t\tdropZone?.removeEventListener('dragover', onDragOver);\r\n\t\t\tdropZone?.removeEventListener('drop', onDrop);\r\n\t\t\tdropZone?.removeEventListener('dragleave', onDragLeave);\r\n\t\t};\r\n\t});\r\n</script>\r\n\r\n<FilesOverlay show={dragged} />\r\n\r\n<div class=\"w-full font-primary\">\r\n\t<div class=\" -mb-0.5 mx-auto inset-x-0 bg-transparent flex justify-center\">\r\n\t\t<div class=\"flex flex-col max-w-6xl px-2.5 md:px-6 w-full\">\r\n\t\t\t<div class=\"relative\">\r\n\t\t\t\t{#if autoScroll === false && history?.currentId}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" absolute -top-12 left-0 right-0 flex justify-center z-30 pointer-events-none\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\" bg-white border border-gray-100 dark:border-none dark:bg-white/20 p-1.5 rounded-full pointer-events-auto\"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tautoScroll = true;\r\n\t\t\t\t\t\t\t\tscrollToBottom();\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\td=\"M10 3a.75.75 0 01.75.75v10.638l3.96-4.158a.75.75 0 111.08 1.04l-5.25 5.5a.75.75 0 01-1.08 0l-5.25-5.5a.75.75 0 111.08-1.04l3.96 4.158V3.75A.75.75 0 0110 3z\"\r\n\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"w-full relative\">\r\n\t\t\t\t{#if atSelectedModel !== undefined}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"px-3 py-2.5 text-left w-full flex justify-between items-center absolute bottom-0.5 left-0 right-0 bg-gradient-to-t from-50% from-white dark:from-gray-900 z-10\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\"flex items-center gap-2 text-sm dark:text-gray-500\">\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tcrossorigin=\"anonymous\"\r\n\t\t\t\t\t\t\t\talt=\"model profile\"\r\n\t\t\t\t\t\t\t\tclass=\"size-5 max-w-[28px] object-cover rounded-full\"\r\n\t\t\t\t\t\t\t\tsrc={$models.find((model) => model.id === atSelectedModel.id)?.info?.meta\r\n\t\t\t\t\t\t\t\t\t?.profile_image_url ??\r\n\t\t\t\t\t\t\t\t\t($i18n.language === 'dg-DG'\r\n\t\t\t\t\t\t\t\t\t\t? `/doge.png`\r\n\t\t\t\t\t\t\t\t\t\t: `${WEBUI_BASE_URL}/static/favicon.png`)}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\tTalking to <span class=\" font-medium\">{atSelectedModel.name}</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclass=\"flex items-center\"\r\n\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\tatSelectedModel = undefined;\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<XMark />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<Commands\r\n\t\t\t\t\tbind:this={commandsElement}\r\n\t\t\t\t\tbind:prompt\r\n\t\t\t\t\tbind:files\r\n\t\t\t\t\ton:select={(e) => {\r\n\t\t\t\t\t\tconst data = e.detail;\r\n\r\n\t\t\t\t\t\tif (data?.type === 'model') {\r\n\t\t\t\t\t\t\tatSelectedModel = data.data;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tchatTextAreaElement?.focus();\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n\r\n\t<div class=\"{transparentBackground ? 'bg-transparent' : 'bg-white dark:bg-gray-900'} \">\r\n\t\t<div class=\"max-w-6xl px-2.5 md:px-6 mx-auto inset-x-0 pb-safe-bottom\">\r\n\t\t\t<div class=\" pb-2\">\r\n\t\t\t\t<input\r\n\t\t\t\t\tbind:this={filesInputElement}\r\n\t\t\t\t\tbind:files={inputFiles}\r\n\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\thidden\r\n\t\t\t\t\tmultiple\r\n\t\t\t\t\ton:change={async () => {\r\n\t\t\t\t\t\tif (inputFiles && inputFiles.length > 0) {\r\n\t\t\t\t\t\t\tconst _inputFiles = Array.from(inputFiles);\r\n\t\t\t\t\t\t\tinputFilesHandler(_inputFiles);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttoast.error($i18n.t(`File not found.`));\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tfilesInputElement.value = '';\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{#if recording}\r\n\t\t\t\t\t<VoiceRecording\r\n\t\t\t\t\t\tbind:recording\r\n\t\t\t\t\t\ton:cancel={async () => {\r\n\t\t\t\t\t\t\trecording = false;\r\n\r\n\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\tdocument.getElementById('chat-textarea')?.focus();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\ton:confirm={async (e) => {\r\n\t\t\t\t\t\t\tconst response = e.detail;\r\n\t\t\t\t\t\t\tprompt = `${prompt}${response} `;\r\n\r\n\t\t\t\t\t\t\trecording = false;\r\n\r\n\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\tdocument.getElementById('chat-textarea')?.focus();\r\n\r\n\t\t\t\t\t\t\tif ($settings?.speechAutoSend ?? false) {\r\n\t\t\t\t\t\t\t\tsubmitPrompt(prompt);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<form\r\n\t\t\t\t\t\tclass=\"w-full flex gap-1.5\"\r\n\t\t\t\t\t\ton:submit|preventDefault={() => {\r\n\t\t\t\t\t\t\t// check if selectedModels support image input\r\n\t\t\t\t\t\t\tsubmitPrompt(prompt);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"flex-1 flex flex-col relative w-full rounded-3xl px-1.5 bg-gray-50 dark:bg-gray-850 dark:text-gray-100\"\r\n\t\t\t\t\t\t\tdir={$settings?.chatDirection ?? 'LTR'}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{#if files.length > 0}\r\n\t\t\t\t\t\t\t\t<div class=\"mx-1 mt-2.5 mb-1 flex flex-wrap gap-2\">\r\n\t\t\t\t\t\t\t\t\t{#each files as file, fileIdx}\r\n\t\t\t\t\t\t\t\t\t\t{#if file.type === 'image'}\r\n\t\t\t\t\t\t\t\t\t\t\t<div class=\" relative group\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={file.url}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt=\"input\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" h-16 w-16 rounded-xl object-cover\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{#if atSelectedModel ? visionCapableModels.length === 0 : selectedModels.length !== visionCapableModels.length}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Tooltip\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\" absolute top-1 left-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent={$i18n.t('{{ models }}', {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmodels: [...(atSelectedModel ? [atSelectedModel] : selectedModels)]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.filter((id) => !visionCapableModels.includes(id))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.join(', ')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-4 fill-yellow-300\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div class=\" absolute -top-1 -right-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\" bg-gray-400 text-white border border-white rounded-full group-hover:visible invisible transition\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t\t\t<FileItem\r\n\t\t\t\t\t\t\t\t\t\t\t\tname={file.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype={file.type}\r\n\t\t\t\t\t\t\t\t\t\t\t\tsize={file?.size}\r\n\t\t\t\t\t\t\t\t\t\t\t\tstatus={file.status}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdismissible={true}\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:dismiss={() => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfiles.splice(fileIdx, 1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = files;\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t<div class=\" flex\">\r\n\t\t\t\t\t\t\t\t<div class=\" ml-0.5 self-end mb-1.5 flex space-x-1\">\r\n\t\t\t\t\t\t\t\t\t<InputMenu\r\n\t\t\t\t\t\t\t\t\t\tbind:webSearchEnabled\r\n\t\t\t\t\t\t\t\t\t\tbind:selectedToolIds\r\n\t\t\t\t\t\t\t\t\t\ttools={$tools.reduce((a, e, i, arr) => {\r\n\t\t\t\t\t\t\t\t\t\t\tif (availableToolIds.includes(e.id) || ($_user?.role ?? 'user') === 'admin') {\r\n\t\t\t\t\t\t\t\t\t\t\t\ta[e.id] = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tname: e.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdescription: e.meta.description,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tenabled: false\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn a;\r\n\t\t\t\t\t\t\t\t\t\t}, {})}\r\n\t\t\t\t\t\t\t\t\t\tuploadFilesHandler={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tfilesInputElement.click();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tonClose={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\t\t\t\tchatTextAreaElement?.focus();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"bg-gray-50 hover:bg-gray-100 text-gray-800 dark:bg-gray-850 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-2 outline-none focus:outline-none\"\r\n\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"More\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M8.75 3.75a.75.75 0 0 0-1.5 0v3.5h-3.5a.75.75 0 0 0 0 1.5h3.5v3.5a.75.75 0 0 0 1.5 0v-3.5h3.5a.75.75 0 0 0 0-1.5h-3.5v-3.5Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</InputMenu>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\tid=\"chat-textarea\"\r\n\t\t\t\t\t\t\t\t\tbind:this={chatTextAreaElement}\r\n\t\t\t\t\t\t\t\t\tclass=\"scrollbar-hidden bg-gray-50 dark:bg-gray-850 dark:text-gray-100 outline-none w-full py-3 px-1 rounded-xl resize-none h-[48px]\"\r\n\t\t\t\t\t\t\t\t\tplaceholder={chatInputPlaceholder !== ''\r\n\t\t\t\t\t\t\t\t\t\t? chatInputPlaceholder\r\n\t\t\t\t\t\t\t\t\t\t: $i18n.t('Send a Message')}\r\n\t\t\t\t\t\t\t\t\tbind:value={prompt}\r\n\t\t\t\t\t\t\t\t\ton:keypress={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t!$mobile ||\r\n\t\t\t\t\t\t\t\t\t\t\t!(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'ontouchstart' in window ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tnavigator.maxTouchPoints > 0 ||\r\n\t\t\t\t\t\t\t\t\t\t\t\tnavigator.msMaxTouchPoints > 0\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\t// Prevent Enter key from creating a new line\r\n\t\t\t\t\t\t\t\t\t\t\tif (e.key === 'Enter' && !e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t// Submit the prompt when Enter key is pressed\r\n\t\t\t\t\t\t\t\t\t\t\tif (prompt !== '' && e.key === 'Enter' && !e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tsubmitPrompt(prompt);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ton:keydown={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\tconst isCtrlPressed = e.ctrlKey || e.metaKey; // metaKey is for Cmd key on Mac\r\n\t\t\t\t\t\t\t\t\t\tconst commandsContainerElement = document.getElementById('commands-container');\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Command/Ctrl + Shift + Enter to submit a message pair\r\n\t\t\t\t\t\t\t\t\t\tif (isCtrlPressed && e.key === 'Enter' && e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tcreateMessagePair(prompt);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Check if Ctrl + R is pressed\r\n\t\t\t\t\t\t\t\t\t\tif (prompt === '' && isCtrlPressed && e.key.toLowerCase() === 'r') {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('regenerate');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst regenerateButton = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('regenerate-response-button')\r\n\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tregenerateButton?.click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (prompt === '' && e.key == 'ArrowUp') {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst userMessageElement = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('user-message')\r\n\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst editButton = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('edit-user-message-button')\r\n\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(userMessageElement);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tuserMessageElement.scrollIntoView({ block: 'center' });\r\n\t\t\t\t\t\t\t\t\t\t\teditButton?.click();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowUp') {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectUp();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\r\n\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\r\n\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'ArrowDown') {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\tcommandsElement.selectDown();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\r\n\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\r\n\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton.scrollIntoView({ block: 'center' });\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Enter') {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\r\n\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (e.shiftKey) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tprompt = `${prompt}\\n`;\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (commandOptionButton) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\tdocument.getElementById('send-message-button')?.click();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (commandsContainerElement && e.key === 'Tab') {\r\n\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tconst commandOptionButton = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t...document.getElementsByClassName('selected-command-option-button')\r\n\t\t\t\t\t\t\t\t\t\t\t]?.at(-1);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tcommandOptionButton?.click();\r\n\t\t\t\t\t\t\t\t\t\t} else if (e.key === 'Tab') {\r\n\t\t\t\t\t\t\t\t\t\t\tconst words = findWordIndices(prompt);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (words.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst word = words.at(0);\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst fullPrompt = prompt;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\tprompt = prompt.substring(0, word?.endIndex + 1);\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait tick();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\te.target.scrollTop = e.target.scrollHeight;\r\n\t\t\t\t\t\t\t\t\t\t\t\tprompt = fullPrompt;\r\n\t\t\t\t\t\t\t\t\t\t\t\tawait tick();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\te.target.setSelectionRange(word?.startIndex, word.endIndex + 1);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\r\n\t\t\t\t\t\t\t\t\t\t\te.target.style.height = Math.min(e.target.scrollHeight, 200) + 'px';\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('Escape');\r\n\t\t\t\t\t\t\t\t\t\t\tatSelectedModel = undefined;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\trows=\"1\"\r\n\t\t\t\t\t\t\t\t\ton:input={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = Math.min(e.target.scrollHeight, 200) + 'px';\r\n\t\t\t\t\t\t\t\t\t\tuser = null;\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ton:focus={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = '';\r\n\t\t\t\t\t\t\t\t\t\te.target.style.height = Math.min(e.target.scrollHeight, 200) + 'px';\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\ton:paste={async (e) => {\r\n\t\t\t\t\t\t\t\t\t\tconst clipboardData = e.clipboardData || window.clipboardData;\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (clipboardData && clipboardData.items) {\r\n\t\t\t\t\t\t\t\t\t\t\tfor (const item of clipboardData.items) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (item.type.indexOf('image') !== -1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst blob = item.getAsFile();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst reader = new FileReader();\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treader.onload = function (e) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfiles = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...files,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'image',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\turl: `${e.target.result}`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treader.readAsDataURL(blob);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t\t\t<div class=\"self-end mb-2 flex space-x-1 mr-1\">\r\n\t\t\t\t\t\t\t\t\t{#if !history?.currentId || history.messages[history.currentId]?.done == true}\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Record voice')}>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"voice-input-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-1.5 mr-0.5 self-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet stream = await navigator.mediaDevices\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.getUserMedia({ audio: true })\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.catch(function (err) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`Permission denied when accessing microphone: {{error}}`,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\terror: err\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (stream) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trecording = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst tracks = stream.getTracks();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttracks.forEach((track) => track.stop());\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstream = null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} catch {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Permission denied when accessing microphone'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Voice Input\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"w-5 h-5 translate-y-[0.5px]\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path d=\"M7 4a3 3 0 016 0v6a3 3 0 11-6 0V4z\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M5.5 9.643a.75.75 0 00-1.5 0V10c0 3.06 2.29 5.585 5.25 5.954V17.5h-1.5a.75.75 0 000 1.5h4.5a.75.75 0 000-1.5h-1.5v-1.546A6.001 6.001 0 0016 10v-.357a.75.75 0 00-1.5 0V10a4.5 4.5 0 01-9 0v-.357z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class=\"flex items-end w-10\">\r\n\t\t\t\t\t\t\t{#if !history.currentId || history.messages[history.currentId]?.done == true}\r\n\t\t\t\t\t\t\t\t{#if prompt === ''}\r\n\t\t\t\t\t\t\t\t\t<div class=\" flex items-center mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Call')}>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\" text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-850 transition rounded-full p-2 self-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (selectedModels.length > 1) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Select only one model to call'));\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ($config.audio.stt.engine === 'web') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$i18n.t('Call feature is not supported when using Web STT engine')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// check if user has access to getUserMedia\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlet stream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// If the user grants the permission, proceed to show the call overlay\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (stream) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst tracks = stream.getTracks();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttracks.forEach((track) => track.stop());\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstream = null;\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowCallOverlay.set(true);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdispatch('call');\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// If the user denies the permission or an error occurs, show an error message\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttoast.error($i18n.t('Permission denied when accessing media devices'));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Call\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Headphone className=\"size-6\" />\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t\t<div class=\" flex items-center mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t<Tooltip content={$i18n.t('Send message')}>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"send-message-button\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"{prompt !== ''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? 'bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 '\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: 'text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled'} transition rounded-full p-1.5 m-0.5 self-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tdisabled={prompt === ''}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclass=\"size-6\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t\t<div class=\" flex items-center mb-1.5\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclass=\"bg-white hover:bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-800 transition rounded-full p-1.5\"\r\n\t\t\t\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\t\t\t\tstopResponse();\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\tclass=\"size-6\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t\td=\"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm6-2.438c0-.724.588-1.312 1.313-1.312h4.874c.725 0 1.313.588 1.313 1.313v4.874c0 .725-.588 1.313-1.313 1.313H9.564a1.312 1.312 0 01-1.313-1.313V9.564z\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"mt-1.5 text-xs text-gray-500 text-center line-clamp-1\">\r\n\t\t\t\t\t{$i18n.t('LLMs can make mistakes. Verify important information.')}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<style>\r\n\t.scrollbar-hidden:active::-webkit-scrollbar-thumb,\r\n\t.scrollbar-hidden:focus::-webkit-scrollbar-thumb,\r\n\t.scrollbar-hidden:hover::-webkit-scrollbar-thumb {\r\n\t\tvisibility: visible;\r\n\t}\r\n\t.scrollbar-hidden::-webkit-scrollbar-thumb {\r\n\t\tvisibility: hidden;\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\timport { models, showSettings, settings, user, mobile, config } from '$lib/stores';\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport Selector from './ModelSelector/Selector.svelte';\r\n\timport Tooltip from '../common/Tooltip.svelte';\r\n\r\n\timport { setDefaultModels } from '$lib/apis/configs';\r\n\timport { updateUserSettings } from '$lib/apis/users';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let selectedModels = [''];\r\n\texport let disabled = false;\r\n\r\n\texport let showSetDefault = true;\r\n\r\n\tconst saveDefaultModel = async () => {\r\n\t\tconst hasEmptyModel = selectedModels.filter((it) => it === '');\r\n\t\tif (hasEmptyModel.length) {\r\n\t\t\ttoast.error($i18n.t('Choose a model before saving...'));\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tsettings.set({ ...$settings, models: selectedModels });\r\n\t\tawait updateUserSettings(localStorage.token, { ui: $settings });\r\n\r\n\t\ttoast.success($i18n.t('Default model updated'));\r\n\t};\r\n\r\n\t$: if (selectedModels.length > 0 && $models.length > 0) {\r\n\t\tselectedModels = selectedModels.map((model) =>\r\n\t\t\t$models.map((m) => m.id).includes(model) ? model : ''\r\n\t\t);\r\n\t}\r\n</script>\r\n\r\n<div class=\"flex flex-col w-full items-start\">\r\n\t{#each selectedModels as selectedModel, selectedModelIdx}\r\n\t\t<div class=\"flex w-full max-w-fit\">\r\n\t\t\t<div class=\"overflow-hidden w-full\">\r\n\t\t\t\t<div class=\"mr-1 max-w-full\">\r\n\t\t\t\t\t<Selector\r\n\t\t\t\t\t\tplaceholder={$i18n.t('Select a model')}\r\n\t\t\t\t\t\titems={$models.map((model) => ({\r\n\t\t\t\t\t\t\tvalue: model.id,\r\n\t\t\t\t\t\t\tlabel: model.name,\r\n\t\t\t\t\t\t\tmodel: model\r\n\t\t\t\t\t\t}))}\r\n\t\t\t\t\t\tshowTemporaryChatControl={$user.role === 'user'\r\n\t\t\t\t\t\t\t? ($config?.permissions?.chat?.temporary ?? true)\r\n\t\t\t\t\t\t\t: true}\r\n\t\t\t\t\t\tbind:value={selectedModel}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#if selectedModelIdx === 0}\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"  self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tooltip content={$i18n.t('Add Model')}>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\" \"\r\n\t\t\t\t\t\t\t{disabled}\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tselectedModels = [...selectedModels, ''];\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\taria-label=\"Add Model\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\r\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"size-3.5\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 6v12m6-6H6\" />\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</div>\r\n\t\t\t{:else}\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\"  self-center mx-1 disabled:text-gray-600 disabled:hover:text-gray-600 -translate-y-[0.5px]\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Tooltip content={$i18n.t('Remove Model')}>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t{disabled}\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tselectedModels.splice(selectedModelIdx, 1);\r\n\t\t\t\t\t\t\t\tselectedModels = selectedModels;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\taria-label=\"Remove Model\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\tstroke-width=\"2\"\r\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"size-3\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19.5 12h-15\" />\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\t{/each}\r\n</div>\r\n\r\n{#if showSetDefault}\r\n\t<div class=\" absolute text-left mt-[1px] ml-1 text-[0.7rem] text-gray-500 font-primary\">\r\n\t\t<button on:click={saveDefaultModel}> {$i18n.t('Set as default')}</button>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n\texport let strokeWidth = '2';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 0 0-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n\texport let strokeWidth = '2';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke=\"currentColor\"\r\n\tfill=\"currentColor\"\r\n\tclass={className}\r\n\tstroke-width={strokeWidth}\r\n>\r\n\t<path\r\n\t\td=\"M18.75 12.75h1.5a.75.75 0 0 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM12 6a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 6ZM12 18a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 12 18ZM3.75 6.75h1.5a.75.75 0 1 0 0-1.5h-1.5a.75.75 0 0 0 0 1.5ZM5.25 18.75h-1.5a.75.75 0 0 1 0-1.5h1.5a.75.75 0 0 1 0 1.5ZM3 12a.75.75 0 0 1 .75-.75h7.5a.75.75 0 0 1 0 1.5h-7.5A.75.75 0 0 1 3 12ZM9 3.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5ZM12.75 12a2.25 2.25 0 1 1 4.5 0 2.25 2.25 0 0 1-4.5 0ZM9 15.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport { getContext } from 'svelte';\r\n\r\n\timport fileSaver from 'file-saver';\r\n\tconst { saveAs } = fileSaver;\r\n\r\n\timport { downloadChatAsPDF } from '$lib/apis/utils';\r\n\timport { copyToClipboard, createMessagesList } from '$lib/utils';\r\n\r\n\timport { showOverview, showControls, mobile } from '$lib/stores';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\r\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\r\n\timport Tags from '$lib/components/chat/Tags.svelte';\r\n\timport Map from '$lib/components/icons/Map.svelte';\r\n\timport { get } from 'svelte/store';\r\n\timport Clipboard from '$lib/components/icons/Clipboard.svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport AdjustmentsHorizontal from '$lib/components/icons/AdjustmentsHorizontal.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let shareEnabled: boolean = false;\r\n\texport let shareHandler: Function;\r\n\texport let downloadHandler: Function;\r\n\r\n\t// export let tagHandler: Function;\r\n\r\n\texport let chat;\r\n\texport let onClose: Function = () => {};\r\n\r\n\tconst getChatAsText = async () => {\r\n\t\tconst _chat = chat.chat;\r\n\r\n\t\tconst messages = createMessagesList(_chat.history, _chat.history.currentId);\r\n\t\tconst chatText = messages.reduce((a, message, i, arr) => {\r\n\t\t\treturn `${a}### ${message.role.toUpperCase()}\\n${message.content}\\n\\n`;\r\n\t\t}, '');\r\n\r\n\t\treturn chatText.trim();\r\n\t};\r\n\r\n\tconst downloadTxt = async () => {\r\n\t\tconst chatText = await getChatAsText();\r\n\r\n\t\tlet blob = new Blob([chatText], {\r\n\t\t\ttype: 'text/plain'\r\n\t\t});\r\n\r\n\t\tsaveAs(blob, `chat-${chat.chat.title}.txt`);\r\n\t};\r\n\r\n\tconst downloadPdf = async () => {\r\n\t\tconst _chat = chat.chat;\r\n\t\tconst messages = createMessagesList(_chat.history, _chat.history.currentId);\r\n\r\n\t\tconsole.log('download', chat);\r\n\r\n\t\tconst blob = await downloadChatAsPDF(_chat.title, messages);\r\n\r\n\t\t// Create a URL for the blob\r\n\t\tconst url = window.URL.createObjectURL(blob);\r\n\r\n\t\t// Create a link element to trigger the download\r\n\t\tconst a = document.createElement('a');\r\n\t\ta.href = url;\r\n\t\ta.download = `chat-${_chat.title}.pdf`;\r\n\r\n\t\t// Append the link to the body and click it programmatically\r\n\t\tdocument.body.appendChild(a);\r\n\t\ta.click();\r\n\r\n\t\t// Remove the link from the body\r\n\t\tdocument.body.removeChild(a);\r\n\r\n\t\t// Revoke the URL to release memory\r\n\t\twindow.URL.revokeObjectURL(url);\r\n\t};\r\n\r\n\tconst downloadJSONExport = async () => {\r\n\t\tlet blob = new Blob([JSON.stringify([chat])], {\r\n\t\t\ttype: 'application/json'\r\n\t\t});\r\n\t\tsaveAs(blob, `chat-export-${Date.now()}.json`);\r\n\t};\r\n</script>\r\n\r\n<Dropdown\r\n\ton:change={(e) => {\r\n\t\tif (e.detail === false) {\r\n\t\t\tonClose();\r\n\t\t}\r\n\t}}\r\n>\r\n\t<slot />\r\n\r\n\t<div slot=\"content\">\r\n\t\t<DropdownMenu.Content\r\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\r\n\t\t\tsideOffset={8}\r\n\t\t\tside=\"bottom\"\r\n\t\t\talign=\"end\"\r\n\t\t\ttransition={flyAndScale}\r\n\t\t>\r\n\t\t\t<!-- <DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\ton:click={async () => {\r\n\t\t\t\t\tawait showSettings.set(!$showSettings);\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\td=\"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\td=\"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</svg>\r\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Settings')}</div>\r\n\t\t\t</DropdownMenu.Item> -->\r\n\r\n\t\t\t{#if $mobile}\r\n\t\t\t\t<DropdownMenu.Item\r\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\t\tid=\"chat-controls-button\"\r\n\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\tawait showControls.set(true);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<AdjustmentsHorizontal className=\" size-4\" strokeWidth=\"0.5\" />\r\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Controls')}</div>\r\n\t\t\t\t</DropdownMenu.Item>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\tid=\"chat-overview-button\"\r\n\t\t\t\ton:click={async () => {\r\n\t\t\t\t\tawait showControls.set(true);\r\n\t\t\t\t\tawait showOverview.set(true);\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Map className=\" size-4\" strokeWidth=\"1.5\" />\r\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Overview')}</div>\r\n\t\t\t</DropdownMenu.Item>\r\n\r\n\t\t\t<DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\tid=\"chat-copy-button\"\r\n\t\t\t\ton:click={async () => {\r\n\t\t\t\t\tconst res = await copyToClipboard(await getChatAsText()).catch((e) => {\r\n\t\t\t\t\t\tconsole.error(e);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\ttoast.success($i18n.t('Copied to clipboard'));\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Clipboard className=\" size-4\" strokeWidth=\"1.5\" />\r\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Copy')}</div>\r\n\t\t\t</DropdownMenu.Item>\r\n\r\n\t\t\t<DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\tid=\"chat-share-button\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tshareHandler();\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\td=\"M15.75 4.5a3 3 0 1 1 .825 2.066l-8.421 4.679a3.002 3.002 0 0 1 0 1.51l8.421 4.679a3 3 0 1 1-.729 1.31l-8.421-4.678a3 3 0 1 1 0-4.132l8.421-4.679a3 3 0 0 1-.096-.755Z\"\r\n\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</svg>\r\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Share')}</div>\r\n\t\t\t</DropdownMenu.Item>\r\n\r\n\t\t\t<DropdownMenu.Sub>\r\n\t\t\t\t<DropdownMenu.SubTrigger\r\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\tclass=\"size-4\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\td=\"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\r\n\t\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Download')}</div>\r\n\t\t\t\t</DropdownMenu.SubTrigger>\r\n\t\t\t\t<DropdownMenu.SubContent\r\n\t\t\t\t\tclass=\"w-full rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\r\n\t\t\t\t\ttransition={flyAndScale}\r\n\t\t\t\t\tsideOffset={8}\r\n\t\t\t\t>\r\n\t\t\t\t\t<DropdownMenu.Item\r\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tdownloadJSONExport();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Export chat (.json)')}</div>\r\n\t\t\t\t\t</DropdownMenu.Item>\r\n\t\t\t\t\t<DropdownMenu.Item\r\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tdownloadTxt();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('Plain text (.txt)')}</div>\r\n\t\t\t\t\t</DropdownMenu.Item>\r\n\r\n\t\t\t\t\t<DropdownMenu.Item\r\n\t\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tdownloadPdf();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\"flex items-center line-clamp-1\">{$i18n.t('PDF document (.pdf)')}</div>\r\n\t\t\t\t\t</DropdownMenu.Item>\r\n\t\t\t\t</DropdownMenu.SubContent>\r\n\t\t\t</DropdownMenu.Sub>\r\n\r\n\t\t\t<hr class=\"border-gray-100 dark:border-gray-800 mt-2.5 mb-1.5\" />\r\n\r\n\t\t\t<div class=\"flex p-1\">\r\n\t\t\t\t<Tags chatId={chat.id} />\r\n\t\t\t</div>\r\n\t\t</DropdownMenu.Content>\r\n\t</div>\r\n</Dropdown>\r\n","<script lang=\"ts\">\r\n\timport { getContext } from 'svelte';\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport {\r\n\t\tWEBUI_NAME,\r\n\t\tchatId,\r\n\t\tmobile,\r\n\t\tsettings,\r\n\t\tshowArchivedChats,\r\n\t\tshowControls,\r\n\t\tshowSidebar,\r\n\t\tuser\r\n\t} from '$lib/stores';\r\n\r\n\timport { slide } from 'svelte/transition';\r\n\timport ShareChatModal from '../chat/ShareChatModal.svelte';\r\n\timport ModelSelector from '../chat/ModelSelector.svelte';\r\n\timport Tooltip from '../common/Tooltip.svelte';\r\n\timport Menu from './Navbar/Menu.svelte';\r\n\timport { page } from '$app/stores';\r\n\timport UserMenu from './Sidebar/UserMenu.svelte';\r\n\timport MenuLines from '../icons/MenuLines.svelte';\r\n\timport AdjustmentsHorizontal from '../icons/AdjustmentsHorizontal.svelte';\r\n\timport Map from '../icons/Map.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let initNewChat: Function;\r\n\texport let title: string = $WEBUI_NAME;\r\n\texport let shareEnabled: boolean = false;\r\n\r\n\texport let chat;\r\n\texport let selectedModels;\r\n\texport let showModelSelector = true;\r\n\r\n\tlet showShareChatModal = false;\r\n\tlet showDownloadChatModal = false;\r\n</script>\r\n\r\n<ShareChatModal bind:show={showShareChatModal} chatId={$chatId} />\r\n<nav id=\"nav\" class=\" sticky py-2.5 top-0 flex flex-row justify-center z-10\">\r\n\t<div class=\" flex max-w-full w-full mx-auto px-5 pt-0.5 md:px-[1rem]\">\r\n\t\t<div class=\"flex items-center w-full max-w-full\">\r\n\t\t\t<div\r\n\t\t\t\tclass=\"{$showSidebar\r\n\t\t\t\t\t? 'md:hidden'\r\n\t\t\t\t\t: ''} mr-3 self-start flex flex-none items-center text-gray-600 dark:text-gray-400\"\r\n\t\t\t>\r\n\t\t\t\t<button\r\n\t\t\t\t\tid=\"sidebar-toggle-button\"\r\n\t\t\t\t\tclass=\"cursor-pointer px-2 py-2 flex rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tshowSidebar.set(!$showSidebar);\r\n\t\t\t\t\t}}\r\n\t\t\t\t\taria-label=\"Toggle Sidebar\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\" m-auto self-center\">\r\n\t\t\t\t\t\t<MenuLines />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"flex-1 overflow-hidden max-w-full\">\r\n\t\t\t\t{#if showModelSelector}\r\n\t\t\t\t\t<ModelSelector bind:selectedModels showSetDefault={!shareEnabled} />\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"self-start flex flex-none items-center text-gray-600 dark:text-gray-400\">\r\n\t\t\t\t<!-- <div class=\"md:hidden flex self-center w-[1px] h-5 mx-2 bg-gray-300 dark:bg-stone-700\" /> -->\r\n\r\n\t\t\t\t{#if shareEnabled && chat && chat.id}\r\n\t\t\t\t\t<Menu\r\n\t\t\t\t\t\t{chat}\r\n\t\t\t\t\t\t{shareEnabled}\r\n\t\t\t\t\t\tshareHandler={() => {\r\n\t\t\t\t\t\t\tshowShareChatModal = !showShareChatModal;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdownloadHandler={() => {\r\n\t\t\t\t\t\t\tshowDownloadChatModal = !showDownloadChatModal;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\"flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\r\n\t\t\t\t\t\t\tid=\"chat-context-menu-button\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\" m-auto self-center\">\r\n\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\t\td=\"M6.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM12.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0ZM18.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</Menu>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t{#if !$mobile}\r\n\t\t\t\t\t<Tooltip content={$i18n.t('Controls')}>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\" flex cursor-pointer px-2 py-2 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\r\n\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\tawait showControls.set(!$showControls);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\taria-label=\"Controls\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\" m-auto self-center\">\r\n\t\t\t\t\t\t\t\t<AdjustmentsHorizontal className=\" size-5\" strokeWidth=\"0.5\" />\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<Tooltip content={$i18n.t('New Chat')}>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tid=\"new-chat-button\"\r\n\t\t\t\t\t\tclass=\" flex {$showSidebar\r\n\t\t\t\t\t\t\t? 'md:hidden'\r\n\t\t\t\t\t\t\t: ''} cursor-pointer px-2 py-2 rounded-xl text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tinitNewChat();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\taria-label=\"New Chat\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\" m-auto self-center\">\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\td=\"M5.433 13.917l1.262-3.155A4 4 0 017.58 9.42l6.92-6.918a2.121 2.121 0 013 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 01-.65-.65z\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\td=\"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0010 3H4.75A2.75 2.75 0 002 5.75v9.5A2.75 2.75 0 004.75 18h9.5A2.75 2.75 0 0017 15.25V10a.75.75 0 00-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5z\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</Tooltip>\r\n\r\n\t\t\t\t{#if $user !== undefined}\r\n\t\t\t\t\t<UserMenu\r\n\t\t\t\t\t\tclassName=\"max-w-[200px]\"\r\n\t\t\t\t\t\trole={$user.role}\r\n\t\t\t\t\t\ton:show={(e) => {\r\n\t\t\t\t\t\t\tif (e.detail === 'archived-chat') {\r\n\t\t\t\t\t\t\t\tshowArchivedChats.set(true);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\"select-none flex rounded-xl p-1.5 w-full hover:bg-gray-50 dark:hover:bg-gray-850 transition\"\r\n\t\t\t\t\t\t\taria-label=\"User Menu\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div class=\" self-center\">\r\n\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\tsrc={$user.profile_image_url}\r\n\t\t\t\t\t\t\t\t\tclass=\"size-6 object-cover rounded-full\"\r\n\t\t\t\t\t\t\t\t\talt=\"User profile\"\r\n\t\t\t\t\t\t\t\t\tdraggable=\"false\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</UserMenu>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</nav>\r\n","export default function cc(names) {\n  if (typeof names === \"string\" || typeof names === \"number\") return \"\" + names\n\n  let out = \"\"\n\n  if (Array.isArray(names)) {\n    for (let i = 0, tmp; i < names.length; i++) {\n      if ((tmp = cc(names[i])) !== \"\") {\n        out += (out && \" \") + tmp\n      }\n    }\n  } else {\n    for (let k in names) {\n      if (names[k]) out += (out && \" \") + k\n    }\n  }\n\n  return out\n}\n","import { drag } from 'd3-drag';\nimport { select, pointer } from 'd3-selection';\nimport { zoom, zoomIdentity, zoomTransform } from 'd3-zoom';\n\nconst errorMessages = {\n    error001: () => '[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001',\n    error002: () => \"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.\",\n    error003: (nodeType) => `Node type \"${nodeType}\" not found. Using fallback type \"default\".`,\n    error004: () => 'The React Flow parent container needs a width and a height to render the graph.',\n    error005: () => 'Only child nodes can use a parent extent.',\n    error006: () => \"Can't create edge. An edge needs a source and a target.\",\n    error007: (id) => `The old edge with id=${id} does not exist.`,\n    error009: (type) => `Marker type \"${type}\" doesn't exist.`,\n    error008: (handleType, { id, sourceHandle, targetHandle }) => `Couldn't create edge for ${handleType} handle id: \"${handleType === 'source' ? sourceHandle : targetHandle}\", edge id: ${id}.`,\n    error010: () => 'Handle: No node id found. Make sure to only use a Handle inside a custom Node.',\n    error011: (edgeType) => `Edge type \"${edgeType}\" not found. Using fallback type \"default\".`,\n    error012: (id) => `Node with id \"${id}\" does not exist, it may have been removed. This can happen when a node is deleted before the \"onNodeClick\" handler is called.`,\n    error013: (lib = 'react') => `It seems that you haven't loaded the styles. Please import '@xyflow/${lib}/dist/style.css' or base.css to make sure everything is working properly.`,\n};\nconst infiniteExtent = [\n    [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY],\n    [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY],\n];\nconst elementSelectionKeys = ['Enter', ' ', 'Escape'];\n\nvar ConnectionMode;\n(function (ConnectionMode) {\n    ConnectionMode[\"Strict\"] = \"strict\";\n    ConnectionMode[\"Loose\"] = \"loose\";\n})(ConnectionMode || (ConnectionMode = {}));\nvar PanOnScrollMode;\n(function (PanOnScrollMode) {\n    PanOnScrollMode[\"Free\"] = \"free\";\n    PanOnScrollMode[\"Vertical\"] = \"vertical\";\n    PanOnScrollMode[\"Horizontal\"] = \"horizontal\";\n})(PanOnScrollMode || (PanOnScrollMode = {}));\nvar SelectionMode;\n(function (SelectionMode) {\n    SelectionMode[\"Partial\"] = \"partial\";\n    SelectionMode[\"Full\"] = \"full\";\n})(SelectionMode || (SelectionMode = {}));\nconst initialConnection = {\n    inProgress: false,\n    isValid: null,\n    from: null,\n    fromHandle: null,\n    fromPosition: null,\n    fromNode: null,\n    to: null,\n    toHandle: null,\n    toPosition: null,\n    toNode: null,\n};\n\nvar ConnectionLineType;\n(function (ConnectionLineType) {\n    ConnectionLineType[\"Bezier\"] = \"default\";\n    ConnectionLineType[\"Straight\"] = \"straight\";\n    ConnectionLineType[\"Step\"] = \"step\";\n    ConnectionLineType[\"SmoothStep\"] = \"smoothstep\";\n    ConnectionLineType[\"SimpleBezier\"] = \"simplebezier\";\n})(ConnectionLineType || (ConnectionLineType = {}));\nvar MarkerType;\n(function (MarkerType) {\n    MarkerType[\"Arrow\"] = \"arrow\";\n    MarkerType[\"ArrowClosed\"] = \"arrowclosed\";\n})(MarkerType || (MarkerType = {}));\n\nvar Position;\n(function (Position) {\n    Position[\"Left\"] = \"left\";\n    Position[\"Top\"] = \"top\";\n    Position[\"Right\"] = \"right\";\n    Position[\"Bottom\"] = \"bottom\";\n})(Position || (Position = {}));\nconst oppositePosition = {\n    [Position.Left]: Position.Right,\n    [Position.Right]: Position.Left,\n    [Position.Top]: Position.Bottom,\n    [Position.Bottom]: Position.Top,\n};\n\n/**\n * @internal\n */\nfunction areConnectionMapsEqual(a, b) {\n    if (!a && !b) {\n        return true;\n    }\n    if (!a || !b || a.size !== b.size) {\n        return false;\n    }\n    if (!a.size && !b.size) {\n        return true;\n    }\n    for (const key of a.keys()) {\n        if (!b.has(key)) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * We call the callback for all connections in a that are not in b\n *\n * @internal\n */\nfunction handleConnectionChange(a, b, cb) {\n    if (!cb) {\n        return;\n    }\n    const diff = [];\n    a.forEach((connection, key) => {\n        if (!b?.has(key)) {\n            diff.push(connection);\n        }\n    });\n    if (diff.length) {\n        cb(diff);\n    }\n}\nfunction getConnectionStatus(isValid) {\n    return isValid === null ? null : isValid ? 'valid' : 'invalid';\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n/**\n * Test whether an object is useable as an Edge\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Edge if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Edge\n */\nconst isEdgeBase = (element) => 'id' in element && 'source' in element && 'target' in element;\n/**\n * Test whether an object is useable as a Node\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Node if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Node\n */\nconst isNodeBase = (element) => 'id' in element && 'position' in element && !('source' in element) && !('target' in element);\nconst isInternalNodeBase = (element) => 'id' in element && 'internals' in element && !('source' in element) && !('target' in element);\n/**\n * Pass in a node, and get connected nodes where edge.source === node.id\n * @public\n * @param node - The node to get the connected nodes from\n * @param nodes - The array of all nodes\n * @param edges - The array of all edges\n * @returns An array of nodes that are connected over eges where the source is the given node\n */\nconst getOutgoers = (node, nodes, edges) => {\n    if (!node.id) {\n        return [];\n    }\n    const outgoerIds = new Set();\n    edges.forEach((edge) => {\n        if (edge.source === node.id) {\n            outgoerIds.add(edge.target);\n        }\n    });\n    return nodes.filter((n) => outgoerIds.has(n.id));\n};\n/**\n * Pass in a node, and get connected nodes where edge.target === node.id\n * @public\n * @param node - The node to get the connected nodes from\n * @param nodes - The array of all nodes\n * @param edges - The array of all edges\n * @returns An array of nodes that are connected over eges where the target is the given node\n */\nconst getIncomers = (node, nodes, edges) => {\n    if (!node.id) {\n        return [];\n    }\n    const incomersIds = new Set();\n    edges.forEach((edge) => {\n        if (edge.target === node.id) {\n            incomersIds.add(edge.source);\n        }\n    });\n    return nodes.filter((n) => incomersIds.has(n.id));\n};\nconst getNodePositionWithOrigin = (node, nodeOrigin = [0, 0]) => {\n    const { width, height } = getNodeDimensions(node);\n    const origin = node.origin ?? nodeOrigin;\n    const offsetX = width * origin[0];\n    const offsetY = height * origin[1];\n    return {\n        x: node.position.x - offsetX,\n        y: node.position.y - offsetY,\n    };\n};\n/**\n * Internal function for determining a bounding box that contains all given nodes in an array.\n * @public\n * @remarks Useful when combined with {@link getViewportForBounds} to calculate the correct transform to fit the given nodes in a viewport.\n * @param nodes - Nodes to calculate the bounds for\n * @param params.nodeOrigin - Origin of the nodes: [0, 0] - top left, [0.5, 0.5] - center\n * @returns Bounding box enclosing all nodes\n */\nconst getNodesBounds = (nodes, params = { nodeOrigin: [0, 0], nodeLookup: undefined }) => {\n    if (process.env.NODE_ENV === 'development' && !params.nodeLookup) {\n        console.warn('Please use `getNodesBounds` from `useReactFlow`/`useSvelteFlow` hook to ensure correct values for sub flows. If not possible, you have to provide a nodeLookup to support sub flows.');\n    }\n    if (nodes.length === 0) {\n        return { x: 0, y: 0, width: 0, height: 0 };\n    }\n    const box = nodes.reduce((currBox, nodeOrId) => {\n        const isId = typeof nodeOrId === 'string';\n        let currentNode = !params.nodeLookup && !isId ? nodeOrId : undefined;\n        if (params.nodeLookup) {\n            currentNode = isId\n                ? params.nodeLookup.get(nodeOrId)\n                : !isInternalNodeBase(nodeOrId)\n                    ? params.nodeLookup.get(nodeOrId.id)\n                    : nodeOrId;\n        }\n        const nodeBox = currentNode ? nodeToBox(currentNode, params.nodeOrigin) : { x: 0, y: 0, x2: 0, y2: 0 };\n        return getBoundsOfBoxes(currBox, nodeBox);\n    }, { x: Infinity, y: Infinity, x2: -Infinity, y2: -Infinity });\n    return boxToRect(box);\n};\n/**\n * Determines a bounding box that contains all given nodes in an array\n * @internal\n */\nconst getInternalNodesBounds = (nodeLookup, params = {}) => {\n    if (nodeLookup.size === 0) {\n        return { x: 0, y: 0, width: 0, height: 0 };\n    }\n    let box = { x: Infinity, y: Infinity, x2: -Infinity, y2: -Infinity };\n    nodeLookup.forEach((node) => {\n        if (params.filter === undefined || params.filter(node)) {\n            const nodeBox = nodeToBox(node);\n            box = getBoundsOfBoxes(box, nodeBox);\n        }\n    });\n    return boxToRect(box);\n};\nconst getNodesInside = (nodes, rect, [tx, ty, tScale] = [0, 0, 1], partially = false, \n// set excludeNonSelectableNodes if you want to pay attention to the nodes \"selectable\" attribute\nexcludeNonSelectableNodes = false) => {\n    const paneRect = {\n        ...pointToRendererPoint(rect, [tx, ty, tScale]),\n        width: rect.width / tScale,\n        height: rect.height / tScale,\n    };\n    const visibleNodes = [];\n    for (const node of nodes.values()) {\n        const { measured, selectable = true, hidden = false } = node;\n        if ((excludeNonSelectableNodes && !selectable) || hidden) {\n            continue;\n        }\n        const width = measured.width ?? node.width ?? node.initialWidth ?? null;\n        const height = measured.height ?? node.height ?? node.initialHeight ?? null;\n        const overlappingArea = getOverlappingArea(paneRect, nodeToRect(node));\n        const area = (width ?? 0) * (height ?? 0);\n        const partiallyVisible = partially && overlappingArea > 0;\n        const forceInitialRender = !node.internals.handleBounds;\n        const isVisible = forceInitialRender || partiallyVisible || overlappingArea >= area;\n        if (isVisible || node.dragging) {\n            visibleNodes.push(node);\n        }\n    }\n    return visibleNodes;\n};\n/**\n * Get all connecting edges for a given set of nodes\n * @param nodes - Nodes you want to get the connected edges for\n * @param edges - All edges\n * @returns Array of edges that connect any of the given nodes with each other\n */\nconst getConnectedEdges = (nodes, edges) => {\n    const nodeIds = new Set();\n    nodes.forEach((node) => {\n        nodeIds.add(node.id);\n    });\n    return edges.filter((edge) => nodeIds.has(edge.source) || nodeIds.has(edge.target));\n};\nfunction getFitViewNodes(nodeLookup, options) {\n    const fitViewNodes = new Map();\n    const optionNodeIds = options?.nodes ? new Set(options.nodes.map((node) => node.id)) : null;\n    nodeLookup.forEach((n) => {\n        const isVisible = n.measured.width && n.measured.height && (options?.includeHiddenNodes || !n.hidden);\n        if (isVisible && (!optionNodeIds || optionNodeIds.has(n.id))) {\n            fitViewNodes.set(n.id, n);\n        }\n    });\n    return fitViewNodes;\n}\nasync function fitView({ nodes, width, height, panZoom, minZoom, maxZoom }, options) {\n    if (nodes.size === 0) {\n        return Promise.resolve(false);\n    }\n    const bounds = getInternalNodesBounds(nodes);\n    const viewport = getViewportForBounds(bounds, width, height, options?.minZoom ?? minZoom, options?.maxZoom ?? maxZoom, options?.padding ?? 0.1);\n    await panZoom.setViewport(viewport, { duration: options?.duration });\n    return Promise.resolve(true);\n}\n/**\n * This function calculates the next position of a node, taking into account the node's extent, parent node, and origin.\n *\n * @internal\n * @returns position, positionAbsolute\n */\nfunction calculateNodePosition({ nodeId, nextPosition, nodeLookup, nodeOrigin = [0, 0], nodeExtent, onError, }) {\n    const node = nodeLookup.get(nodeId);\n    const parentNode = node.parentId ? nodeLookup.get(node.parentId) : undefined;\n    const { x: parentX, y: parentY } = parentNode ? parentNode.internals.positionAbsolute : { x: 0, y: 0 };\n    const origin = node.origin ?? nodeOrigin;\n    let extent = nodeExtent;\n    if (node.extent === 'parent' && !node.expandParent) {\n        if (!parentNode) {\n            onError?.('005', errorMessages['error005']());\n        }\n        else {\n            const parentWidth = parentNode.measured.width;\n            const parentHeight = parentNode.measured.height;\n            if (parentWidth && parentHeight) {\n                extent = [\n                    [parentX, parentY],\n                    [parentX + parentWidth, parentY + parentHeight],\n                ];\n            }\n        }\n    }\n    else if (parentNode && isCoordinateExtent(node.extent)) {\n        extent = [\n            [node.extent[0][0] + parentX, node.extent[0][1] + parentY],\n            [node.extent[1][0] + parentX, node.extent[1][1] + parentY],\n        ];\n    }\n    const positionAbsolute = isCoordinateExtent(extent)\n        ? clampPosition(nextPosition, extent, node.measured)\n        : nextPosition;\n    return {\n        position: {\n            x: positionAbsolute.x - parentX + node.measured.width * origin[0],\n            y: positionAbsolute.y - parentY + node.measured.height * origin[1],\n        },\n        positionAbsolute,\n    };\n}\n/**\n * Pass in nodes & edges to delete, get arrays of nodes and edges that actually can be deleted\n * @internal\n * @param param.nodesToRemove - The nodes to remove\n * @param param.edgesToRemove - The edges to remove\n * @param param.nodes - All nodes\n * @param param.edges - All edges\n * @param param.onBeforeDelete - Callback to check which nodes and edges can be deleted\n * @returns nodes: nodes that can be deleted, edges: edges that can be deleted\n */\nasync function getElementsToRemove({ nodesToRemove = [], edgesToRemove = [], nodes, edges, onBeforeDelete, }) {\n    const nodeIds = new Set(nodesToRemove.map((node) => node.id));\n    const matchingNodes = [];\n    for (const node of nodes) {\n        if (node.deletable === false) {\n            continue;\n        }\n        const isIncluded = nodeIds.has(node.id);\n        const parentHit = !isIncluded && node.parentId && matchingNodes.find((n) => n.id === node.parentId);\n        if (isIncluded || parentHit) {\n            matchingNodes.push(node);\n        }\n    }\n    const edgeIds = new Set(edgesToRemove.map((edge) => edge.id));\n    const deletableEdges = edges.filter((edge) => edge.deletable !== false);\n    const connectedEdges = getConnectedEdges(matchingNodes, deletableEdges);\n    const matchingEdges = connectedEdges;\n    for (const edge of deletableEdges) {\n        const isIncluded = edgeIds.has(edge.id);\n        if (isIncluded && !matchingEdges.find((e) => e.id === edge.id)) {\n            matchingEdges.push(edge);\n        }\n    }\n    if (!onBeforeDelete) {\n        return {\n            edges: matchingEdges,\n            nodes: matchingNodes,\n        };\n    }\n    const onBeforeDeleteResult = await onBeforeDelete({\n        nodes: matchingNodes,\n        edges: matchingEdges,\n    });\n    if (typeof onBeforeDeleteResult === 'boolean') {\n        return onBeforeDeleteResult ? { edges: matchingEdges, nodes: matchingNodes } : { edges: [], nodes: [] };\n    }\n    return onBeforeDeleteResult;\n}\n\nconst clamp = (val, min = 0, max = 1) => Math.min(Math.max(val, min), max);\nconst clampPosition = (position = { x: 0, y: 0 }, extent, dimensions) => ({\n    x: clamp(position.x, extent[0][0], extent[1][0] - (dimensions?.width ?? 0)),\n    y: clamp(position.y, extent[0][1], extent[1][1] - (dimensions?.height ?? 0)),\n});\nfunction clampPositionToParent(childPosition, childDimensions, parent) {\n    const { width: parentWidth, height: parentHeight } = getNodeDimensions(parent);\n    const { x: parentX, y: parentY } = parent.internals.positionAbsolute;\n    return clampPosition(childPosition, [\n        [parentX, parentY],\n        [parentX + parentWidth, parentY + parentHeight],\n    ], childDimensions);\n}\n/**\n * Calculates the velocity of panning when the mouse is close to the edge of the canvas\n * @internal\n * @param value - One dimensional poition of the mouse (x or y)\n * @param min - Minimal position on canvas before panning starts\n * @param max - Maximal position on canvas before panning starts\n * @returns - A number between 0 and 1 that represents the velocity of panning\n */\nconst calcAutoPanVelocity = (value, min, max) => {\n    if (value < min) {\n        return clamp(Math.abs(value - min), 1, min) / min;\n    }\n    else if (value > max) {\n        return -clamp(Math.abs(value - max), 1, min) / min;\n    }\n    return 0;\n};\nconst calcAutoPan = (pos, bounds, speed = 15, distance = 40) => {\n    const xMovement = calcAutoPanVelocity(pos.x, distance, bounds.width - distance) * speed;\n    const yMovement = calcAutoPanVelocity(pos.y, distance, bounds.height - distance) * speed;\n    return [xMovement, yMovement];\n};\nconst getBoundsOfBoxes = (box1, box2) => ({\n    x: Math.min(box1.x, box2.x),\n    y: Math.min(box1.y, box2.y),\n    x2: Math.max(box1.x2, box2.x2),\n    y2: Math.max(box1.y2, box2.y2),\n});\nconst rectToBox = ({ x, y, width, height }) => ({\n    x,\n    y,\n    x2: x + width,\n    y2: y + height,\n});\nconst boxToRect = ({ x, y, x2, y2 }) => ({\n    x,\n    y,\n    width: x2 - x,\n    height: y2 - y,\n});\nconst nodeToRect = (node, nodeOrigin = [0, 0]) => {\n    const { x, y } = isInternalNodeBase(node)\n        ? node.internals.positionAbsolute\n        : getNodePositionWithOrigin(node, nodeOrigin);\n    return {\n        x,\n        y,\n        width: node.measured?.width ?? node.width ?? node.initialWidth ?? 0,\n        height: node.measured?.height ?? node.height ?? node.initialHeight ?? 0,\n    };\n};\nconst nodeToBox = (node, nodeOrigin = [0, 0]) => {\n    const { x, y } = isInternalNodeBase(node)\n        ? node.internals.positionAbsolute\n        : getNodePositionWithOrigin(node, nodeOrigin);\n    return {\n        x,\n        y,\n        x2: x + (node.measured?.width ?? node.width ?? node.initialWidth ?? 0),\n        y2: y + (node.measured?.height ?? node.height ?? node.initialHeight ?? 0),\n    };\n};\nconst getBoundsOfRects = (rect1, rect2) => boxToRect(getBoundsOfBoxes(rectToBox(rect1), rectToBox(rect2)));\nconst getOverlappingArea = (rectA, rectB) => {\n    const xOverlap = Math.max(0, Math.min(rectA.x + rectA.width, rectB.x + rectB.width) - Math.max(rectA.x, rectB.x));\n    const yOverlap = Math.max(0, Math.min(rectA.y + rectA.height, rectB.y + rectB.height) - Math.max(rectA.y, rectB.y));\n    return Math.ceil(xOverlap * yOverlap);\n};\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst isRectObject = (obj) => isNumeric(obj.width) && isNumeric(obj.height) && isNumeric(obj.x) && isNumeric(obj.y);\n/* eslint-disable-next-line @typescript-eslint/no-explicit-any */\nconst isNumeric = (n) => !isNaN(n) && isFinite(n);\n// used for a11y key board controls for nodes and edges\nconst devWarn = (id, message) => {\n    if (process.env.NODE_ENV === 'development') {\n        console.warn(`[React Flow]: ${message} Help: https://reactflow.dev/error#${id}`);\n    }\n};\nconst snapPosition = (position, snapGrid = [1, 1]) => {\n    return {\n        x: snapGrid[0] * Math.round(position.x / snapGrid[0]),\n        y: snapGrid[1] * Math.round(position.y / snapGrid[1]),\n    };\n};\nconst pointToRendererPoint = ({ x, y }, [tx, ty, tScale], snapToGrid = false, snapGrid = [1, 1]) => {\n    const position = {\n        x: (x - tx) / tScale,\n        y: (y - ty) / tScale,\n    };\n    return snapToGrid ? snapPosition(position, snapGrid) : position;\n};\nconst rendererPointToPoint = ({ x, y }, [tx, ty, tScale]) => {\n    return {\n        x: x * tScale + tx,\n        y: y * tScale + ty,\n    };\n};\n/**\n * Returns a viewport that encloses the given bounds with optional padding.\n * @public\n * @remarks You can determine bounds of nodes with {@link getNodesBounds} and {@link getBoundsOfRects}\n * @param bounds - Bounds to fit inside viewport\n * @param width - Width of the viewport\n * @param height  - Height of the viewport\n * @param minZoom - Minimum zoom level of the resulting viewport\n * @param maxZoom - Maximum zoom level of the resulting viewport\n * @param padding - Optional padding around the bounds\n * @returns A transforned {@link Viewport} that encloses the given bounds which you can pass to e.g. {@link setViewport}\n * @example\n * const { x, y, zoom } = getViewportForBounds(\n  { x: 0, y: 0, width: 100, height: 100},\n  1200, 800, 0.5, 2);\n */\nconst getViewportForBounds = (bounds, width, height, minZoom, maxZoom, padding) => {\n    const xZoom = width / (bounds.width * (1 + padding));\n    const yZoom = height / (bounds.height * (1 + padding));\n    const zoom = Math.min(xZoom, yZoom);\n    const clampedZoom = clamp(zoom, minZoom, maxZoom);\n    const boundsCenterX = bounds.x + bounds.width / 2;\n    const boundsCenterY = bounds.y + bounds.height / 2;\n    const x = width / 2 - boundsCenterX * clampedZoom;\n    const y = height / 2 - boundsCenterY * clampedZoom;\n    return { x, y, zoom: clampedZoom };\n};\nconst isMacOs = () => typeof navigator !== 'undefined' && navigator?.userAgent?.indexOf('Mac') >= 0;\nfunction isCoordinateExtent(extent) {\n    return extent !== undefined && extent !== 'parent';\n}\nfunction getNodeDimensions(node) {\n    return {\n        width: node.measured?.width ?? node.width ?? node.initialWidth ?? 0,\n        height: node.measured?.height ?? node.height ?? node.initialHeight ?? 0,\n    };\n}\nfunction nodeHasDimensions(node) {\n    return ((node.measured?.width ?? node.width ?? node.initialWidth) !== undefined &&\n        (node.measured?.height ?? node.height ?? node.initialHeight) !== undefined);\n}\n/**\n * Convert child position to aboslute position\n *\n * @internal\n * @param position\n * @param parentId\n * @param nodeLookup\n * @param nodeOrigin\n * @returns an internal node with an absolute position\n */\nfunction evaluateAbsolutePosition(position, dimensions = { width: 0, height: 0 }, parentId, nodeLookup, nodeOrigin) {\n    let nextParentId = parentId;\n    const positionAbsolute = { ...position };\n    while (nextParentId) {\n        const parent = nodeLookup.get(nextParentId);\n        nextParentId = parent?.parentId;\n        if (parent) {\n            const origin = parent.origin || nodeOrigin;\n            positionAbsolute.x += parent.internals.positionAbsolute.x - (dimensions.width ?? 0) * origin[0];\n            positionAbsolute.y += parent.internals.positionAbsolute.y - (dimensions.height ?? 0) * origin[1];\n        }\n    }\n    return positionAbsolute;\n}\n\nfunction getPointerPosition(event, { snapGrid = [0, 0], snapToGrid = false, transform }) {\n    const { x, y } = getEventPosition(event);\n    const pointerPos = pointToRendererPoint({ x, y }, transform);\n    const { x: xSnapped, y: ySnapped } = snapToGrid ? snapPosition(pointerPos, snapGrid) : pointerPos;\n    // we need the snapped position in order to be able to skip unnecessary drag events\n    return {\n        xSnapped,\n        ySnapped,\n        ...pointerPos,\n    };\n}\nconst getDimensions = (node) => ({\n    width: node.offsetWidth,\n    height: node.offsetHeight,\n});\nconst getHostForElement = (element) => element.getRootNode?.() || window?.document;\nconst inputTags = ['INPUT', 'SELECT', 'TEXTAREA'];\nfunction isInputDOMNode(event) {\n    // using composed path for handling shadow dom\n    const target = (event.composedPath?.()?.[0] || event.target);\n    const isInput = inputTags.includes(target?.nodeName) || target?.hasAttribute('contenteditable');\n    // when an input field is focused we don't want to trigger deletion or movement of nodes\n    return isInput || !!target?.closest('.nokey');\n}\nconst isMouseEvent = (event) => 'clientX' in event;\nconst getEventPosition = (event, bounds) => {\n    const isMouse = isMouseEvent(event);\n    const evtX = isMouse ? event.clientX : event.touches?.[0].clientX;\n    const evtY = isMouse ? event.clientY : event.touches?.[0].clientY;\n    return {\n        x: evtX - (bounds?.left ?? 0),\n        y: evtY - (bounds?.top ?? 0),\n    };\n};\n// The handle bounds are calculated relative to the node element.\n// We store them in the internals object of the node in order to avoid\n// unnecessary recalculations.\nconst getHandleBounds = (type, nodeElement, nodeBounds, zoom, nodeId) => {\n    const handles = nodeElement.querySelectorAll(`.${type}`);\n    if (!handles || !handles.length) {\n        return null;\n    }\n    return Array.from(handles).map((handle) => {\n        const handleBounds = handle.getBoundingClientRect();\n        return {\n            id: handle.getAttribute('data-handleid'),\n            type,\n            nodeId,\n            position: handle.getAttribute('data-handlepos'),\n            x: (handleBounds.left - nodeBounds.left) / zoom,\n            y: (handleBounds.top - nodeBounds.top) / zoom,\n            ...getDimensions(handle),\n        };\n    });\n};\n\nfunction getBezierEdgeCenter({ sourceX, sourceY, targetX, targetY, sourceControlX, sourceControlY, targetControlX, targetControlY, }) {\n    // cubic bezier t=0.5 mid point, not the actual mid point, but easy to calculate\n    // https://stackoverflow.com/questions/67516101/how-to-find-distance-mid-point-of-bezier-curve\n    const centerX = sourceX * 0.125 + sourceControlX * 0.375 + targetControlX * 0.375 + targetX * 0.125;\n    const centerY = sourceY * 0.125 + sourceControlY * 0.375 + targetControlY * 0.375 + targetY * 0.125;\n    const offsetX = Math.abs(centerX - sourceX);\n    const offsetY = Math.abs(centerY - sourceY);\n    return [centerX, centerY, offsetX, offsetY];\n}\nfunction calculateControlOffset(distance, curvature) {\n    if (distance >= 0) {\n        return 0.5 * distance;\n    }\n    return curvature * 25 * Math.sqrt(-distance);\n}\nfunction getControlWithCurvature({ pos, x1, y1, x2, y2, c }) {\n    switch (pos) {\n        case Position.Left:\n            return [x1 - calculateControlOffset(x1 - x2, c), y1];\n        case Position.Right:\n            return [x1 + calculateControlOffset(x2 - x1, c), y1];\n        case Position.Top:\n            return [x1, y1 - calculateControlOffset(y1 - y2, c)];\n        case Position.Bottom:\n            return [x1, y1 + calculateControlOffset(y2 - y1, c)];\n    }\n}\n/**\n * Get a bezier path from source to target handle\n * @param params.sourceX - The x position of the source handle\n * @param params.sourceY - The y position of the source handle\n * @param params.sourcePosition - The position of the source handle (default: Position.Bottom)\n * @param params.targetX - The x position of the target handle\n * @param params.targetY - The y position of the target handle\n * @param params.targetPosition - The position of the target handle (default: Position.Top)\n * @param params.curvature - The curvature of the bezier edge\n * @returns A path string you can use in an SVG, the labelX and labelY position (center of path) and offsetX, offsetY between source handle and label\n * @example\n *  const source = { x: 0, y: 20 };\n    const target = { x: 150, y: 100 };\n    \n    const [path, labelX, labelY, offsetX, offsetY] = getBezierPath({\n      sourceX: source.x,\n      sourceY: source.y,\n      sourcePosition: Position.Right,\n      targetX: target.x,\n      targetY: target.y,\n      targetPosition: Position.Left,\n});\n */\nfunction getBezierPath({ sourceX, sourceY, sourcePosition = Position.Bottom, targetX, targetY, targetPosition = Position.Top, curvature = 0.25, }) {\n    const [sourceControlX, sourceControlY] = getControlWithCurvature({\n        pos: sourcePosition,\n        x1: sourceX,\n        y1: sourceY,\n        x2: targetX,\n        y2: targetY,\n        c: curvature,\n    });\n    const [targetControlX, targetControlY] = getControlWithCurvature({\n        pos: targetPosition,\n        x1: targetX,\n        y1: targetY,\n        x2: sourceX,\n        y2: sourceY,\n        c: curvature,\n    });\n    const [labelX, labelY, offsetX, offsetY] = getBezierEdgeCenter({\n        sourceX,\n        sourceY,\n        targetX,\n        targetY,\n        sourceControlX,\n        sourceControlY,\n        targetControlX,\n        targetControlY,\n    });\n    return [\n        `M${sourceX},${sourceY} C${sourceControlX},${sourceControlY} ${targetControlX},${targetControlY} ${targetX},${targetY}`,\n        labelX,\n        labelY,\n        offsetX,\n        offsetY,\n    ];\n}\n\n// this is used for straight edges and simple smoothstep edges (LTR, RTL, BTT, TTB)\nfunction getEdgeCenter({ sourceX, sourceY, targetX, targetY, }) {\n    const xOffset = Math.abs(targetX - sourceX) / 2;\n    const centerX = targetX < sourceX ? targetX + xOffset : targetX - xOffset;\n    const yOffset = Math.abs(targetY - sourceY) / 2;\n    const centerY = targetY < sourceY ? targetY + yOffset : targetY - yOffset;\n    return [centerX, centerY, xOffset, yOffset];\n}\nfunction getElevatedEdgeZIndex({ sourceNode, targetNode, selected = false, zIndex = 0, elevateOnSelect = false, }) {\n    if (!elevateOnSelect) {\n        return zIndex;\n    }\n    const edgeOrConnectedNodeSelected = selected || targetNode.selected || sourceNode.selected;\n    const selectedZIndex = Math.max(sourceNode.internals.z || 0, targetNode.internals.z || 0, 1000);\n    return zIndex + (edgeOrConnectedNodeSelected ? selectedZIndex : 0);\n}\nfunction isEdgeVisible({ sourceNode, targetNode, width, height, transform }) {\n    const edgeBox = getBoundsOfBoxes(nodeToBox(sourceNode), nodeToBox(targetNode));\n    if (edgeBox.x === edgeBox.x2) {\n        edgeBox.x2 += 1;\n    }\n    if (edgeBox.y === edgeBox.y2) {\n        edgeBox.y2 += 1;\n    }\n    const viewRect = {\n        x: -transform[0] / transform[2],\n        y: -transform[1] / transform[2],\n        width: width / transform[2],\n        height: height / transform[2],\n    };\n    return getOverlappingArea(viewRect, boxToRect(edgeBox)) > 0;\n}\nconst getEdgeId = ({ source, sourceHandle, target, targetHandle }) => `xy-edge__${source}${sourceHandle || ''}-${target}${targetHandle || ''}`;\nconst connectionExists = (edge, edges) => {\n    return edges.some((el) => el.source === edge.source &&\n        el.target === edge.target &&\n        (el.sourceHandle === edge.sourceHandle || (!el.sourceHandle && !edge.sourceHandle)) &&\n        (el.targetHandle === edge.targetHandle || (!el.targetHandle && !edge.targetHandle)));\n};\n/**\n * This util is a convenience function to add a new Edge to an array of edges\n * @remarks It also performs some validation to make sure you don't add an invalid edge or duplicate an existing one.\n * @public\n * @param edgeParams - Either an Edge or a Connection you want to add\n * @param edges -  The array of all current edges\n * @returns A new array of edges with the new edge added\n */\nconst addEdge = (edgeParams, edges) => {\n    if (!edgeParams.source || !edgeParams.target) {\n        devWarn('006', errorMessages['error006']());\n        return edges;\n    }\n    let edge;\n    if (isEdgeBase(edgeParams)) {\n        edge = { ...edgeParams };\n    }\n    else {\n        edge = {\n            ...edgeParams,\n            id: getEdgeId(edgeParams),\n        };\n    }\n    if (connectionExists(edge, edges)) {\n        return edges;\n    }\n    if (edge.sourceHandle === null) {\n        delete edge.sourceHandle;\n    }\n    if (edge.targetHandle === null) {\n        delete edge.targetHandle;\n    }\n    return edges.concat(edge);\n};\n/**\n * A handy utility to reconnect an existing edge with new properties\n * @param oldEdge - The edge you want to update\n * @param newConnection - The new connection you want to update the edge with\n * @param edges - The array of all current edges\n * @param options.shouldReplaceId - should the id of the old edge be replaced with the new connection id\n * @returns the updated edges array\n */\nconst reconnectEdge = (oldEdge, newConnection, edges, options = { shouldReplaceId: true }) => {\n    const { id: oldEdgeId, ...rest } = oldEdge;\n    if (!newConnection.source || !newConnection.target) {\n        devWarn('006', errorMessages['error006']());\n        return edges;\n    }\n    const foundEdge = edges.find((e) => e.id === oldEdge.id);\n    if (!foundEdge) {\n        devWarn('007', errorMessages['error007'](oldEdgeId));\n        return edges;\n    }\n    // Remove old edge and create the new edge with parameters of old edge.\n    const edge = {\n        ...rest,\n        id: options.shouldReplaceId ? getEdgeId(newConnection) : oldEdgeId,\n        source: newConnection.source,\n        target: newConnection.target,\n        sourceHandle: newConnection.sourceHandle,\n        targetHandle: newConnection.targetHandle,\n    };\n    return edges.filter((e) => e.id !== oldEdgeId).concat(edge);\n};\n\n/**\n * Get a straight path from source to target handle\n * @param params.sourceX - The x position of the source handle\n * @param params.sourceY - The y position of the source handle\n * @param params.targetX - The x position of the target handle\n * @param params.targetY - The y position of the target handle\n * @returns A path string you can use in an SVG, the labelX and labelY position (center of path) and offsetX, offsetY between source handle and label\n * @example\n *  const source = { x: 0, y: 20 };\n    const target = { x: 150, y: 100 };\n    \n    const [path, labelX, labelY, offsetX, offsetY] = getStraightPath({\n      sourceX: source.x,\n      sourceY: source.y,\n      sourcePosition: Position.Right,\n      targetX: target.x,\n      targetY: target.y,\n      targetPosition: Position.Left,\n    });\n */\nfunction getStraightPath({ sourceX, sourceY, targetX, targetY, }) {\n    const [labelX, labelY, offsetX, offsetY] = getEdgeCenter({\n        sourceX,\n        sourceY,\n        targetX,\n        targetY,\n    });\n    return [`M ${sourceX},${sourceY}L ${targetX},${targetY}`, labelX, labelY, offsetX, offsetY];\n}\n\nconst handleDirections = {\n    [Position.Left]: { x: -1, y: 0 },\n    [Position.Right]: { x: 1, y: 0 },\n    [Position.Top]: { x: 0, y: -1 },\n    [Position.Bottom]: { x: 0, y: 1 },\n};\nconst getDirection = ({ source, sourcePosition = Position.Bottom, target, }) => {\n    if (sourcePosition === Position.Left || sourcePosition === Position.Right) {\n        return source.x < target.x ? { x: 1, y: 0 } : { x: -1, y: 0 };\n    }\n    return source.y < target.y ? { x: 0, y: 1 } : { x: 0, y: -1 };\n};\nconst distance = (a, b) => Math.sqrt(Math.pow(b.x - a.x, 2) + Math.pow(b.y - a.y, 2));\n// ith this function we try to mimic a orthogonal edge routing behaviour\n// It's not as good as a real orthogonal edge routing but it's faster and good enough as a default for step and smooth step edges\nfunction getPoints({ source, sourcePosition = Position.Bottom, target, targetPosition = Position.Top, center, offset, }) {\n    const sourceDir = handleDirections[sourcePosition];\n    const targetDir = handleDirections[targetPosition];\n    const sourceGapped = { x: source.x + sourceDir.x * offset, y: source.y + sourceDir.y * offset };\n    const targetGapped = { x: target.x + targetDir.x * offset, y: target.y + targetDir.y * offset };\n    const dir = getDirection({\n        source: sourceGapped,\n        sourcePosition,\n        target: targetGapped,\n    });\n    const dirAccessor = dir.x !== 0 ? 'x' : 'y';\n    const currDir = dir[dirAccessor];\n    let points = [];\n    let centerX, centerY;\n    const sourceGapOffset = { x: 0, y: 0 };\n    const targetGapOffset = { x: 0, y: 0 };\n    const [defaultCenterX, defaultCenterY, defaultOffsetX, defaultOffsetY] = getEdgeCenter({\n        sourceX: source.x,\n        sourceY: source.y,\n        targetX: target.x,\n        targetY: target.y,\n    });\n    // opposite handle positions, default case\n    if (sourceDir[dirAccessor] * targetDir[dirAccessor] === -1) {\n        centerX = center.x ?? defaultCenterX;\n        centerY = center.y ?? defaultCenterY;\n        //    --->\n        //    |\n        // >---\n        const verticalSplit = [\n            { x: centerX, y: sourceGapped.y },\n            { x: centerX, y: targetGapped.y },\n        ];\n        //    |\n        //  ---\n        //  |\n        const horizontalSplit = [\n            { x: sourceGapped.x, y: centerY },\n            { x: targetGapped.x, y: centerY },\n        ];\n        if (sourceDir[dirAccessor] === currDir) {\n            points = dirAccessor === 'x' ? verticalSplit : horizontalSplit;\n        }\n        else {\n            points = dirAccessor === 'x' ? horizontalSplit : verticalSplit;\n        }\n    }\n    else {\n        // sourceTarget means we take x from source and y from target, targetSource is the opposite\n        const sourceTarget = [{ x: sourceGapped.x, y: targetGapped.y }];\n        const targetSource = [{ x: targetGapped.x, y: sourceGapped.y }];\n        // this handles edges with same handle positions\n        if (dirAccessor === 'x') {\n            points = sourceDir.x === currDir ? targetSource : sourceTarget;\n        }\n        else {\n            points = sourceDir.y === currDir ? sourceTarget : targetSource;\n        }\n        if (sourcePosition === targetPosition) {\n            const diff = Math.abs(source[dirAccessor] - target[dirAccessor]);\n            // if an edge goes from right to right for example (sourcePosition === targetPosition) and the distance between source.x and target.x is less than the offset, the added point and the gapped source/target will overlap. This leads to a weird edge path. To avoid this we add a gapOffset to the source/target\n            if (diff <= offset) {\n                const gapOffset = Math.min(offset - 1, offset - diff);\n                if (sourceDir[dirAccessor] === currDir) {\n                    sourceGapOffset[dirAccessor] = (sourceGapped[dirAccessor] > source[dirAccessor] ? -1 : 1) * gapOffset;\n                }\n                else {\n                    targetGapOffset[dirAccessor] = (targetGapped[dirAccessor] > target[dirAccessor] ? -1 : 1) * gapOffset;\n                }\n            }\n        }\n        // these are conditions for handling mixed handle positions like Right -> Bottom for example\n        if (sourcePosition !== targetPosition) {\n            const dirAccessorOpposite = dirAccessor === 'x' ? 'y' : 'x';\n            const isSameDir = sourceDir[dirAccessor] === targetDir[dirAccessorOpposite];\n            const sourceGtTargetOppo = sourceGapped[dirAccessorOpposite] > targetGapped[dirAccessorOpposite];\n            const sourceLtTargetOppo = sourceGapped[dirAccessorOpposite] < targetGapped[dirAccessorOpposite];\n            const flipSourceTarget = (sourceDir[dirAccessor] === 1 && ((!isSameDir && sourceGtTargetOppo) || (isSameDir && sourceLtTargetOppo))) ||\n                (sourceDir[dirAccessor] !== 1 && ((!isSameDir && sourceLtTargetOppo) || (isSameDir && sourceGtTargetOppo)));\n            if (flipSourceTarget) {\n                points = dirAccessor === 'x' ? sourceTarget : targetSource;\n            }\n        }\n        const sourceGapPoint = { x: sourceGapped.x + sourceGapOffset.x, y: sourceGapped.y + sourceGapOffset.y };\n        const targetGapPoint = { x: targetGapped.x + targetGapOffset.x, y: targetGapped.y + targetGapOffset.y };\n        const maxXDistance = Math.max(Math.abs(sourceGapPoint.x - points[0].x), Math.abs(targetGapPoint.x - points[0].x));\n        const maxYDistance = Math.max(Math.abs(sourceGapPoint.y - points[0].y), Math.abs(targetGapPoint.y - points[0].y));\n        // we want to place the label on the longest segment of the edge\n        if (maxXDistance >= maxYDistance) {\n            centerX = (sourceGapPoint.x + targetGapPoint.x) / 2;\n            centerY = points[0].y;\n        }\n        else {\n            centerX = points[0].x;\n            centerY = (sourceGapPoint.y + targetGapPoint.y) / 2;\n        }\n    }\n    const pathPoints = [\n        source,\n        { x: sourceGapped.x + sourceGapOffset.x, y: sourceGapped.y + sourceGapOffset.y },\n        ...points,\n        { x: targetGapped.x + targetGapOffset.x, y: targetGapped.y + targetGapOffset.y },\n        target,\n    ];\n    return [pathPoints, centerX, centerY, defaultOffsetX, defaultOffsetY];\n}\nfunction getBend(a, b, c, size) {\n    const bendSize = Math.min(distance(a, b) / 2, distance(b, c) / 2, size);\n    const { x, y } = b;\n    // no bend\n    if ((a.x === x && x === c.x) || (a.y === y && y === c.y)) {\n        return `L${x} ${y}`;\n    }\n    // first segment is horizontal\n    if (a.y === y) {\n        const xDir = a.x < c.x ? -1 : 1;\n        const yDir = a.y < c.y ? 1 : -1;\n        return `L ${x + bendSize * xDir},${y}Q ${x},${y} ${x},${y + bendSize * yDir}`;\n    }\n    const xDir = a.x < c.x ? 1 : -1;\n    const yDir = a.y < c.y ? -1 : 1;\n    return `L ${x},${y + bendSize * yDir}Q ${x},${y} ${x + bendSize * xDir},${y}`;\n}\n/**\n * Get a smooth step path from source to target handle\n * @param params.sourceX - The x position of the source handle\n * @param params.sourceY - The y position of the source handle\n * @param params.sourcePosition - The position of the source handle (default: Position.Bottom)\n * @param params.targetX - The x position of the target handle\n * @param params.targetY - The y position of the target handle\n * @param params.targetPosition - The position of the target handle (default: Position.Top)\n * @returns A path string you can use in an SVG, the labelX and labelY position (center of path) and offsetX, offsetY between source handle and label\n * @example\n *  const source = { x: 0, y: 20 };\n    const target = { x: 150, y: 100 };\n    \n    const [path, labelX, labelY, offsetX, offsetY] = getSmoothStepPath({\n      sourceX: source.x,\n      sourceY: source.y,\n      sourcePosition: Position.Right,\n      targetX: target.x,\n      targetY: target.y,\n      targetPosition: Position.Left,\n    });\n */\nfunction getSmoothStepPath({ sourceX, sourceY, sourcePosition = Position.Bottom, targetX, targetY, targetPosition = Position.Top, borderRadius = 5, centerX, centerY, offset = 20, }) {\n    const [points, labelX, labelY, offsetX, offsetY] = getPoints({\n        source: { x: sourceX, y: sourceY },\n        sourcePosition,\n        target: { x: targetX, y: targetY },\n        targetPosition,\n        center: { x: centerX, y: centerY },\n        offset,\n    });\n    const path = points.reduce((res, p, i) => {\n        let segment = '';\n        if (i > 0 && i < points.length - 1) {\n            segment = getBend(points[i - 1], p, points[i + 1], borderRadius);\n        }\n        else {\n            segment = `${i === 0 ? 'M' : 'L'}${p.x} ${p.y}`;\n        }\n        res += segment;\n        return res;\n    }, '');\n    return [path, labelX, labelY, offsetX, offsetY];\n}\n\nfunction isNodeInitialized(node) {\n    return (node &&\n        !!(node.internals.handleBounds || node.handles?.length) &&\n        !!(node.measured.width || node.width || node.initialWidth));\n}\nfunction getEdgePosition(params) {\n    const { sourceNode, targetNode } = params;\n    if (!isNodeInitialized(sourceNode) || !isNodeInitialized(targetNode)) {\n        return null;\n    }\n    const sourceHandleBounds = sourceNode.internals.handleBounds || toHandleBounds(sourceNode.handles);\n    const targetHandleBounds = targetNode.internals.handleBounds || toHandleBounds(targetNode.handles);\n    const sourceHandle = getHandle$1(sourceHandleBounds?.source ?? [], params.sourceHandle);\n    const targetHandle = getHandle$1(\n    // when connection type is loose we can define all handles as sources and connect source -> source\n    params.connectionMode === ConnectionMode.Strict\n        ? targetHandleBounds?.target ?? []\n        : (targetHandleBounds?.target ?? []).concat(targetHandleBounds?.source ?? []), params.targetHandle);\n    if (!sourceHandle || !targetHandle) {\n        params.onError?.('008', errorMessages['error008'](!sourceHandle ? 'source' : 'target', {\n            id: params.id,\n            sourceHandle: params.sourceHandle,\n            targetHandle: params.targetHandle,\n        }));\n        return null;\n    }\n    const sourcePosition = sourceHandle?.position || Position.Bottom;\n    const targetPosition = targetHandle?.position || Position.Top;\n    const source = getHandlePosition(sourceNode, sourceHandle, sourcePosition);\n    const target = getHandlePosition(targetNode, targetHandle, targetPosition);\n    return {\n        sourceX: source.x,\n        sourceY: source.y,\n        targetX: target.x,\n        targetY: target.y,\n        sourcePosition,\n        targetPosition,\n    };\n}\nfunction toHandleBounds(handles) {\n    if (!handles) {\n        return null;\n    }\n    const source = [];\n    const target = [];\n    for (const handle of handles) {\n        handle.width = handle.width ?? 1;\n        handle.height = handle.height ?? 1;\n        if (handle.type === 'source') {\n            source.push(handle);\n        }\n        else if (handle.type === 'target') {\n            target.push(handle);\n        }\n    }\n    return {\n        source,\n        target,\n    };\n}\nfunction getHandlePosition(node, handle, fallbackPosition = Position.Left, center = false) {\n    const x = (handle?.x ?? 0) + node.internals.positionAbsolute.x;\n    const y = (handle?.y ?? 0) + node.internals.positionAbsolute.y;\n    const { width, height } = handle ?? getNodeDimensions(node);\n    if (center) {\n        return { x: x + width / 2, y: y + height / 2 };\n    }\n    const position = handle?.position ?? fallbackPosition;\n    switch (position) {\n        case Position.Top:\n            return { x: x + width / 2, y };\n        case Position.Right:\n            return { x: x + width, y: y + height / 2 };\n        case Position.Bottom:\n            return { x: x + width / 2, y: y + height };\n        case Position.Left:\n            return { x, y: y + height / 2 };\n    }\n}\nfunction getHandle$1(bounds, handleId) {\n    if (!bounds) {\n        return null;\n    }\n    // if no handleId is given, we use the first handle, otherwise we check for the id\n    return (!handleId ? bounds[0] : bounds.find((d) => d.id === handleId)) || null;\n}\n\nfunction getMarkerId(marker, id) {\n    if (!marker) {\n        return '';\n    }\n    if (typeof marker === 'string') {\n        return marker;\n    }\n    const idPrefix = id ? `${id}__` : '';\n    return `${idPrefix}${Object.keys(marker)\n        .sort()\n        .map((key) => `${key}=${marker[key]}`)\n        .join('&')}`;\n}\nfunction createMarkerIds(edges, { id, defaultColor, defaultMarkerStart, defaultMarkerEnd, }) {\n    const ids = new Set();\n    return edges\n        .reduce((markers, edge) => {\n        [edge.markerStart || defaultMarkerStart, edge.markerEnd || defaultMarkerEnd].forEach((marker) => {\n            if (marker && typeof marker === 'object') {\n                const markerId = getMarkerId(marker, id);\n                if (!ids.has(markerId)) {\n                    markers.push({ id: markerId, color: marker.color || defaultColor, ...marker });\n                    ids.add(markerId);\n                }\n            }\n        });\n        return markers;\n    }, [])\n        .sort((a, b) => a.id.localeCompare(b.id));\n}\n\nfunction getNodeToolbarTransform(nodeRect, viewport, position, offset, align) {\n    let alignmentOffset = 0.5;\n    if (align === 'start') {\n        alignmentOffset = 0;\n    }\n    else if (align === 'end') {\n        alignmentOffset = 1;\n    }\n    // position === Position.Top\n    // we set the x any y position of the toolbar based on the nodes position\n    let pos = [\n        (nodeRect.x + nodeRect.width * alignmentOffset) * viewport.zoom + viewport.x,\n        nodeRect.y * viewport.zoom + viewport.y - offset,\n    ];\n    // and than shift it based on the alignment. The shift values are in %.\n    let shift = [-100 * alignmentOffset, -100];\n    switch (position) {\n        case Position.Right:\n            pos = [\n                (nodeRect.x + nodeRect.width) * viewport.zoom + viewport.x + offset,\n                (nodeRect.y + nodeRect.height * alignmentOffset) * viewport.zoom + viewport.y,\n            ];\n            shift = [0, -100 * alignmentOffset];\n            break;\n        case Position.Bottom:\n            pos[1] = (nodeRect.y + nodeRect.height) * viewport.zoom + viewport.y + offset;\n            shift[1] = 0;\n            break;\n        case Position.Left:\n            pos = [\n                nodeRect.x * viewport.zoom + viewport.x - offset,\n                (nodeRect.y + nodeRect.height * alignmentOffset) * viewport.zoom + viewport.y,\n            ];\n            shift = [-100, -100 * alignmentOffset];\n            break;\n    }\n    return `translate(${pos[0]}px, ${pos[1]}px) translate(${shift[0]}%, ${shift[1]}%)`;\n}\n\nconst defaultOptions = {\n    nodeOrigin: [0, 0],\n    nodeExtent: infiniteExtent,\n    elevateNodesOnSelect: true,\n    defaults: {},\n};\nconst adoptUserNodesDefaultOptions = {\n    ...defaultOptions,\n    checkEquality: true,\n};\nfunction mergeObjects(base, incoming) {\n    const result = { ...base };\n    for (const key in incoming) {\n        if (incoming[key] !== undefined) {\n            // typecast is safe here, because we check for undefined\n            result[key] = incoming[key];\n        }\n    }\n    return result;\n}\nfunction updateAbsolutePositions(nodeLookup, parentLookup, options) {\n    const _options = mergeObjects(defaultOptions, options);\n    for (const node of nodeLookup.values()) {\n        if (!node.parentId) {\n            continue;\n        }\n        updateChildNode(node, nodeLookup, parentLookup, _options);\n    }\n}\nfunction adoptUserNodes(nodes, nodeLookup, parentLookup, options) {\n    const _options = mergeObjects(adoptUserNodesDefaultOptions, options);\n    const tmpLookup = new Map(nodeLookup);\n    const selectedNodeZ = _options?.elevateNodesOnSelect ? 1000 : 0;\n    nodeLookup.clear();\n    parentLookup.clear();\n    for (const userNode of nodes) {\n        let internalNode = tmpLookup.get(userNode.id);\n        if (_options.checkEquality && userNode === internalNode?.internals.userNode) {\n            nodeLookup.set(userNode.id, internalNode);\n        }\n        else {\n            const positionWithOrigin = getNodePositionWithOrigin(userNode, _options.nodeOrigin);\n            const extent = isCoordinateExtent(userNode.extent) ? userNode.extent : _options.nodeExtent;\n            const clampedPosition = clampPosition(positionWithOrigin, extent, getNodeDimensions(userNode));\n            internalNode = {\n                ..._options.defaults,\n                ...userNode,\n                measured: {\n                    width: userNode.measured?.width,\n                    height: userNode.measured?.height,\n                },\n                internals: {\n                    positionAbsolute: clampedPosition,\n                    // if user re-initializes the node or removes `measured` for whatever reason, we reset the handleBounds so that the node gets re-measured\n                    handleBounds: !userNode.measured ? undefined : internalNode?.internals.handleBounds,\n                    z: calculateZ(userNode, selectedNodeZ),\n                    userNode,\n                },\n            };\n            nodeLookup.set(userNode.id, internalNode);\n        }\n        if (userNode.parentId) {\n            updateChildNode(internalNode, nodeLookup, parentLookup, options);\n        }\n    }\n}\nfunction updateParentLookup(node, parentLookup) {\n    if (!node.parentId) {\n        return;\n    }\n    const childNodes = parentLookup.get(node.parentId);\n    if (childNodes) {\n        childNodes.set(node.id, node);\n    }\n    else {\n        parentLookup.set(node.parentId, new Map([[node.id, node]]));\n    }\n}\n/**\n * Updates positionAbsolute and zIndex of a child node and the parentLookup.\n */\nfunction updateChildNode(node, nodeLookup, parentLookup, options) {\n    const { elevateNodesOnSelect, nodeOrigin, nodeExtent } = mergeObjects(defaultOptions, options);\n    const parentId = node.parentId;\n    const parentNode = nodeLookup.get(parentId);\n    if (!parentNode) {\n        console.warn(`Parent node ${parentId} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);\n        return;\n    }\n    updateParentLookup(node, parentLookup);\n    const selectedNodeZ = elevateNodesOnSelect ? 1000 : 0;\n    const { x, y, z } = calculateChildXYZ(node, parentNode, nodeOrigin, nodeExtent, selectedNodeZ);\n    const { positionAbsolute } = node.internals;\n    const positionChanged = x !== positionAbsolute.x || y !== positionAbsolute.y;\n    if (positionChanged || z !== node.internals.z) {\n        node.internals = {\n            ...node.internals,\n            positionAbsolute: positionChanged ? { x, y } : positionAbsolute,\n            z,\n        };\n    }\n}\nfunction calculateZ(node, selectedNodeZ) {\n    return (isNumeric(node.zIndex) ? node.zIndex : 0) + (node.selected ? selectedNodeZ : 0);\n}\nfunction calculateChildXYZ(childNode, parentNode, nodeOrigin, nodeExtent, selectedNodeZ) {\n    const { x: parentX, y: parentY } = parentNode.internals.positionAbsolute;\n    const childDimensions = getNodeDimensions(childNode);\n    const positionWithOrigin = getNodePositionWithOrigin(childNode, nodeOrigin);\n    const clampedPosition = isCoordinateExtent(childNode.extent)\n        ? clampPosition(positionWithOrigin, childNode.extent, childDimensions)\n        : positionWithOrigin;\n    let absolutePosition = clampPosition({ x: parentX + clampedPosition.x, y: parentY + clampedPosition.y }, nodeExtent, childDimensions);\n    if (childNode.extent === 'parent') {\n        absolutePosition = clampPositionToParent(absolutePosition, childDimensions, parentNode);\n    }\n    const childZ = calculateZ(childNode, selectedNodeZ);\n    const parentZ = parentNode.internals.z ?? 0;\n    return {\n        x: absolutePosition.x,\n        y: absolutePosition.y,\n        z: parentZ > childZ ? parentZ : childZ,\n    };\n}\nfunction handleExpandParent(children, nodeLookup, parentLookup, nodeOrigin = [0, 0]) {\n    const changes = [];\n    const parentExpansions = new Map();\n    // determine the expanded rectangle the child nodes would take for each parent\n    for (const child of children) {\n        const parent = nodeLookup.get(child.parentId);\n        if (!parent) {\n            continue;\n        }\n        const parentRect = parentExpansions.get(child.parentId)?.expandedRect ?? nodeToRect(parent);\n        const expandedRect = getBoundsOfRects(parentRect, child.rect);\n        parentExpansions.set(child.parentId, { expandedRect, parent });\n    }\n    if (parentExpansions.size > 0) {\n        parentExpansions.forEach(({ expandedRect, parent }, parentId) => {\n            // determine the position & dimensions of the parent\n            const positionAbsolute = parent.internals.positionAbsolute;\n            const dimensions = getNodeDimensions(parent);\n            const origin = parent.origin ?? nodeOrigin;\n            // determine how much the parent expands in width and position\n            const xChange = expandedRect.x < positionAbsolute.x ? Math.round(Math.abs(positionAbsolute.x - expandedRect.x)) : 0;\n            const yChange = expandedRect.y < positionAbsolute.y ? Math.round(Math.abs(positionAbsolute.y - expandedRect.y)) : 0;\n            const newWidth = Math.max(dimensions.width, Math.round(expandedRect.width));\n            const newHeight = Math.max(dimensions.height, Math.round(expandedRect.height));\n            const widthChange = (newWidth - dimensions.width) * origin[0];\n            const heightChange = (newHeight - dimensions.height) * origin[1];\n            // We need to correct the position of the parent node if the origin is not [0,0]\n            if (xChange > 0 || yChange > 0 || widthChange || heightChange) {\n                changes.push({\n                    id: parentId,\n                    type: 'position',\n                    position: {\n                        x: parent.position.x - xChange + widthChange,\n                        y: parent.position.y - yChange + heightChange,\n                    },\n                });\n                // We move all child nodes in the oppsite direction\n                // so the x,y changes of the parent do not move the children\n                parentLookup.get(parentId)?.forEach((childNode) => {\n                    if (!children.some((child) => child.id === childNode.id)) {\n                        changes.push({\n                            id: childNode.id,\n                            type: 'position',\n                            position: {\n                                x: childNode.position.x + xChange,\n                                y: childNode.position.y + yChange,\n                            },\n                        });\n                    }\n                });\n            }\n            // We need to correct the dimensions of the parent node if the origin is not [0,0]\n            if (dimensions.width < expandedRect.width || dimensions.height < expandedRect.height || xChange || yChange) {\n                changes.push({\n                    id: parentId,\n                    type: 'dimensions',\n                    setAttributes: true,\n                    dimensions: {\n                        width: newWidth + (xChange ? origin[0] * xChange - widthChange : 0),\n                        height: newHeight + (yChange ? origin[1] * yChange - heightChange : 0),\n                    },\n                });\n            }\n        });\n    }\n    return changes;\n}\nfunction updateNodeInternals(updates, nodeLookup, parentLookup, domNode, nodeOrigin, nodeExtent) {\n    const viewportNode = domNode?.querySelector('.xyflow__viewport');\n    let updatedInternals = false;\n    if (!viewportNode) {\n        return { changes: [], updatedInternals };\n    }\n    const changes = [];\n    const style = window.getComputedStyle(viewportNode);\n    const { m22: zoom } = new window.DOMMatrixReadOnly(style.transform);\n    // in this array we collect nodes, that might trigger changes (like expanding parent)\n    const parentExpandChildren = [];\n    for (const update of updates.values()) {\n        const node = nodeLookup.get(update.id);\n        if (!node) {\n            continue;\n        }\n        if (node.hidden) {\n            node.internals = {\n                ...node.internals,\n                handleBounds: undefined,\n            };\n            updatedInternals = true;\n        }\n        else {\n            const dimensions = getDimensions(update.nodeElement);\n            const dimensionChanged = node.measured.width !== dimensions.width || node.measured.height !== dimensions.height;\n            const doUpdate = !!(dimensions.width &&\n                dimensions.height &&\n                (dimensionChanged || !node.internals.handleBounds || update.force));\n            if (doUpdate) {\n                const nodeBounds = update.nodeElement.getBoundingClientRect();\n                const extent = isCoordinateExtent(node.extent) ? node.extent : nodeExtent;\n                let { positionAbsolute } = node.internals;\n                if (node.parentId && node.extent === 'parent') {\n                    positionAbsolute = clampPositionToParent(positionAbsolute, dimensions, nodeLookup.get(node.parentId));\n                }\n                else if (extent) {\n                    positionAbsolute = clampPosition(positionAbsolute, extent, dimensions);\n                }\n                node.measured = dimensions;\n                node.internals = {\n                    ...node.internals,\n                    positionAbsolute,\n                    handleBounds: {\n                        source: getHandleBounds('source', update.nodeElement, nodeBounds, zoom, node.id),\n                        target: getHandleBounds('target', update.nodeElement, nodeBounds, zoom, node.id),\n                    },\n                };\n                if (node.parentId) {\n                    updateChildNode(node, nodeLookup, parentLookup, { nodeOrigin });\n                }\n                updatedInternals = true;\n                if (dimensionChanged) {\n                    changes.push({\n                        id: node.id,\n                        type: 'dimensions',\n                        dimensions,\n                    });\n                    if (node.expandParent && node.parentId) {\n                        parentExpandChildren.push({\n                            id: node.id,\n                            parentId: node.parentId,\n                            rect: nodeToRect(node, nodeOrigin),\n                        });\n                    }\n                }\n            }\n        }\n    }\n    if (parentExpandChildren.length > 0) {\n        const parentExpandChanges = handleExpandParent(parentExpandChildren, nodeLookup, parentLookup, nodeOrigin);\n        changes.push(...parentExpandChanges);\n    }\n    return { changes, updatedInternals };\n}\nasync function panBy({ delta, panZoom, transform, translateExtent, width, height, }) {\n    if (!panZoom || (!delta.x && !delta.y)) {\n        return Promise.resolve(false);\n    }\n    const nextViewport = await panZoom.setViewportConstrained({\n        x: transform[0] + delta.x,\n        y: transform[1] + delta.y,\n        zoom: transform[2],\n    }, [\n        [0, 0],\n        [width, height],\n    ], translateExtent);\n    const transformChanged = !!nextViewport &&\n        (nextViewport.x !== transform[0] || nextViewport.y !== transform[1] || nextViewport.k !== transform[2]);\n    return Promise.resolve(transformChanged);\n}\nfunction updateConnectionLookup(connectionLookup, edgeLookup, edges) {\n    connectionLookup.clear();\n    edgeLookup.clear();\n    for (const edge of edges) {\n        const { source, target, sourceHandle = null, targetHandle = null } = edge;\n        const sourceKey = `${source}-source-${sourceHandle}`;\n        const targetKey = `${target}-target-${targetHandle}`;\n        const prevSource = connectionLookup.get(sourceKey) || new Map();\n        const prevTarget = connectionLookup.get(targetKey) || new Map();\n        const connection = { edgeId: edge.id, source, target, sourceHandle, targetHandle };\n        edgeLookup.set(edge.id, edge);\n        connectionLookup.set(sourceKey, prevSource.set(`${target}-${targetHandle}`, connection));\n        connectionLookup.set(targetKey, prevTarget.set(`${source}-${sourceHandle}`, connection));\n    }\n}\n\nfunction shallowNodeData(a, b) {\n    if (a === null || b === null) {\n        return false;\n    }\n    const _a = Array.isArray(a) ? a : [a];\n    const _b = Array.isArray(b) ? b : [b];\n    if (_a.length !== _b.length) {\n        return false;\n    }\n    for (let i = 0; i < _a.length; i++) {\n        if (_a[i].id !== _b[i].id || _a[i].type !== _b[i].type || !Object.is(_a[i].data, _b[i].data)) {\n            return false;\n        }\n    }\n    return true;\n}\n\nfunction isParentSelected(node, nodeLookup) {\n    if (!node.parentId) {\n        return false;\n    }\n    const parentNode = nodeLookup.get(node.parentId);\n    if (!parentNode) {\n        return false;\n    }\n    if (parentNode.selected) {\n        return true;\n    }\n    return isParentSelected(parentNode, nodeLookup);\n}\nfunction hasSelector(target, selector, domNode) {\n    let current = target;\n    do {\n        if (current?.matches(selector))\n            return true;\n        if (current === domNode)\n            return false;\n        current = current.parentElement;\n    } while (current);\n    return false;\n}\n// looks for all selected nodes and created a NodeDragItem for each of them\nfunction getDragItems(nodeLookup, nodesDraggable, mousePos, nodeId) {\n    const dragItems = new Map();\n    for (const [id, node] of nodeLookup) {\n        if ((node.selected || node.id === nodeId) &&\n            (!node.parentId || !isParentSelected(node, nodeLookup)) &&\n            (node.draggable || (nodesDraggable && typeof node.draggable === 'undefined'))) {\n            const internalNode = nodeLookup.get(id);\n            if (internalNode) {\n                dragItems.set(id, {\n                    id,\n                    position: internalNode.position || { x: 0, y: 0 },\n                    distance: {\n                        x: mousePos.x - internalNode.internals.positionAbsolute.x,\n                        y: mousePos.y - internalNode.internals.positionAbsolute.y,\n                    },\n                    extent: internalNode.extent,\n                    parentId: internalNode.parentId,\n                    origin: internalNode.origin,\n                    expandParent: internalNode.expandParent,\n                    internals: {\n                        positionAbsolute: internalNode.internals.positionAbsolute || { x: 0, y: 0 },\n                    },\n                    measured: {\n                        width: internalNode.measured.width ?? 0,\n                        height: internalNode.measured.height ?? 0,\n                    },\n                });\n            }\n        }\n    }\n    return dragItems;\n}\n// returns two params:\n// 1. the dragged node (or the first of the list, if we are dragging a node selection)\n// 2. array of selected nodes (for multi selections)\nfunction getEventHandlerParams({ nodeId, dragItems, nodeLookup, dragging = true, }) {\n    const nodesFromDragItems = [];\n    for (const [id, dragItem] of dragItems) {\n        const node = nodeLookup.get(id)?.internals.userNode;\n        if (node) {\n            nodesFromDragItems.push({\n                ...node,\n                position: dragItem.position,\n                dragging,\n            });\n        }\n    }\n    if (!nodeId) {\n        return [nodesFromDragItems[0], nodesFromDragItems];\n    }\n    const node = nodeLookup.get(nodeId).internals.userNode;\n    return [\n        {\n            ...node,\n            position: dragItems.get(nodeId)?.position || node.position,\n            dragging,\n        },\n        nodesFromDragItems,\n    ];\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction XYDrag({ onNodeMouseDown, getStoreItems, onDragStart, onDrag, onDragStop, }) {\n    let lastPos = { x: null, y: null };\n    let autoPanId = 0;\n    let dragItems = new Map();\n    let autoPanStarted = false;\n    let mousePosition = { x: 0, y: 0 };\n    let containerBounds = null;\n    let dragStarted = false;\n    let d3Selection = null;\n    let abortDrag = false; // prevents unintentional dragging on multitouch\n    // public functions\n    function update({ noDragClassName, handleSelector, domNode, isSelectable, nodeId, nodeClickDistance = 0, }) {\n        d3Selection = select(domNode);\n        function updateNodes({ x, y }, dragEvent) {\n            const { nodeLookup, nodeExtent, snapGrid, snapToGrid, nodeOrigin, onNodeDrag, onSelectionDrag, onError, updateNodePositions, } = getStoreItems();\n            lastPos = { x, y };\n            let hasChange = false;\n            let nodesBox = { x: 0, y: 0, x2: 0, y2: 0 };\n            if (dragItems.size > 1 && nodeExtent) {\n                const rect = getInternalNodesBounds(dragItems);\n                nodesBox = rectToBox(rect);\n            }\n            for (const [id, dragItem] of dragItems) {\n                let nextPosition = { x: x - dragItem.distance.x, y: y - dragItem.distance.y };\n                if (snapToGrid) {\n                    nextPosition = snapPosition(nextPosition, snapGrid);\n                }\n                // if there is selection with multiple nodes and a node extent is set, we need to adjust the node extent for each node\n                // based on its position so that the node stays at it's position relative to the selection.\n                let adjustedNodeExtent = [\n                    [nodeExtent[0][0], nodeExtent[0][1]],\n                    [nodeExtent[1][0], nodeExtent[1][1]],\n                ];\n                if (dragItems.size > 1 && nodeExtent && !dragItem.extent) {\n                    const { positionAbsolute } = dragItem.internals;\n                    const x1 = positionAbsolute.x - nodesBox.x + nodeExtent[0][0];\n                    const x2 = positionAbsolute.x + dragItem.measured.width - nodesBox.x2 + nodeExtent[1][0];\n                    const y1 = positionAbsolute.y - nodesBox.y + nodeExtent[0][1];\n                    const y2 = positionAbsolute.y + dragItem.measured.height - nodesBox.y2 + nodeExtent[1][1];\n                    adjustedNodeExtent = [\n                        [x1, y1],\n                        [x2, y2],\n                    ];\n                }\n                const { position, positionAbsolute } = calculateNodePosition({\n                    nodeId: id,\n                    nextPosition,\n                    nodeLookup,\n                    nodeExtent: adjustedNodeExtent,\n                    nodeOrigin,\n                    onError,\n                });\n                // we want to make sure that we only fire a change event when there is a change\n                hasChange = hasChange || dragItem.position.x !== position.x || dragItem.position.y !== position.y;\n                dragItem.position = position;\n                dragItem.internals.positionAbsolute = positionAbsolute;\n            }\n            if (!hasChange) {\n                return;\n            }\n            updateNodePositions(dragItems, true);\n            if (dragEvent && (onDrag || onNodeDrag || (!nodeId && onSelectionDrag))) {\n                const [currentNode, currentNodes] = getEventHandlerParams({\n                    nodeId,\n                    dragItems,\n                    nodeLookup,\n                });\n                onDrag?.(dragEvent, dragItems, currentNode, currentNodes);\n                onNodeDrag?.(dragEvent, currentNode, currentNodes);\n                if (!nodeId) {\n                    onSelectionDrag?.(dragEvent, currentNodes);\n                }\n            }\n        }\n        async function autoPan() {\n            if (!containerBounds) {\n                return;\n            }\n            const { transform, panBy, autoPanSpeed } = getStoreItems();\n            const [xMovement, yMovement] = calcAutoPan(mousePosition, containerBounds, autoPanSpeed);\n            if (xMovement !== 0 || yMovement !== 0) {\n                lastPos.x = (lastPos.x ?? 0) - xMovement / transform[2];\n                lastPos.y = (lastPos.y ?? 0) - yMovement / transform[2];\n                if (await panBy({ x: xMovement, y: yMovement })) {\n                    updateNodes(lastPos, null);\n                }\n            }\n            autoPanId = requestAnimationFrame(autoPan);\n        }\n        function startDrag(event) {\n            const { nodeLookup, multiSelectionActive, nodesDraggable, transform, snapGrid, snapToGrid, selectNodesOnDrag, onNodeDragStart, onSelectionDragStart, unselectNodesAndEdges, } = getStoreItems();\n            dragStarted = true;\n            if ((!selectNodesOnDrag || !isSelectable) && !multiSelectionActive && nodeId) {\n                if (!nodeLookup.get(nodeId)?.selected) {\n                    // we need to reset selected nodes when selectNodesOnDrag=false\n                    unselectNodesAndEdges();\n                }\n            }\n            if (isSelectable && selectNodesOnDrag && nodeId) {\n                onNodeMouseDown?.(nodeId);\n            }\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid });\n            lastPos = pointerPos;\n            dragItems = getDragItems(nodeLookup, nodesDraggable, pointerPos, nodeId);\n            if (dragItems.size > 0 && (onDragStart || onNodeDragStart || (!nodeId && onSelectionDragStart))) {\n                const [currentNode, currentNodes] = getEventHandlerParams({\n                    nodeId,\n                    dragItems,\n                    nodeLookup,\n                });\n                onDragStart?.(event.sourceEvent, dragItems, currentNode, currentNodes);\n                onNodeDragStart?.(event.sourceEvent, currentNode, currentNodes);\n                if (!nodeId) {\n                    onSelectionDragStart?.(event.sourceEvent, currentNodes);\n                }\n            }\n        }\n        const d3DragInstance = drag()\n            .clickDistance(nodeClickDistance)\n            .on('start', (event) => {\n            const { domNode, nodeDragThreshold, transform, snapGrid, snapToGrid } = getStoreItems();\n            abortDrag = false;\n            if (nodeDragThreshold === 0) {\n                startDrag(event);\n            }\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid });\n            lastPos = pointerPos;\n            containerBounds = domNode?.getBoundingClientRect() || null;\n            mousePosition = getEventPosition(event.sourceEvent, containerBounds);\n        })\n            .on('drag', (event) => {\n            const { autoPanOnNodeDrag, transform, snapGrid, snapToGrid, nodeDragThreshold } = getStoreItems();\n            const pointerPos = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid });\n            if (event.sourceEvent.type === 'touchmove' && event.sourceEvent.touches.length > 1) {\n                abortDrag = true;\n            }\n            if (abortDrag) {\n                return;\n            }\n            if (!autoPanStarted && autoPanOnNodeDrag && dragStarted) {\n                autoPanStarted = true;\n                autoPan();\n            }\n            if (!dragStarted) {\n                const x = pointerPos.xSnapped - (lastPos.x ?? 0);\n                const y = pointerPos.ySnapped - (lastPos.y ?? 0);\n                const distance = Math.sqrt(x * x + y * y);\n                if (distance > nodeDragThreshold) {\n                    startDrag(event);\n                }\n            }\n            // skip events without movement\n            if ((lastPos.x !== pointerPos.xSnapped || lastPos.y !== pointerPos.ySnapped) && dragItems && dragStarted) {\n                // dragEvent = event.sourceEvent as MouseEvent;\n                mousePosition = getEventPosition(event.sourceEvent, containerBounds);\n                updateNodes(pointerPos, event.sourceEvent);\n            }\n        })\n            .on('end', (event) => {\n            if (!dragStarted || abortDrag) {\n                return;\n            }\n            autoPanStarted = false;\n            dragStarted = false;\n            cancelAnimationFrame(autoPanId);\n            if (dragItems.size > 0) {\n                const { nodeLookup, updateNodePositions, onNodeDragStop, onSelectionDragStop } = getStoreItems();\n                updateNodePositions(dragItems, false);\n                if (onDragStop || onNodeDragStop || (!nodeId && onSelectionDragStop)) {\n                    const [currentNode, currentNodes] = getEventHandlerParams({\n                        nodeId,\n                        dragItems,\n                        nodeLookup,\n                        dragging: false,\n                    });\n                    onDragStop?.(event.sourceEvent, dragItems, currentNode, currentNodes);\n                    onNodeDragStop?.(event.sourceEvent, currentNode, currentNodes);\n                    if (!nodeId) {\n                        onSelectionDragStop?.(event.sourceEvent, currentNodes);\n                    }\n                }\n            }\n        })\n            .filter((event) => {\n            const target = event.target;\n            const isDraggable = !event.button &&\n                (!noDragClassName || !hasSelector(target, `.${noDragClassName}`, domNode)) &&\n                (!handleSelector || hasSelector(target, handleSelector, domNode));\n            return isDraggable;\n        });\n        d3Selection.call(d3DragInstance);\n    }\n    function destroy() {\n        d3Selection?.on('.drag', null);\n    }\n    return {\n        update,\n        destroy,\n    };\n}\n\nfunction getNodesWithinDistance(position, nodeLookup, distance) {\n    const nodes = [];\n    const rect = {\n        x: position.x - distance,\n        y: position.y - distance,\n        width: distance * 2,\n        height: distance * 2,\n    };\n    for (const node of nodeLookup.values()) {\n        if (getOverlappingArea(rect, nodeToRect(node)) > 0) {\n            nodes.push(node);\n        }\n    }\n    return nodes;\n}\n// this distance is used for the area around the user pointer\n// while doing a connection for finding the closest nodes\nconst ADDITIONAL_DISTANCE = 250;\nfunction getClosestHandle(position, connectionRadius, nodeLookup, fromHandle) {\n    let closestHandles = [];\n    let minDistance = Infinity;\n    const closeNodes = getNodesWithinDistance(position, nodeLookup, connectionRadius + ADDITIONAL_DISTANCE);\n    for (const node of closeNodes) {\n        const allHandles = [...(node.internals.handleBounds?.source ?? []), ...(node.internals.handleBounds?.target ?? [])];\n        for (const handle of allHandles) {\n            // if the handle is the same as the fromHandle we skip it\n            if (fromHandle.nodeId === handle.nodeId && fromHandle.type === handle.type && fromHandle.id === handle.id) {\n                continue;\n            }\n            // determine absolute position of the handle\n            const { x, y } = getHandlePosition(node, handle, handle.position, true);\n            const distance = Math.sqrt(Math.pow(x - position.x, 2) + Math.pow(y - position.y, 2));\n            if (distance > connectionRadius) {\n                continue;\n            }\n            if (distance < minDistance) {\n                closestHandles = [{ ...handle, x, y }];\n                minDistance = distance;\n            }\n            else if (distance === minDistance) {\n                // when multiple handles are on the same distance we collect all of them\n                closestHandles.push({ ...handle, x, y });\n            }\n        }\n    }\n    if (!closestHandles.length) {\n        return null;\n    }\n    // when multiple handles overlay each other we prefer the opposite handle\n    if (closestHandles.length > 1) {\n        const oppositeHandleType = fromHandle.type === 'source' ? 'target' : 'source';\n        return closestHandles.find((handle) => handle.type === oppositeHandleType) ?? closestHandles[0];\n    }\n    return closestHandles[0];\n}\nfunction getHandle(nodeId, handleType, handleId, nodeLookup, connectionMode, withAbsolutePosition = false) {\n    const node = nodeLookup.get(nodeId);\n    if (!node) {\n        return null;\n    }\n    const handles = connectionMode === 'strict'\n        ? node.internals.handleBounds?.[handleType]\n        : [...(node.internals.handleBounds?.source ?? []), ...(node.internals.handleBounds?.target ?? [])];\n    const handle = (handleId ? handles?.find((h) => h.id === handleId) : handles?.[0]) ?? null;\n    return handle && withAbsolutePosition\n        ? { ...handle, ...getHandlePosition(node, handle, handle.position, true) }\n        : handle;\n}\nfunction getHandleType(edgeUpdaterType, handleDomNode) {\n    if (edgeUpdaterType) {\n        return edgeUpdaterType;\n    }\n    else if (handleDomNode?.classList.contains('target')) {\n        return 'target';\n    }\n    else if (handleDomNode?.classList.contains('source')) {\n        return 'source';\n    }\n    return null;\n}\nfunction isConnectionValid(isInsideConnectionRadius, isHandleValid) {\n    let isValid = null;\n    if (isHandleValid) {\n        isValid = true;\n    }\n    else if (isInsideConnectionRadius && !isHandleValid) {\n        isValid = false;\n    }\n    return isValid;\n}\n\nconst alwaysValid = () => true;\nfunction onPointerDown(event, { connectionMode, connectionRadius, handleId, nodeId, edgeUpdaterType, isTarget, domNode, nodeLookup, lib, autoPanOnConnect, flowId, panBy, cancelConnection, onConnectStart, onConnect, onConnectEnd, isValidConnection = alwaysValid, onReconnectEnd, updateConnection, getTransform, getFromHandle, autoPanSpeed, }) {\n    // when xyflow is used inside a shadow root we can't use document\n    const doc = getHostForElement(event.target);\n    let autoPanId = 0;\n    let closestHandle;\n    const { x, y } = getEventPosition(event);\n    const clickedHandle = doc?.elementFromPoint(x, y);\n    const handleType = getHandleType(edgeUpdaterType, clickedHandle);\n    const containerBounds = domNode?.getBoundingClientRect();\n    if (!containerBounds || !handleType) {\n        return;\n    }\n    const fromHandleInternal = getHandle(nodeId, handleType, handleId, nodeLookup, connectionMode);\n    if (!fromHandleInternal) {\n        return;\n    }\n    let position = getEventPosition(event, containerBounds);\n    let autoPanStarted = false;\n    let connection = null;\n    let isValid = false;\n    let handleDomNode = null;\n    // when the user is moving the mouse close to the edge of the canvas while connecting we move the canvas\n    function autoPan() {\n        if (!autoPanOnConnect || !containerBounds) {\n            return;\n        }\n        const [x, y] = calcAutoPan(position, containerBounds, autoPanSpeed);\n        panBy({ x, y });\n        autoPanId = requestAnimationFrame(autoPan);\n    }\n    // Stays the same for all consecutive pointermove events\n    const fromHandle = {\n        ...fromHandleInternal,\n        nodeId,\n        type: handleType,\n        position: fromHandleInternal.position,\n    };\n    const fromNodeInternal = nodeLookup.get(nodeId);\n    const from = getHandlePosition(fromNodeInternal, fromHandle, Position.Left, true);\n    const newConnection = {\n        inProgress: true,\n        isValid: null,\n        from,\n        fromHandle,\n        fromPosition: fromHandle.position,\n        fromNode: fromNodeInternal,\n        to: position,\n        toHandle: null,\n        toPosition: oppositePosition[fromHandle.position],\n        toNode: null,\n    };\n    updateConnection(newConnection);\n    let previousConnection = newConnection;\n    onConnectStart?.(event, { nodeId, handleId, handleType });\n    function onPointerMove(event) {\n        if (!getFromHandle() || !fromHandle) {\n            onPointerUp(event);\n            return;\n        }\n        const transform = getTransform();\n        position = getEventPosition(event, containerBounds);\n        closestHandle = getClosestHandle(pointToRendererPoint(position, transform, false, [1, 1]), connectionRadius, nodeLookup, fromHandle);\n        if (!autoPanStarted) {\n            autoPan();\n            autoPanStarted = true;\n        }\n        const result = isValidHandle(event, {\n            handle: closestHandle,\n            connectionMode,\n            fromNodeId: nodeId,\n            fromHandleId: handleId,\n            fromType: isTarget ? 'target' : 'source',\n            isValidConnection,\n            doc,\n            lib,\n            flowId,\n            nodeLookup,\n        });\n        handleDomNode = result.handleDomNode;\n        connection = result.connection;\n        isValid = isConnectionValid(!!closestHandle, result.isValid);\n        const newConnection = {\n            // from stays the same\n            ...previousConnection,\n            isValid,\n            to: closestHandle && isValid\n                ? rendererPointToPoint({ x: closestHandle.x, y: closestHandle.y }, transform)\n                : position,\n            toHandle: result.toHandle,\n            toPosition: isValid && result.toHandle ? result.toHandle.position : oppositePosition[fromHandle.position],\n            toNode: result.toHandle ? nodeLookup.get(result.toHandle.nodeId) : null,\n        };\n        // we don't want to trigger an update when the connection\n        // is snapped to the same handle as before\n        if (isValid &&\n            closestHandle &&\n            previousConnection.toHandle &&\n            newConnection.toHandle &&\n            previousConnection.toHandle.type === newConnection.toHandle.type &&\n            previousConnection.toHandle.nodeId === newConnection.toHandle.nodeId &&\n            previousConnection.toHandle.id === newConnection.toHandle.id &&\n            previousConnection.to.x === newConnection.to.x &&\n            previousConnection.to.y === newConnection.to.y) {\n            return;\n        }\n        updateConnection(newConnection);\n        previousConnection = newConnection;\n    }\n    function onPointerUp(event) {\n        if ((closestHandle || handleDomNode) && connection && isValid) {\n            onConnect?.(connection);\n        }\n        // it's important to get a fresh reference from the store here\n        // in order to get the latest state of onConnectEnd\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const { inProgress, ...connectionState } = previousConnection;\n        const finalConnectionState = {\n            ...connectionState,\n            toPosition: previousConnection.toHandle ? previousConnection.toPosition : null,\n        };\n        onConnectEnd?.(event, finalConnectionState);\n        if (edgeUpdaterType) {\n            onReconnectEnd?.(event, finalConnectionState);\n        }\n        cancelConnection();\n        cancelAnimationFrame(autoPanId);\n        autoPanStarted = false;\n        isValid = false;\n        connection = null;\n        handleDomNode = null;\n        doc.removeEventListener('mousemove', onPointerMove);\n        doc.removeEventListener('mouseup', onPointerUp);\n        doc.removeEventListener('touchmove', onPointerMove);\n        doc.removeEventListener('touchend', onPointerUp);\n    }\n    doc.addEventListener('mousemove', onPointerMove);\n    doc.addEventListener('mouseup', onPointerUp);\n    doc.addEventListener('touchmove', onPointerMove);\n    doc.addEventListener('touchend', onPointerUp);\n}\n// checks if  and returns connection in fom of an object { source: 123, target: 312 }\nfunction isValidHandle(event, { handle, connectionMode, fromNodeId, fromHandleId, fromType, doc, lib, flowId, isValidConnection = alwaysValid, nodeLookup, }) {\n    const isTarget = fromType === 'target';\n    const handleDomNode = handle\n        ? doc.querySelector(`.${lib}-flow__handle[data-id=\"${flowId}-${handle?.nodeId}-${handle?.id}-${handle?.type}\"]`)\n        : null;\n    const { x, y } = getEventPosition(event);\n    const handleBelow = doc.elementFromPoint(x, y);\n    // we always want to prioritize the handle below the mouse cursor over the closest distance handle,\n    // because it could be that the center of another handle is closer to the mouse pointer than the handle below the cursor\n    const handleToCheck = handleBelow?.classList.contains(`${lib}-flow__handle`) ? handleBelow : handleDomNode;\n    const result = {\n        handleDomNode: handleToCheck,\n        isValid: false,\n        connection: null,\n        toHandle: null,\n    };\n    if (handleToCheck) {\n        const handleType = getHandleType(undefined, handleToCheck);\n        const handleNodeId = handleToCheck.getAttribute('data-nodeid');\n        const handleId = handleToCheck.getAttribute('data-handleid');\n        const connectable = handleToCheck.classList.contains('connectable');\n        const connectableEnd = handleToCheck.classList.contains('connectableend');\n        if (!handleNodeId || !handleType) {\n            return result;\n        }\n        const connection = {\n            source: isTarget ? handleNodeId : fromNodeId,\n            sourceHandle: isTarget ? handleId : fromHandleId,\n            target: isTarget ? fromNodeId : handleNodeId,\n            targetHandle: isTarget ? fromHandleId : handleId,\n        };\n        result.connection = connection;\n        const isConnectable = connectable && connectableEnd;\n        // in strict mode we don't allow target to target or source to source connections\n        const isValid = isConnectable &&\n            (connectionMode === ConnectionMode.Strict\n                ? (isTarget && handleType === 'source') || (!isTarget && handleType === 'target')\n                : handleNodeId !== fromNodeId || handleId !== fromHandleId);\n        result.isValid = isValid && isValidConnection(connection);\n        result.toHandle = getHandle(handleNodeId, handleType, handleId, nodeLookup, connectionMode, false);\n    }\n    return result;\n}\nconst XYHandle = {\n    onPointerDown,\n    isValid: isValidHandle,\n};\n\nfunction XYMinimap({ domNode, panZoom, getTransform, getViewScale }) {\n    const selection = select(domNode);\n    function update({ translateExtent, width, height, zoomStep = 10, pannable = true, zoomable = true, inversePan = false, }) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const zoomHandler = (event) => {\n            const transform = getTransform();\n            if (event.sourceEvent.type !== 'wheel' || !panZoom) {\n                return;\n            }\n            const pinchDelta = -event.sourceEvent.deltaY *\n                (event.sourceEvent.deltaMode === 1 ? 0.05 : event.sourceEvent.deltaMode ? 1 : 0.002) *\n                zoomStep;\n            const nextZoom = transform[2] * Math.pow(2, pinchDelta);\n            panZoom.scaleTo(nextZoom);\n        };\n        let panStart = [0, 0];\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const panStartHandler = (event) => {\n            if (event.sourceEvent.type === 'mousedown' || event.sourceEvent.type === 'touchstart') {\n                panStart = [\n                    event.sourceEvent.clientX ?? event.sourceEvent.touches[0].clientX,\n                    event.sourceEvent.clientY ?? event.sourceEvent.touches[0].clientY,\n                ];\n            }\n        };\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const panHandler = (event) => {\n            const transform = getTransform();\n            if ((event.sourceEvent.type !== 'mousemove' && event.sourceEvent.type !== 'touchmove') || !panZoom) {\n                return;\n            }\n            const panCurrent = [\n                event.sourceEvent.clientX ?? event.sourceEvent.touches[0].clientX,\n                event.sourceEvent.clientY ?? event.sourceEvent.touches[0].clientY,\n            ];\n            const panDelta = [panCurrent[0] - panStart[0], panCurrent[1] - panStart[1]];\n            panStart = panCurrent;\n            const moveScale = getViewScale() * Math.max(transform[2], Math.log(transform[2])) * (inversePan ? -1 : 1);\n            const position = {\n                x: transform[0] - panDelta[0] * moveScale,\n                y: transform[1] - panDelta[1] * moveScale,\n            };\n            const extent = [\n                [0, 0],\n                [width, height],\n            ];\n            panZoom.setViewportConstrained({\n                x: position.x,\n                y: position.y,\n                zoom: transform[2],\n            }, extent, translateExtent);\n        };\n        const zoomAndPanHandler = zoom()\n            .on('start', panStartHandler)\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            .on('zoom', pannable ? panHandler : null)\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            .on('zoom.wheel', zoomable ? zoomHandler : null);\n        selection.call(zoomAndPanHandler, {});\n    }\n    function destroy() {\n        selection.on('zoom', null);\n    }\n    return {\n        update,\n        destroy,\n        pointer,\n    };\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nconst viewChanged = (prevViewport, eventViewport) => prevViewport.x !== eventViewport.x || prevViewport.y !== eventViewport.y || prevViewport.zoom !== eventViewport.k;\nconst transformToViewport = (transform) => ({\n    x: transform.x,\n    y: transform.y,\n    zoom: transform.k,\n});\nconst viewportToTransform = ({ x, y, zoom }) => zoomIdentity.translate(x, y).scale(zoom);\nconst isWrappedWithClass = (event, className) => event.target.closest(`.${className}`);\nconst isRightClickPan = (panOnDrag, usedButton) => usedButton === 2 && Array.isArray(panOnDrag) && panOnDrag.includes(2);\nconst getD3Transition = (selection, duration = 0, onEnd = () => { }) => {\n    const hasDuration = typeof duration === 'number' && duration > 0;\n    if (!hasDuration) {\n        onEnd();\n    }\n    return hasDuration ? selection.transition().duration(duration).on('end', onEnd) : selection;\n};\nconst wheelDelta = (event) => {\n    const factor = event.ctrlKey && isMacOs() ? 10 : 1;\n    return -event.deltaY * (event.deltaMode === 1 ? 0.05 : event.deltaMode ? 1 : 0.002) * factor;\n};\n\nfunction createPanOnScrollHandler({ zoomPanValues, noWheelClassName, d3Selection, d3Zoom, panOnScrollMode, panOnScrollSpeed, zoomOnPinch, onPanZoomStart, onPanZoom, onPanZoomEnd, }) {\n    return (event) => {\n        if (isWrappedWithClass(event, noWheelClassName)) {\n            return false;\n        }\n        event.preventDefault();\n        event.stopImmediatePropagation();\n        const currentZoom = d3Selection.property('__zoom').k || 1;\n        // macos sets ctrlKey=true for pinch gesture on a trackpad\n        if (event.ctrlKey && zoomOnPinch) {\n            const point = pointer(event);\n            const pinchDelta = wheelDelta(event);\n            const zoom = currentZoom * Math.pow(2, pinchDelta);\n            // @ts-ignore\n            d3Zoom.scaleTo(d3Selection, zoom, point, event);\n            return;\n        }\n        // increase scroll speed in firefox\n        // firefox: deltaMode === 1; chrome: deltaMode === 0\n        const deltaNormalize = event.deltaMode === 1 ? 20 : 1;\n        let deltaX = panOnScrollMode === PanOnScrollMode.Vertical ? 0 : event.deltaX * deltaNormalize;\n        let deltaY = panOnScrollMode === PanOnScrollMode.Horizontal ? 0 : event.deltaY * deltaNormalize;\n        // this enables vertical scrolling with shift + scroll on windows\n        if (!isMacOs() && event.shiftKey && panOnScrollMode !== PanOnScrollMode.Vertical) {\n            deltaX = event.deltaY * deltaNormalize;\n            deltaY = 0;\n        }\n        d3Zoom.translateBy(d3Selection, -(deltaX / currentZoom) * panOnScrollSpeed, -(deltaY / currentZoom) * panOnScrollSpeed, \n        // @ts-ignore\n        { internal: true });\n        const nextViewport = transformToViewport(d3Selection.property('__zoom'));\n        clearTimeout(zoomPanValues.panScrollTimeout);\n        // for pan on scroll we need to handle the event calls on our own\n        // we can't use the start, zoom and end events from d3-zoom\n        // because start and move gets called on every scroll event and not once at the beginning\n        if (!zoomPanValues.isPanScrolling) {\n            zoomPanValues.isPanScrolling = true;\n            onPanZoomStart?.(event, nextViewport);\n        }\n        if (zoomPanValues.isPanScrolling) {\n            onPanZoom?.(event, nextViewport);\n            zoomPanValues.panScrollTimeout = setTimeout(() => {\n                onPanZoomEnd?.(event, nextViewport);\n                zoomPanValues.isPanScrolling = false;\n            }, 150);\n        }\n    };\n}\nfunction createZoomOnScrollHandler({ noWheelClassName, preventScrolling, d3ZoomHandler }) {\n    return function (event, d) {\n        // we still want to enable pinch zooming even if preventScrolling is set to false\n        const preventZoom = !preventScrolling && event.type === 'wheel' && !event.ctrlKey;\n        if (preventZoom || isWrappedWithClass(event, noWheelClassName)) {\n            return null;\n        }\n        event.preventDefault();\n        d3ZoomHandler.call(this, event, d);\n    };\n}\nfunction createPanZoomStartHandler({ zoomPanValues, onDraggingChange, onPanZoomStart }) {\n    return (event) => {\n        if (event.sourceEvent?.internal) {\n            return;\n        }\n        const viewport = transformToViewport(event.transform);\n        // we need to remember it here, because it's always 0 in the \"zoom\" event\n        zoomPanValues.mouseButton = event.sourceEvent?.button || 0;\n        zoomPanValues.isZoomingOrPanning = true;\n        zoomPanValues.prevViewport = viewport;\n        if (event.sourceEvent?.type === 'mousedown') {\n            onDraggingChange(true);\n        }\n        if (onPanZoomStart) {\n            onPanZoomStart?.(event.sourceEvent, viewport);\n        }\n    };\n}\nfunction createPanZoomHandler({ zoomPanValues, panOnDrag, onPaneContextMenu, onTransformChange, onPanZoom, }) {\n    return (event) => {\n        zoomPanValues.usedRightMouseButton = !!(onPaneContextMenu && isRightClickPan(panOnDrag, zoomPanValues.mouseButton ?? 0));\n        if (!event.sourceEvent?.sync) {\n            onTransformChange([event.transform.x, event.transform.y, event.transform.k]);\n        }\n        if (onPanZoom && !event.sourceEvent?.internal) {\n            onPanZoom?.(event.sourceEvent, transformToViewport(event.transform));\n        }\n    };\n}\nfunction createPanZoomEndHandler({ zoomPanValues, panOnDrag, panOnScroll, onDraggingChange, onPanZoomEnd, onPaneContextMenu, }) {\n    return (event) => {\n        if (event.sourceEvent?.internal) {\n            return;\n        }\n        zoomPanValues.isZoomingOrPanning = false;\n        if (onPaneContextMenu &&\n            isRightClickPan(panOnDrag, zoomPanValues.mouseButton ?? 0) &&\n            !zoomPanValues.usedRightMouseButton &&\n            event.sourceEvent) {\n            onPaneContextMenu(event.sourceEvent);\n        }\n        zoomPanValues.usedRightMouseButton = false;\n        onDraggingChange(false);\n        if (onPanZoomEnd && viewChanged(zoomPanValues.prevViewport, event.transform)) {\n            const viewport = transformToViewport(event.transform);\n            zoomPanValues.prevViewport = viewport;\n            clearTimeout(zoomPanValues.timerId);\n            zoomPanValues.timerId = setTimeout(() => {\n                onPanZoomEnd?.(event.sourceEvent, viewport);\n            }, \n            // we need a setTimeout for panOnScroll to supress multiple end events fired during scroll\n            panOnScroll ? 150 : 0);\n        }\n    };\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\nfunction createFilter({ zoomActivationKeyPressed, zoomOnScroll, zoomOnPinch, panOnDrag, panOnScroll, zoomOnDoubleClick, userSelectionActive, noWheelClassName, noPanClassName, lib, }) {\n    return (event) => {\n        const zoomScroll = zoomActivationKeyPressed || zoomOnScroll;\n        const pinchZoom = zoomOnPinch && event.ctrlKey;\n        if (event.button === 1 &&\n            event.type === 'mousedown' &&\n            (isWrappedWithClass(event, `${lib}-flow__node`) || isWrappedWithClass(event, `${lib}-flow__edge`))) {\n            return true;\n        }\n        // if all interactions are disabled, we prevent all zoom events\n        if (!panOnDrag && !zoomScroll && !panOnScroll && !zoomOnDoubleClick && !zoomOnPinch) {\n            return false;\n        }\n        // during a selection we prevent all other interactions\n        if (userSelectionActive) {\n            return false;\n        }\n        // if the target element is inside an element with the nowheel class, we prevent zooming\n        if (isWrappedWithClass(event, noWheelClassName) && event.type === 'wheel') {\n            return false;\n        }\n        // if the target element is inside an element with the nopan class, we prevent panning\n        if (isWrappedWithClass(event, noPanClassName) &&\n            (event.type !== 'wheel' || (panOnScroll && event.type === 'wheel' && !zoomActivationKeyPressed))) {\n            return false;\n        }\n        if (!zoomOnPinch && event.ctrlKey && event.type === 'wheel') {\n            return false;\n        }\n        if (!zoomOnPinch && event.type === 'touchstart' && event.touches?.length > 1) {\n            event.preventDefault(); // if you manage to start with 2 touches, we prevent native zoom\n            return false;\n        }\n        // when there is no scroll handling enabled, we prevent all wheel events\n        if (!zoomScroll && !panOnScroll && !pinchZoom && event.type === 'wheel') {\n            return false;\n        }\n        // if the pane is not movable, we prevent dragging it with mousestart or touchstart\n        if (!panOnDrag && (event.type === 'mousedown' || event.type === 'touchstart')) {\n            return false;\n        }\n        // if the pane is only movable using allowed clicks\n        if (Array.isArray(panOnDrag) && !panOnDrag.includes(event.button) && event.type === 'mousedown') {\n            return false;\n        }\n        // We only allow right clicks if pan on drag is set to right click\n        const buttonAllowed = (Array.isArray(panOnDrag) && panOnDrag.includes(event.button)) || !event.button || event.button <= 1;\n        // default filter for d3-zoom\n        return (!event.ctrlKey || event.type === 'wheel') && buttonAllowed;\n    };\n}\n\nfunction XYPanZoom({ domNode, minZoom, maxZoom, paneClickDistance, translateExtent, viewport, onPanZoom, onPanZoomStart, onPanZoomEnd, onDraggingChange, }) {\n    const zoomPanValues = {\n        isZoomingOrPanning: false,\n        usedRightMouseButton: false,\n        prevViewport: { x: 0, y: 0, zoom: 0 },\n        mouseButton: 0,\n        timerId: undefined,\n        panScrollTimeout: undefined,\n        isPanScrolling: false,\n    };\n    const bbox = domNode.getBoundingClientRect();\n    const d3ZoomInstance = zoom()\n        .clickDistance(!isNumeric(paneClickDistance) || paneClickDistance < 0 ? 0 : paneClickDistance)\n        .scaleExtent([minZoom, maxZoom])\n        .translateExtent(translateExtent);\n    const d3Selection = select(domNode).call(d3ZoomInstance);\n    setViewportConstrained({\n        x: viewport.x,\n        y: viewport.y,\n        zoom: clamp(viewport.zoom, minZoom, maxZoom),\n    }, [\n        [0, 0],\n        [bbox.width, bbox.height],\n    ], translateExtent);\n    const d3ZoomHandler = d3Selection.on('wheel.zoom');\n    const d3DblClickZoomHandler = d3Selection.on('dblclick.zoom');\n    d3ZoomInstance.wheelDelta(wheelDelta);\n    function setTransform(transform, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.transform(getD3Transition(d3Selection, options?.duration, () => resolve(true)), transform);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    // public functions\n    function update({ noWheelClassName, noPanClassName, onPaneContextMenu, userSelectionActive, panOnScroll, panOnDrag, panOnScrollMode, panOnScrollSpeed, preventScrolling, zoomOnPinch, zoomOnScroll, zoomOnDoubleClick, zoomActivationKeyPressed, lib, onTransformChange, }) {\n        if (userSelectionActive && !zoomPanValues.isZoomingOrPanning) {\n            destroy();\n        }\n        const isPanOnScroll = panOnScroll && !zoomActivationKeyPressed && !userSelectionActive;\n        const wheelHandler = isPanOnScroll\n            ? createPanOnScrollHandler({\n                zoomPanValues,\n                noWheelClassName,\n                d3Selection,\n                d3Zoom: d3ZoomInstance,\n                panOnScrollMode,\n                panOnScrollSpeed,\n                zoomOnPinch,\n                onPanZoomStart,\n                onPanZoom,\n                onPanZoomEnd,\n            })\n            : createZoomOnScrollHandler({\n                noWheelClassName,\n                preventScrolling,\n                d3ZoomHandler,\n            });\n        d3Selection.on('wheel.zoom', wheelHandler, { passive: false });\n        if (!userSelectionActive) {\n            // pan zoom start\n            const startHandler = createPanZoomStartHandler({\n                zoomPanValues,\n                onDraggingChange,\n                onPanZoomStart,\n            });\n            d3ZoomInstance.on('start', startHandler);\n            // pan zoom\n            const panZoomHandler = createPanZoomHandler({\n                zoomPanValues,\n                panOnDrag,\n                onPaneContextMenu: !!onPaneContextMenu,\n                onPanZoom,\n                onTransformChange,\n            });\n            d3ZoomInstance.on('zoom', panZoomHandler);\n            // pan zoom end\n            const panZoomEndHandler = createPanZoomEndHandler({\n                zoomPanValues,\n                panOnDrag,\n                panOnScroll,\n                onPaneContextMenu,\n                onPanZoomEnd,\n                onDraggingChange,\n            });\n            d3ZoomInstance.on('end', panZoomEndHandler);\n        }\n        const filter = createFilter({\n            zoomActivationKeyPressed,\n            panOnDrag,\n            zoomOnScroll,\n            panOnScroll,\n            zoomOnDoubleClick,\n            zoomOnPinch,\n            userSelectionActive,\n            noPanClassName,\n            noWheelClassName,\n            lib,\n        });\n        d3ZoomInstance.filter(filter);\n        // We cannot add zoomOnDoubleClick to the filter above because\n        // double tapping on touch screens circumvents the filter and\n        // dblclick.zoom is fired on the selection directly\n        if (zoomOnDoubleClick) {\n            d3Selection.on('dblclick.zoom', d3DblClickZoomHandler);\n        }\n        else {\n            d3Selection.on('dblclick.zoom', null);\n        }\n    }\n    function destroy() {\n        d3ZoomInstance.on('zoom', null);\n    }\n    async function setViewportConstrained(viewport, extent, translateExtent) {\n        const nextTransform = viewportToTransform(viewport);\n        const contrainedTransform = d3ZoomInstance?.constrain()(nextTransform, extent, translateExtent);\n        if (contrainedTransform) {\n            await setTransform(contrainedTransform);\n        }\n        return new Promise((resolve) => resolve(contrainedTransform));\n    }\n    async function setViewport(viewport, options) {\n        const nextTransform = viewportToTransform(viewport);\n        await setTransform(nextTransform, options);\n        return new Promise((resolve) => resolve(nextTransform));\n    }\n    function syncViewport(viewport) {\n        if (d3Selection) {\n            const nextTransform = viewportToTransform(viewport);\n            const currentTransform = d3Selection.property('__zoom');\n            if (currentTransform.k !== viewport.zoom ||\n                currentTransform.x !== viewport.x ||\n                currentTransform.y !== viewport.y) {\n                // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                // @ts-ignore\n                d3ZoomInstance?.transform(d3Selection, nextTransform, null, { sync: true });\n            }\n        }\n    }\n    function getViewport() {\n        const transform = d3Selection ? zoomTransform(d3Selection.node()) : { x: 0, y: 0, k: 1 };\n        return { x: transform.x, y: transform.y, zoom: transform.k };\n    }\n    function scaleTo(zoom, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.scaleTo(getD3Transition(d3Selection, options?.duration, () => resolve(true)), zoom);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    function scaleBy(factor, options) {\n        if (d3Selection) {\n            return new Promise((resolve) => {\n                d3ZoomInstance?.scaleBy(getD3Transition(d3Selection, options?.duration, () => resolve(true)), factor);\n            });\n        }\n        return Promise.resolve(false);\n    }\n    function setScaleExtent(scaleExtent) {\n        d3ZoomInstance?.scaleExtent(scaleExtent);\n    }\n    function setTranslateExtent(translateExtent) {\n        d3ZoomInstance?.translateExtent(translateExtent);\n    }\n    function setClickDistance(distance) {\n        const validDistance = !isNumeric(distance) || distance < 0 ? 0 : distance;\n        d3ZoomInstance?.clickDistance(validDistance);\n    }\n    return {\n        update,\n        destroy,\n        setViewport,\n        setViewportConstrained,\n        getViewport,\n        scaleTo,\n        scaleBy,\n        setScaleExtent,\n        setTranslateExtent,\n        syncViewport,\n        setClickDistance,\n    };\n}\n\nvar ResizeControlVariant;\n(function (ResizeControlVariant) {\n    ResizeControlVariant[\"Line\"] = \"line\";\n    ResizeControlVariant[\"Handle\"] = \"handle\";\n})(ResizeControlVariant || (ResizeControlVariant = {}));\nconst XY_RESIZER_HANDLE_POSITIONS = ['top-left', 'top-right', 'bottom-left', 'bottom-right'];\nconst XY_RESIZER_LINE_POSITIONS = ['top', 'right', 'bottom', 'left'];\n\n/**\n * Get all connecting edges for a given set of nodes\n * @param width - new width of the node\n * @param prevWidth - previous width of the node\n * @param height - new height of the node\n * @param prevHeight - previous height of the node\n * @param affectsX - whether to invert the resize direction for the x axis\n * @param affectsY - whether to invert the resize direction for the y axis\n * @returns array of two numbers representing the direction of the resize for each axis, 0 = no change, 1 = increase, -1 = decrease\n */\nfunction getResizeDirection({ width, prevWidth, height, prevHeight, affectsX, affectsY, }) {\n    const deltaWidth = width - prevWidth;\n    const deltaHeight = height - prevHeight;\n    const direction = [deltaWidth > 0 ? 1 : deltaWidth < 0 ? -1 : 0, deltaHeight > 0 ? 1 : deltaHeight < 0 ? -1 : 0];\n    if (deltaWidth && affectsX) {\n        direction[0] = direction[0] * -1;\n    }\n    if (deltaHeight && affectsY) {\n        direction[1] = direction[1] * -1;\n    }\n    return direction;\n}\n/**\n * Parses the control position that is being dragged to dimensions that are being resized\n * @param controlPosition - position of the control that is being dragged\n * @returns isHorizontal, isVertical, affectsX, affectsY,\n */\nfunction getControlDirection(controlPosition) {\n    const isHorizontal = controlPosition.includes('right') || controlPosition.includes('left');\n    const isVertical = controlPosition.includes('bottom') || controlPosition.includes('top');\n    const affectsX = controlPosition.includes('left');\n    const affectsY = controlPosition.includes('top');\n    return {\n        isHorizontal,\n        isVertical,\n        affectsX,\n        affectsY,\n    };\n}\nfunction getLowerExtentClamp(lowerExtent, lowerBound) {\n    return Math.max(0, lowerBound - lowerExtent);\n}\nfunction getUpperExtentClamp(upperExtent, upperBound) {\n    return Math.max(0, upperExtent - upperBound);\n}\nfunction getSizeClamp(size, minSize, maxSize) {\n    return Math.max(0, minSize - size, size - maxSize);\n}\nfunction xor(a, b) {\n    return a ? !b : b;\n}\n/**\n * Calculates new width & height and x & y of node after resize based on pointer position\n * @description - Buckle up, this is a chunky one... If you want to determine the new dimensions of a node after a resize,\n * you have to account for all possible restrictions: min/max width/height of the node, the maximum extent the node is allowed\n * to move in (in this case: resize into) determined by the parent node, the minimal extent determined by child nodes\n * with expandParent or extent: 'parent' set and oh yeah, these things also have to work with keepAspectRatio!\n * The way this is done is by determining how much each of these restricting actually restricts the resize and then applying the\n * strongest restriction. Because the resize affects x, y and width, height and width, height of a opposing side with keepAspectRatio,\n * the resize amount is always kept in distX & distY amount (the distance in mouse movement)\n * Instead of clamping each value, we first calculate the biggest 'clamp' (for the lack of a better name) and then apply it to all values.\n * To complicate things nodeOrigin has to be taken into account as well. This is done by offsetting the nodes as if their origin is [0, 0],\n * then calculating the restrictions as usual\n * @param startValues - starting values of resize\n * @param controlDirection - dimensions affected by the resize\n * @param pointerPosition - the current pointer position corrected for snapping\n * @param boundaries - minimum and maximum dimensions of the node\n * @param keepAspectRatio - prevent changes of asprect ratio\n * @returns x, y, width and height of the node after resize\n */\nfunction getDimensionsAfterResize(startValues, controlDirection, pointerPosition, boundaries, keepAspectRatio, nodeOrigin, extent, childExtent) {\n    let { affectsX, affectsY } = controlDirection;\n    const { isHorizontal, isVertical } = controlDirection;\n    const isDiagonal = isHorizontal && isVertical;\n    const { xSnapped, ySnapped } = pointerPosition;\n    const { minWidth, maxWidth, minHeight, maxHeight } = boundaries;\n    const { x: startX, y: startY, width: startWidth, height: startHeight, aspectRatio } = startValues;\n    let distX = Math.floor(isHorizontal ? xSnapped - startValues.pointerX : 0);\n    let distY = Math.floor(isVertical ? ySnapped - startValues.pointerY : 0);\n    const newWidth = startWidth + (affectsX ? -distX : distX);\n    const newHeight = startHeight + (affectsY ? -distY : distY);\n    const originOffsetX = -nodeOrigin[0] * startWidth;\n    const originOffsetY = -nodeOrigin[1] * startHeight;\n    // Check if maxWidth, minWWidth, maxHeight, minHeight are restricting the resize\n    let clampX = getSizeClamp(newWidth, minWidth, maxWidth);\n    let clampY = getSizeClamp(newHeight, minHeight, maxHeight);\n    // Check if extent is restricting the resize\n    if (extent) {\n        let xExtentClamp = 0;\n        let yExtentClamp = 0;\n        if (affectsX && distX < 0) {\n            xExtentClamp = getLowerExtentClamp(startX + distX + originOffsetX, extent[0][0]);\n        }\n        else if (!affectsX && distX > 0) {\n            xExtentClamp = getUpperExtentClamp(startX + newWidth + originOffsetX, extent[1][0]);\n        }\n        if (affectsY && distY < 0) {\n            yExtentClamp = getLowerExtentClamp(startY + distY + originOffsetY, extent[0][1]);\n        }\n        else if (!affectsY && distY > 0) {\n            yExtentClamp = getUpperExtentClamp(startY + newHeight + originOffsetY, extent[1][1]);\n        }\n        clampX = Math.max(clampX, xExtentClamp);\n        clampY = Math.max(clampY, yExtentClamp);\n    }\n    // Check if the child extent is restricting the resize\n    if (childExtent) {\n        let xExtentClamp = 0;\n        let yExtentClamp = 0;\n        if (affectsX && distX > 0) {\n            xExtentClamp = getUpperExtentClamp(startX + distX, childExtent[0][0]);\n        }\n        else if (!affectsX && distX < 0) {\n            xExtentClamp = getLowerExtentClamp(startX + newWidth, childExtent[1][0]);\n        }\n        if (affectsY && distY > 0) {\n            yExtentClamp = getUpperExtentClamp(startY + distY, childExtent[0][1]);\n        }\n        else if (!affectsY && distY < 0) {\n            yExtentClamp = getLowerExtentClamp(startY + newHeight, childExtent[1][1]);\n        }\n        clampX = Math.max(clampX, xExtentClamp);\n        clampY = Math.max(clampY, yExtentClamp);\n    }\n    // Check if the aspect ratio resizing of the other side is restricting the resize\n    if (keepAspectRatio) {\n        if (isHorizontal) {\n            // Check if the max dimensions might be restricting the resize\n            const aspectHeightClamp = getSizeClamp(newWidth / aspectRatio, minHeight, maxHeight) * aspectRatio;\n            clampX = Math.max(clampX, aspectHeightClamp);\n            // Check if the extent is restricting the resize\n            if (extent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsX && !affectsY && isDiagonal)) {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startY + originOffsetY + newWidth / aspectRatio, extent[1][1]) * aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getLowerExtentClamp(startY + originOffsetY + (affectsX ? distX : -distX) / aspectRatio, extent[0][1]) *\n                            aspectRatio;\n                }\n                clampX = Math.max(clampX, aspectExtentClamp);\n            }\n            // Check if the child extent is restricting the resize\n            if (childExtent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsX && !affectsY && isDiagonal)) {\n                    aspectExtentClamp = getLowerExtentClamp(startY + newWidth / aspectRatio, childExtent[1][1]) * aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startY + (affectsX ? distX : -distX) / aspectRatio, childExtent[0][1]) * aspectRatio;\n                }\n                clampX = Math.max(clampX, aspectExtentClamp);\n            }\n        }\n        // Do the same thing for vertical resizing\n        if (isVertical) {\n            const aspectWidthClamp = getSizeClamp(newHeight * aspectRatio, minWidth, maxWidth) / aspectRatio;\n            clampY = Math.max(clampY, aspectWidthClamp);\n            if (extent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsY && !affectsX && isDiagonal)) {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startX + newHeight * aspectRatio + originOffsetX, extent[1][0]) / aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getLowerExtentClamp(startX + (affectsY ? distY : -distY) * aspectRatio + originOffsetX, extent[0][0]) /\n                            aspectRatio;\n                }\n                clampY = Math.max(clampY, aspectExtentClamp);\n            }\n            if (childExtent) {\n                let aspectExtentClamp = 0;\n                if ((!affectsX && !affectsY) || (affectsY && !affectsX && isDiagonal)) {\n                    aspectExtentClamp = getLowerExtentClamp(startX + newHeight * aspectRatio, childExtent[1][0]) / aspectRatio;\n                }\n                else {\n                    aspectExtentClamp =\n                        getUpperExtentClamp(startX + (affectsY ? distY : -distY) * aspectRatio, childExtent[0][0]) / aspectRatio;\n                }\n                clampY = Math.max(clampY, aspectExtentClamp);\n            }\n        }\n    }\n    distY = distY + (distY < 0 ? clampY : -clampY);\n    distX = distX + (distX < 0 ? clampX : -clampX);\n    if (keepAspectRatio) {\n        if (isDiagonal) {\n            if (newWidth > newHeight * aspectRatio) {\n                distY = (xor(affectsX, affectsY) ? -distX : distX) / aspectRatio;\n            }\n            else {\n                distX = (xor(affectsX, affectsY) ? -distY : distY) * aspectRatio;\n            }\n        }\n        else {\n            if (isHorizontal) {\n                distY = distX / aspectRatio;\n                affectsY = affectsX;\n            }\n            else {\n                distX = distY * aspectRatio;\n                affectsX = affectsY;\n            }\n        }\n    }\n    const x = affectsX ? startX + distX : startX;\n    const y = affectsY ? startY + distY : startY;\n    return {\n        width: startWidth + (affectsX ? -distX : distX),\n        height: startHeight + (affectsY ? -distY : distY),\n        x: nodeOrigin[0] * distX * (!affectsX ? 1 : -1) + x,\n        y: nodeOrigin[1] * distY * (!affectsY ? 1 : -1) + y,\n    };\n}\n\nconst initPrevValues = { width: 0, height: 0, x: 0, y: 0 };\nconst initStartValues = {\n    ...initPrevValues,\n    pointerX: 0,\n    pointerY: 0,\n    aspectRatio: 1,\n};\nfunction nodeToParentExtent(node) {\n    return [\n        [0, 0],\n        [node.measured.width, node.measured.height],\n    ];\n}\nfunction nodeToChildExtent(child, parent, nodeOrigin) {\n    const x = parent.position.x + child.position.x;\n    const y = parent.position.y + child.position.y;\n    const width = child.measured.width ?? 0;\n    const height = child.measured.height ?? 0;\n    const originOffsetX = nodeOrigin[0] * width;\n    const originOffsetY = nodeOrigin[1] * height;\n    return [\n        [x - originOffsetX, y - originOffsetY],\n        [x + width - originOffsetX, y + height - originOffsetY],\n    ];\n}\nfunction XYResizer({ domNode, nodeId, getStoreItems, onChange, onEnd }) {\n    const selection = select(domNode);\n    function update({ controlPosition, boundaries, keepAspectRatio, onResizeStart, onResize, onResizeEnd, shouldResize, }) {\n        let prevValues = { ...initPrevValues };\n        let startValues = { ...initStartValues };\n        const controlDirection = getControlDirection(controlPosition);\n        let node = undefined;\n        let childNodes = [];\n        let parentNode = undefined; // Needed to fix expandParent\n        let parentExtent = undefined;\n        let childExtent = undefined;\n        const dragHandler = drag()\n            .on('start', (event) => {\n            const { nodeLookup, transform, snapGrid, snapToGrid, nodeOrigin } = getStoreItems();\n            node = nodeLookup.get(nodeId);\n            if (!node) {\n                return;\n            }\n            const { xSnapped, ySnapped } = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid });\n            prevValues = {\n                width: node.measured.width ?? 0,\n                height: node.measured.height ?? 0,\n                x: node.position.x ?? 0,\n                y: node.position.y ?? 0,\n            };\n            startValues = {\n                ...prevValues,\n                pointerX: xSnapped,\n                pointerY: ySnapped,\n                aspectRatio: prevValues.width / prevValues.height,\n            };\n            parentNode = undefined;\n            if (node.parentId && (node.extent === 'parent' || node.expandParent)) {\n                parentNode = nodeLookup.get(node.parentId);\n                parentExtent = parentNode && node.extent === 'parent' ? nodeToParentExtent(parentNode) : undefined;\n            }\n            // Collect all child nodes to correct their relative positions when top/left changes\n            // Determine largest minimal extent the parent node is allowed to resize to\n            childNodes = [];\n            childExtent = undefined;\n            for (const [childId, child] of nodeLookup) {\n                if (child.parentId === nodeId) {\n                    childNodes.push({\n                        id: childId,\n                        position: { ...child.position },\n                        extent: child.extent,\n                    });\n                    if (child.extent === 'parent' || child.expandParent) {\n                        const extent = nodeToChildExtent(child, node, child.origin ?? nodeOrigin);\n                        if (childExtent) {\n                            childExtent = [\n                                [Math.min(extent[0][0], childExtent[0][0]), Math.min(extent[0][1], childExtent[0][1])],\n                                [Math.max(extent[1][0], childExtent[1][0]), Math.max(extent[1][1], childExtent[1][1])],\n                            ];\n                        }\n                        else {\n                            childExtent = extent;\n                        }\n                    }\n                }\n            }\n            onResizeStart?.(event, { ...prevValues });\n        })\n            .on('drag', (event) => {\n            const { transform, snapGrid, snapToGrid, nodeOrigin: storeNodeOrigin } = getStoreItems();\n            const pointerPosition = getPointerPosition(event.sourceEvent, { transform, snapGrid, snapToGrid });\n            const childChanges = [];\n            if (!node) {\n                return;\n            }\n            const { x: prevX, y: prevY, width: prevWidth, height: prevHeight } = prevValues;\n            const change = {};\n            const nodeOrigin = node.origin ?? storeNodeOrigin;\n            const { width, height, x, y } = getDimensionsAfterResize(startValues, controlDirection, pointerPosition, boundaries, keepAspectRatio, nodeOrigin, parentExtent, childExtent);\n            const isWidthChange = width !== prevWidth;\n            const isHeightChange = height !== prevHeight;\n            const isXPosChange = x !== prevX && isWidthChange;\n            const isYPosChange = y !== prevY && isHeightChange;\n            if (!isXPosChange && !isYPosChange && !isWidthChange && !isHeightChange) {\n                return;\n            }\n            if (isXPosChange || isYPosChange || nodeOrigin[0] === 1 || nodeOrigin[1] === 1) {\n                change.x = isXPosChange ? x : prevValues.x;\n                change.y = isYPosChange ? y : prevValues.y;\n                prevValues.x = change.x;\n                prevValues.y = change.y;\n                // when top/left changes, correct the relative positions of child nodes\n                // so that they stay in the same position\n                if (childNodes.length > 0) {\n                    const xChange = x - prevX;\n                    const yChange = y - prevY;\n                    for (const childNode of childNodes) {\n                        childNode.position = {\n                            x: childNode.position.x - xChange + nodeOrigin[0] * (width - prevWidth),\n                            y: childNode.position.y - yChange + nodeOrigin[1] * (height - prevHeight),\n                        };\n                        childChanges.push(childNode);\n                    }\n                }\n            }\n            if (isWidthChange || isHeightChange) {\n                change.width = isWidthChange ? width : prevValues.width;\n                change.height = isHeightChange ? height : prevValues.height;\n                prevValues.width = change.width;\n                prevValues.height = change.height;\n            }\n            // Fix expandParent when resizing from top/left\n            if (parentNode && node.expandParent) {\n                const xLimit = nodeOrigin[0] * (change.width ?? 0);\n                if (change.x && change.x < xLimit) {\n                    prevValues.x = xLimit;\n                    startValues.x = startValues.x - (change.x - xLimit);\n                }\n                const yLimit = nodeOrigin[1] * (change.height ?? 0);\n                if (change.y && change.y < yLimit) {\n                    prevValues.y = yLimit;\n                    startValues.y = startValues.y - (change.y - yLimit);\n                }\n            }\n            const direction = getResizeDirection({\n                width: prevValues.width,\n                prevWidth,\n                height: prevValues.height,\n                prevHeight,\n                affectsX: controlDirection.affectsX,\n                affectsY: controlDirection.affectsY,\n            });\n            const nextValues = { ...prevValues, direction };\n            const callResize = shouldResize?.(event, nextValues);\n            if (callResize === false) {\n                return;\n            }\n            onResize?.(event, nextValues);\n            onChange(change, childChanges);\n        })\n            .on('end', (event) => {\n            onResizeEnd?.(event, { ...prevValues });\n            onEnd?.();\n        });\n        selection.call(dragHandler);\n    }\n    function destroy() {\n        selection.on('.drag', null);\n    }\n    return {\n        update,\n        destroy,\n    };\n}\n\nexport { ConnectionLineType, ConnectionMode, MarkerType, PanOnScrollMode, Position, ResizeControlVariant, SelectionMode, XYDrag, XYHandle, XYMinimap, XYPanZoom, XYResizer, XY_RESIZER_HANDLE_POSITIONS, XY_RESIZER_LINE_POSITIONS, addEdge, adoptUserNodes, areConnectionMapsEqual, boxToRect, calcAutoPan, calculateNodePosition, clamp, clampPosition, clampPositionToParent, createMarkerIds, devWarn, elementSelectionKeys, errorMessages, evaluateAbsolutePosition, fitView, getBezierEdgeCenter, getBezierPath, getBoundsOfBoxes, getBoundsOfRects, getConnectedEdges, getConnectionStatus, getDimensions, getEdgeCenter, getEdgePosition, getElementsToRemove, getElevatedEdgeZIndex, getEventPosition, getFitViewNodes, getHandleBounds, getHandlePosition, getHostForElement, getIncomers, getInternalNodesBounds, getMarkerId, getNodeDimensions, getNodePositionWithOrigin, getNodeToolbarTransform, getNodesBounds, getNodesInside, getOutgoers, getOverlappingArea, getPointerPosition, getSmoothStepPath, getStraightPath, getViewportForBounds, handleConnectionChange, handleExpandParent, infiniteExtent, initialConnection, isCoordinateExtent, isEdgeBase, isEdgeVisible, isInputDOMNode, isInternalNodeBase, isMacOs, isMouseEvent, isNodeBase, isNumeric, isRectObject, nodeHasDimensions, nodeToBox, nodeToRect, oppositePosition, panBy, pointToRendererPoint, reconnectEdge, rectToBox, rendererPointToPoint, shallowNodeData, snapPosition, updateAbsolutePositions, updateConnectionLookup, updateNodeInternals };\n","<script>import { getContext } from 'svelte';\nimport cc from 'classcat';\nimport { Position, XYHandle, isMouseEvent, areConnectionMapsEqual, handleConnectionChange, ConnectionMode } from '@xyflow/system';\nimport { useStore } from '../../store';\nexport let id = undefined;\nexport let type = 'source';\nexport let position = Position.Top;\nexport let style = undefined;\nexport let isValidConnection = undefined;\nexport let onconnect = undefined;\nexport let ondisconnect = undefined;\n// @todo implement connectablestart, connectableend\n// export let isConnectableStart: $$Props['isConnectableStart'] = undefined;\n// export let isConnectableEnd: $$Props['isConnectableEnd'] = undefined;\nlet isConnectableProp = undefined;\nexport { isConnectableProp as isConnectable };\nlet className = undefined;\nexport { className as class };\n$: isTarget = type === 'target';\nconst nodeId = getContext('svelteflow__node_id');\nconst connectable = getContext('svelteflow__node_connectable');\n$: isConnectable = isConnectableProp !== undefined ? isConnectableProp : $connectable;\n$: handleId = id || null;\nconst store = useStore();\nconst { connectionMode, domNode, nodeLookup, connectionRadius, viewport, isValidConnection: isValidConnectionStore, lib, addEdge, onedgecreate, panBy, cancelConnection, updateConnection, autoPanOnConnect, edges, connectionLookup, onconnect: onConnectAction, onconnectstart: onConnectStartAction, onconnectend: onConnectEndAction, flowId, connection } = store;\nfunction onPointerDown(event) {\n    const isMouseTriggered = isMouseEvent(event);\n    if ((isMouseTriggered && event.button === 0) || !isMouseTriggered) {\n        XYHandle.onPointerDown(event, {\n            handleId,\n            nodeId,\n            isTarget,\n            connectionRadius: $connectionRadius,\n            domNode: $domNode,\n            nodeLookup: $nodeLookup,\n            connectionMode: $connectionMode,\n            lib: $lib,\n            autoPanOnConnect: $autoPanOnConnect,\n            flowId: $flowId,\n            isValidConnection: isValidConnection ?? $isValidConnectionStore,\n            updateConnection,\n            cancelConnection,\n            panBy,\n            onConnect: (connection) => {\n                const edge = $onedgecreate ? $onedgecreate(connection) : connection;\n                if (!edge) {\n                    return;\n                }\n                addEdge(edge);\n                $onConnectAction?.(connection);\n            },\n            onConnectStart: (event, startParams) => {\n                $onConnectStartAction?.(event, {\n                    nodeId: startParams.nodeId,\n                    handleId: startParams.handleId,\n                    handleType: startParams.handleType\n                });\n            },\n            onConnectEnd: (event, connectionState) => {\n                $onConnectEndAction?.(event, connectionState);\n            },\n            getTransform: () => [$viewport.x, $viewport.y, $viewport.zoom],\n            getFromHandle: () => $connection.fromHandle\n        });\n    }\n}\nlet prevConnections = null;\nlet connections;\n$: if (onconnect || ondisconnect) {\n    // connectionLookup is not reactive, so we use edges to get notified about updates\n    $edges;\n    connections = $connectionLookup.get(`${nodeId}-${type}-${id || null}`);\n}\n$: {\n    if (prevConnections && !areConnectionMapsEqual(connections, prevConnections)) {\n        const _connections = connections ?? new Map();\n        handleConnectionChange(prevConnections, _connections, ondisconnect);\n        handleConnectionChange(_connections, prevConnections, onconnect);\n    }\n    prevConnections = connections ?? new Map();\n}\n$: connectionInProcess = !!$connection.fromHandle;\n$: connectingFrom =\n    $connection.fromHandle?.nodeId === nodeId &&\n        $connection.fromHandle?.type === type &&\n        $connection.fromHandle?.id === handleId;\n$: connectingTo =\n    $connection.toHandle?.nodeId === nodeId &&\n        $connection.toHandle?.type === type &&\n        $connection.toHandle?.id === handleId;\n$: isPossibleEndHandle =\n    $connectionMode === ConnectionMode.Strict\n        ? $connection.fromHandle?.type !== type\n        : nodeId !== $connection.fromHandle?.nodeId || handleId !== $connection.fromHandle?.id;\n$: valid = connectingTo && $connection.isValid;\n</script>\n\n<!--\n@component\nThe Handle component is the part of a node that can be used to connect nodes.\n-->\n<div\n  data-handleid={handleId}\n  data-nodeid={nodeId}\n  data-handlepos={position}\n  data-id=\"{$flowId}-{nodeId}-{id || null}-{type}\"\n  class={cc([\n    'svelte-flow__handle',\n    `svelte-flow__handle-${position}`,\n    'nodrag',\n    'nopan',\n    position,\n    className\n  ])}\n  class:valid\n  class:connectingto={connectingTo}\n  class:connectingfrom={connectingFrom}\n  class:source={!isTarget}\n  class:target={isTarget}\n  class:connectablestart={isConnectable}\n  class:connectableend={isConnectable}\n  class:connectable={isConnectable}\n  class:connectionindicator={isConnectable && (!connectionInProcess || isPossibleEndHandle)}\n  on:mousedown={onPointerDown}\n  on:touchstart={onPointerDown}\n  {style}\n  role=\"button\"\n  tabindex=\"-1\"\n>\n  <slot />\n</div>\n","<script>import { Position } from '@xyflow/system';\nimport { Handle } from '../Handle';\nexport let data = { label: 'Node' };\nexport let targetPosition = undefined;\nexport let sourcePosition = undefined;\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<Handle type=\"target\" position={targetPosition ?? Position.Top} />\n{data?.label}\n<Handle type=\"source\" position={sourcePosition ?? Position.Bottom} />\n","<script>import { Position } from '@xyflow/system';\nimport { Handle } from '../Handle';\nexport let data = { label: 'Node' };\nexport let sourcePosition = undefined;\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n{data?.label}\n<Handle type=\"source\" position={sourcePosition ?? Position.Bottom} />\n","<script>import { Position } from '@xyflow/system';\nimport { Handle } from '../Handle';\nexport let data = { label: 'Node' };\nexport let targetPosition = undefined;\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n{data?.label}\n<Handle type=\"target\" position={targetPosition ?? Position.Top} />\n","function tryToMount(node, domNode, target) {\n    if (!domNode) {\n        return;\n    }\n    const targetEl = target ? domNode.querySelector(target) : domNode;\n    if (targetEl) {\n        targetEl.appendChild(node);\n    }\n}\nexport default function (node, { target, domNode }) {\n    tryToMount(node, domNode, target);\n    return {\n        async update({ target, domNode }) {\n            tryToMount(node, domNode, target);\n        },\n        destroy() {\n            if (node.parentNode) {\n                node.parentNode.removeChild(node);\n            }\n        }\n    };\n}\n","<script>import portal from '../../actions/portal';\nimport { useStore } from '../../store';\nconst { domNode } = useStore();\n</script>\n\n<div use:portal={{ target: '.svelte-flow__edgelabel-renderer', domNode: $domNode }}>\n  <slot />\n</div>\n","import { get } from 'svelte/store';\nimport { errorMessages } from '@xyflow/system';\nimport { useStore } from '../store';\nexport function useHandleEdgeSelect() {\n    const { edgeLookup, selectionRect, selectionRectMode, multiselectionKeyPressed, addSelectedEdges, unselectNodesAndEdges, elementsSelectable } = useStore();\n    return (id) => {\n        const edge = get(edgeLookup).get(id);\n        if (!edge) {\n            console.warn('012', errorMessages['error012'](id));\n            return;\n        }\n        const selectable = edge.selectable || (get(elementsSelectable) && typeof edge.selectable === 'undefined');\n        if (selectable) {\n            selectionRect.set(null);\n            selectionRectMode.set(null);\n            if (!edge.selected) {\n                addSelectedEdges([id]);\n            }\n            else if (edge.selected && get(multiselectionKeyPressed)) {\n                unselectNodesAndEdges({ nodes: [], edges: [edge] });\n            }\n        }\n    };\n}\n","<script>import { getContext } from 'svelte';\nimport { EdgeLabelRenderer } from '../EdgeLabelRenderer';\nimport { useHandleEdgeSelect } from '../../hooks/useHandleEdgeSelect';\nexport let style = undefined;\nexport let x = undefined;\nexport let y = undefined;\nconst handleEdgeSelect = useHandleEdgeSelect();\nconst id = getContext('svelteflow__edge_id');\n</script>\n\n<EdgeLabelRenderer>\n  <div\n    class=\"svelte-flow__edge-label\"\n    style:transform=\"translate(-50%, -50%) translate({x}px,{y}px)\"\n    style={'pointer-events: all;' + style}\n    role=\"button\"\n    tabindex=\"-1\"\n    on:keyup={() => {}}\n    on:click={() => {\n      if (id) handleEdgeSelect(id);\n    }}\n  >\n    <slot />\n  </div>\n</EdgeLabelRenderer>\n","<script>import cc from 'classcat';\nimport EdgeLabel from '../EdgeLabel/EdgeLabel.svelte';\nexport let id = undefined;\nexport let path;\nexport let label = undefined;\nexport let labelX = undefined;\nexport let labelY = undefined;\nexport let labelStyle = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let style = undefined;\nexport let interactionWidth = 20;\nlet className = undefined;\nexport { className as class };\nlet interactionWidthValue = interactionWidth === undefined ? 20 : interactionWidth;\n</script>\n\n<path\n  {id}\n  d={path}\n  class={cc(['svelte-flow__edge-path', className])}\n  marker-start={markerStart}\n  marker-end={markerEnd}\n  fill=\"none\"\n  {style}\n/>\n\n{#if interactionWidthValue}\n  <path\n    d={path}\n    stroke-opacity={0}\n    stroke-width={interactionWidthValue}\n    fill=\"none\"\n    class=\"svelte-flow__edge-interaction\"\n  />\n{/if}\n\n{#if label}\n  <EdgeLabel x={labelX} y={labelY} style={labelStyle}>\n    {label}\n  </EdgeLabel>\n{/if}\n","<script>import { getBezierPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let sourcePosition;\nexport let targetX;\nexport let targetY;\nexport let targetPosition;\n$: [path, labelX, labelY] = getBezierPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    sourcePosition,\n    targetPosition\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","<script>import { getSmoothStepPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let sourcePosition;\nexport let targetX;\nexport let targetY;\nexport let targetPosition;\n$: [path, labelX, labelY] = getSmoothStepPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    sourcePosition,\n    targetPosition\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","<script>import { getStraightPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let targetX;\nexport let targetY;\n$: [path, labelX, labelY] = getStraightPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","<script>import { getSmoothStepPath } from '@xyflow/system';\nimport { BaseEdge } from '../BaseEdge';\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let style = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let interactionWidth = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let sourcePosition;\nexport let targetX;\nexport let targetY;\nexport let targetPosition;\n$: [path, labelX, labelY] = getSmoothStepPath({\n    sourceX,\n    sourceY,\n    targetX,\n    targetY,\n    sourcePosition,\n    targetPosition,\n    borderRadius: 0\n});\n// this is a workaround for suppressing the warning about unused props\n$$restProps;\n</script>\n\n<BaseEdge\n  {path}\n  {labelX}\n  {labelY}\n  {label}\n  {labelStyle}\n  {markerStart}\n  {markerEnd}\n  {interactionWidth}\n  {style}\n/>\n","import { writable, get } from 'svelte/store';\nimport { adoptUserNodes, updateConnectionLookup, infiniteExtent } from '@xyflow/system';\n// we need to sync the user nodes and the internal nodes so that the user can receive the updates\n// made by Svelte Flow (like dragging or selecting a node).\nexport function syncNodeStores(nodesStore, userNodesStore) {\n    const nodesStoreSetter = nodesStore.set;\n    const userNodesStoreSetter = userNodesStore.set;\n    const currentNodesStore = get(nodesStore);\n    const currentUserNodesStore = get(userNodesStore);\n    // depending how the user initializes the nodes, we need to decide if we want to use\n    // the user nodes or the internal nodes for initialization. A user can use a SvelteFlowProvider\n    // without providing any nodes, in that case we want to use the nodes passed by the user.\n    // By default we are using the store nodes, because they already have the absolute positions.\n    const initWithUserNodes = currentNodesStore.length === 0 && currentUserNodesStore.length > 0;\n    let val = initWithUserNodes ? currentUserNodesStore : currentNodesStore;\n    nodesStore.set(val);\n    const _set = (nds) => {\n        const updatedNodes = nodesStoreSetter(nds);\n        val = updatedNodes;\n        userNodesStoreSetter(val);\n        return updatedNodes;\n    };\n    nodesStore.set = userNodesStore.set = _set;\n    nodesStore.update = userNodesStore.update = (fn) => _set(fn(val));\n}\n// same for edges\nexport function syncEdgeStores(edgesStore, userEdgesStore) {\n    const nodesStoreSetter = edgesStore.set;\n    const userEdgesStoreSetter = userEdgesStore.set;\n    let val = get(userEdgesStore);\n    edgesStore.set(val);\n    const _set = (eds) => {\n        nodesStoreSetter(eds);\n        userEdgesStoreSetter(eds);\n        val = eds;\n    };\n    edgesStore.set = userEdgesStore.set = _set;\n    edgesStore.update = userEdgesStore.update = (fn) => _set(fn(val));\n}\n// it is possible to pass a viewport store to SvelteFlow for having more control\n// if that's the case we need to sync the internal viewport with the user viewport\nexport const syncViewportStores = (panZoomStore, viewportStore, userViewportStore) => {\n    if (!userViewportStore) {\n        return;\n    }\n    const panZoom = get(panZoomStore);\n    const viewportStoreSetter = viewportStore.set;\n    const userViewportStoreSetter = userViewportStore.set;\n    let val = userViewportStore ? get(userViewportStore) : { x: 0, y: 0, zoom: 1 };\n    viewportStore.set(val);\n    viewportStore.set = (vp) => {\n        viewportStoreSetter(vp);\n        userViewportStoreSetter(vp);\n        val = vp;\n        return vp;\n    };\n    userViewportStore.set = (vp) => {\n        panZoom?.syncViewport(vp);\n        viewportStoreSetter(vp);\n        userViewportStoreSetter(vp);\n        val = vp;\n        return vp;\n    };\n    viewportStore.update = (fn) => {\n        viewportStore.set(fn(val));\n    };\n    userViewportStore.update = (fn) => {\n        userViewportStore.set(fn(val));\n    };\n};\n// we are creating a custom store for the internals nodes in order to update the zIndex and positionAbsolute.\n// The user only passes in relative positions, so we need to calculate the absolute positions based on the parent nodes.\nexport const createNodesStore = (nodes, nodeLookup, parentLookup, nodeOrigin = [0, 0], nodeExtent = infiniteExtent) => {\n    const { subscribe, set, update } = writable([]);\n    let value = nodes;\n    let defaults = {};\n    let elevateNodesOnSelect = true;\n    const _set = (nds) => {\n        adoptUserNodes(nds, nodeLookup, parentLookup, {\n            elevateNodesOnSelect,\n            nodeOrigin,\n            nodeExtent,\n            defaults,\n            checkEquality: false\n        });\n        value = nds;\n        set(value);\n        return value;\n    };\n    const _update = (fn) => _set(fn(value));\n    const setDefaultOptions = (options) => {\n        defaults = options;\n    };\n    const setOptions = (options) => {\n        elevateNodesOnSelect = options.elevateNodesOnSelect ?? elevateNodesOnSelect;\n    };\n    _set(value);\n    return {\n        subscribe,\n        set: _set,\n        update: _update,\n        setDefaultOptions,\n        setOptions\n    };\n};\nexport const createEdgesStore = (edges, connectionLookup, edgeLookup, defaultOptions) => {\n    const { subscribe, set, update } = writable([]);\n    let value = edges;\n    let defaults = defaultOptions || {};\n    const _set = (eds) => {\n        const nextEdges = defaults ? eds.map((edge) => ({ ...defaults, ...edge })) : eds;\n        updateConnectionLookup(connectionLookup, edgeLookup, nextEdges);\n        value = nextEdges;\n        set(value);\n    };\n    const _update = (fn) => _set(fn(value));\n    const setDefaultOptions = (options) => {\n        defaults = options;\n    };\n    _set(value);\n    return {\n        subscribe,\n        set: _set,\n        update: _update,\n        setDefaultOptions\n    };\n};\n","import { readable, writable } from 'svelte/store';\nimport { infiniteExtent, SelectionMode, ConnectionMode, ConnectionLineType, devWarn, adoptUserNodes, getViewportForBounds, updateConnectionLookup, initialConnection, getInternalNodesBounds } from '@xyflow/system';\nimport DefaultNode from '../components/nodes/DefaultNode.svelte';\nimport InputNode from '../components/nodes/InputNode.svelte';\nimport OutputNode from '../components/nodes/OutputNode.svelte';\nimport GroupNode from '../components/nodes/GroupNode.svelte';\nimport { BezierEdgeInternal, SmoothStepEdgeInternal, StraightEdgeInternal, StepEdgeInternal } from '../components/edges';\nimport { createNodesStore, createEdgesStore } from './utils';\nexport const initialNodeTypes = {\n    input: InputNode,\n    output: OutputNode,\n    default: DefaultNode,\n    group: GroupNode\n};\nexport const initialEdgeTypes = {\n    straight: StraightEdgeInternal,\n    smoothstep: SmoothStepEdgeInternal,\n    default: BezierEdgeInternal,\n    step: StepEdgeInternal\n};\nexport const getInitialStore = ({ nodes = [], edges = [], width, height, fitView, nodeOrigin, nodeExtent }) => {\n    const nodeLookup = new Map();\n    const parentLookup = new Map();\n    const connectionLookup = new Map();\n    const edgeLookup = new Map();\n    const storeNodeOrigin = nodeOrigin ?? [0, 0];\n    const storeNodeExtent = nodeExtent ?? infiniteExtent;\n    adoptUserNodes(nodes, nodeLookup, parentLookup, {\n        nodeExtent: storeNodeExtent,\n        nodeOrigin: storeNodeOrigin,\n        elevateNodesOnSelect: false,\n        checkEquality: false\n    });\n    updateConnectionLookup(connectionLookup, edgeLookup, edges);\n    let viewport = { x: 0, y: 0, zoom: 1 };\n    if (fitView && width && height) {\n        const bounds = getInternalNodesBounds(nodeLookup, {\n            filter: (node) => !!((node.width || node.initialWidth) && (node.height || node.initialHeight))\n        });\n        viewport = getViewportForBounds(bounds, width, height, 0.5, 2, 0.1);\n    }\n    return {\n        flowId: writable(null),\n        nodes: createNodesStore(nodes, nodeLookup, parentLookup, storeNodeOrigin, storeNodeExtent),\n        nodeLookup: readable(nodeLookup),\n        parentLookup: readable(parentLookup),\n        edgeLookup: readable(edgeLookup),\n        visibleNodes: readable([]),\n        edges: createEdgesStore(edges, connectionLookup, edgeLookup),\n        visibleEdges: readable([]),\n        connectionLookup: readable(connectionLookup),\n        height: writable(500),\n        width: writable(500),\n        minZoom: writable(0.5),\n        maxZoom: writable(2),\n        nodeOrigin: writable(storeNodeOrigin),\n        nodeDragThreshold: writable(1),\n        nodeExtent: writable(storeNodeExtent),\n        translateExtent: writable(infiniteExtent),\n        autoPanOnNodeDrag: writable(true),\n        autoPanOnConnect: writable(true),\n        fitViewOnInit: writable(false),\n        fitViewOnInitDone: writable(false),\n        fitViewOptions: writable(undefined),\n        panZoom: writable(null),\n        snapGrid: writable(null),\n        dragging: writable(false),\n        selectionRect: writable(null),\n        selectionKeyPressed: writable(false),\n        multiselectionKeyPressed: writable(false),\n        deleteKeyPressed: writable(false),\n        panActivationKeyPressed: writable(false),\n        zoomActivationKeyPressed: writable(false),\n        selectionRectMode: writable(null),\n        selectionMode: writable(SelectionMode.Partial),\n        nodeTypes: writable(initialNodeTypes),\n        edgeTypes: writable(initialEdgeTypes),\n        viewport: writable(viewport),\n        connectionMode: writable(ConnectionMode.Strict),\n        domNode: writable(null),\n        connection: readable(initialConnection),\n        connectionLineType: writable(ConnectionLineType.Bezier),\n        connectionRadius: writable(20),\n        isValidConnection: writable(() => true),\n        nodesDraggable: writable(true),\n        nodesConnectable: writable(true),\n        elementsSelectable: writable(true),\n        selectNodesOnDrag: writable(true),\n        markers: readable([]),\n        defaultMarkerColor: writable('#b1b1b7'),\n        lib: readable('svelte'),\n        onlyRenderVisibleElements: writable(false),\n        onerror: writable(devWarn),\n        ondelete: writable(undefined),\n        onedgecreate: writable(undefined),\n        onconnect: writable(undefined),\n        onconnectstart: writable(undefined),\n        onconnectend: writable(undefined),\n        onbeforedelete: writable(undefined),\n        nodesInitialized: writable(false),\n        edgesInitialized: writable(false),\n        viewportInitialized: writable(false),\n        initialized: readable(false)\n    };\n};\n","import { derived } from 'svelte/store';\nimport { isEdgeVisible, getEdgePosition, getElevatedEdgeZIndex } from '@xyflow/system';\nexport function getVisibleEdges(store) {\n    const visibleEdges = derived([\n        store.edges,\n        store.nodes,\n        store.nodeLookup,\n        store.onlyRenderVisibleElements,\n        store.viewport,\n        store.width,\n        store.height\n    ], ([edges, , nodeLookup, onlyRenderVisibleElements, viewport, width, height]) => {\n        const visibleEdges = onlyRenderVisibleElements && width && height\n            ? edges.filter((edge) => {\n                const sourceNode = nodeLookup.get(edge.source);\n                const targetNode = nodeLookup.get(edge.target);\n                return (sourceNode &&\n                    targetNode &&\n                    isEdgeVisible({\n                        sourceNode,\n                        targetNode,\n                        width,\n                        height,\n                        transform: [viewport.x, viewport.y, viewport.zoom]\n                    }));\n            })\n            : edges;\n        return visibleEdges;\n    });\n    return derived([visibleEdges, store.nodes, store.nodeLookup, store.connectionMode, store.onerror], ([visibleEdges, , nodeLookup, connectionMode, onerror]) => {\n        const layoutedEdges = visibleEdges.reduce((res, edge) => {\n            const sourceNode = nodeLookup.get(edge.source);\n            const targetNode = nodeLookup.get(edge.target);\n            if (!sourceNode || !targetNode) {\n                return res;\n            }\n            const edgePosition = getEdgePosition({\n                id: edge.id,\n                sourceNode,\n                targetNode,\n                sourceHandle: edge.sourceHandle || null,\n                targetHandle: edge.targetHandle || null,\n                connectionMode,\n                onError: onerror\n            });\n            if (edgePosition) {\n                res.push({\n                    ...edge,\n                    zIndex: getElevatedEdgeZIndex({\n                        selected: edge.selected,\n                        zIndex: edge.zIndex,\n                        sourceNode,\n                        targetNode,\n                        elevateOnSelect: false\n                    }),\n                    ...edgePosition\n                });\n            }\n            return res;\n        }, []);\n        return layoutedEdges;\n    });\n}\n","import { derived } from 'svelte/store';\nimport { getNodesInside } from '@xyflow/system';\nexport function getVisibleNodes(store) {\n    return derived([\n        store.nodeLookup,\n        store.onlyRenderVisibleElements,\n        store.width,\n        store.height,\n        store.viewport,\n        store.nodes\n    ], ([nodeLookup, onlyRenderVisibleElements, width, height, viewport]) => {\n        const transform = [viewport.x, viewport.y, viewport.zoom];\n        return onlyRenderVisibleElements\n            ? getNodesInside(nodeLookup, { x: 0, y: 0, width, height }, transform, true)\n            : Array.from(nodeLookup.values());\n    });\n}\n","import { getContext, setContext } from 'svelte';\nimport { derived, get, writable } from 'svelte/store';\nimport { createMarkerIds, fitView as fitViewSystem, getElementsToRemove, panBy as panBySystem, updateNodeInternals as updateNodeInternalsSystem, addEdge as addEdgeUtil, initialConnection, errorMessages, pointToRendererPoint, getFitViewNodes } from '@xyflow/system';\nimport { initialEdgeTypes, initialNodeTypes, getInitialStore } from './initial-store';\nimport { syncNodeStores, syncEdgeStores, syncViewportStores } from './utils';\nimport { getVisibleEdges } from './visible-edges';\nimport { getVisibleNodes } from './visible-nodes';\nexport const key = Symbol();\nexport function createStore({ nodes, edges, width, height, fitView: fitViewOnCreate, nodeOrigin, nodeExtent }) {\n    const store = getInitialStore({\n        nodes,\n        edges,\n        width,\n        height,\n        fitView: fitViewOnCreate,\n        nodeOrigin,\n        nodeExtent\n    });\n    function setNodeTypes(nodeTypes) {\n        store.nodeTypes.set({\n            ...initialNodeTypes,\n            ...nodeTypes\n        });\n    }\n    function setEdgeTypes(edgeTypes) {\n        store.edgeTypes.set({\n            ...initialEdgeTypes,\n            ...edgeTypes\n        });\n    }\n    function addEdge(edgeParams) {\n        const edges = get(store.edges);\n        store.edges.set(addEdgeUtil(edgeParams, edges));\n    }\n    const updateNodePositions = (nodeDragItems, dragging = false) => {\n        const nodeLookup = get(store.nodeLookup);\n        for (const [id, dragItem] of nodeDragItems) {\n            const node = nodeLookup.get(id)?.internals.userNode;\n            if (!node) {\n                continue;\n            }\n            node.position = dragItem.position;\n            node.dragging = dragging;\n        }\n        store.nodes.update((nds) => nds);\n    };\n    function updateNodeInternals(updates) {\n        const nodeLookup = get(store.nodeLookup);\n        const { changes, updatedInternals } = updateNodeInternalsSystem(updates, nodeLookup, get(store.parentLookup), get(store.domNode), get(store.nodeOrigin));\n        if (!updatedInternals) {\n            return;\n        }\n        if (!get(store.fitViewOnInitDone) && get(store.fitViewOnInit)) {\n            const fitViewOptions = get(store.fitViewOptions);\n            const fitViewOnInitDone = fitViewSync({\n                ...fitViewOptions,\n                nodes: fitViewOptions?.nodes\n            });\n            store.fitViewOnInitDone.set(fitViewOnInitDone);\n        }\n        for (const change of changes) {\n            const node = nodeLookup.get(change.id)?.internals.userNode;\n            if (!node) {\n                continue;\n            }\n            switch (change.type) {\n                case 'dimensions': {\n                    const measured = { ...node.measured, ...change.dimensions };\n                    if (change.setAttributes) {\n                        node.width = change.dimensions?.width ?? node.width;\n                        node.height = change.dimensions?.height ?? node.height;\n                    }\n                    node.measured = measured;\n                    break;\n                }\n                case 'position':\n                    node.position = change.position ?? node.position;\n                    break;\n            }\n        }\n        store.nodes.update((nds) => nds);\n        if (!get(store.nodesInitialized)) {\n            store.nodesInitialized.set(true);\n        }\n    }\n    function fitView(options) {\n        const panZoom = get(store.panZoom);\n        if (!panZoom) {\n            return Promise.resolve(false);\n        }\n        const fitViewNodes = getFitViewNodes(get(store.nodeLookup), options);\n        return fitViewSystem({\n            nodes: fitViewNodes,\n            width: get(store.width),\n            height: get(store.height),\n            minZoom: get(store.minZoom),\n            maxZoom: get(store.maxZoom),\n            panZoom\n        }, options);\n    }\n    function fitViewSync(options) {\n        const panZoom = get(store.panZoom);\n        if (!panZoom) {\n            return false;\n        }\n        const fitViewNodes = getFitViewNodes(get(store.nodeLookup), options);\n        fitViewSystem({\n            nodes: fitViewNodes,\n            width: get(store.width),\n            height: get(store.height),\n            minZoom: get(store.minZoom),\n            maxZoom: get(store.maxZoom),\n            panZoom\n        }, options);\n        return fitViewNodes.size > 0;\n    }\n    function zoomBy(factor, options) {\n        const panZoom = get(store.panZoom);\n        if (!panZoom) {\n            return Promise.resolve(false);\n        }\n        return panZoom.scaleBy(factor, options);\n    }\n    function zoomIn(options) {\n        return zoomBy(1.2, options);\n    }\n    function zoomOut(options) {\n        return zoomBy(1 / 1.2, options);\n    }\n    function setMinZoom(minZoom) {\n        const panZoom = get(store.panZoom);\n        if (panZoom) {\n            panZoom.setScaleExtent([minZoom, get(store.maxZoom)]);\n            store.minZoom.set(minZoom);\n        }\n    }\n    function setMaxZoom(maxZoom) {\n        const panZoom = get(store.panZoom);\n        if (panZoom) {\n            panZoom.setScaleExtent([get(store.minZoom), maxZoom]);\n            store.maxZoom.set(maxZoom);\n        }\n    }\n    function setTranslateExtent(extent) {\n        const panZoom = get(store.panZoom);\n        if (panZoom) {\n            panZoom.setTranslateExtent(extent);\n            store.translateExtent.set(extent);\n        }\n    }\n    function resetSelectedElements(elements) {\n        let elementsChanged = false;\n        elements.forEach((element) => {\n            if (element.selected) {\n                element.selected = false;\n                elementsChanged = true;\n            }\n        });\n        return elementsChanged;\n    }\n    function setPaneClickDistance(distance) {\n        get(store.panZoom)?.setClickDistance(distance);\n    }\n    function unselectNodesAndEdges(params) {\n        const resetNodes = resetSelectedElements(params?.nodes || get(store.nodes));\n        if (resetNodes)\n            store.nodes.set(get(store.nodes));\n        const resetEdges = resetSelectedElements(params?.edges || get(store.edges));\n        if (resetEdges)\n            store.edges.set(get(store.edges));\n    }\n    store.deleteKeyPressed.subscribe(async (deleteKeyPressed) => {\n        if (deleteKeyPressed) {\n            const nodes = get(store.nodes);\n            const edges = get(store.edges);\n            const selectedNodes = nodes.filter((node) => node.selected);\n            const selectedEdges = edges.filter((edge) => edge.selected);\n            const { nodes: matchingNodes, edges: matchingEdges } = await getElementsToRemove({\n                nodesToRemove: selectedNodes,\n                edgesToRemove: selectedEdges,\n                nodes,\n                edges,\n                onBeforeDelete: get(store.onbeforedelete)\n            });\n            if (matchingNodes.length || matchingEdges.length) {\n                store.nodes.update((nds) => nds.filter((node) => !matchingNodes.some((mN) => mN.id === node.id)));\n                store.edges.update((eds) => eds.filter((edge) => !matchingEdges.some((mE) => mE.id === edge.id)));\n                get(store.ondelete)?.({\n                    nodes: matchingNodes,\n                    edges: matchingEdges\n                });\n            }\n        }\n    });\n    function addSelectedNodes(ids) {\n        const isMultiSelection = get(store.multiselectionKeyPressed);\n        store.nodes.update((ns) => ns.map((node) => {\n            const nodeWillBeSelected = ids.includes(node.id);\n            const selected = isMultiSelection\n                ? node.selected || nodeWillBeSelected\n                : nodeWillBeSelected;\n            // we need to mutate the node here in order to have the correct selected state in the drag handler\n            node.selected = selected;\n            return node;\n        }));\n        if (!isMultiSelection) {\n            store.edges.update((es) => es.map((edge) => {\n                edge.selected = false;\n                return edge;\n            }));\n        }\n    }\n    function addSelectedEdges(ids) {\n        const isMultiSelection = get(store.multiselectionKeyPressed);\n        store.edges.update((edges) => edges.map((edge) => {\n            const edgeWillBeSelected = ids.includes(edge.id);\n            const selected = isMultiSelection\n                ? edge.selected || edgeWillBeSelected\n                : edgeWillBeSelected;\n            edge.selected = selected;\n            return edge;\n        }));\n        if (!isMultiSelection) {\n            store.nodes.update((ns) => ns.map((node) => {\n                node.selected = false;\n                return node;\n            }));\n        }\n    }\n    function handleNodeSelection(id) {\n        const node = get(store.nodes)?.find((n) => n.id === id);\n        if (!node) {\n            console.warn('012', errorMessages['error012'](id));\n            return;\n        }\n        store.selectionRect.set(null);\n        store.selectionRectMode.set(null);\n        if (!node.selected) {\n            addSelectedNodes([id]);\n        }\n        else if (node.selected && get(store.multiselectionKeyPressed)) {\n            unselectNodesAndEdges({ nodes: [node], edges: [] });\n        }\n    }\n    function panBy(delta) {\n        const viewport = get(store.viewport);\n        return panBySystem({\n            delta,\n            panZoom: get(store.panZoom),\n            transform: [viewport.x, viewport.y, viewport.zoom],\n            translateExtent: get(store.translateExtent),\n            width: get(store.width),\n            height: get(store.height)\n        });\n    }\n    const _connection = writable(initialConnection);\n    const updateConnection = (newConnection) => {\n        _connection.set({ ...newConnection });\n    };\n    function cancelConnection() {\n        _connection.set(initialConnection);\n    }\n    function reset() {\n        store.fitViewOnInitDone.set(false);\n        store.selectionRect.set(null);\n        store.selectionRectMode.set(null);\n        store.snapGrid.set(null);\n        store.isValidConnection.set(() => true);\n        unselectNodesAndEdges();\n        cancelConnection();\n    }\n    return {\n        // state\n        ...store,\n        // derived state\n        visibleEdges: getVisibleEdges(store),\n        visibleNodes: getVisibleNodes(store),\n        connection: derived([_connection, store.viewport], ([connection, viewport]) => {\n            return connection.inProgress\n                ? {\n                    ...connection,\n                    to: pointToRendererPoint(connection.to, [viewport.x, viewport.y, viewport.zoom])\n                }\n                : { ...connection };\n        }),\n        markers: derived([store.edges, store.defaultMarkerColor, store.flowId], ([edges, defaultColor, id]) => createMarkerIds(edges, { defaultColor, id })),\n        initialized: (() => {\n            let initialized = false;\n            const initialNodesLength = get(store.nodes).length;\n            const initialEdgesLength = get(store.edges).length;\n            return derived([store.nodesInitialized, store.edgesInitialized, store.viewportInitialized], ([nodesInitialized, edgesInitialized, viewportInitialized]) => {\n                // If it was already initialized, return true from then on\n                if (initialized)\n                    return initialized;\n                // if it hasn't been initialised check if it's now\n                if (initialNodesLength === 0) {\n                    initialized = viewportInitialized;\n                }\n                else if (initialEdgesLength === 0) {\n                    initialized = viewportInitialized && nodesInitialized;\n                }\n                else {\n                    initialized = viewportInitialized && nodesInitialized && edgesInitialized;\n                }\n                return initialized;\n            });\n        })(),\n        // actions\n        syncNodeStores: (nodes) => syncNodeStores(store.nodes, nodes),\n        syncEdgeStores: (edges) => syncEdgeStores(store.edges, edges),\n        syncViewport: (viewport) => syncViewportStores(store.panZoom, store.viewport, viewport),\n        setNodeTypes,\n        setEdgeTypes,\n        addEdge,\n        updateNodePositions,\n        updateNodeInternals,\n        zoomIn,\n        zoomOut,\n        fitView: (options) => fitView(options),\n        setMinZoom,\n        setMaxZoom,\n        setTranslateExtent,\n        setPaneClickDistance,\n        unselectNodesAndEdges,\n        addSelectedNodes,\n        addSelectedEdges,\n        handleNodeSelection,\n        panBy,\n        updateConnection,\n        cancelConnection,\n        reset\n    };\n}\nexport function useStore() {\n    const store = getContext(key);\n    if (!store) {\n        throw new Error('In order to use useStore you need to wrap your component in a <SvelteFlowProvider />');\n    }\n    return store.getStore();\n}\nexport function createStoreContext({ nodes, edges, width, height, fitView, nodeOrigin, nodeExtent }) {\n    const store = createStore({ nodes, edges, width, height, fitView, nodeOrigin, nodeExtent });\n    setContext(key, {\n        getStore: () => store\n    });\n    return store;\n}\n","import { PanOnScrollMode, XYPanZoom } from '@xyflow/system';\nexport default function zoom(domNode, params) {\n    const { panZoom, minZoom, maxZoom, initialViewport, viewport, dragging, translateExtent, paneClickDistance } = params;\n    const panZoomInstance = XYPanZoom({\n        domNode,\n        minZoom,\n        maxZoom,\n        translateExtent,\n        viewport: initialViewport,\n        paneClickDistance,\n        onDraggingChange: dragging.set\n    });\n    const currentViewport = panZoomInstance.getViewport();\n    viewport.set(currentViewport);\n    panZoom.set(panZoomInstance);\n    panZoomInstance.update(params);\n    return {\n        update(params) {\n            panZoomInstance.update(params);\n        }\n    };\n}\n","<script>import { onMount } from 'svelte';\nimport { PanOnScrollMode } from '@xyflow/system';\nimport { useStore } from '../../store';\nimport zoom from '../../actions/zoom';\nexport let initialViewport = undefined;\nexport let onMoveStart = undefined;\nexport let onMove = undefined;\nexport let onMoveEnd = undefined;\nexport let panOnScrollMode;\nexport let preventScrolling;\nexport let zoomOnScroll;\nexport let zoomOnDoubleClick;\nexport let zoomOnPinch;\nexport let panOnDrag;\nexport let panOnScroll;\nexport let paneClickDistance;\nconst { viewport, panZoom, selectionRect, minZoom, maxZoom, dragging, translateExtent, lib, panActivationKeyPressed, zoomActivationKeyPressed, viewportInitialized } = useStore();\n$: viewPort = initialViewport || { x: 0, y: 0, zoom: 1 };\n$: _panOnDrag = $panActivationKeyPressed || panOnDrag;\n$: _panOnScroll = $panActivationKeyPressed || panOnScroll;\nconst onTransformChange = (transform) => viewport.set({ x: transform[0], y: transform[1], zoom: transform[2] });\nonMount(() => {\n    $viewportInitialized = true;\n});\n</script>\n\n<div\n  class=\"svelte-flow__zoom\"\n  use:zoom={{\n    viewport,\n    minZoom: $minZoom,\n    maxZoom: $maxZoom,\n    initialViewport: viewPort,\n    dragging,\n    panZoom,\n    onPanZoomStart: onMoveStart,\n    onPanZoom: onMove,\n    onPanZoomEnd: onMoveEnd,\n    zoomOnScroll,\n    zoomOnDoubleClick,\n    zoomOnPinch,\n    panOnScroll: _panOnScroll,\n    panOnDrag: _panOnDrag,\n    panOnScrollSpeed: 0.5,\n    panOnScrollMode: panOnScrollMode || PanOnScrollMode.Free,\n    zoomActivationKeyPressed: $zoomActivationKeyPressed,\n    preventScrolling: typeof preventScrolling === 'boolean' ? preventScrolling : true,\n    noPanClassName: 'nopan',\n    noWheelClassName: 'nowheel',\n    userSelectionActive: !!$selectionRect,\n    translateExtent: $translateExtent,\n    lib: $lib,\n    paneClickDistance,\n    onTransformChange\n  }}\n>\n  <slot />\n</div>\n\n<style>\n  .svelte-flow__zoom {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 4;\n  }\n</style>\n","<script context=\"module\">export function wrapHandler(handler, container) {\n    return (event) => {\n        if (event.target !== container) {\n            return;\n        }\n        handler?.(event);\n    };\n}\nexport function toggleSelected(ids) {\n    return (item) => {\n        const isSelected = ids.includes(item.id);\n        if (item.selected !== isSelected) {\n            item.selected = isSelected;\n        }\n        return item;\n    };\n}\n</script>\n\n<script>import { createEventDispatcher } from 'svelte';\nimport { SelectionMode, getEventPosition, getNodesInside, getConnectedEdges } from '@xyflow/system';\nimport { useStore } from '../../store';\nexport let panOnDrag = undefined;\nexport let selectionOnDrag = undefined;\nconst dispatch = createEventDispatcher();\nconst { nodes, nodeLookup, edges, viewport, dragging, elementsSelectable, selectionRect, selectionRectMode, selectionKeyPressed, selectionMode, panActivationKeyPressed, unselectNodesAndEdges } = useStore();\nlet container;\nlet containerBounds = null;\nlet selectedNodes = [];\n$: _panOnDrag = $panActivationKeyPressed || panOnDrag;\n$: isSelecting =\n    $selectionKeyPressed || $selectionRect || (selectionOnDrag && _panOnDrag !== true);\n$: hasActiveSelection = $elementsSelectable && (isSelecting || $selectionRectMode === 'user');\n// Used to prevent click events when the user lets go of the selectionKey during a selection\nlet selectionInProgress = false;\nfunction onClick(event) {\n    // We prevent click events when the user let go of the selectionKey during a selection\n    if (selectionInProgress) {\n        selectionInProgress = false;\n        return;\n    }\n    dispatch('paneclick', { event });\n    unselectNodesAndEdges();\n    selectionRectMode.set(null);\n}\nfunction onPointerDown(event) {\n    containerBounds = container.getBoundingClientRect();\n    if (!elementsSelectable ||\n        !isSelecting ||\n        event.button !== 0 ||\n        event.target !== container ||\n        !containerBounds) {\n        return;\n    }\n    event.target?.setPointerCapture?.(event.pointerId);\n    const { x, y } = getEventPosition(event, containerBounds);\n    unselectNodesAndEdges();\n    selectionRect.set({\n        width: 0,\n        height: 0,\n        startX: x,\n        startY: y,\n        x,\n        y\n    });\n    // onSelectionStart?.(event);\n}\nfunction onPointerMove(event) {\n    if (!isSelecting || !containerBounds || !$selectionRect) {\n        return;\n    }\n    selectionInProgress = true;\n    const mousePos = getEventPosition(event, containerBounds);\n    const startX = $selectionRect.startX ?? 0;\n    const startY = $selectionRect.startY ?? 0;\n    const nextUserSelectRect = {\n        ...$selectionRect,\n        x: mousePos.x < startX ? mousePos.x : startX,\n        y: mousePos.y < startY ? mousePos.y : startY,\n        width: Math.abs(mousePos.x - startX),\n        height: Math.abs(mousePos.y - startY)\n    };\n    const prevSelectedNodeIds = selectedNodes.map((n) => n.id);\n    const prevSelectedEdgeIds = getConnectedEdges(selectedNodes, $edges).map((e) => e.id);\n    selectedNodes = getNodesInside($nodeLookup, nextUserSelectRect, [$viewport.x, $viewport.y, $viewport.zoom], $selectionMode === SelectionMode.Partial, true);\n    const selectedEdgeIds = getConnectedEdges(selectedNodes, $edges).map((e) => e.id);\n    const selectedNodeIds = selectedNodes.map((n) => n.id);\n    // this prevents unnecessary updates while updating the selection rectangle\n    if (prevSelectedNodeIds.length !== selectedNodeIds.length ||\n        selectedNodeIds.some((id) => !prevSelectedNodeIds.includes(id))) {\n        nodes.update((nodes) => nodes.map(toggleSelected(selectedNodeIds)));\n    }\n    if (prevSelectedEdgeIds.length !== selectedEdgeIds.length ||\n        selectedEdgeIds.some((id) => !prevSelectedEdgeIds.includes(id))) {\n        edges.update((edges) => edges.map(toggleSelected(selectedEdgeIds)));\n    }\n    selectionRectMode.set('user');\n    selectionRect.set(nextUserSelectRect);\n}\nfunction onPointerUp(event) {\n    if (event.button !== 0) {\n        return;\n    }\n    event.target?.releasePointerCapture?.(event.pointerId);\n    // We only want to trigger click functions when in selection mode if\n    // the user did not move the mouse.\n    if (!isSelecting && $selectionRectMode === 'user' && event.target === container) {\n        onClick?.(event);\n    }\n    selectionRect.set(null);\n    if (selectedNodes.length > 0) {\n        $selectionRectMode = 'nodes';\n    }\n    // If the user kept holding the selectionKey during the selection,\n    // we need to reset the selectionInProgress, so the next click event is not prevented\n    if ($selectionKeyPressed) {\n        selectionInProgress = false;\n    }\n    // onSelectionEnd?.(event);\n}\nconst onContextMenu = (event) => {\n    if (Array.isArray(_panOnDrag) && _panOnDrag?.includes(2)) {\n        event.preventDefault();\n        return;\n    }\n    dispatch('panecontextmenu', { event });\n};\n</script>\n\n<!-- svelte-ignore a11y-no-static-element-interactions -->\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<div\n  bind:this={container}\n  class=\"svelte-flow__pane\"\n  class:draggable={panOnDrag === true || (Array.isArray(panOnDrag) && panOnDrag.includes(0))}\n  class:dragging={$dragging}\n  class:selection={isSelecting}\n  on:click={hasActiveSelection ? undefined : wrapHandler(onClick, container)}\n  on:pointerdown={hasActiveSelection ? onPointerDown : undefined}\n  on:pointermove={hasActiveSelection ? onPointerMove : undefined}\n  on:pointerup={hasActiveSelection ? onPointerUp : undefined}\n  on:contextmenu={wrapHandler(onContextMenu, container)}\n>\n  <slot />\n</div>\n\n<style>\n  .svelte-flow__pane {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n  }\n</style>\n","<script>import { useStore } from '../../store';\nconst { viewport } = useStore();\n</script>\n\n<div\n  class=\"svelte-flow__viewport xyflow__viewport\"\n  style=\"transform: translate({$viewport.x}px, {$viewport.y}px) scale({$viewport.zoom})\"\n>\n  <slot />\n</div>\n\n<style>\n  .svelte-flow__viewport {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n</style>\n","import { get } from 'svelte/store';\nimport { XYDrag } from '@xyflow/system';\nexport default function drag(domNode, params) {\n    const { store, onDrag, onDragStart, onDragStop, onNodeMouseDown } = params;\n    const dragInstance = XYDrag({\n        onDrag,\n        onDragStart,\n        onDragStop,\n        onNodeMouseDown,\n        getStoreItems: () => {\n            const snapGrid = get(store.snapGrid);\n            const vp = get(store.viewport);\n            return {\n                nodes: get(store.nodes),\n                nodeLookup: get(store.nodeLookup),\n                edges: get(store.edges),\n                nodeExtent: get(store.nodeExtent),\n                snapGrid: snapGrid ? snapGrid : [0, 0],\n                snapToGrid: !!snapGrid,\n                nodeOrigin: get(store.nodeOrigin),\n                multiSelectionActive: get(store.multiselectionKeyPressed),\n                domNode: get(store.domNode),\n                transform: [vp.x, vp.y, vp.zoom],\n                autoPanOnNodeDrag: get(store.autoPanOnNodeDrag),\n                nodesDraggable: get(store.nodesDraggable),\n                selectNodesOnDrag: get(store.selectNodesOnDrag),\n                nodeDragThreshold: get(store.nodeDragThreshold),\n                unselectNodesAndEdges: store.unselectNodesAndEdges,\n                updateNodePositions: store.updateNodePositions,\n                panBy: store.panBy\n            };\n        }\n    });\n    function updateDrag(domNode, params) {\n        if (params.disabled) {\n            dragInstance.destroy();\n            return;\n        }\n        dragInstance.update({\n            domNode,\n            noDragClassName: params.noDragClass,\n            handleSelector: params.handleSelector,\n            nodeId: params.nodeId,\n            isSelectable: params.isSelectable,\n            nodeClickDistance: params.nodeClickDistance\n        });\n    }\n    updateDrag(domNode, params);\n    return {\n        update(params) {\n            updateDrag(domNode, params);\n        },\n        destroy() {\n            dragInstance.destroy();\n        }\n    };\n}\n","export function getNodeInlineStyleDimensions({ width, height, initialWidth, initialHeight, measuredWidth, measuredHeight }) {\n    if (measuredWidth === undefined && measuredHeight === undefined) {\n        const styleWidth = width ?? initialWidth;\n        const styleHeight = height ?? initialHeight;\n        return {\n            width: styleWidth ? `width:${styleWidth}px;` : '',\n            height: styleHeight ? `height:${styleHeight}px;` : ''\n        };\n    }\n    return {\n        width: width ? `width:${width}px;` : '',\n        height: height ? `height:${height}px;` : ''\n    };\n}\n","<svelte:options immutable />\n\n<script>import { setContext, onDestroy, createEventDispatcher } from 'svelte';\nimport { get, writable } from 'svelte/store';\nimport cc from 'classcat';\nimport { errorMessages, Position } from '@xyflow/system';\nimport drag from '../../actions/drag';\nimport { useStore } from '../../store';\nimport DefaultNode from '../nodes/DefaultNode.svelte';\nimport { getNodeInlineStyleDimensions } from './utils';\nexport let node;\nexport let id;\nexport let data = {};\nexport let selected = false;\nexport let draggable = undefined;\nexport let selectable = undefined;\nexport let connectable = true;\nexport let deletable = true;\nexport let hidden = false;\nexport let dragging = false;\nexport let resizeObserver = null;\nexport let style = undefined;\nexport let type = 'default';\nexport let isParent = false;\nexport let positionX;\nexport let positionY;\nexport let sourcePosition = undefined;\nexport let targetPosition = undefined;\nexport let zIndex;\nexport let measuredWidth = undefined;\nexport let measuredHeight = undefined;\nexport let initialWidth = undefined;\nexport let initialHeight = undefined;\nexport let width = undefined;\nexport let height = undefined;\nexport let dragHandle = undefined;\nexport let initialized = false;\nexport let parentId = undefined;\nexport let nodeClickDistance = undefined;\nlet className = '';\nexport { className as class };\nconst store = useStore();\nconst { nodeTypes, nodeDragThreshold, selectNodesOnDrag, handleNodeSelection, updateNodeInternals } = store;\nlet nodeRef;\nlet prevNodeRef = null;\nconst dispatchNodeEvent = createEventDispatcher();\nconst connectableStore = writable(connectable);\nlet prevType = undefined;\nlet prevSourcePosition = undefined;\nlet prevTargetPosition = undefined;\n$: nodeType = type || 'default';\n$: nodeTypeValid = !!$nodeTypes[nodeType];\n$: nodeComponent = $nodeTypes[nodeType] || DefaultNode;\n$: {\n    if (!nodeTypeValid) {\n        console.warn('003', errorMessages['error003'](type));\n    }\n}\n$: inlineStyleDimensions = getNodeInlineStyleDimensions({\n    width,\n    height,\n    initialWidth,\n    initialHeight,\n    measuredWidth,\n    measuredHeight\n});\n$: {\n    connectableStore.set(!!connectable);\n}\n$: {\n    // if type, sourcePosition or targetPosition changes,\n    // we need to re-calculate the handle positions\n    const doUpdate = (prevType && nodeType !== prevType) ||\n        (prevSourcePosition && sourcePosition !== prevSourcePosition) ||\n        (prevTargetPosition && targetPosition !== prevTargetPosition);\n    if (doUpdate) {\n        requestAnimationFrame(() => updateNodeInternals(new Map([\n            [\n                id,\n                {\n                    id,\n                    nodeElement: nodeRef,\n                    force: true\n                }\n            ]\n        ])));\n    }\n    prevType = nodeType;\n    prevSourcePosition = sourcePosition;\n    prevTargetPosition = targetPosition;\n}\nsetContext('svelteflow__node_id', id);\nsetContext('svelteflow__node_connectable', connectableStore);\n$: {\n    if (resizeObserver && (nodeRef !== prevNodeRef || !initialized)) {\n        prevNodeRef && resizeObserver.unobserve(prevNodeRef);\n        nodeRef && resizeObserver.observe(nodeRef);\n        prevNodeRef = nodeRef;\n    }\n}\nonDestroy(() => {\n    if (prevNodeRef) {\n        resizeObserver?.unobserve(prevNodeRef);\n    }\n});\nfunction onSelectNodeHandler(event) {\n    if (selectable && (!get(selectNodesOnDrag) || !draggable || get(nodeDragThreshold) > 0)) {\n        // this handler gets called by XYDrag on drag start when selectNodesOnDrag=true\n        // here we only need to call it when selectNodesOnDrag=false\n        handleNodeSelection(id);\n    }\n    dispatchNodeEvent('nodeclick', { node: node.internals.userNode, event });\n}\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<!-- svelte-ignore a11y-no-static-element-interactions -->\n{#if !hidden}\n  <div\n    use:drag={{\n      nodeId: id,\n      isSelectable: selectable,\n      disabled: false,\n      handleSelector: dragHandle,\n      noDragClass: 'nodrag',\n      nodeClickDistance,\n      onNodeMouseDown: handleNodeSelection,\n      onDrag: (event, _, targetNode, nodes) => {\n        dispatchNodeEvent('nodedrag', { event, targetNode, nodes });\n      },\n      onDragStart: (event, _, targetNode, nodes) => {\n        dispatchNodeEvent('nodedragstart', { event, targetNode, nodes });\n      },\n      onDragStop: (event, _, targetNode, nodes) => {\n        dispatchNodeEvent('nodedragstop', { event, targetNode, nodes });\n      },\n      store\n    }}\n    bind:this={nodeRef}\n    data-id={id}\n    class={cc(['svelte-flow__node', `svelte-flow__node-${nodeType}`, className])}\n    class:dragging\n    class:selected\n    class:draggable\n    class:connectable\n    class:selectable\n    class:nopan={draggable}\n    class:parent={isParent}\n    style:z-index={zIndex}\n    style:transform=\"translate({positionX}px, {positionY}px)\"\n    style:visibility={initialized ? 'visible' : 'hidden'}\n    style=\"{style ?? ''};{inlineStyleDimensions.width}{inlineStyleDimensions.height}\"\n    on:click={onSelectNodeHandler}\n    on:mouseenter={(event) => dispatchNodeEvent('nodemouseenter', { node, event })}\n    on:mouseleave={(event) => dispatchNodeEvent('nodemouseleave', { node, event })}\n    on:mousemove={(event) => dispatchNodeEvent('nodemousemove', { node, event })}\n    on:contextmenu={(event) => dispatchNodeEvent('nodecontextmenu', { node, event })}\n  >\n    <svelte:component\n      this={nodeComponent}\n      {data}\n      {id}\n      {selected}\n      {selectable}\n      {deletable}\n      {sourcePosition}\n      {targetPosition}\n      {zIndex}\n      {dragging}\n      {draggable}\n      {dragHandle}\n      {parentId}\n      type={nodeType}\n      isConnectable={$connectableStore}\n      positionAbsoluteX={positionX}\n      positionAbsoluteY={positionY}\n      {width}\n      {height}\n    />\n  </div>\n{/if}\n","<script>import { onDestroy } from 'svelte';\nimport { nodeHasDimensions } from '@xyflow/system';\nimport { NodeWrapper } from '../../components/NodeWrapper';\nimport { useStore } from '../../store';\nexport let nodeClickDistance = 0;\nconst { visibleNodes, nodesDraggable, nodesConnectable, elementsSelectable, updateNodeInternals, parentLookup } = useStore();\nconst resizeObserver = typeof ResizeObserver === 'undefined'\n    ? null\n    : new ResizeObserver((entries) => {\n        const updates = new Map();\n        entries.forEach((entry) => {\n            const id = entry.target.getAttribute('data-id');\n            updates.set(id, {\n                id,\n                nodeElement: entry.target,\n                force: true\n            });\n        });\n        updateNodeInternals(updates);\n    });\nonDestroy(() => {\n    resizeObserver?.disconnect();\n});\n</script>\n\n<div class=\"svelte-flow__nodes\">\n  {#each $visibleNodes as node (node.id)}\n    <NodeWrapper\n      {node}\n      id={node.id}\n      data={node.data}\n      selected={!!node.selected}\n      hidden={!!node.hidden}\n      draggable={!!(node.draggable || ($nodesDraggable && typeof node.draggable === 'undefined'))}\n      selectable={!!(\n        node.selectable ||\n        ($elementsSelectable && typeof node.selectable === 'undefined')\n      )}\n      connectable={!!(\n        node.connectable ||\n        ($nodesConnectable && typeof node.connectable === 'undefined')\n      )}\n      deletable={node.deletable ?? true}\n      positionX={node.internals.positionAbsolute.x}\n      positionY={node.internals.positionAbsolute.y}\n      isParent={$parentLookup.has(node.id)}\n      style={node.style}\n      class={node.class}\n      type={node.type ?? 'default'}\n      sourcePosition={node.sourcePosition}\n      targetPosition={node.targetPosition}\n      dragging={node.dragging}\n      zIndex={node.internals.z ?? 0}\n      dragHandle={node.dragHandle}\n      initialized={nodeHasDimensions(node)}\n      width={node.width}\n      height={node.height}\n      initialWidth={node.initialWidth}\n      initialHeight={node.initialHeight}\n      measuredWidth={node.measured.width}\n      measuredHeight={node.measured.height}\n      parentId={node.parentId}\n      {resizeObserver}\n      {nodeClickDistance}\n      on:nodeclick\n      on:nodemouseenter\n      on:nodemousemove\n      on:nodemouseleave\n      on:nodedrag\n      on:nodedragstart\n      on:nodedragstop\n      on:nodecontextmenu\n    />\n  {/each}\n</div>\n\n<style>\n  .svelte-flow__nodes {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    left: 0;\n    top: 0;\n  }\n</style>\n","<svelte:options immutable />\n\n<script>import { createEventDispatcher, setContext } from 'svelte';\nimport cc from 'classcat';\nimport { getMarkerId } from '@xyflow/system';\nimport { useStore } from '../../store';\nimport { BezierEdgeInternal } from '../edges';\nimport { useHandleEdgeSelect } from '../../hooks/useHandleEdgeSelect';\nexport let id;\nexport let type = 'default';\nexport let source = '';\nexport let target = '';\nexport let data = {};\nexport let style = undefined;\nexport let zIndex = undefined;\nexport let animated = false;\nexport let selected = false;\nexport let selectable = undefined;\nexport let deletable = undefined;\nexport let hidden = false;\nexport let label = undefined;\nexport let labelStyle = undefined;\nexport let markerStart = undefined;\nexport let markerEnd = undefined;\nexport let sourceHandle = undefined;\nexport let targetHandle = undefined;\nexport let sourceX;\nexport let sourceY;\nexport let targetX;\nexport let targetY;\nexport let sourcePosition;\nexport let targetPosition;\nexport let ariaLabel = undefined;\nexport let interactionWidth = undefined;\n// @ todo: support edge updates\nlet className = '';\nexport { className as class };\nsetContext('svelteflow__edge_id', id);\nconst { edgeLookup, edgeTypes, flowId, elementsSelectable } = useStore();\nconst dispatch = createEventDispatcher();\n$: edgeType = type || 'default';\n$: edgeComponent = $edgeTypes[edgeType] || BezierEdgeInternal;\n$: markerStartUrl = markerStart ? `url('#${getMarkerId(markerStart, $flowId)}')` : undefined;\n$: markerEndUrl = markerEnd ? `url('#${getMarkerId(markerEnd, $flowId)}')` : undefined;\n$: isSelectable = selectable ?? $elementsSelectable;\nconst handleEdgeSelect = useHandleEdgeSelect();\nfunction onClick(event) {\n    const edge = $edgeLookup.get(id);\n    if (edge) {\n        handleEdgeSelect(id);\n        dispatch('edgeclick', { event, edge });\n    }\n}\nfunction onMouseEvent(event, type) {\n    const edge = $edgeLookup.get(id);\n    if (edge) {\n        dispatch(type, { event, edge });\n    }\n}\n</script>\n\n<!-- svelte-ignore a11y-click-events-have-key-events -->\n<!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n{#if !hidden}\n  <svg style:z-index={zIndex}>\n    <g\n      class={cc(['svelte-flow__edge', className])}\n      class:animated\n      class:selected\n      class:selectable={isSelectable}\n      data-id={id}\n      on:click={onClick}\n      on:contextmenu={(e) => {\n        onMouseEvent(e, 'edgecontextmenu');\n      }}\n      on:mouseenter={(e) => {\n        onMouseEvent(e, 'edgemouseenter');\n      }}\n      on:mouseleave={(e) => {\n        onMouseEvent(e, 'edgemouseleave');\n      }}\n      aria-label={ariaLabel === null\n        ? undefined\n        : ariaLabel\n          ? ariaLabel\n          : `Edge from ${source} to ${target}`}\n      role=\"img\"\n    >\n      <svelte:component\n        this={edgeComponent}\n        {id}\n        {source}\n        {target}\n        {sourceX}\n        {sourceY}\n        {targetX}\n        {targetY}\n        {sourcePosition}\n        {targetPosition}\n        {animated}\n        {selected}\n        {label}\n        {labelStyle}\n        {data}\n        {style}\n        {interactionWidth}\n        selectable={isSelectable}\n        deletable={deletable ?? true}\n        type={edgeType}\n        sourceHandleId={sourceHandle}\n        targetHandleId={targetHandle}\n        markerStart={markerStartUrl}\n        markerEnd={markerEndUrl}\n      />\n    </g>\n  </svg>\n{/if}\n","<script>import { onMount } from 'svelte';\nlet _onMount = undefined;\nexport { _onMount as onMount };\nlet _onDestroy = undefined;\nexport { _onDestroy as onDestroy };\nonMount(() => {\n    _onMount?.();\n    return _onDestroy;\n});\n</script>\n","<script>import { useStore } from '../../../store';\nimport { Marker } from './';\nconst { markers } = useStore();\n</script>\n\n<defs>\n  {#each $markers as marker (marker.id)}\n    <Marker {...marker} />\n  {/each}\n</defs>\n","<script>import { MarkerType } from '@xyflow/system';\nexport let id;\nexport let type;\nexport let width = 12.5;\nexport let height = 12.5;\nexport let markerUnits = 'strokeWidth';\nexport let orient = 'auto-start-reverse';\nexport let color = undefined;\nexport let strokeWidth = undefined;\n</script>\n\n<marker\n  class=\"svelte-flow__arrowhead\"\n  {id}\n  markerWidth={`${width}`}\n  markerHeight={`${height}`}\n  viewBox=\"-10 -10 20 20\"\n  {markerUnits}\n  {orient}\n  refX=\"0\"\n  refY=\"0\"\n>\n  {#if type === MarkerType.Arrow}\n    <polyline\n      stroke={color}\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n      stroke-width={strokeWidth}\n      fill=\"none\"\n      points=\"-5,-4 0,0 -5,4\"\n    />\n  {:else if type === MarkerType.ArrowClosed}\n    <polyline\n      stroke={color}\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n      stroke-width={strokeWidth}\n      fill={color}\n      points=\"-5,-4 0,0 -5,4 -5,-4\"\n    />\n  {/if}\n</marker>\n","<script>import { onMount } from 'svelte';\nimport { EdgeWrapper } from '../../components/EdgeWrapper';\nimport { CallOnMount } from '../../components/CallOnMount';\nimport { MarkerDefinition } from './MarkerDefinition';\nimport { useStore } from '../../store';\nexport let defaultEdgeOptions;\nconst { visibleEdges, edgesInitialized, edges: { setDefaultOptions }, elementsSelectable } = useStore();\nonMount(() => {\n    if (defaultEdgeOptions)\n        setDefaultOptions(defaultEdgeOptions);\n});\n</script>\n\n<div class=\"svelte-flow__edges\">\n  <svg class=\"svelte-flow__marker\">\n    <MarkerDefinition />\n  </svg>\n\n  {#each $visibleEdges as edge (edge.id)}\n    <EdgeWrapper\n      id={edge.id}\n      source={edge.source}\n      target={edge.target}\n      data={edge.data}\n      style={edge.style}\n      animated={edge.animated}\n      selected={edge.selected}\n      selectable={edge.selectable ?? $elementsSelectable}\n      deletable={edge.deletable}\n      hidden={edge.hidden}\n      label={edge.label}\n      labelStyle={edge.labelStyle}\n      markerStart={edge.markerStart}\n      markerEnd={edge.markerEnd}\n      sourceHandle={edge.sourceHandle}\n      targetHandle={edge.targetHandle}\n      sourceX={edge.sourceX}\n      sourceY={edge.sourceY}\n      targetX={edge.targetX}\n      targetY={edge.targetY}\n      sourcePosition={edge.sourcePosition}\n      targetPosition={edge.targetPosition}\n      ariaLabel={edge.ariaLabel}\n      interactionWidth={edge.interactionWidth}\n      class={edge.class}\n      type={edge.type || 'default'}\n      zIndex={edge.zIndex}\n      on:edgeclick\n      on:edgecontextmenu\n      on:edgemouseenter\n      on:edgemouseleave\n    />\n  {/each}\n\n  {#if $visibleEdges.length > 0}\n    <CallOnMount\n      onMount={() => {\n        $edgesInitialized = true;\n      }}\n      onDestroy={() => {\n        $edgesInitialized = false;\n      }}\n    />\n  {/if}\n</div>\n","<script>export let x = 0;\nexport let y = 0;\nexport let width = 0;\nexport let height = 0;\nexport let isVisible = true;\n</script>\n\n{#if isVisible}\n  <div\n    class=\"svelte-flow__selection\"\n    style:width={typeof width === 'string' ? width : `${width}px`}\n    style:height={typeof height === 'string' ? height : `${height}px`}\n    style:transform={`translate(${x}px, ${y}px)`}\n  />\n{/if}\n\n<style>\n  .svelte-flow__selection {\n    position: absolute;\n    top: 0;\n    left: 0;\n  }\n</style>\n","<script>import { useStore } from '../../store';\nimport { Selection } from '../Selection';\nconst { selectionRect, selectionRectMode } = useStore();\n</script>\n\n<Selection\n  isVisible={!!($selectionRect && $selectionRectMode === 'user')}\n  width={$selectionRect?.width}\n  height={$selectionRect?.height}\n  x={$selectionRect?.x}\n  y={$selectionRect?.y}\n/>\n","<script>import { createEventDispatcher } from 'svelte';\nimport { getInternalNodesBounds, isNumeric } from '@xyflow/system';\nimport { useStore } from '../../store';\nimport { Selection } from '../Selection';\nimport drag from '../../actions/drag';\nconst store = useStore();\nconst { selectionRectMode, nodes, nodeLookup } = store;\nconst dispatch = createEventDispatcher();\nlet bounds = null;\n$: if ($selectionRectMode === 'nodes') {\n    bounds = getInternalNodesBounds($nodeLookup, { filter: (node) => !!node.selected });\n    $nodes;\n}\nfunction onContextMenu(event) {\n    const selectedNodes = $nodes.filter((n) => n.selected);\n    dispatch('selectioncontextmenu', { nodes: selectedNodes, event });\n}\nfunction onClick(event) {\n    const selectedNodes = $nodes.filter((n) => n.selected);\n    dispatch('selectionclick', { nodes: selectedNodes, event });\n}\n</script>\n\n{#if $selectionRectMode === 'nodes' && bounds && isNumeric(bounds.x) && isNumeric(bounds.y)}\n  <div\n    class=\"selection-wrapper nopan\"\n    style=\"width: {bounds.width}px; height: {bounds.height}px; transform: translate({bounds.x}px, {bounds.y}px)\"\n    use:drag={{\n      disabled: false,\n      store,\n      onDrag: (event, _, __, nodes) => {\n        dispatch('nodedrag', { event, targetNode: null, nodes });\n      },\n      onDragStart: (event, _, __, nodes) => {\n        dispatch('nodedragstart', { event, targetNode: null, nodes });\n      },\n      onDragStop: (event, _, __, nodes) => {\n        dispatch('nodedragstop', { event, targetNode: null, nodes });\n      }\n    }}\n    on:contextmenu={onContextMenu}\n    on:click={onClick}\n    role=\"button\"\n    tabindex=\"-1\"\n    on:keyup={() => {}}\n  >\n    <Selection width=\"100%\" height=\"100%\" x={0} y={0} />\n  </div>\n{/if}\n\n<style>\n  .selection-wrapper {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 7;\n    pointer-events: all;\n  }\n</style>\n","/**\n * Listen for keyboard event and trigger `shortcut` {@link https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent | CustomEvent }\n * @example Typical usage\n *\n * ```svelte\n * <script lang=\"ts\">\n *  import { shortcut, type ShortcutEventDetail } from '@svelte-put/shortcut';\n *\n *  let commandPalette = false;\n *\n *  function onOpenCommandPalette() {\n *    commandPalette = true;\n *  }\n *  function onCloseCommandPalette() {\n *    commandPalette = false;\n *  }\n *\n *  function doSomethingElse(details: ShortcutEventDetail) {\n *    console.log('Action was placed on:', details.node);\n *    console.log('Trigger:', details.trigger);\n *  }\n *\n *  function onShortcut(event: CustomEvent<ShortcutEventDetail>) {\n *    if (event.detail.trigger.id === 'do-something-else') {\n *      console.log('Same as doSomethingElse()');\n *      // be careful here doSomethingElse would have been called too\n *   }\n * }\n * </script>\n *\n * <svelte:window\n *   use:shortcut={{\n *     trigger: [\n *       {\n *         key: 'k',\n *\n *         // trigger if either ctrl or meta is pressed\n *         modifier: ['ctrl', 'meta'],\n *\n *         callback: onOpenCommandPalette,\n *         preventDefault: true,\n *       },\n *       {\n *         key: 'Escape',\n *\n *         // preferably avoid arrow functions here for better performance\n *         // with arrow functions the action has to be updated more frequently\n *         callback: onCloseCommandPalette,\n *\n *         enabled: commandPalette,\n *         preventDefault: true,\n *       },\n *      {\n *         key: 'k',\n *\n *         // trigger if both ctrl & shift are pressed\n *         modifier: [['ctrl', 'shift']],\n *         id: 'do-something-else',\n *         callback: doSomethingElse,\n *      },\n *     ],\n *   }}\n *   on:shortcut={onShortcut}\n * />\n * ```\n *\n *\n *\n * As with any svelte action, `shortcut` should be use with element and not component.\n *\n * ```html\n * <-- correct usage-->\n *  <div use:intersect />\n *\n * <-- incorrect usage-->\n * <Component use:intersect/>\n * ```\n *\n * You can either:\n *\n * - pass multiple callbacks to their associated triggers, or\n *\n * - pass one single handler to the `on:shortcut` event, in which case you should\n * provide an ID to each trigger to be able to distinguish what trigger was activated\n * in the event handler.\n *\n * Either way, only use `callback` or `on:shortcut` and not both to\n * avoid handler duplication.\n * @param {HTMLElement} node - HTMLElement to add event listener to\n * @param {import('./public').ShortcutParameter} param - svelte action parameters\n * @returns {import('./public').ShortcutActionReturn}\n */\nexport function shortcut(node, param) {\n\tlet { enabled = true, trigger, type = 'keydown' } = param;\n\n\t/**\n\t * @param {KeyboardEvent} event\n\t */\n\tfunction handler(event) {\n\t\tconst normalizedTriggers = Array.isArray(trigger) ? trigger : [trigger];\n\t\t/** @type {Record<import('./public').ShortcutModifier, boolean>} */\n\t\tconst modifiedMap = {\n\t\t\talt: event.altKey,\n\t\t\tctrl: event.ctrlKey,\n\t\t\tshift: event.shiftKey,\n\t\t\tmeta: event.metaKey,\n\t\t};\n\t\tfor (const trigger of normalizedTriggers) {\n\t\t\tconst mergedTrigger = {\n\t\t\t\tmodifier: [],\n\t\t\t\tpreventDefault: false,\n\t\t\t\tenabled: true,\n\t\t\t\t...trigger,\n\t\t\t};\n\t\t\tconst { modifier, key, callback, preventDefault, enabled: triggerEnabled } = mergedTrigger;\n\t\t\tif (triggerEnabled) {\n\t\t\t\tif (modifier.length) {\n\t\t\t\t\tconst modifierDefs = (Array.isArray(modifier) ? modifier : [modifier]).map((def) =>\n\t\t\t\t\t\ttypeof def === 'string' ? [def] : def,\n\t\t\t\t\t);\n\t\t\t\t\tconst modified = modifierDefs.some((def) =>\n\t\t\t\t\t\tdef.every((modifier) => modifiedMap[modifier]),\n\t\t\t\t\t);\n\t\t\t\t\tif (!modified) continue;\n\t\t\t\t}\n\t\t\t\tif (event.key === key) {\n\t\t\t\t\tif (preventDefault) event.preventDefault();\n\t\t\t\t\t/** @type {import('./public').ShortcutEventDetail} */\n\t\t\t\t\tconst detail = {\n\t\t\t\t\t\tnode,\n\t\t\t\t\t\ttrigger: mergedTrigger,\n\t\t\t\t\t\toriginalEvent: event,\n\t\t\t\t\t};\n\t\t\t\t\tnode.dispatchEvent(new CustomEvent('shortcut', { detail }));\n\t\t\t\t\tcallback?.(detail);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (enabled) node.addEventListener(type, handler);\n\n\treturn {\n\t\tupdate: (update) => {\n\t\t\tconst { enabled: newEnabled = true, type: newType = 'keydown' } = update;\n\n\t\t\tif (enabled && (!newEnabled || type !== newType)) {\n\t\t\t\tnode.removeEventListener(type, handler);\n\t\t\t} else if (!enabled && newEnabled) {\n\t\t\t\tnode.addEventListener(newType, handler);\n\t\t\t}\n\n\t\t\tenabled = newEnabled;\n\t\t\ttype = newType;\n\t\t\ttrigger = update.trigger;\n\t\t},\n\t\tdestroy: () => {\n\t\t\tnode.removeEventListener(type, handler);\n\t\t},\n\t};\n}\n","<script>import { shortcut } from '@svelte-put/shortcut';\nimport { isInputDOMNode, isMacOs } from '@xyflow/system';\nimport { useStore } from '../../store';\nexport let selectionKey = 'Shift';\nexport let multiSelectionKey = isMacOs() ? 'Meta' : 'Control';\nexport let deleteKey = 'Backspace';\nexport let panActivationKey = ' ';\nexport let zoomActivationKey = isMacOs() ? 'Meta' : 'Control';\nconst { selectionKeyPressed, multiselectionKeyPressed, deleteKeyPressed, panActivationKeyPressed, zoomActivationKeyPressed, selectionRect } = useStore();\nfunction isKeyObject(key) {\n    return key !== null && typeof key === 'object';\n}\nfunction getModifier(key) {\n    return isKeyObject(key) ? key.modifier || [] : [];\n}\nfunction getKeyString(key) {\n    if (key === null || key === undefined) {\n        // this is a workaround to check if a key is set\n        // if not we won't call the callback\n        return '';\n    }\n    return isKeyObject(key) ? key.key : key;\n}\nfunction getShortcutTrigger(key, callback) {\n    const keys = Array.isArray(key) ? key : [key];\n    return keys.map((_key) => {\n        const keyString = getKeyString(_key);\n        return {\n            key: keyString,\n            modifier: getModifier(_key),\n            enabled: keyString !== null,\n            callback\n        };\n    });\n}\nfunction resetKeysAndSelection() {\n    selectionRect.set(null);\n    selectionKeyPressed.set(false);\n    multiselectionKeyPressed.set(false);\n    deleteKeyPressed.set(false);\n    panActivationKeyPressed.set(false);\n    zoomActivationKeyPressed.set(false);\n}\n</script>\n\n<svelte:window\n  on:blur={resetKeysAndSelection}\n  on:contextmenu={resetKeysAndSelection}\n  use:shortcut={{\n    trigger: getShortcutTrigger(selectionKey, () => selectionKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(selectionKey, () => selectionKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(multiSelectionKey, () => multiselectionKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(multiSelectionKey, () => multiselectionKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(deleteKey, (detail) => {\n      const isModifierKey =\n        detail.originalEvent.ctrlKey ||\n        detail.originalEvent.metaKey ||\n        detail.originalEvent.shiftKey;\n      if (!isModifierKey && !isInputDOMNode(detail.originalEvent)) {\n        deleteKeyPressed.set(true);\n      }\n    }),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(deleteKey, () => deleteKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(panActivationKey, () => panActivationKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(panActivationKey, () => panActivationKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(zoomActivationKey, () => zoomActivationKeyPressed.set(true)),\n    type: 'keydown'\n  }}\n  use:shortcut={{\n    trigger: getShortcutTrigger(zoomActivationKey, () => zoomActivationKeyPressed.set(false)),\n    type: 'keyup'\n  }}\n/>\n","<script>import cc from 'classcat';\nimport { useStore } from '../../store';\nimport { ConnectionLineType, getBezierPath, getConnectionStatus, getSmoothStepPath, getStraightPath } from '@xyflow/system';\nexport let containerStyle = '';\nexport let style = '';\nexport let isCustomComponent = false;\nconst { width, height, connection, connectionLineType } = useStore();\nlet path = null;\n$: if ($connection.inProgress && !isCustomComponent) {\n    const { from, to, fromPosition, toPosition } = $connection;\n    const pathParams = {\n        sourceX: from.x,\n        sourceY: from.y,\n        sourcePosition: fromPosition,\n        targetX: to.x,\n        targetY: to.y,\n        targetPosition: toPosition\n    };\n    switch ($connectionLineType) {\n        case ConnectionLineType.Bezier:\n            [path] = getBezierPath(pathParams);\n            break;\n        case ConnectionLineType.Step:\n            [path] = getSmoothStepPath({\n                ...pathParams,\n                borderRadius: 0\n            });\n            break;\n        case ConnectionLineType.SmoothStep:\n            [path] = getSmoothStepPath(pathParams);\n            break;\n        default:\n            [path] = getStraightPath(pathParams);\n    }\n}\n</script>\n\n{#if $connection.inProgress}\n  <svg width={$width} height={$height} class=\"svelte-flow__connectionline\" style={containerStyle}>\n    <g class={cc(['svelte-flow__connection', getConnectionStatus($connection.isValid)])}>\n      <slot name=\"connectionLine\" />\n      <!-- slot fallbacks do not work if slots are forwarded in parent -->\n      {#if !isCustomComponent}\n        <path d={path} {style} fill=\"none\" class=\"svelte-flow__connection-path\" />\n      {/if}\n    </g>\n  </svg>\n{/if}\n","<script>import cc from 'classcat';\nimport { useStore } from '../../store';\nexport let position = 'top-right';\nexport let style = undefined;\nlet className = undefined;\nexport { className as class };\nconst { selectionRectMode } = useStore();\n$: positionClasses = `${position}`.split('-');\n</script>\n\n<div\n  class={cc(['svelte-flow__panel', className, ...positionClasses])}\n  {style}\n  style:pointer-events={$selectionRectMode ? 'none' : ''}\n  {...$$restProps}\n>\n  <slot />\n</div>\n","<script>import { Panel } from '../../container/Panel';\nexport let proOptions = undefined;\nexport let position = 'bottom-right';\n</script>\n\n{#if !proOptions?.hideAttribution}\n  <Panel\n    {position}\n    class=\"svelte-flow__attribution\"\n    data-message=\"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us\"\n  >\n    <a\n      href=\"https://svelteflow.dev\"\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n      aria-label=\"Svelte Flow attribution\"\n    >\n      Svelte Flow\n    </a>\n  </Panel>\n{/if}\n","// this is helper function for updating the store\n// for props where we need to call a specific store action\nexport function updateStore(store, { nodeTypes, edgeTypes, minZoom, maxZoom, translateExtent, paneClickDistance }) {\n    if (nodeTypes !== undefined) {\n        store.setNodeTypes(nodeTypes);\n    }\n    if (edgeTypes !== undefined) {\n        store.setEdgeTypes(edgeTypes);\n    }\n    if (minZoom !== undefined) {\n        store.setMinZoom(minZoom);\n    }\n    if (maxZoom !== undefined) {\n        store.setMaxZoom(maxZoom);\n    }\n    if (translateExtent !== undefined) {\n        store.setTranslateExtent(translateExtent);\n    }\n    if (paneClickDistance !== undefined) {\n        store.setPaneClickDistance(paneClickDistance);\n    }\n}\nconst getKeys = (obj) => Object.keys(obj);\nexport function updateStoreByKeys(store, keys) {\n    getKeys(keys).forEach((prop) => {\n        const update = keys[prop];\n        if (update !== undefined) {\n            // @ts-expect-error @todo: how to fix this TS error?\n            store[prop].set(update);\n        }\n    });\n}\n","import { readable } from 'svelte/store';\nfunction getMediaQuery() {\n    if (typeof window === 'undefined' || !window.matchMedia) {\n        return null;\n    }\n    return window.matchMedia('(prefers-color-scheme: dark)');\n}\n/**\n * Hook for receiving the current color mode class 'dark' or 'light'.\n *\n * @internal\n * @param colorMode - The color mode to use ('dark', 'light' or 'system')\n */\nexport function useColorModeClass(colorMode = 'light') {\n    const colorModeClass = readable('light', (set) => {\n        if (colorMode !== 'system') {\n            set(colorMode);\n            return;\n        }\n        const mediaQuery = getMediaQuery();\n        const updateColorModeClass = () => set(mediaQuery?.matches ? 'dark' : 'light');\n        set(mediaQuery?.matches ? 'dark' : 'light');\n        mediaQuery?.addEventListener('change', updateColorModeClass);\n        return () => {\n            mediaQuery?.removeEventListener('change', updateColorModeClass);\n        };\n    });\n    return colorModeClass;\n}\n","<script>import { onMount, hasContext } from 'svelte';\nimport { get } from 'svelte/store';\nimport cc from 'classcat';\nimport { ConnectionMode, PanOnScrollMode } from '@xyflow/system';\nimport { Zoom } from '../Zoom';\nimport { Pane } from '../Pane';\nimport { Viewport as ViewportComponent } from '../Viewport';\nimport { NodeRenderer } from '../NodeRenderer';\nimport { EdgeRenderer } from '../EdgeRenderer';\nimport { UserSelection } from '../../components/UserSelection';\nimport { NodeSelection } from '../../components/NodeSelection';\nimport { KeyHandler } from '../../components/KeyHandler';\nimport { ConnectionLine } from '../../components/ConnectionLine';\nimport { Attribution } from '../../components/Attribution';\nimport { key, useStore, createStoreContext } from '../../store';\nimport { updateStore, updateStoreByKeys } from './utils';\nimport { useColorModeClass } from '../../hooks/useColorModeClass';\nexport let id = '1';\nexport let nodes;\nexport let edges;\nexport let fitView = undefined;\nexport let fitViewOptions = undefined;\nexport let minZoom = undefined;\nexport let maxZoom = undefined;\nexport let initialViewport = undefined;\nexport let viewport = undefined;\nexport let nodeTypes = undefined;\nexport let edgeTypes = undefined;\nexport let selectionKey = undefined;\nexport let selectionMode = undefined;\nexport let panActivationKey = undefined;\nexport let multiSelectionKey = undefined;\nexport let zoomActivationKey = undefined;\nexport let nodesDraggable = undefined;\nexport let nodesConnectable = undefined;\nexport let nodeDragThreshold = undefined;\nexport let elementsSelectable = undefined;\nexport let snapGrid = undefined;\nexport let deleteKey = undefined;\nexport let connectionRadius = undefined;\nexport let connectionLineType = undefined;\nexport let connectionMode = ConnectionMode.Strict;\nexport let connectionLineStyle = '';\nexport let connectionLineContainerStyle = '';\nexport let onMoveStart = undefined;\nexport let onMove = undefined;\nexport let onMoveEnd = undefined;\nexport let isValidConnection = undefined;\nexport let translateExtent = undefined;\nexport let nodeExtent = undefined;\nexport let onlyRenderVisibleElements = undefined;\nexport let panOnScrollMode = PanOnScrollMode.Free;\nexport let preventScrolling = true;\nexport let zoomOnScroll = true;\nexport let zoomOnDoubleClick = true;\nexport let zoomOnPinch = true;\nexport let panOnScroll = false;\nexport let panOnDrag = true;\nexport let selectionOnDrag = undefined;\nexport let autoPanOnConnect = true;\nexport let autoPanOnNodeDrag = true;\nexport let onerror = undefined;\nexport let ondelete = undefined;\nexport let onedgecreate = undefined;\nexport let attributionPosition = undefined;\nexport let proOptions = undefined;\nexport let defaultEdgeOptions = undefined;\nexport let width = undefined;\nexport let height = undefined;\nexport let colorMode = 'light';\nexport let onconnect = undefined;\nexport let onconnectstart = undefined;\nexport let onconnectend = undefined;\nexport let onbeforedelete = undefined;\nexport let oninit = undefined;\nexport let nodeOrigin = undefined;\nexport let paneClickDistance = 0;\nexport let nodeClickDistance = 0;\nexport let defaultMarkerColor = '#b1b1b7';\nexport let style = undefined;\nlet className = undefined;\nexport { className as class };\nlet domNode;\nlet clientWidth;\nlet clientHeight;\nconst initViewport = $viewport || initialViewport;\nconst store = hasContext(key)\n    ? useStore()\n    : createStoreContext({\n        nodes: get(nodes),\n        edges: get(edges),\n        width,\n        height,\n        fitView,\n        nodeOrigin,\n        nodeExtent\n    });\nonMount(() => {\n    store.width.set(clientWidth);\n    store.height.set(clientHeight);\n    store.domNode.set(domNode);\n    store.syncNodeStores(nodes);\n    store.syncEdgeStores(edges);\n    store.syncViewport(viewport);\n    if (fitView !== undefined) {\n        store.fitViewOnInit.set(fitView);\n    }\n    if (fitViewOptions) {\n        store.fitViewOptions.set(fitViewOptions);\n    }\n    updateStore(store, {\n        nodeTypes,\n        edgeTypes,\n        minZoom,\n        maxZoom,\n        translateExtent,\n        paneClickDistance\n    });\n    return () => {\n        store.reset();\n    };\n});\n// Update width & height on resize\n$: {\n    if (clientWidth !== undefined && clientHeight !== undefined) {\n        store.width.set(clientWidth);\n        store.height.set(clientHeight);\n    }\n}\n// Call oninit once when flow is intialized\nconst { initialized } = store;\nlet onInitCalled = false;\n$: {\n    if (!onInitCalled && $initialized) {\n        oninit?.();\n        onInitCalled = true;\n    }\n}\n// this updates the store for simple changes\n// where the prop names equals the store name\n$: {\n    const updatableProps = {\n        flowId: id,\n        connectionLineType,\n        connectionRadius,\n        selectionMode,\n        snapGrid,\n        defaultMarkerColor,\n        nodesDraggable,\n        nodesConnectable,\n        elementsSelectable,\n        onlyRenderVisibleElements,\n        isValidConnection,\n        autoPanOnConnect,\n        autoPanOnNodeDrag,\n        onerror,\n        ondelete,\n        onedgecreate,\n        connectionMode,\n        nodeDragThreshold,\n        onconnect,\n        onconnectstart,\n        onconnectend,\n        onbeforedelete,\n        nodeOrigin\n    };\n    updateStoreByKeys(store, updatableProps);\n}\n$: updateStore(store, {\n    nodeTypes,\n    edgeTypes,\n    minZoom,\n    maxZoom,\n    translateExtent,\n    paneClickDistance\n});\n$: colorModeClass = useColorModeClass(colorMode);\n</script>\n\n<div\n  bind:this={domNode}\n  bind:clientWidth\n  bind:clientHeight\n  {style}\n  class={cc(['svelte-flow', className, $colorModeClass])}\n  data-testid=\"svelte-flow__wrapper\"\n  on:dragover\n  on:drop\n  {...$$restProps}\n  role=\"application\"\n>\n  <KeyHandler\n    {selectionKey}\n    {deleteKey}\n    {panActivationKey}\n    {multiSelectionKey}\n    {zoomActivationKey}\n  />\n  <Zoom\n    initialViewport={initViewport}\n    {onMoveStart}\n    {onMove}\n    {onMoveEnd}\n    panOnScrollMode={panOnScrollMode === undefined ? PanOnScrollMode.Free : panOnScrollMode}\n    preventScrolling={preventScrolling === undefined ? true : preventScrolling}\n    zoomOnScroll={zoomOnScroll === undefined ? true : zoomOnScroll}\n    zoomOnDoubleClick={zoomOnDoubleClick === undefined ? true : zoomOnDoubleClick}\n    zoomOnPinch={zoomOnPinch === undefined ? true : zoomOnPinch}\n    panOnScroll={panOnScroll === undefined ? false : panOnScroll}\n    panOnDrag={panOnDrag === undefined ? true : panOnDrag}\n    paneClickDistance={paneClickDistance === undefined ? 0 : paneClickDistance}\n  >\n    <Pane\n      on:paneclick\n      on:panecontextmenu\n      panOnDrag={panOnDrag === undefined ? true : panOnDrag}\n      {selectionOnDrag}\n    >\n      <ViewportComponent>\n        <EdgeRenderer\n          on:edgeclick\n          on:edgecontextmenu\n          on:edgemouseenter\n          on:edgemouseleave\n          {defaultEdgeOptions}\n        />\n        <ConnectionLine\n          containerStyle={connectionLineContainerStyle}\n          style={connectionLineStyle}\n          isCustomComponent={$$slots.connectionLine}\n        >\n          <slot name=\"connectionLine\" slot=\"connectionLine\" />\n        </ConnectionLine>\n        <div class=\"svelte-flow__edgelabel-renderer\" />\n        <div class=\"svelte-flow__viewport-portal\" />\n        <NodeRenderer\n          {nodeClickDistance}\n          on:nodeclick\n          on:nodemouseenter\n          on:nodemousemove\n          on:nodemouseleave\n          on:nodedragstart\n          on:nodedrag\n          on:nodedragstop\n          on:nodecontextmenu\n        />\n        <NodeSelection\n          on:selectionclick\n          on:selectioncontextmenu\n          on:nodedragstart\n          on:nodedrag\n          on:nodedragstop\n        />\n      </ViewportComponent>\n      <UserSelection />\n    </Pane>\n  </Zoom>\n  <Attribution {proOptions} position={attributionPosition} />\n  <slot />\n</div>\n\n<style>\n  .svelte-flow {\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    position: relative;\n    z-index: 0;\n\n    background-color: var(--background-color, var(--background-color-default));\n  }\n\n  :root {\n    --background-color-default: #fff;\n    --background-pattern-color-default: #ddd;\n\n    --minimap-mask-color-default: rgb(240, 240, 240, 0.6);\n    --minimap-mask-stroke-color-default: none;\n    --minimap-mask-stroke-width-default: 1;\n\n    --controls-button-background-color-default: #fefefe;\n    --controls-button-background-color-hover-default: #f4f4f4;\n    --controls-button-color-default: inherit;\n    --controls-button-color-hover-default: inherit;\n    --controls-button-border-color-default: #eee;\n  }\n</style>\n","<script>import { onDestroy, setContext } from 'svelte';\nimport { createStore, key } from '../../store';\nexport let initialNodes = undefined;\nexport let initialEdges = undefined;\nexport let initialWidth = undefined;\nexport let initialHeight = undefined;\nexport let fitView = undefined;\nexport let nodeOrigin = undefined;\nconst store = createStore({\n    nodes: initialNodes,\n    edges: initialEdges,\n    width: initialWidth,\n    height: initialHeight,\n    nodeOrigin,\n    fitView\n});\nsetContext(key, {\n    getStore: () => store\n});\nonDestroy(() => {\n    store.reset();\n});\n</script>\n\n<slot />\n","<script>import cc from 'classcat';\nlet className = undefined;\nlet bgColor = undefined;\nlet bgColorHover = undefined;\nlet color = undefined;\nlet colorHover = undefined;\nlet borderColor = undefined;\nexport { className as class };\n</script>\n\n<button\n  type=\"button\"\n  on:click\n  class={cc(['svelte-flow__controls-button', className])}\n  style:--xy-controls-button-background-color-props={bgColor}\n  style:--xy-controls-button-background-color-hover-props={bgColorHover}\n  style:--xy-controls-button-color-props={color}\n  style:--xy-controls-button-color-hover-props={colorHover}\n  style:--xy-controls-button-border-color-props={borderColor}\n  {...$$restProps}\n>\n  <slot class=\"button-svg\" />\n</button>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 32\">\n  <path d=\"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z\" />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 5\">\n  <path d=\"M0 0h32v4.2H0z\" />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 32 30\">\n  <path\n    d=\"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z\"\n  />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 25 32\">\n  <path\n    d=\"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z\"\n  />\n</svg>\n","<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 25 32\">\n  <path\n    d=\"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z\"\n  />\n</svg>\n","<script>import cc from 'classcat';\nimport Panel from '../../container/Panel/Panel.svelte';\nimport { useStore } from '../../store';\nimport ControlButton from './ControlButton.svelte';\nimport PlusIcon from './Icons/Plus.svelte';\nimport MinusIcon from './Icons/Minus.svelte';\nimport FitViewIcon from './Icons/Fit.svelte';\nimport LockIcon from './Icons/Lock.svelte';\nimport UnlockIcon from './Icons/Unlock.svelte';\nexport let position = 'bottom-left';\nexport let showZoom = true;\nexport let showFitView = true;\nexport let showLock = true;\nexport let buttonBgColor = undefined;\nexport let buttonBgColorHover = undefined;\nexport let buttonColor = undefined;\nexport let buttonColorHover = undefined;\nexport let buttonBorderColor = undefined;\nexport let ariaLabel = undefined;\nexport let style = undefined;\nexport let orientation = 'vertical';\nexport let fitViewOptions = undefined;\nlet className = '';\nexport { className as class };\nconst { zoomIn, zoomOut, fitView, viewport, minZoom, maxZoom, nodesDraggable, nodesConnectable, elementsSelectable } = useStore();\nconst buttonProps = {\n    bgColor: buttonBgColor,\n    bgColorHover: buttonBgColorHover,\n    color: buttonColor,\n    colorHover: buttonColorHover,\n    borderColor: buttonBorderColor\n};\n$: isInteractive = $nodesDraggable || $nodesConnectable || $elementsSelectable;\n$: minZoomReached = $viewport.zoom <= $minZoom;\n$: maxZoomReached = $viewport.zoom >= $maxZoom;\nconst onZoomInHandler = () => {\n    zoomIn();\n};\nconst onZoomOutHandler = () => {\n    zoomOut();\n};\nconst onFitViewHandler = () => {\n    fitView(fitViewOptions);\n};\nconst onToggleInteractivity = () => {\n    isInteractive = !isInteractive;\n    nodesDraggable.set(isInteractive);\n    nodesConnectable.set(isInteractive);\n    elementsSelectable.set(isInteractive);\n};\n$: orientationClass = orientation === 'horizontal' ? 'horizontal' : 'vertical';\n</script>\n\n<Panel\n  class={cc(['svelte-flow__controls', orientationClass, className])}\n  {position}\n  data-testid=\"svelte-flow__controls\"\n  aria-label={ariaLabel ?? 'Svelte Flow controls'}\n  {style}\n>\n  <slot name=\"before\" />\n  {#if showZoom}\n    <ControlButton\n      on:click={onZoomInHandler}\n      class=\"svelte-flow__controls-zoomin\"\n      title=\"zoom in\"\n      aria-label=\"zoom in\"\n      disabled={maxZoomReached}\n      {...buttonProps}\n    >\n      <PlusIcon />\n    </ControlButton>\n    <ControlButton\n      on:click={onZoomOutHandler}\n      class=\"svelte-flow__controls-zoomout\"\n      title=\"zoom out\"\n      aria-label=\"zoom out\"\n      disabled={minZoomReached}\n      {...buttonProps}\n    >\n      <MinusIcon />\n    </ControlButton>\n  {/if}\n  {#if showFitView}\n    <ControlButton\n      class=\"svelte-flow__controls-fitview\"\n      on:click={onFitViewHandler}\n      title=\"fit view\"\n      aria-label=\"fit view\"\n      {...buttonProps}\n    >\n      <FitViewIcon />\n    </ControlButton>\n  {/if}\n  {#if showLock}\n    <ControlButton\n      class=\"svelte-flow__controls-interactive\"\n      on:click={onToggleInteractivity}\n      title=\"toggle interactivity\"\n      aria-label=\"toggle interactivity\"\n      {...buttonProps}\n    >\n      {#if isInteractive}<UnlockIcon />{:else}<LockIcon />{/if}\n    </ControlButton>\n  {/if}\n  <slot />\n  <slot name=\"after\" />\n</Panel>\n","export var BackgroundVariant;\n(function (BackgroundVariant) {\n    BackgroundVariant[\"Lines\"] = \"lines\";\n    BackgroundVariant[\"Dots\"] = \"dots\";\n    BackgroundVariant[\"Cross\"] = \"cross\";\n})(BackgroundVariant || (BackgroundVariant = {}));\n","<script>import cc from 'classcat';\nexport let radius = 5;\nlet className = '';\nexport { className as class };\n</script>\n\n<circle\n  cx={radius}\n  cy={radius}\n  r={radius}\n  class={cc(['svelte-flow__background-pattern', 'dots', className])}\n/>\n","<script>import cc from 'classcat';\nexport let lineWidth = 1;\nexport let dimensions;\nexport let variant = undefined;\nlet className = '';\nexport { className as class };\n</script>\n\n<path\n  stroke-width={lineWidth}\n  d={`M${dimensions[0] / 2} 0 V${dimensions[1]} M0 ${dimensions[1] / 2} H${dimensions[0]}`}\n  class={cc(['svelte-flow__background-pattern', variant, className])}\n/>\n","<script labg=\"ts\" context=\"module\">\n  const defaultSize = {\n    [BackgroundVariant.Dots]: 1,\n    [BackgroundVariant.Lines]: 1,\n    [BackgroundVariant.Cross]: 6\n  };\n</script>\n\n<script>import cc from 'classcat';\nimport DotPattern from './DotPattern.svelte';\nimport LinePattern from './LinePattern.svelte';\nimport { useStore } from '../../store';\nimport { BackgroundVariant } from './types';\nexport let id = undefined;\nexport let variant = BackgroundVariant.Dots;\nexport let gap = 20;\nexport let size = 1;\nexport let lineWidth = 1;\nexport let bgColor = undefined;\nexport let patternColor = undefined;\nexport let patternClass = undefined;\nlet className = '';\nexport { className as class };\nconst { viewport, flowId } = useStore();\nconst patternSize = size || defaultSize[variant];\nconst isDots = variant === BackgroundVariant.Dots;\nconst isCross = variant === BackgroundVariant.Cross;\nconst gapXY = Array.isArray(gap) ? gap : [gap, gap];\n$: patternId = `background-pattern-${$flowId}-${id ? id : ''}`;\n$: scaledGap = [gapXY[0] * $viewport.zoom || 1, gapXY[1] * $viewport.zoom || 1];\n$: scaledSize = patternSize * $viewport.zoom;\n$: patternDimensions = (isCross ? [scaledSize, scaledSize] : scaledGap);\n$: patternOffset = isDots\n    ? [scaledSize / 2, scaledSize / 2]\n    : [patternDimensions[0] / 2, patternDimensions[1] / 2];\n</script>\n\n<svg\n  class={cc(['svelte-flow__background', className])}\n  data-testid=\"svelte-flow__background\"\n  style:--xy-background-color-props={bgColor}\n  style:--xy-background-pattern-color-props={patternColor}\n>\n  <pattern\n    id={patternId}\n    x={$viewport.x % scaledGap[0]}\n    y={$viewport.y % scaledGap[1]}\n    width={scaledGap[0]}\n    height={scaledGap[1]}\n    patternUnits=\"userSpaceOnUse\"\n    patternTransform={`translate(-${patternOffset[0]},-${patternOffset[1]})`}\n  >\n    {#if isDots}\n      <DotPattern radius={scaledSize / 2} class={patternClass} />\n    {:else}\n      <LinePattern dimensions={patternDimensions} {variant} {lineWidth} class={patternClass} />\n    {/if}\n  </pattern>\n  <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill={`url(#${patternId})`} />\n</svg>\n\n<style>\n  .svelte-flow__background {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n  }\n</style>\n","import { isNodeBase, isEdgeBase } from '@xyflow/system';\n/**\n * Test whether an object is useable as a Node\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Node if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Node\n */\nexport const isNode = (element) => isNodeBase(element);\n/**\n * Test whether an object is useable as an Edge\n * @public\n * @remarks In TypeScript this is a type guard that will narrow the type of whatever you pass in to Edge if it returns true\n * @param element - The element to test\n * @returns A boolean indicating whether the element is an Edge\n */\nexport const isEdge = (element) => isEdgeBase(element);\n","import { get } from 'svelte/store';\nimport { getOverlappingArea, isRectObject, nodeToRect, pointToRendererPoint, getViewportForBounds, getElementsToRemove, rendererPointToPoint, evaluateAbsolutePosition, getNodesBounds } from '@xyflow/system';\nimport { useStore } from '../store';\nimport { isNode } from '../utils';\n/**\n * Hook for accessing the ReactFlow instance.\n *\n * @public\n *\n * @returns helper functions\n */\nexport function useSvelteFlow() {\n    const { zoomIn, zoomOut, fitView, onbeforedelete, snapGrid, viewport, width, height, minZoom, maxZoom, panZoom, nodes, edges, domNode, nodeLookup, nodeOrigin, edgeLookup, connectionLookup } = useStore();\n    const getNodeRect = (node) => {\n        const $nodeLookup = get(nodeLookup);\n        const nodeToUse = isNode(node) ? node : $nodeLookup.get(node.id);\n        const position = nodeToUse.parentId\n            ? evaluateAbsolutePosition(nodeToUse.position, nodeToUse.measured, nodeToUse.parentId, $nodeLookup, get(nodeOrigin))\n            : nodeToUse.position;\n        const nodeWithPosition = {\n            id: nodeToUse.id,\n            position,\n            width: nodeToUse.measured?.width ?? nodeToUse.width,\n            height: nodeToUse.measured?.height ?? nodeToUse.height,\n            data: nodeToUse.data\n        };\n        return nodeToRect(nodeWithPosition);\n    };\n    const updateNode = (id, nodeUpdate, options = { replace: false }) => {\n        const node = get(nodeLookup).get(id)?.internals.userNode;\n        if (!node) {\n            return;\n        }\n        const nextNode = typeof nodeUpdate === 'function' ? nodeUpdate(node) : nodeUpdate;\n        if (options.replace) {\n            nodes.update((nds) => nds.map((node) => {\n                if (node.id === id) {\n                    return isNode(nextNode) ? nextNode : { ...node, ...nextNode };\n                }\n                return node;\n            }));\n        }\n        else {\n            Object.assign(node, nextNode);\n            nodes.update((nds) => nds);\n        }\n    };\n    const getInternalNode = (id) => get(nodeLookup).get(id);\n    return {\n        zoomIn,\n        zoomOut,\n        getInternalNode,\n        getNode: (id) => getInternalNode(id)?.internals.userNode,\n        getNodes: (ids) => (ids === undefined ? get(nodes) : getElements(get(nodeLookup), ids)),\n        getEdge: (id) => get(edgeLookup).get(id),\n        getEdges: (ids) => (ids === undefined ? get(edges) : getElements(get(edgeLookup), ids)),\n        setZoom: (zoomLevel, options) => {\n            const currentPanZoom = get(panZoom);\n            return currentPanZoom\n                ? currentPanZoom.scaleTo(zoomLevel, { duration: options?.duration })\n                : Promise.resolve(false);\n        },\n        getZoom: () => get(viewport).zoom,\n        setViewport: async (nextViewport, options) => {\n            const currentViewport = get(viewport);\n            const currentPanZoom = get(panZoom);\n            if (!currentPanZoom) {\n                return Promise.resolve(false);\n            }\n            await currentPanZoom.setViewport({\n                x: nextViewport.x ?? currentViewport.x,\n                y: nextViewport.y ?? currentViewport.y,\n                zoom: nextViewport.zoom ?? currentViewport.zoom\n            }, { duration: options?.duration });\n            return Promise.resolve(true);\n        },\n        getViewport: () => get(viewport),\n        setCenter: async (x, y, options) => {\n            const nextZoom = typeof options?.zoom !== 'undefined' ? options.zoom : get(maxZoom);\n            const currentPanZoom = get(panZoom);\n            if (!currentPanZoom) {\n                return Promise.resolve(false);\n            }\n            await currentPanZoom.setViewport({\n                x: get(width) / 2 - x * nextZoom,\n                y: get(height) / 2 - y * nextZoom,\n                zoom: nextZoom\n            }, { duration: options?.duration });\n            return Promise.resolve(true);\n        },\n        fitView,\n        fitBounds: async (bounds, options) => {\n            const currentPanZoom = get(panZoom);\n            if (!currentPanZoom) {\n                return Promise.resolve(false);\n            }\n            const viewport = getViewportForBounds(bounds, get(width), get(height), get(minZoom), get(maxZoom), options?.padding ?? 0.1);\n            await currentPanZoom.setViewport(viewport, { duration: options?.duration });\n            return Promise.resolve(true);\n        },\n        getIntersectingNodes: (nodeOrRect, partially = true, nodesToIntersect) => {\n            const isRect = isRectObject(nodeOrRect);\n            const nodeRect = isRect ? nodeOrRect : getNodeRect(nodeOrRect);\n            if (!nodeRect) {\n                return [];\n            }\n            return (nodesToIntersect || get(nodes)).filter((n) => {\n                const internalNode = get(nodeLookup).get(n.id);\n                if (!internalNode || (!isRect && n.id === nodeOrRect.id)) {\n                    return false;\n                }\n                const currNodeRect = nodeToRect(internalNode);\n                const overlappingArea = getOverlappingArea(currNodeRect, nodeRect);\n                const partiallyVisible = partially && overlappingArea > 0;\n                return partiallyVisible || overlappingArea >= nodeRect.width * nodeRect.height;\n            });\n        },\n        isNodeIntersecting: (nodeOrRect, area, partially = true) => {\n            const isRect = isRectObject(nodeOrRect);\n            const nodeRect = isRect ? nodeOrRect : getNodeRect(nodeOrRect);\n            if (!nodeRect) {\n                return false;\n            }\n            const overlappingArea = getOverlappingArea(nodeRect, area);\n            const partiallyVisible = partially && overlappingArea > 0;\n            return partiallyVisible || overlappingArea >= nodeRect.width * nodeRect.height;\n        },\n        deleteElements: async ({ nodes: nodesToRemove = [], edges: edgesToRemove = [] }) => {\n            const { nodes: matchingNodes, edges: matchingEdges } = await getElementsToRemove({\n                nodesToRemove,\n                edgesToRemove,\n                nodes: get(nodes),\n                edges: get(edges),\n                onBeforeDelete: get(onbeforedelete)\n            });\n            if (matchingNodes) {\n                nodes.update((nds) => nds.filter((node) => !matchingNodes.some(({ id }) => id === node.id)));\n            }\n            if (matchingEdges) {\n                edges.update((eds) => eds.filter((edge) => !matchingEdges.some(({ id }) => id === edge.id)));\n            }\n            return {\n                deletedNodes: matchingNodes,\n                deletedEdges: matchingEdges\n            };\n        },\n        screenToFlowPosition: (position, options = { snapToGrid: true }) => {\n            const _domNode = get(domNode);\n            if (!_domNode) {\n                return position;\n            }\n            const _snapGrid = options.snapToGrid ? get(snapGrid) : false;\n            const { x, y, zoom } = get(viewport);\n            const { x: domX, y: domY } = _domNode.getBoundingClientRect();\n            const correctedPosition = {\n                x: position.x - domX,\n                y: position.y - domY\n            };\n            return pointToRendererPoint(correctedPosition, [x, y, zoom], _snapGrid !== null, _snapGrid || [1, 1]);\n        },\n        /**\n         *\n         * @param position\n         * @returns\n         */\n        flowToScreenPosition: (position) => {\n            const _domNode = get(domNode);\n            if (!_domNode) {\n                return position;\n            }\n            const { x, y, zoom } = get(viewport);\n            const { x: domX, y: domY } = _domNode.getBoundingClientRect();\n            const rendererPosition = rendererPointToPoint(position, [x, y, zoom]);\n            return {\n                x: rendererPosition.x + domX,\n                y: rendererPosition.y + domY\n            };\n        },\n        toObject: () => {\n            return {\n                nodes: get(nodes).map((node) => ({\n                    ...node,\n                    // we want to make sure that changes to the nodes object that gets returned by toObject\n                    // do not affect the nodes object\n                    position: { ...node.position },\n                    data: { ...node.data }\n                })),\n                edges: get(edges).map((edge) => ({ ...edge })),\n                viewport: { ...get(viewport) }\n            };\n        },\n        updateNode,\n        updateNodeData: (id, dataUpdate, options) => {\n            const node = get(nodeLookup).get(id)?.internals.userNode;\n            if (!node) {\n                return;\n            }\n            const nextData = typeof dataUpdate === 'function' ? dataUpdate(node) : dataUpdate;\n            node.data = options?.replace ? nextData : { ...node.data, ...nextData };\n            nodes.update((nds) => nds);\n        },\n        getNodesBounds: (nodes) => {\n            const _nodeLookup = get(nodeLookup);\n            const _nodeOrigin = get(nodeOrigin);\n            return getNodesBounds(nodes, { nodeLookup: _nodeLookup, nodeOrigin: _nodeOrigin });\n        },\n        getHandleConnections: ({ type, id, nodeId }) => Array.from(get(connectionLookup)\n            .get(`${nodeId}-${type}-${id ?? null}`)\n            ?.values() ?? []),\n        viewport\n    };\n}\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction getElements(lookup, ids) {\n    const result = [];\n    for (const id of ids) {\n        const item = lookup.get(id);\n        if (item) {\n            const element = 'internals' in item ? item.internals?.userNode : item;\n            result.push(element);\n        }\n    }\n    return result;\n}\n","import { useStore } from '../store';\n/**\n * Hook for seeing if nodes are initialized\n * @returns - nodesInitialized Writable\n */\nexport function useNodesInitialized() {\n    const { nodesInitialized } = useStore();\n    return {\n        subscribe: nodesInitialized.subscribe\n    };\n}\n/**\n * Hook for seeing if the flow is initialized\n * @returns - initialized Writable\n */\nexport function useInitialized() {\n    const { initialized } = useStore();\n    return {\n        subscribe: initialized.subscribe\n    };\n}\n","<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport { config, functions, models, settings, tools, user } from '$lib/stores';\r\n\timport { createEventDispatcher, onMount, getContext, tick } from 'svelte';\r\n\r\n\timport {\r\n\t\tgetUserValvesSpecById as getToolUserValvesSpecById,\r\n\t\tgetUserValvesById as getToolUserValvesById,\r\n\t\tupdateUserValvesById as updateToolUserValvesById\r\n\t} from '$lib/apis/tools';\r\n\timport {\r\n\t\tgetUserValvesSpecById as getFunctionUserValvesSpecById,\r\n\t\tgetUserValvesById as getFunctionUserValvesById,\r\n\t\tupdateUserValvesById as updateFunctionUserValvesById\r\n\t} from '$lib/apis/functions';\r\n\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport Spinner from '$lib/components/common/Spinner.svelte';\r\n\timport Valves from '$lib/components/common/Valves.svelte';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tlet tab = 'tools';\r\n\tlet selectedId = '';\r\n\r\n\tlet loading = false;\r\n\r\n\tlet valvesSpec = null;\r\n\tlet valves = {};\r\n\r\n\tlet debounceTimer;\r\n\r\n\tconst debounceSubmitHandler = async () => {\r\n\t\tif (debounceTimer) {\r\n\t\t\tclearTimeout(debounceTimer);\r\n\t\t}\r\n\r\n\t\t// Set a new timer\r\n\t\tdebounceTimer = setTimeout(() => {\r\n\t\t\tsubmitHandler();\r\n\t\t}, 500); // 0.5 second debounce\r\n\t};\r\n\r\n\tconst getUserValves = async () => {\r\n\t\tloading = true;\r\n\t\tif (tab === 'tools') {\r\n\t\t\tvalves = await getToolUserValvesById(localStorage.token, selectedId);\r\n\t\t\tvalvesSpec = await getToolUserValvesSpecById(localStorage.token, selectedId);\r\n\t\t} else if (tab === 'functions') {\r\n\t\t\tvalves = await getFunctionUserValvesById(localStorage.token, selectedId);\r\n\t\t\tvalvesSpec = await getFunctionUserValvesSpecById(localStorage.token, selectedId);\r\n\t\t}\r\n\r\n\t\tif (valvesSpec) {\r\n\t\t\t// Convert array to string\r\n\t\t\tfor (const property in valvesSpec.properties) {\r\n\t\t\t\tif (valvesSpec.properties[property]?.type === 'array') {\r\n\t\t\t\t\tvalves[property] = (valves[property] ?? []).join(',');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tloading = false;\r\n\t};\r\n\r\n\tconst submitHandler = async () => {\r\n\t\tif (valvesSpec) {\r\n\t\t\t// Convert string to array\r\n\t\t\tfor (const property in valvesSpec.properties) {\r\n\t\t\t\tif (valvesSpec.properties[property]?.type === 'array') {\r\n\t\t\t\t\tvalves[property] = (valves[property] ?? '').split(',').map((v) => v.trim());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (tab === 'tools') {\r\n\t\t\t\tconst res = await updateToolUserValvesById(localStorage.token, selectedId, valves).catch(\r\n\t\t\t\t\t(error) => {\r\n\t\t\t\t\t\ttoast.error(error);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (res) {\r\n\t\t\t\t\ttoast.success($i18n.t('Valves updated'));\r\n\t\t\t\t\tvalves = res;\r\n\t\t\t\t}\r\n\t\t\t} else if (tab === 'functions') {\r\n\t\t\t\tconst res = await updateFunctionUserValvesById(\r\n\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\tselectedId,\r\n\t\t\t\t\tvalves\r\n\t\t\t\t).catch((error) => {\r\n\t\t\t\t\ttoast.error(error);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (res) {\r\n\t\t\t\t\ttoast.success($i18n.t('Valves updated'));\r\n\t\t\t\t\tvalves = res;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t$: if (tab) {\r\n\t\tselectedId = '';\r\n\t}\r\n\r\n\t$: if (selectedId) {\r\n\t\tgetUserValves();\r\n\t}\r\n</script>\r\n\r\n<form\r\n\tclass=\"flex flex-col h-full justify-between space-y-3 text-sm\"\r\n\ton:submit|preventDefault={() => {\r\n\t\tsubmitHandler();\r\n\t\tdispatch('save');\r\n\t}}\r\n>\r\n\t<div class=\"flex flex-col\">\r\n\t\t<div class=\"space-y-1\">\r\n\t\t\t<div class=\"flex gap-2\">\r\n\t\t\t\t<div class=\"flex-1\">\r\n\t\t\t\t\t<select\r\n\t\t\t\t\t\tclass=\"  w-full rounded text-xs py-2 px-1 bg-transparent outline-none\"\r\n\t\t\t\t\t\tbind:value={tab}\r\n\t\t\t\t\t\tplaceholder=\"Select\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<option value=\"tools\" class=\"bg-gray-100 dark:bg-gray-800\">{$i18n.t('Tools')}</option>\r\n\t\t\t\t\t\t<option value=\"functions\" class=\"bg-gray-100 dark:bg-gray-800\"\r\n\t\t\t\t\t\t\t>{$i18n.t('Functions')}</option\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"flex-1\">\r\n\t\t\t\t\t<select\r\n\t\t\t\t\t\tclass=\"w-full rounded py-2 px-1 text-xs bg-transparent outline-none\"\r\n\t\t\t\t\t\tbind:value={selectedId}\r\n\t\t\t\t\t\ton:change={async () => {\r\n\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if tab === 'tools'}\r\n\t\t\t\t\t\t\t<option value=\"\" selected disabled class=\"bg-gray-100 dark:bg-gray-800\"\r\n\t\t\t\t\t\t\t\t>{$i18n.t('Select a tool')}</option\r\n\t\t\t\t\t\t\t>\r\n\r\n\t\t\t\t\t\t\t{#each $tools as tool, toolIdx}\r\n\t\t\t\t\t\t\t\t<option value={tool.id} class=\"bg-gray-100 dark:bg-gray-800\">{tool.name}</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t{:else if tab === 'functions'}\r\n\t\t\t\t\t\t\t<option value=\"\" selected disabled class=\"bg-gray-100 dark:bg-gray-800\"\r\n\t\t\t\t\t\t\t\t>{$i18n.t('Select a function')}</option\r\n\t\t\t\t\t\t\t>\r\n\r\n\t\t\t\t\t\t\t{#each $functions as func, funcIdx}\r\n\t\t\t\t\t\t\t\t<option value={func.id} class=\"bg-gray-100 dark:bg-gray-800\">{func.name}</option>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</select>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t{#if selectedId}\r\n\t\t\t<hr class=\"dark:border-gray-800 my-1 w-full\" />\r\n\r\n\t\t\t<div class=\"my-2 text-xs\">\r\n\t\t\t\t{#if !loading}\r\n\t\t\t\t\t<Valves\r\n\t\t\t\t\t\t{valvesSpec}\r\n\t\t\t\t\t\tbind:valves\r\n\t\t\t\t\t\ton:change={() => {\r\n\t\t\t\t\t\t\tdebounceSubmitHandler();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t/>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<Spinner className=\"size-5\" />\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t</div>\r\n</form>\r\n","<script lang=\"ts\">\r\n\timport { createEventDispatcher, getContext } from 'svelte';\r\n\tconst dispatch = createEventDispatcher();\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport XMark from '$lib/components/icons/XMark.svelte';\r\n\timport AdvancedParams from '../Settings/Advanced/AdvancedParams.svelte';\r\n\timport Valves from '$lib/components/chat/Controls/Valves.svelte';\r\n\timport FileItem from '$lib/components/common/FileItem.svelte';\r\n\timport Collapsible from '$lib/components/common/Collapsible.svelte';\r\n\r\n\timport { user } from '$lib/stores';\r\n\texport let models = [];\r\n\texport let chatFiles = [];\r\n\texport let params = {};\r\n</script>\r\n\r\n<div class=\" dark:text-white\">\r\n\t<div class=\" flex justify-between dark:text-gray-100 mb-2\">\r\n\t\t<div class=\" text-lg font-medium self-center font-primary\">{$i18n.t('Chat Controls')}</div>\r\n\t\t<button\r\n\t\t\tclass=\"self-center\"\r\n\t\t\ton:click={() => {\r\n\t\t\t\tdispatch('close');\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<XMark className=\"size-4\" />\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t<div class=\" dark:text-gray-200 text-sm font-primary py-0.5\">\r\n\t\t{#if chatFiles.length > 0}\r\n\t\t\t<Collapsible title={$i18n.t('Files')} open={true}>\r\n\t\t\t\t<div class=\"flex flex-col gap-1 mt-1.5\" slot=\"content\">\r\n\t\t\t\t\t{#each chatFiles as file, fileIdx}\r\n\t\t\t\t\t\t<FileItem\r\n\t\t\t\t\t\t\tclassName=\"w-full\"\r\n\t\t\t\t\t\t\turl={`${file?.url}`}\r\n\t\t\t\t\t\t\tname={file.name}\r\n\t\t\t\t\t\t\ttype={file.type}\r\n\t\t\t\t\t\t\tsize={file?.size}\r\n\t\t\t\t\t\t\tdismissible={true}\r\n\t\t\t\t\t\t\ton:dismiss={() => {\r\n\t\t\t\t\t\t\t\t// Remove the file from the chatFiles array\r\n\r\n\t\t\t\t\t\t\t\tchatFiles.splice(fileIdx, 1);\r\n\t\t\t\t\t\t\t\tchatFiles = chatFiles;\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t</div>\r\n\t\t\t</Collapsible>\r\n\r\n\t\t\t<hr class=\"my-2 border-gray-100 dark:border-gray-800\" />\r\n\t\t{/if}\r\n\r\n\t\t<Collapsible title={$i18n.t('Valves')}>\r\n\t\t\t<div class=\"text-sm mt-1.5\" slot=\"content\">\r\n\t\t\t\t<Valves />\r\n\t\t\t</div>\r\n\t\t</Collapsible>\r\n\r\n\t\t<hr class=\"my-2 border-gray-100 dark:border-gray-800\" />\r\n\r\n\t\t<Collapsible title={$i18n.t('System Prompt')} open={true}>\r\n\t\t\t<div class=\" mt-1.5\" slot=\"content\">\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tbind:value={params.system}\r\n\t\t\t\t\tclass=\"w-full rounded-lg px-3.5 py-2.5 text-sm dark:text-gray-300 dark:bg-gray-850 border border-gray-100 dark:border-gray-800 outline-none resize-none\"\r\n\t\t\t\t\trows=\"4\"\r\n\t\t\t\t\tplaceholder={$i18n.t('Enter system prompt')}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</Collapsible>\r\n\r\n\t\t<hr class=\"my-2 border-gray-100 dark:border-gray-800\" />\r\n\r\n\t\t<Collapsible title={$i18n.t('Advanced Params')} open={true}>\r\n\t\t\t<div class=\"text-sm mt-1.5\" slot=\"content\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<AdvancedParams admin={$user?.role === 'admin'} bind:params />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</Collapsible>\r\n\t</div>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\timport { getContext, createEventDispatcher } from 'svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\r\n\r\n\texport let onClose: Function = () => {};\r\n\texport let devices: any;\r\n\r\n\tlet show = false;\r\n</script>\r\n\r\n<Dropdown\r\n\tbind:show\r\n\ton:change={(e) => {\r\n\t\tif (e.detail === false) {\r\n\t\t\tonClose();\r\n\t\t}\r\n\t}}\r\n>\r\n\t<slot />\r\n\r\n\t<div slot=\"content\">\r\n\t\t<DropdownMenu.Content\r\n\t\t\tclass=\"w-full max-w-[180px] rounded-lg px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-[9999] bg-white dark:bg-gray-900 dark:text-white shadow-sm\"\r\n\t\t\tsideOffset={6}\r\n\t\t\tside=\"top\"\r\n\t\t\talign=\"start\"\r\n\t\t\ttransition={flyAndScale}\r\n\t\t>\r\n\t\t\t{#each devices as device}\r\n\t\t\t\t<DropdownMenu.Item\r\n\t\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tdispatch('change', device.deviceId);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\"flex items-center\">\r\n\t\t\t\t\t\t<div class=\" line-clamp-1\">\r\n\t\t\t\t\t\t\t{device?.label ?? 'Camera'}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</DropdownMenu.Item>\r\n\t\t\t{/each}\r\n\t\t</DropdownMenu.Content>\r\n\t</div>\r\n</Dropdown>\r\n","<script lang=\"ts\">\r\n\timport { config, models, settings, showCallOverlay } from '$lib/stores';\r\n\timport { onMount, tick, getContext, onDestroy, createEventDispatcher } from 'svelte';\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport { blobToFile } from '$lib/utils';\r\n\timport { generateEmoji } from '$lib/apis';\r\n\timport { synthesizeOpenAISpeech, transcribeAudio } from '$lib/apis/audio';\r\n\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport VideoInputMenu from './CallOverlay/VideoInputMenu.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let eventTarget: EventTarget;\r\n\texport let submitPrompt: Function;\r\n\texport let stopResponse: Function;\r\n\texport let files;\r\n\texport let chatId;\r\n\texport let modelId;\r\n\r\n\tlet wakeLock = null;\r\n\r\n\tlet model = null;\r\n\r\n\tlet loading = false;\r\n\tlet confirmed = false;\r\n\tlet interrupted = false;\r\n\tlet assistantSpeaking = false;\r\n\r\n\tlet emoji = null;\r\n\r\n\tlet camera = false;\r\n\tlet cameraStream = null;\r\n\r\n\tlet chatStreaming = false;\r\n\r\n\tlet rmsLevel = 0;\r\n\tlet hasStartedSpeaking = false;\r\n\tlet mediaRecorder;\r\n\tlet audioStream = null;\r\n\tlet audioChunks = [];\r\n\r\n\tlet videoInputDevices = [];\r\n\tlet selectedVideoInputDeviceId = null;\r\n\r\n\tconst getVideoInputDevices = async () => {\r\n\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\r\n\t\tvideoInputDevices = devices.filter((device) => device.kind === 'videoinput');\r\n\r\n\t\tif (!!navigator.mediaDevices.getDisplayMedia) {\r\n\t\t\tvideoInputDevices = [\r\n\t\t\t\t...videoInputDevices,\r\n\t\t\t\t{\r\n\t\t\t\t\tdeviceId: 'screen',\r\n\t\t\t\t\tlabel: 'Screen Share'\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\tconsole.log(videoInputDevices);\r\n\t\tif (selectedVideoInputDeviceId === null && videoInputDevices.length > 0) {\r\n\t\t\tselectedVideoInputDeviceId = videoInputDevices[0].deviceId;\r\n\t\t}\r\n\t};\r\n\r\n\tconst startCamera = async () => {\r\n\t\tawait getVideoInputDevices();\r\n\r\n\t\tif (cameraStream === null) {\r\n\t\t\tcamera = true;\r\n\t\t\tawait tick();\r\n\t\t\ttry {\r\n\t\t\t\tawait startVideoStream();\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error('Error accessing webcam: ', err);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst startVideoStream = async () => {\r\n\t\tconst video = document.getElementById('camera-feed');\r\n\t\tif (video) {\r\n\t\t\tif (selectedVideoInputDeviceId === 'screen') {\r\n\t\t\t\tcameraStream = await navigator.mediaDevices.getDisplayMedia({\r\n\t\t\t\t\tvideo: {\r\n\t\t\t\t\t\tcursor: 'always'\r\n\t\t\t\t\t},\r\n\t\t\t\t\taudio: false\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcameraStream = await navigator.mediaDevices.getUserMedia({\r\n\t\t\t\t\tvideo: {\r\n\t\t\t\t\t\tdeviceId: selectedVideoInputDeviceId ? { exact: selectedVideoInputDeviceId } : undefined\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (cameraStream) {\r\n\t\t\t\tawait getVideoInputDevices();\r\n\t\t\t\tvideo.srcObject = cameraStream;\r\n\t\t\t\tawait video.play();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst stopVideoStream = async () => {\r\n\t\tif (cameraStream) {\r\n\t\t\tconst tracks = cameraStream.getTracks();\r\n\t\t\ttracks.forEach((track) => track.stop());\r\n\t\t}\r\n\r\n\t\tcameraStream = null;\r\n\t};\r\n\r\n\tconst takeScreenshot = () => {\r\n\t\tconst video = document.getElementById('camera-feed');\r\n\t\tconst canvas = document.getElementById('camera-canvas');\r\n\r\n\t\tif (!canvas) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst context = canvas.getContext('2d');\r\n\r\n\t\t// Make the canvas match the video dimensions\r\n\t\tcanvas.width = video.videoWidth;\r\n\t\tcanvas.height = video.videoHeight;\r\n\r\n\t\t// Draw the image from the video onto the canvas\r\n\t\tcontext.drawImage(video, 0, 0, video.videoWidth, video.videoHeight);\r\n\r\n\t\t// Convert the canvas to a data base64 URL and console log it\r\n\t\tconst dataURL = canvas.toDataURL('image/png');\r\n\t\tconsole.log(dataURL);\r\n\r\n\t\treturn dataURL;\r\n\t};\r\n\r\n\tconst stopCamera = async () => {\r\n\t\tawait stopVideoStream();\r\n\t\tcamera = false;\r\n\t};\r\n\r\n\tconst MIN_DECIBELS = -55;\r\n\tconst VISUALIZER_BUFFER_LENGTH = 300;\r\n\r\n\tconst transcribeHandler = async (audioBlob) => {\r\n\t\t// Create a blob from the audio chunks\r\n\r\n\t\tawait tick();\r\n\t\tconst file = blobToFile(audioBlob, 'recording.wav');\r\n\r\n\t\tconst res = await transcribeAudio(localStorage.token, file).catch((error) => {\r\n\t\t\ttoast.error(error);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (res) {\r\n\t\t\tconsole.log(res.text);\r\n\r\n\t\t\tif (res.text !== '') {\r\n\t\t\t\tconst _responses = await submitPrompt(res.text, { _raw: true });\r\n\t\t\t\tconsole.log(_responses);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst stopRecordingCallback = async (_continue = true) => {\r\n\t\tif ($showCallOverlay) {\r\n\t\t\tconsole.log('%c%s', 'color: red; font-size: 20px;', '🚨 stopRecordingCallback 🚨');\r\n\r\n\t\t\t// deep copy the audioChunks array\r\n\t\t\tconst _audioChunks = audioChunks.slice(0);\r\n\r\n\t\t\taudioChunks = [];\r\n\t\t\tmediaRecorder = false;\r\n\r\n\t\t\tif (_continue) {\r\n\t\t\t\tstartRecording();\r\n\t\t\t}\r\n\r\n\t\t\tif (confirmed) {\r\n\t\t\t\tloading = true;\r\n\t\t\t\temoji = null;\r\n\r\n\t\t\t\tif (cameraStream) {\r\n\t\t\t\t\tconst imageUrl = takeScreenshot();\r\n\r\n\t\t\t\t\tfiles = [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\ttype: 'image',\r\n\t\t\t\t\t\t\turl: imageUrl\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst audioBlob = new Blob(_audioChunks, { type: 'audio/wav' });\r\n\t\t\t\tawait transcribeHandler(audioBlob);\r\n\r\n\t\t\t\tconfirmed = false;\r\n\t\t\t\tloading = false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\taudioChunks = [];\r\n\t\t\tmediaRecorder = false;\r\n\r\n\t\t\tif (audioStream) {\r\n\t\t\t\tconst tracks = audioStream.getTracks();\r\n\t\t\t\ttracks.forEach((track) => track.stop());\r\n\t\t\t}\r\n\t\t\taudioStream = null;\r\n\t\t}\r\n\t};\r\n\r\n\tconst startRecording = async () => {\r\n\t\tif (!audioStream) {\r\n\t\t\taudioStream = await navigator.mediaDevices.getUserMedia({ audio: true });\r\n\t\t}\r\n\t\tmediaRecorder = new MediaRecorder(audioStream);\r\n\r\n\t\tmediaRecorder.onstart = () => {\r\n\t\t\tconsole.log('Recording started');\r\n\t\t\taudioChunks = [];\r\n\t\t\tanalyseAudio(audioStream);\r\n\t\t};\r\n\r\n\t\tmediaRecorder.ondataavailable = (event) => {\r\n\t\t\tif (hasStartedSpeaking) {\r\n\t\t\t\taudioChunks.push(event.data);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tmediaRecorder.onstop = (e) => {\r\n\t\t\tconsole.log('Recording stopped', audioStream, e);\r\n\t\t\tstopRecordingCallback();\r\n\t\t};\r\n\r\n\t\tmediaRecorder.start();\r\n\t};\r\n\r\n\tconst stopAudioStream = async () => {\r\n\t\tif (!audioStream) return;\r\n\r\n\t\taudioStream.getAudioTracks().forEach(function (track) {\r\n\t\t\ttrack.stop();\r\n\t\t});\r\n\r\n\t\taudioStream = null;\r\n\t};\r\n\r\n\t// Function to calculate the RMS level from time domain data\r\n\tconst calculateRMS = (data: Uint8Array) => {\r\n\t\tlet sumSquares = 0;\r\n\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\tconst normalizedValue = (data[i] - 128) / 128; // Normalize the data\r\n\t\t\tsumSquares += normalizedValue * normalizedValue;\r\n\t\t}\r\n\t\treturn Math.sqrt(sumSquares / data.length);\r\n\t};\r\n\r\n\tconst analyseAudio = (stream) => {\r\n\t\tconst audioContext = new AudioContext();\r\n\t\tconst audioStreamSource = audioContext.createMediaStreamSource(stream);\r\n\r\n\t\tconst analyser = audioContext.createAnalyser();\r\n\t\tanalyser.minDecibels = MIN_DECIBELS;\r\n\t\taudioStreamSource.connect(analyser);\r\n\r\n\t\tconst bufferLength = analyser.frequencyBinCount;\r\n\r\n\t\tconst domainData = new Uint8Array(bufferLength);\r\n\t\tconst timeDomainData = new Uint8Array(analyser.fftSize);\r\n\r\n\t\tlet lastSoundTime = Date.now();\r\n\t\thasStartedSpeaking = false;\r\n\r\n\t\tconsole.log('🔊 Sound detection started', lastSoundTime, hasStartedSpeaking);\r\n\r\n\t\tconst detectSound = () => {\r\n\t\t\tconst processFrame = () => {\r\n\t\t\t\tif (!mediaRecorder || !$showCallOverlay) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (assistantSpeaking && !($settings?.voiceInterruption ?? false)) {\r\n\t\t\t\t\t// Mute the audio if the assistant is speaking\r\n\t\t\t\t\tanalyser.maxDecibels = 0;\r\n\t\t\t\t\tanalyser.minDecibels = -1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tanalyser.minDecibels = MIN_DECIBELS;\r\n\t\t\t\t\tanalyser.maxDecibels = -30;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tanalyser.getByteTimeDomainData(timeDomainData);\r\n\t\t\t\tanalyser.getByteFrequencyData(domainData);\r\n\r\n\t\t\t\t// Calculate RMS level from time domain data\r\n\t\t\t\trmsLevel = calculateRMS(timeDomainData);\r\n\r\n\t\t\t\t// Check if initial speech/noise has started\r\n\t\t\t\tconst hasSound = domainData.some((value) => value > 0);\r\n\t\t\t\tif (hasSound) {\r\n\t\t\t\t\t// BIG RED TEXT\r\n\t\t\t\t\tconsole.log('%c%s', 'color: red; font-size: 20px;', '🔊 Sound detected');\r\n\r\n\t\t\t\t\tif (!hasStartedSpeaking) {\r\n\t\t\t\t\t\thasStartedSpeaking = true;\r\n\t\t\t\t\t\tstopAllAudio();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlastSoundTime = Date.now();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Start silence detection only after initial speech/noise has been detected\r\n\t\t\t\tif (hasStartedSpeaking) {\r\n\t\t\t\t\tif (Date.now() - lastSoundTime > 2000) {\r\n\t\t\t\t\t\tconfirmed = true;\r\n\r\n\t\t\t\t\t\tif (mediaRecorder) {\r\n\t\t\t\t\t\t\tconsole.log('%c%s', 'color: red; font-size: 20px;', '🔇 Silence detected');\r\n\t\t\t\t\t\t\tmediaRecorder.stop();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.requestAnimationFrame(processFrame);\r\n\t\t\t};\r\n\r\n\t\t\twindow.requestAnimationFrame(processFrame);\r\n\t\t};\r\n\r\n\t\tdetectSound();\r\n\t};\r\n\r\n\tlet finishedMessages = {};\r\n\tlet currentMessageId = null;\r\n\tlet currentUtterance = null;\r\n\r\n\tconst speakSpeechSynthesisHandler = (content) => {\r\n\t\tif ($showCallOverlay) {\r\n\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\tlet voices = [];\r\n\t\t\t\tconst getVoicesLoop = setInterval(async () => {\r\n\t\t\t\t\tvoices = await speechSynthesis.getVoices();\r\n\t\t\t\t\tif (voices.length > 0) {\r\n\t\t\t\t\t\tclearInterval(getVoicesLoop);\r\n\r\n\t\t\t\t\t\tconst voice =\r\n\t\t\t\t\t\t\tvoices\r\n\t\t\t\t\t\t\t\t?.filter(\r\n\t\t\t\t\t\t\t\t\t(v) => v.voiceURI === ($settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice)\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t?.at(0) ?? undefined;\r\n\r\n\t\t\t\t\t\tcurrentUtterance = new SpeechSynthesisUtterance(content);\r\n\t\t\t\t\t\tcurrentUtterance.rate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\t\tif (voice) {\r\n\t\t\t\t\t\t\tcurrentUtterance.voice = voice;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tspeechSynthesis.speak(currentUtterance);\r\n\t\t\t\t\t\tcurrentUtterance.onend = async (e) => {\r\n\t\t\t\t\t\t\tawait new Promise((r) => setTimeout(r, 200));\r\n\t\t\t\t\t\t\tresolve(e);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 100);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\t};\r\n\r\n\tconst playAudio = (audio) => {\r\n\t\tif ($showCallOverlay) {\r\n\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\tconst audioElement = document.getElementById('audioElement') as HTMLAudioElement;\r\n\r\n\t\t\t\tif (audioElement) {\r\n\t\t\t\t\taudioElement.src = audio.src;\r\n\t\t\t\t\taudioElement.muted = true;\r\n\t\t\t\t\taudioElement.playbackRate = $settings.audio?.tts?.playbackRate ?? 1;\r\n\r\n\t\t\t\t\taudioElement\r\n\t\t\t\t\t\t.play()\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\taudioElement.muted = false;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.catch((error) => {\r\n\t\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\taudioElement.onended = async (e) => {\r\n\t\t\t\t\t\tawait new Promise((r) => setTimeout(r, 100));\r\n\t\t\t\t\t\tresolve(e);\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn Promise.resolve();\r\n\t\t}\r\n\t};\r\n\r\n\tconst stopAllAudio = async () => {\r\n\t\tassistantSpeaking = false;\r\n\t\tinterrupted = true;\r\n\r\n\t\tif (chatStreaming) {\r\n\t\t\tstopResponse();\r\n\t\t}\r\n\r\n\t\tif (currentUtterance) {\r\n\t\t\tspeechSynthesis.cancel();\r\n\t\t\tcurrentUtterance = null;\r\n\t\t}\r\n\r\n\t\tconst audioElement = document.getElementById('audioElement');\r\n\t\tif (audioElement) {\r\n\t\t\taudioElement.muted = true;\r\n\t\t\taudioElement.pause();\r\n\t\t\taudioElement.currentTime = 0;\r\n\t\t}\r\n\t};\r\n\r\n\tlet audioAbortController = new AbortController();\r\n\r\n\t// Audio cache map where key is the content and value is the Audio object.\r\n\tconst audioCache = new Map();\r\n\tconst emojiCache = new Map();\r\n\r\n\tconst fetchAudio = async (content) => {\r\n\t\tif (!audioCache.has(content)) {\r\n\t\t\ttry {\r\n\t\t\t\t// Set the emoji for the content if needed\r\n\t\t\t\tif ($settings?.showEmojiInCall ?? false) {\r\n\t\t\t\t\tconst emoji = await generateEmoji(localStorage.token, modelId, content, chatId);\r\n\t\t\t\t\tif (emoji) {\r\n\t\t\t\t\t\temojiCache.set(content, emoji);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($config.audio.tts.engine !== '') {\r\n\t\t\t\t\tconst res = await synthesizeOpenAISpeech(\r\n\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\t$settings?.audio?.tts?.voice ?? $config?.audio?.tts?.voice,\r\n\t\t\t\t\t\tcontent\r\n\t\t\t\t\t).catch((error) => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\tconst blob = await res.blob();\r\n\t\t\t\t\t\tconst blobUrl = URL.createObjectURL(blob);\r\n\t\t\t\t\t\taudioCache.set(content, new Audio(blobUrl));\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\taudioCache.set(content, true);\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Error synthesizing speech:', error);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn audioCache.get(content);\r\n\t};\r\n\r\n\tlet messages = {};\r\n\r\n\tconst monitorAndPlayAudio = async (id, signal) => {\r\n\t\twhile (!signal.aborted) {\r\n\t\t\tif (messages[id] && messages[id].length > 0) {\r\n\t\t\t\t// Retrieve the next content string from the queue\r\n\t\t\t\tconst content = messages[id].shift(); // Dequeues the content for playing\r\n\r\n\t\t\t\tif (audioCache.has(content)) {\r\n\t\t\t\t\t// If content is available in the cache, play it\r\n\r\n\t\t\t\t\t// Set the emoji for the content if available\r\n\t\t\t\t\tif (($settings?.showEmojiInCall ?? false) && emojiCache.has(content)) {\r\n\t\t\t\t\t\temoji = emojiCache.get(content);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\temoji = null;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ($config.audio.tts.engine !== '') {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t'%c%s',\r\n\t\t\t\t\t\t\t\t'color: red; font-size: 20px;',\r\n\t\t\t\t\t\t\t\t`Playing audio for content: ${content}`\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tconst audio = audioCache.get(content);\r\n\t\t\t\t\t\t\tawait playAudio(audio); // Here ensure that playAudio is indeed correct method to execute\r\n\t\t\t\t\t\t\tconsole.log(`Played audio for content: ${content}`);\r\n\t\t\t\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 200)); // Wait before retrying to reduce tight loop\r\n\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\tconsole.error('Error playing audio:', error);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tawait speakSpeechSynthesisHandler(content);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// If not available in the cache, push it back to the queue and delay\r\n\t\t\t\t\tmessages[id].unshift(content); // Re-queue the content at the start\r\n\t\t\t\t\tconsole.log(`Audio for \"${content}\" not yet available in the cache, re-queued...`);\r\n\t\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 200)); // Wait before retrying to reduce tight loop\r\n\t\t\t\t}\r\n\t\t\t} else if (finishedMessages[id] && messages[id] && messages[id].length === 0) {\r\n\t\t\t\t// If the message is finished and there are no more messages to process, break the loop\r\n\t\t\t\tassistantSpeaking = false;\r\n\t\t\t\tbreak;\r\n\t\t\t} else {\r\n\t\t\t\t// No messages to process, sleep for a bit\r\n\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 200));\r\n\t\t\t}\r\n\t\t}\r\n\t\tconsole.log(`Audio monitoring and playing stopped for message ID ${id}`);\r\n\t};\r\n\r\n\tconst chatStartHandler = async (e) => {\r\n\t\tconst { id } = e.detail;\r\n\r\n\t\tchatStreaming = true;\r\n\r\n\t\tif (currentMessageId !== id) {\r\n\t\t\tconsole.log(`Received chat start event for message ID ${id}`);\r\n\r\n\t\t\tcurrentMessageId = id;\r\n\t\t\tif (audioAbortController) {\r\n\t\t\t\taudioAbortController.abort();\r\n\t\t\t}\r\n\t\t\taudioAbortController = new AbortController();\r\n\r\n\t\t\tassistantSpeaking = true;\r\n\t\t\t// Start monitoring and playing audio for the message ID\r\n\t\t\tmonitorAndPlayAudio(id, audioAbortController.signal);\r\n\t\t}\r\n\t};\r\n\r\n\tconst chatEventHandler = async (e) => {\r\n\t\tconst { id, content } = e.detail;\r\n\t\t// \"id\" here is message id\r\n\t\t// if \"id\" is not the same as \"currentMessageId\" then do not process\r\n\t\t// \"content\" here is a sentence from the assistant,\r\n\t\t// there will be many sentences for the same \"id\"\r\n\r\n\t\tif (currentMessageId === id) {\r\n\t\t\tconsole.log(`Received chat event for message ID ${id}: ${content}`);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tif (messages[id] === undefined) {\r\n\t\t\t\t\tmessages[id] = [content];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessages[id].push(content);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(content);\r\n\r\n\t\t\t\tfetchAudio(content);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Failed to fetch or play audio:', error);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst chatFinishHandler = async (e) => {\r\n\t\tconst { id, content } = e.detail;\r\n\t\t// \"content\" here is the entire message from the assistant\r\n\t\tfinishedMessages[id] = true;\r\n\r\n\t\tchatStreaming = false;\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\tconst setWakeLock = async () => {\r\n\t\t\ttry {\r\n\t\t\t\twakeLock = await navigator.wakeLock.request('screen');\r\n\t\t\t} catch (err) {\r\n\t\t\t\t// The Wake Lock request has failed - usually system related, such as battery.\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t}\r\n\r\n\t\t\tif (wakeLock) {\r\n\t\t\t\t// Add a listener to release the wake lock when the page is unloaded\r\n\t\t\t\twakeLock.addEventListener('release', () => {\r\n\t\t\t\t\t// the wake lock has been released\r\n\t\t\t\t\tconsole.log('Wake Lock released');\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif ('wakeLock' in navigator) {\r\n\t\t\tawait setWakeLock();\r\n\r\n\t\t\tdocument.addEventListener('visibilitychange', async () => {\r\n\t\t\t\t// Re-request the wake lock if the document becomes visible\r\n\t\t\t\tif (wakeLock !== null && document.visibilityState === 'visible') {\r\n\t\t\t\t\tawait setWakeLock();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tmodel = $models.find((m) => m.id === modelId);\r\n\r\n\t\tstartRecording();\r\n\r\n\t\teventTarget.addEventListener('chat:start', chatStartHandler);\r\n\t\teventTarget.addEventListener('chat', chatEventHandler);\r\n\t\teventTarget.addEventListener('chat:finish', chatFinishHandler);\r\n\r\n\t\treturn async () => {\r\n\t\t\tawait stopAllAudio();\r\n\r\n\t\t\tstopAudioStream();\r\n\r\n\t\t\teventTarget.removeEventListener('chat:start', chatStartHandler);\r\n\t\t\teventTarget.removeEventListener('chat', chatEventHandler);\r\n\t\t\teventTarget.removeEventListener('chat:finish', chatFinishHandler);\r\n\r\n\t\t\taudioAbortController.abort();\r\n\t\t\tawait tick();\r\n\r\n\t\t\tawait stopAllAudio();\r\n\r\n\t\t\tawait stopRecordingCallback(false);\r\n\t\t\tawait stopCamera();\r\n\t\t};\r\n\t});\r\n\r\n\tonDestroy(async () => {\r\n\t\tawait stopAllAudio();\r\n\t\tstopAudioStream();\r\n\r\n\t\teventTarget.removeEventListener('chat:start', chatStartHandler);\r\n\t\teventTarget.removeEventListener('chat', chatEventHandler);\r\n\t\teventTarget.removeEventListener('chat:finish', chatFinishHandler);\r\n\r\n\t\taudioAbortController.abort();\r\n\t\tawait tick();\r\n\r\n\t\tawait stopAllAudio();\r\n\r\n\t\tawait stopRecordingCallback(false);\r\n\t\tawait stopCamera();\r\n\t});\r\n</script>\r\n\r\n{#if $showCallOverlay}\r\n\t<div class=\"max-w-lg w-full h-full max-h-[100dvh] flex flex-col justify-between p-3 md:p-6\">\r\n\t\t{#if camera}\r\n\t\t\t<button\r\n\t\t\t\ttype=\"button\"\r\n\t\t\t\tclass=\"flex justify-center items-center w-full h-20 min-h-20\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tif (assistantSpeaking) {\r\n\t\t\t\t\t\tstopAllAudio();\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t{#if emoji}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"  transition-all rounded-full\"\r\n\t\t\t\t\t\tstyle=\"font-size:{rmsLevel * 100 > 4\r\n\t\t\t\t\t\t\t? '4.5'\r\n\t\t\t\t\t\t\t: rmsLevel * 100 > 2\r\n\t\t\t\t\t\t\t\t? '4.25'\r\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\r\n\t\t\t\t\t\t\t\t\t? '3.75'\r\n\t\t\t\t\t\t\t\t\t: '3.5'}rem;width: 100%; text-align:center;\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{emoji}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{:else if loading || assistantSpeaking}\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\tclass=\"size-12 text-gray-900 dark:text-gray-400\"\r\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t><style>\r\n\t\t\t\t\t\t\t.spinner_qM83 {\r\n\t\t\t\t\t\t\t\tanimation: spinner_8HQG 1.05s infinite;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t.spinner_oXPr {\r\n\t\t\t\t\t\t\t\tanimation-delay: 0.1s;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t.spinner_ZTLf {\r\n\t\t\t\t\t\t\t\tanimation-delay: 0.2s;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t@keyframes spinner_8HQG {\r\n\t\t\t\t\t\t\t\t0%,\r\n\t\t\t\t\t\t\t\t57.14% {\r\n\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);\r\n\t\t\t\t\t\t\t\t\ttransform: translate(0);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t28.57% {\r\n\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);\r\n\t\t\t\t\t\t\t\t\ttransform: translateY(-6px);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\t\ttransform: translate(0);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t</style><circle class=\"spinner_qM83\" cx=\"4\" cy=\"12\" r=\"3\" /><circle\r\n\t\t\t\t\t\t\tclass=\"spinner_qM83 spinner_oXPr\"\r\n\t\t\t\t\t\t\tcx=\"12\"\r\n\t\t\t\t\t\t\tcy=\"12\"\r\n\t\t\t\t\t\t\tr=\"3\"\r\n\t\t\t\t\t\t/><circle class=\"spinner_qM83 spinner_ZTLf\" cx=\"20\" cy=\"12\" r=\"3\" /></svg\r\n\t\t\t\t\t>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" {rmsLevel * 100 > 4\r\n\t\t\t\t\t\t\t? ' size-[4.5rem]'\r\n\t\t\t\t\t\t\t: rmsLevel * 100 > 2\r\n\t\t\t\t\t\t\t\t? ' size-16'\r\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\r\n\t\t\t\t\t\t\t\t\t? 'size-14'\r\n\t\t\t\t\t\t\t\t\t: 'size-12'}  transition-all rounded-full {(model?.info?.meta\r\n\t\t\t\t\t\t\t?.profile_image_url ?? '/static/favicon.png') !== '/static/favicon.png'\r\n\t\t\t\t\t\t\t? ' bg-cover bg-center bg-no-repeat'\r\n\t\t\t\t\t\t\t: 'bg-black dark:bg-white'}  bg-black dark:bg-white\"\r\n\t\t\t\t\t\tstyle={(model?.info?.meta?.profile_image_url ?? '/static/favicon.png') !==\r\n\t\t\t\t\t\t'/static/favicon.png'\r\n\t\t\t\t\t\t\t? `background-image: url('${model?.info?.meta?.profile_image_url}');`\r\n\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t/>\r\n\t\t\t\t{/if}\r\n\t\t\t\t<!-- navbar -->\r\n\t\t\t</button>\r\n\t\t{/if}\r\n\r\n\t\t<div class=\"flex justify-center items-center flex-1 h-full w-full max-h-full\">\r\n\t\t\t{#if !camera}\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tif (assistantSpeaking) {\r\n\t\t\t\t\t\t\tstopAllAudio();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t{#if emoji}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\"  transition-all rounded-full\"\r\n\t\t\t\t\t\t\tstyle=\"font-size:{rmsLevel * 100 > 4\r\n\t\t\t\t\t\t\t\t? '13'\r\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 2\r\n\t\t\t\t\t\t\t\t\t? '12'\r\n\t\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\r\n\t\t\t\t\t\t\t\t\t\t? '11.5'\r\n\t\t\t\t\t\t\t\t\t\t: '11'}rem;width:100%;text-align:center;\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{emoji}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{:else if loading || assistantSpeaking}\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\tclass=\"size-44 text-gray-900 dark:text-gray-400\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t><style>\r\n\t\t\t\t\t\t\t\t.spinner_qM83 {\r\n\t\t\t\t\t\t\t\t\tanimation: spinner_8HQG 1.05s infinite;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t.spinner_oXPr {\r\n\t\t\t\t\t\t\t\t\tanimation-delay: 0.1s;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t.spinner_ZTLf {\r\n\t\t\t\t\t\t\t\t\tanimation-delay: 0.2s;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t@keyframes spinner_8HQG {\r\n\t\t\t\t\t\t\t\t\t0%,\r\n\t\t\t\t\t\t\t\t\t57.14% {\r\n\t\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0.66, 0.66, 1);\r\n\t\t\t\t\t\t\t\t\t\ttransform: translate(0);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t28.57% {\r\n\t\t\t\t\t\t\t\t\t\tanimation-timing-function: cubic-bezier(0.33, 0, 0.66, 0.33);\r\n\t\t\t\t\t\t\t\t\t\ttransform: translateY(-6px);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t100% {\r\n\t\t\t\t\t\t\t\t\t\ttransform: translate(0);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t</style><circle class=\"spinner_qM83\" cx=\"4\" cy=\"12\" r=\"3\" /><circle\r\n\t\t\t\t\t\t\t\tclass=\"spinner_qM83 spinner_oXPr\"\r\n\t\t\t\t\t\t\t\tcx=\"12\"\r\n\t\t\t\t\t\t\t\tcy=\"12\"\r\n\t\t\t\t\t\t\t\tr=\"3\"\r\n\t\t\t\t\t\t\t/><circle class=\"spinner_qM83 spinner_ZTLf\" cx=\"20\" cy=\"12\" r=\"3\" /></svg\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" {rmsLevel * 100 > 4\r\n\t\t\t\t\t\t\t\t? ' size-52'\r\n\t\t\t\t\t\t\t\t: rmsLevel * 100 > 2\r\n\t\t\t\t\t\t\t\t\t? 'size-48'\r\n\t\t\t\t\t\t\t\t\t: rmsLevel * 100 > 1\r\n\t\t\t\t\t\t\t\t\t\t? 'size-44'\r\n\t\t\t\t\t\t\t\t\t\t: 'size-40'}  transition-all rounded-full {(model?.info?.meta\r\n\t\t\t\t\t\t\t\t?.profile_image_url ?? '/static/favicon.png') !== '/static/favicon.png'\r\n\t\t\t\t\t\t\t\t? ' bg-cover bg-center bg-no-repeat'\r\n\t\t\t\t\t\t\t\t: 'bg-black dark:bg-white'} \"\r\n\t\t\t\t\t\t\tstyle={(model?.info?.meta?.profile_image_url ?? '/static/favicon.png') !==\r\n\t\t\t\t\t\t\t'/static/favicon.png'\r\n\t\t\t\t\t\t\t\t? `background-image: url('${model?.info?.meta?.profile_image_url}');`\r\n\t\t\t\t\t\t\t\t: ''}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</button>\r\n\t\t\t{:else}\r\n\t\t\t\t<div class=\"relative flex video-container w-full max-h-full pt-2 pb-4 md:py-6 px-2 h-full\">\r\n\t\t\t\t\t<video\r\n\t\t\t\t\t\tid=\"camera-feed\"\r\n\t\t\t\t\t\tautoplay\r\n\t\t\t\t\t\tclass=\"rounded-2xl h-full min-w-full object-cover object-center\"\r\n\t\t\t\t\t\tplaysinline\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<canvas id=\"camera-canvas\" style=\"display:none;\" />\r\n\r\n\t\t\t\t\t<div class=\" absolute top-4 md:top-8 left-4\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\tclass=\"p-1.5 text-white cursor-pointer backdrop-blur-xl bg-black/10 rounded-full\"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tstopCamera();\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"size-6\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\td=\"M5.28 4.22a.75.75 0 0 0-1.06 1.06L6.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L8 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L9.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L8 6.94 5.28 4.22Z\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex justify-between items-center pb-2 w-full\">\r\n\t\t\t<div>\r\n\t\t\t\t{#if camera}\r\n\t\t\t\t\t<VideoInputMenu\r\n\t\t\t\t\t\tdevices={videoInputDevices}\r\n\t\t\t\t\t\ton:change={async (e) => {\r\n\t\t\t\t\t\t\tconsole.log(e.detail);\r\n\t\t\t\t\t\t\tselectedVideoInputDeviceId = e.detail;\r\n\t\t\t\t\t\t\tawait stopVideoStream();\r\n\t\t\t\t\t\t\tawait startVideoStream();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<button class=\" p-3 rounded-full bg-gray-50 dark:bg-gray-900\" type=\"button\">\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\td=\"M15.312 11.424a5.5 5.5 0 0 1-9.201 2.466l-.312-.311h2.433a.75.75 0 0 0 0-1.5H3.989a.75.75 0 0 0-.75.75v4.242a.75.75 0 0 0 1.5 0v-2.43l.31.31a7 7 0 0 0 11.712-3.138.75.75 0 0 0-1.449-.39Zm1.23-3.723a.75.75 0 0 0 .219-.53V2.929a.75.75 0 0 0-1.5 0V5.36l-.31-.31A7 7 0 0 0 3.239 8.188a.75.75 0 1 0 1.448.389A5.5 5.5 0 0 1 13.89 6.11l.311.31h-2.432a.75.75 0 0 0 0 1.5h4.243a.75.75 0 0 0 .53-.219Z\"\r\n\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</VideoInputMenu>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<Tooltip content={$i18n.t('Camera')}>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\" p-3 rounded-full bg-gray-50 dark:bg-gray-900\"\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\t\t\tawait navigator.mediaDevices.getUserMedia({ video: true });\r\n\t\t\t\t\t\t\t\tstartCamera();\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\td=\"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\td=\"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</Tooltip>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div>\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tif (assistantSpeaking) {\r\n\t\t\t\t\t\t\tstopAllAudio();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<div class=\" line-clamp-1 text-sm font-medium\">\r\n\t\t\t\t\t\t{#if loading}\r\n\t\t\t\t\t\t\t{$i18n.t('Thinking...')}\r\n\t\t\t\t\t\t{:else if assistantSpeaking}\r\n\t\t\t\t\t\t\t{$i18n.t('Tap to interrupt')}\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t{$i18n.t('Listening...')}\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div>\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\" p-3 rounded-full bg-gray-50 dark:bg-gray-900\"\r\n\t\t\t\t\ton:click={async () => {\r\n\t\t\t\t\t\tawait stopAudioStream();\r\n\t\t\t\t\t\tawait stopVideoStream();\r\n\r\n\t\t\t\t\t\tconsole.log(audioStream);\r\n\t\t\t\t\t\tconsole.log(cameraStream);\r\n\r\n\t\t\t\t\t\tshowCallOverlay.set(false);\r\n\t\t\t\t\t\tdispatch('close');\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\tclass=\"size-5\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 0 0-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 1 0 1.06 1.06L10 11.06l3.72 3.72a.75.75 0 1 0 1.06-1.06L11.06 10l3.72-3.72a.75.75 0 0 0-1.06-1.06L10 8.94 6.28 5.22Z\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { onDestroy, onMount, createEventDispatcher } from 'svelte';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\timport { fade, fly, slide } from 'svelte/transition';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\texport let show = false;\r\n\texport let size = 'md';\r\n\r\n\tlet modalElement = null;\r\n\tlet mounted = false;\r\n\r\n\tconst sizeToWidth = (size) => {\r\n\t\tif (size === 'xs') {\r\n\t\t\treturn 'w-[16rem]';\r\n\t\t} else if (size === 'sm') {\r\n\t\t\treturn 'w-[30rem]';\r\n\t\t} else if (size === 'md') {\r\n\t\t\treturn 'w-[48rem]';\r\n\t\t} else {\r\n\t\t\treturn 'w-[56rem]';\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleKeyDown = (event: KeyboardEvent) => {\r\n\t\tif (event.key === 'Escape' && isTopModal()) {\r\n\t\t\tconsole.log('Escape');\r\n\t\t\tshow = false;\r\n\t\t}\r\n\t};\r\n\r\n\tconst isTopModal = () => {\r\n\t\tconst modals = document.getElementsByClassName('modal');\r\n\t\treturn modals.length && modals[modals.length - 1] === modalElement;\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\tmounted = true;\r\n\t});\r\n\r\n\t$: if (show && modalElement) {\r\n\t\tdocument.body.appendChild(modalElement);\r\n\t\twindow.addEventListener('keydown', handleKeyDown);\r\n\t\tdocument.body.style.overflow = 'hidden';\r\n\t} else if (modalElement) {\r\n\t\tdispatch('close');\r\n\t\twindow.removeEventListener('keydown', handleKeyDown);\r\n\r\n\t\tif (document.body.contains(modalElement)) {\r\n\t\t\tdocument.body.removeChild(modalElement);\r\n\t\t\tdocument.body.style.overflow = 'unset';\r\n\t\t}\r\n\t}\r\n\r\n\tonDestroy(() => {\r\n\t\tshow = false;\r\n\t\tif (modalElement) {\r\n\t\t\tif (document.body.contains(modalElement)) {\r\n\t\t\t\tdocument.body.removeChild(modalElement);\r\n\t\t\t\tdocument.body.style.overflow = 'unset';\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n<!-- svelte-ignore a11y-click-events-have-key-events -->\r\n<!-- svelte-ignore a11y-no-static-element-interactions -->\r\n\r\n<div\r\n\tbind:this={modalElement}\r\n\tclass=\"modal fixed right-0 left-0 bottom-0 bg-black/60 w-full h-screen max-h-[100dvh] flex justify-center z-[9999] overflow-hidden overscroll-contain\"\r\n\tin:fly={{ y: 100, duration: 100 }}\r\n\ton:mousedown={() => {\r\n\t\tshow = false;\r\n\t}}\r\n>\r\n\t<div\r\n\t\tclass=\" mt-auto max-w-full w-full bg-gray-50 dark:bg-gray-900 max-h-[100dvh] overflow-y-auto scrollbar-hidden\"\r\n\t\ton:mousedown={(e) => {\r\n\t\t\te.stopPropagation();\r\n\t\t}}\r\n\t>\r\n\t\t<slot />\r\n\t</div>\r\n</div>\r\n\r\n<style>\r\n\t.modal-content {\r\n\t\tanimation: scaleUp 0.1s ease-out forwards;\r\n\t}\r\n\r\n\t@keyframes scaleUp {\r\n\t\tfrom {\r\n\t\t\ttransform: scale(0.985);\r\n\t\t\topacity: 0;\r\n\t\t}\r\n\t\tto {\r\n\t\t\ttransform: scale(1);\r\n\t\t\topacity: 1;\r\n\t\t}\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\timport { Handle, Position, type NodeProps } from '@xyflow/svelte';\r\n\r\n\timport ProfileImageBase from '../Messages/ProfileImageBase.svelte';\r\n\timport Tooltip from '$lib/components/common/Tooltip.svelte';\r\n\timport Heart from '$lib/components/icons/Heart.svelte';\r\n\r\n\ttype $$Props = NodeProps;\r\n\texport let data: $$Props['data'];\r\n</script>\r\n\r\n<div\r\n\tclass=\"px-4 py-3 shadow-md rounded-xl dark:bg-black bg-white border dark:border-gray-900 w-60 h-20 group\"\r\n>\r\n\t<Tooltip\r\n\t\tcontent={data?.message?.error ? data.message.error.content : data.message.content}\r\n\t\tclass=\"w-full\"\r\n\t\tallowHTML={false}\r\n\t>\r\n\t\t{#if data.message.role === 'user'}\r\n\t\t\t<div class=\"flex w-full\">\r\n\t\t\t\t<ProfileImageBase\r\n\t\t\t\t\tsrc={data.user?.profile_image_url ?? '/user.png'}\r\n\t\t\t\t\tclassName={'size-5 -translate-y-[1px]'}\r\n\t\t\t\t/>\r\n\t\t\t\t<div class=\"ml-2\">\r\n\t\t\t\t\t<div class=\" flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\"text-xs text-black dark:text-white font-medium line-clamp-1\">\r\n\t\t\t\t\t\t\t{data?.user?.name ?? 'User'}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if data?.message?.error}\r\n\t\t\t\t\t\t<div class=\"text-red-500 line-clamp-2 text-xs mt-0.5\">{data.message.error.content}</div>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<div class=\"text-gray-500 line-clamp-2 text-xs mt-0.5\">{data.message.content}</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{:else}\r\n\t\t\t<div class=\"flex w-full\">\r\n\t\t\t\t<ProfileImageBase\r\n\t\t\t\t\tsrc={data?.model?.info?.meta?.profile_image_url ?? ''}\r\n\t\t\t\t\tclassName={'size-5 -translate-y-[1px]'}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t<div class=\"ml-2\">\r\n\t\t\t\t\t<div class=\" flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\"text-xs text-black dark:text-white font-medium line-clamp-1\">\r\n\t\t\t\t\t\t\t{data?.model?.name ?? data?.message?.model ?? 'Assistant'}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass={data?.message?.favorite ? '' : 'invisible group-hover:visible'}\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tdata.message.favorite = !(data?.message?.favorite ?? false);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Heart\r\n\t\t\t\t\t\t\t\tclassName=\"size-3 {data?.message?.favorite\r\n\t\t\t\t\t\t\t\t\t? 'fill-red-500 stroke-red-500'\r\n\t\t\t\t\t\t\t\t\t: 'hover:fill-red-500 hover:stroke-red-500'} \"\r\n\t\t\t\t\t\t\t\tstrokeWidth=\"2.5\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{#if data?.message?.error}\r\n\t\t\t\t\t\t<div class=\"text-red-500 line-clamp-2 text-xs mt-0.5\">\r\n\t\t\t\t\t\t\t{data.message.error.content}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<div class=\"text-gray-500 line-clamp-2 text-xs mt-0.5\">{data.message.content}</div>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t{/if}\r\n\t</Tooltip>\r\n\t<Handle type=\"target\" position={Position.Top} class=\"w-2 rounded-full dark:bg-gray-900\" />\r\n\t<Handle type=\"source\" position={Position.Bottom} class=\"w-2 rounded-full dark:bg-gray-900\" />\r\n</div>\r\n","<script>\r\n\timport { createEventDispatcher } from 'svelte';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\r\n\timport { theme } from '$lib/stores';\r\n\timport { Background, Controls, SvelteFlow, BackgroundVariant } from '@xyflow/svelte';\r\n\r\n\texport let nodes;\r\n\texport let nodeTypes;\r\n\texport let edges;\r\n</script>\r\n\r\n<SvelteFlow\r\n\t{nodes}\r\n\t{nodeTypes}\r\n\t{edges}\r\n\tfitView\r\n\tminZoom={0.001}\r\n\tcolorMode={$theme.includes('dark')\r\n\t\t? 'dark'\r\n\t\t: $theme === 'system'\r\n\t\t\t? window.matchMedia('(prefers-color-scheme: dark)').matches\r\n\t\t\t\t? 'dark'\r\n\t\t\t\t: 'light'\r\n\t\t\t: 'light'}\r\n\tnodesConnectable={false}\r\n\tnodesDraggable={false}\r\n\ton:nodeclick={(e) => dispatch('nodeclick', e.detail)}\r\n\toninit={() => {\r\n\t\tconsole.log('Flow initialized');\r\n\t}}\r\n>\r\n\t<Controls showLock={false} />\r\n\t<Background variant={BackgroundVariant.Dots} />\r\n</SvelteFlow>\r\n","<script lang=\"ts\">\r\n\timport { getContext, createEventDispatcher, onDestroy } from 'svelte';\r\n\timport { useSvelteFlow, useNodesInitialized, useStore } from '@xyflow/svelte';\r\n\r\n\tconst dispatch = createEventDispatcher();\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport { onMount, tick } from 'svelte';\r\n\r\n\timport { writable } from 'svelte/store';\r\n\timport { models, showOverview, theme, user } from '$lib/stores';\r\n\r\n\timport '@xyflow/svelte/dist/style.css';\r\n\r\n\timport CustomNode from './Overview/Node.svelte';\r\n\timport Flow from './Overview/Flow.svelte';\r\n\timport XMark from '../icons/XMark.svelte';\r\n\r\n\tconst { width, height } = useStore();\r\n\r\n\tconst { fitView, getViewport } = useSvelteFlow();\r\n\tconst nodesInitialized = useNodesInitialized();\r\n\r\n\texport let history;\r\n\r\n\tlet selectedMessageId = null;\r\n\r\n\tconst nodes = writable([]);\r\n\tconst edges = writable([]);\r\n\r\n\tconst nodeTypes = {\r\n\t\tcustom: CustomNode\r\n\t};\r\n\r\n\t$: if (history) {\r\n\t\tdrawFlow();\r\n\t}\r\n\r\n\t$: if (history && history.currentId) {\r\n\t\tfocusNode();\r\n\t\tselectedMessageId = null;\r\n\t}\r\n\r\n\tconst focusNode = async () => {\r\n\t\tif (selectedMessageId === null) {\r\n\t\t\tawait fitView({ nodes: [{ id: history.currentId }] });\r\n\t\t}\r\n\t};\r\n\r\n\tconst drawFlow = async () => {\r\n\t\tconst nodeList = [];\r\n\t\tconst edgeList = [];\r\n\t\tconst levelOffset = 150; // Vertical spacing between layers\r\n\t\tconst siblingOffset = 250; // Horizontal spacing between nodes at the same layer\r\n\r\n\t\t// Map to keep track of node positions at each level\r\n\t\tlet positionMap = new Map();\r\n\r\n\t\t// Helper function to truncate labels\r\n\t\tfunction createLabel(content) {\r\n\t\t\tconst maxLength = 100;\r\n\t\t\treturn content.length > maxLength ? content.substr(0, maxLength) + '...' : content;\r\n\t\t}\r\n\r\n\t\t// Create nodes and map children to ensure alignment in width\r\n\t\tlet layerWidths = {}; // Track widths of each layer\r\n\r\n\t\tObject.keys(history.messages).forEach((id) => {\r\n\t\t\tconst message = history.messages[id];\r\n\t\t\tconst level = message.parentId ? (positionMap.get(message.parentId)?.level ?? -1) + 1 : 0;\r\n\t\t\tif (!layerWidths[level]) layerWidths[level] = 0;\r\n\r\n\t\t\tpositionMap.set(id, {\r\n\t\t\t\tid: message.id,\r\n\t\t\t\tlevel,\r\n\t\t\t\tposition: layerWidths[level]++\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t// Adjust positions based on siblings count to centralize vertical spacing\r\n\t\tObject.keys(history.messages).forEach((id) => {\r\n\t\t\tconst pos = positionMap.get(id);\r\n\t\t\tconst xOffset = pos.position * siblingOffset;\r\n\t\t\tconst y = pos.level * levelOffset;\r\n\t\t\tconst x = xOffset;\r\n\r\n\t\t\tnodeList.push({\r\n\t\t\t\tid: pos.id,\r\n\t\t\t\ttype: 'custom',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tuser: $user,\r\n\t\t\t\t\tmessage: history.messages[id],\r\n\t\t\t\t\tmodel: $models.find((model) => model.id === history.messages[id].model)\r\n\t\t\t\t},\r\n\t\t\t\tposition: { x, y }\r\n\t\t\t});\r\n\r\n\t\t\t// Create edges\r\n\t\t\tconst parentId = history.messages[id].parentId;\r\n\t\t\tif (parentId) {\r\n\t\t\t\tedgeList.push({\r\n\t\t\t\t\tid: parentId + '-' + pos.id,\r\n\t\t\t\t\tsource: parentId,\r\n\t\t\t\t\ttarget: pos.id,\r\n\t\t\t\t\tselectable: false,\r\n\t\t\t\t\tclass: ' dark:fill-gray-300 fill-gray-300',\r\n\t\t\t\t\ttype: 'smoothstep',\r\n\t\t\t\t\tanimated: history.currentId === id || recurseCheckChild(id, history.currentId)\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tawait edges.set([...edgeList]);\r\n\t\tawait nodes.set([...nodeList]);\r\n\t};\r\n\r\n\tconst recurseCheckChild = (nodeId, currentId) => {\r\n\t\tconst node = history.messages[nodeId];\r\n\t\treturn (\r\n\t\t\tnode.childrenIds &&\r\n\t\t\tnode.childrenIds.some((id) => id === currentId || recurseCheckChild(id, currentId))\r\n\t\t);\r\n\t};\r\n\r\n\tonMount(() => {\r\n\t\tdrawFlow();\r\n\r\n\t\tnodesInitialized.subscribe(async (initialized) => {\r\n\t\t\tif (initialized) {\r\n\t\t\t\tawait tick();\r\n\t\t\t\tconst res = await fitView({ nodes: [{ id: history.currentId }] });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\twidth.subscribe((value) => {\r\n\t\t\tif (value) {\r\n\t\t\t\t// fitView();\r\n\t\t\t\tfitView({ nodes: [{ id: history.currentId }] });\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\theight.subscribe((value) => {\r\n\t\t\tif (value) {\r\n\t\t\t\t// fitView();\r\n\t\t\t\tfitView({ nodes: [{ id: history.currentId }] });\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\tconsole.log('Overview destroyed');\r\n\r\n\t\tnodes.set([]);\r\n\t\tedges.set([]);\r\n\t});\r\n</script>\r\n\r\n<div class=\"w-full h-full relative\">\r\n\t<div class=\" absolute z-50 w-full flex justify-between dark:text-gray-100 px-5 py-4\">\r\n\t\t<div class=\" text-lg font-medium self-center font-primary\">{$i18n.t('Chat Overview')}</div>\r\n\t\t<button\r\n\t\t\tclass=\"self-center\"\r\n\t\t\ton:click={() => {\r\n\t\t\t\tdispatch('close');\r\n\t\t\t\tshowOverview.set(false);\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t<XMark className=\"size-4\" />\r\n\t\t</button>\r\n\t</div>\r\n\r\n\t{#if $nodes.length > 0}\r\n\t\t<Flow\r\n\t\t\t{nodes}\r\n\t\t\t{nodeTypes}\r\n\t\t\t{edges}\r\n\t\t\ton:nodeclick={(e) => {\r\n\t\t\t\tconsole.log(e.detail.node.data);\r\n\t\t\t\tdispatch('nodeclick', e.detail);\r\n\t\t\t\tselectedMessageId = e.detail.node.data.message.id;\r\n\t\t\t\tfitView({ nodes: [{ id: selectedMessageId }] });\r\n\t\t\t}}\r\n\t\t/>\r\n\t{/if}\r\n</div>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '1.5';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { SvelteFlowProvider } from '@xyflow/svelte';\r\n\timport { slide } from 'svelte/transition';\r\n\r\n\timport { onDestroy, onMount } from 'svelte';\r\n\timport { mobile, showControls, showCallOverlay, showOverview } from '$lib/stores';\r\n\r\n\timport Modal from '../common/Modal.svelte';\r\n\timport Controls from './Controls/Controls.svelte';\r\n\timport CallOverlay from './MessageInput/CallOverlay.svelte';\r\n\timport Drawer from '../common/Drawer.svelte';\r\n\timport Overview from './Overview.svelte';\r\n\timport { Pane, PaneResizer } from 'paneforge';\r\n\timport EllipsisVertical from '../icons/EllipsisVertical.svelte';\r\n\timport { get } from 'svelte/store';\r\n\r\n\texport let history;\r\n\texport let models = [];\r\n\r\n\texport let chatId = null;\r\n\texport let chatFiles = [];\r\n\texport let params = {};\r\n\r\n\texport let eventTarget: EventTarget;\r\n\texport let submitPrompt: Function;\r\n\texport let stopResponse: Function;\r\n\texport let showMessage: Function;\r\n\texport let files;\r\n\texport let modelId;\r\n\r\n\texport let pane;\r\n\tlet largeScreen = false;\r\n\r\n\tonMount(() => {\r\n\t\t// listen to resize 1024px\r\n\t\tconst mediaQuery = window.matchMedia('(min-width: 1024px)');\r\n\r\n\t\tconst handleMediaQuery = (e) => {\r\n\t\t\tif (e.matches) {\r\n\t\t\t\tlargeScreen = true;\r\n\t\t\t} else {\r\n\t\t\t\tlargeScreen = false;\r\n\t\t\t\tpane = null;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tmediaQuery.addEventListener('change', handleMediaQuery);\r\n\r\n\t\thandleMediaQuery(mediaQuery);\r\n\r\n\t\treturn () => {\r\n\t\t\tmediaQuery.removeEventListener('change', handleMediaQuery);\r\n\t\t};\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\tshowControls.set(false);\r\n\t});\r\n\r\n\t$: if (!chatId) {\r\n\t\tshowOverview.set(false);\r\n\t}\r\n</script>\r\n\r\n<SvelteFlowProvider>\r\n\t{#if !largeScreen}\r\n\t\t{#if $showControls}\r\n\t\t\t<Drawer\r\n\t\t\t\tshow={$showControls}\r\n\t\t\t\ton:close={() => {\r\n\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<div\r\n\t\t\t\t\tclass=\" {$showCallOverlay || $showOverview ? ' h-screen  w-screen' : 'px-6 py-4'} h-full\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{#if $showCallOverlay}\r\n\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\tclass=\" h-full max-h-[100dvh] bg-white text-gray-700 dark:bg-black dark:text-gray-300 flex justify-center\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<CallOverlay\r\n\t\t\t\t\t\t\t\tbind:files\r\n\t\t\t\t\t\t\t\t{submitPrompt}\r\n\t\t\t\t\t\t\t\t{stopResponse}\r\n\t\t\t\t\t\t\t\t{modelId}\r\n\t\t\t\t\t\t\t\t{chatId}\r\n\t\t\t\t\t\t\t\t{eventTarget}\r\n\t\t\t\t\t\t\t\ton:close={() => {\r\n\t\t\t\t\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t{:else if $showOverview}\r\n\t\t\t\t\t\t<Overview\r\n\t\t\t\t\t\t\t{history}\r\n\t\t\t\t\t\t\ton:nodeclick={(e) => {\r\n\t\t\t\t\t\t\t\tshowMessage(e.detail.node.data.message);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\ton:close={() => {\r\n\t\t\t\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t<Controls\r\n\t\t\t\t\t\t\ton:close={() => {\r\n\t\t\t\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t{models}\r\n\t\t\t\t\t\t\tbind:chatFiles\r\n\t\t\t\t\t\t\tbind:params\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</Drawer>\r\n\t\t{/if}\r\n\t{:else}\r\n\t\t<!-- if $showControls -->\r\n\t\t<PaneResizer class=\"relative flex w-2 items-center justify-center bg-background group\">\r\n\t\t\t<div class=\"z-10 flex h-7 w-5 items-center justify-center rounded-sm\">\r\n\t\t\t\t<EllipsisVertical className=\"size-4 invisible group-hover:visible\" />\r\n\t\t\t</div>\r\n\t\t</PaneResizer>\r\n\t\t<Pane\r\n\t\t\tbind:pane\r\n\t\t\tdefaultSize={$showControls\r\n\t\t\t\t? parseInt(localStorage?.chatControlsSize ?? '30')\r\n\t\t\t\t\t? parseInt(localStorage?.chatControlsSize ?? '30')\r\n\t\t\t\t\t: 30\r\n\t\t\t\t: 0}\r\n\t\t\tonResize={(size) => {\r\n\t\t\t\tif (size === 0) {\r\n\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!$showControls) {\r\n\t\t\t\t\t\tshowControls.set(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlocalStorage.chatControlsSize = size;\r\n\t\t\t\t}\r\n\t\t\t}}\r\n\t\t>\r\n\t\t\t{#if $showControls}\r\n\t\t\t\t<div class=\"pr-4 pb-8 flex max-h-full min-h-full\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\"w-full {$showOverview && !$showCallOverlay\r\n\t\t\t\t\t\t\t? ' '\r\n\t\t\t\t\t\t\t: 'px-5 py-4 bg-white dark:shadow-lg dark:bg-gray-850  border border-gray-50 dark:border-gray-800'}  rounded-lg z-50 pointer-events-auto overflow-y-auto scrollbar-hidden\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{#if $showCallOverlay}\r\n\t\t\t\t\t\t\t<div class=\"w-full h-full flex justify-center\">\r\n\t\t\t\t\t\t\t\t<CallOverlay\r\n\t\t\t\t\t\t\t\t\tbind:files\r\n\t\t\t\t\t\t\t\t\t{submitPrompt}\r\n\t\t\t\t\t\t\t\t\t{stopResponse}\r\n\t\t\t\t\t\t\t\t\t{modelId}\r\n\t\t\t\t\t\t\t\t\t{chatId}\r\n\t\t\t\t\t\t\t\t\t{eventTarget}\r\n\t\t\t\t\t\t\t\t\ton:close={() => {\r\n\t\t\t\t\t\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{:else if $showOverview}\r\n\t\t\t\t\t\t\t<Overview\r\n\t\t\t\t\t\t\t\t{history}\r\n\t\t\t\t\t\t\t\ton:nodeclick={(e) => {\r\n\t\t\t\t\t\t\t\t\tif (e.detail.node.data.message.favorite) {\r\n\t\t\t\t\t\t\t\t\t\thistory.messages[e.detail.node.data.message.id].favorite = true;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\thistory.messages[e.detail.node.data.message.id].favorite = null;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tshowMessage(e.detail.node.data.message);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\ton:close={() => {\r\n\t\t\t\t\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{:else}\r\n\t\t\t\t\t\t\t<Controls\r\n\t\t\t\t\t\t\t\ton:close={() => {\r\n\t\t\t\t\t\t\t\t\tshowControls.set(false);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t{models}\r\n\t\t\t\t\t\t\t\tbind:chatFiles\r\n\t\t\t\t\t\t\t\tbind:params\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\t\t</Pane>\r\n\t{/if}\r\n</SvelteFlowProvider>\r\n","<script lang=\"ts\">\r\n\timport { v4 as uuidv4 } from 'uuid';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport mermaid from 'mermaid';\r\n\timport { PaneGroup, Pane, PaneResizer } from 'paneforge';\r\n\r\n\timport { getContext, onDestroy, onMount, tick } from 'svelte';\r\n\tconst i18n: Writable<i18nType> = getContext('i18n');\r\n\r\n\timport { goto } from '$app/navigation';\r\n\timport { page } from '$app/stores';\r\n\r\n\timport type { Unsubscriber, Writable } from 'svelte/store';\r\n\timport type { i18n as i18nType } from 'i18next';\r\n\timport { WEBUI_BASE_URL } from '$lib/constants';\r\n\r\n\timport {\r\n\t\tchatId,\r\n\t\tchats,\r\n\t\tconfig,\r\n\t\ttype Model,\r\n\t\tmodels,\r\n\t\tsettings,\r\n\t\tshowSidebar,\r\n\t\tWEBUI_NAME,\r\n\t\tbanners,\r\n\t\tuser,\r\n\t\tsocket,\r\n\t\tshowControls,\r\n\t\tshowCallOverlay,\r\n\t\tcurrentChatPage,\r\n\t\ttemporaryChatEnabled,\r\n\t\tmobile,\r\n\t\tshowOverview,\r\n\t\tchatTitle\r\n\t} from '$lib/stores';\r\n\timport {\r\n\t\tconvertMessagesToHistory,\r\n\t\tcopyToClipboard,\r\n\t\tgetMessageContentParts,\r\n\t\textractSentencesForAudio,\r\n\t\tpromptTemplate,\r\n\t\tsplitStream\r\n\t} from '$lib/utils';\r\n\r\n\timport { generateChatCompletion } from '$lib/apis/ollama';\r\n\timport {\r\n\t\tcreateNewChat,\r\n\t\tgetChatById,\r\n\t\tgetChatList,\r\n\t\tgetTagsById,\r\n\t\tupdateChatById\r\n\t} from '$lib/apis/chats';\r\n\timport { generateOpenAIChatCompletion } from '$lib/apis/openai';\r\n\timport { runWebSearch } from '$lib/apis/rag';\r\n\timport { createOpenAITextStream } from '$lib/apis/streaming';\r\n\timport { queryMemory } from '$lib/apis/memories';\r\n\timport { getAndUpdateUserLocation, getUserSettings } from '$lib/apis/users';\r\n\timport {\r\n\t\tchatCompleted,\r\n\t\tgenerateTitle,\r\n\t\tgenerateSearchQuery,\r\n\t\tchatAction,\r\n\t\tgenerateMoACompletion\r\n\t} from '$lib/apis';\r\n\r\n\timport Banner from '../common/Banner.svelte';\r\n\timport MessageInput from '$lib/components/chat/MessageInput.svelte';\r\n\timport Messages from '$lib/components/chat/Messages.svelte';\r\n\timport Navbar from '$lib/components/layout/Navbar.svelte';\r\n\timport ChatControls from './ChatControls.svelte';\r\n\timport EventConfirmDialog from '../common/ConfirmDialog.svelte';\r\n\r\n\texport let chatIdProp = '';\r\n\r\n\tlet loaded = false;\r\n\tconst eventTarget = new EventTarget();\r\n\tlet controlPane;\r\n\r\n\tlet stopResponseFlag = false;\r\n\tlet autoScroll = true;\r\n\tlet processing = '';\r\n\tlet messagesContainerElement: HTMLDivElement;\r\n\r\n\tlet showEventConfirmation = false;\r\n\tlet eventConfirmationTitle = '';\r\n\tlet eventConfirmationMessage = '';\r\n\tlet eventConfirmationInput = false;\r\n\tlet eventConfirmationInputPlaceholder = '';\r\n\tlet eventConfirmationInputValue = '';\r\n\tlet eventCallback = null;\r\n\r\n\tlet chatIdUnsubscriber: Unsubscriber | undefined;\r\n\r\n\tlet selectedModels = [''];\r\n\tlet atSelectedModel: Model | undefined;\r\n\tlet selectedModelIds = [];\r\n\t$: selectedModelIds = atSelectedModel !== undefined ? [atSelectedModel.id] : selectedModels;\r\n\r\n\tlet selectedToolIds = [];\r\n\tlet webSearchEnabled = false;\r\n\r\n\tlet chat = null;\r\n\tlet tags = [];\r\n\r\n\tlet history = {\r\n\t\tmessages: {},\r\n\t\tcurrentId: null\r\n\t};\r\n\r\n\t// Chat Input\r\n\tlet prompt = '';\r\n\tlet chatFiles = [];\r\n\tlet files = [];\r\n\tlet params = {};\r\n\r\n\t$: if (chatIdProp) {\r\n\t\t(async () => {\r\n\t\t\tconsole.log(chatIdProp);\r\n\t\t\tif (chatIdProp && (await loadChat())) {\r\n\t\t\t\tawait tick();\r\n\t\t\t\tloaded = true;\r\n\r\n\t\t\t\twindow.setTimeout(() => scrollToBottom(), 0);\r\n\t\t\t\tconst chatInput = document.getElementById('chat-textarea');\r\n\t\t\t\tchatInput?.focus();\r\n\t\t\t} else {\r\n\t\t\t\tawait goto('/');\r\n\t\t\t}\r\n\t\t})();\r\n\t}\r\n\r\n\tconst showMessage = async (message) => {\r\n\t\tconst _chatId = JSON.parse(JSON.stringify($chatId));\r\n\t\tlet _messageId = JSON.parse(JSON.stringify(message.id));\r\n\r\n\t\tlet messageChildrenIds = history.messages[_messageId].childrenIds;\r\n\r\n\t\twhile (messageChildrenIds.length !== 0) {\r\n\t\t\t_messageId = messageChildrenIds.at(-1);\r\n\t\t\tmessageChildrenIds = history.messages[_messageId].childrenIds;\r\n\t\t}\r\n\r\n\t\thistory.currentId = _messageId;\r\n\r\n\t\tawait tick();\r\n\t\tawait tick();\r\n\t\tawait tick();\r\n\r\n\t\tconst messageElement = document.getElementById(`message-${message.id}`);\r\n\t\tif (messageElement) {\r\n\t\t\tmessageElement.scrollIntoView({ behavior: 'smooth' });\r\n\t\t}\r\n\r\n\t\tawait tick();\r\n\t\tsaveChatHandler(_chatId);\r\n\t};\r\n\r\n\tconst chatEventHandler = async (event, cb) => {\r\n\t\tif (event.chat_id === $chatId) {\r\n\t\t\tawait tick();\r\n\t\t\tconsole.log(event);\r\n\t\t\tlet message = history.messages[event.message_id];\r\n\r\n\t\t\tconst type = event?.data?.type ?? null;\r\n\t\t\tconst data = event?.data?.data ?? null;\r\n\r\n\t\t\tif (type === 'status') {\r\n\t\t\t\tif (message?.statusHistory) {\r\n\t\t\t\t\tmessage.statusHistory.push(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessage.statusHistory = [data];\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'citation') {\r\n\t\t\t\tif (message?.citations) {\r\n\t\t\t\t\tmessage.citations.push(data);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmessage.citations = [data];\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'message') {\r\n\t\t\t\tmessage.content += data.content;\r\n\t\t\t} else if (type === 'replace') {\r\n\t\t\t\tmessage.content = data.content;\r\n\t\t\t} else if (type === 'action') {\r\n\t\t\t\tif (data.action === 'continue') {\r\n\t\t\t\t\tconst continueButton = document.getElementById('continue-response-button');\r\n\r\n\t\t\t\t\tif (continueButton) {\r\n\t\t\t\t\t\tcontinueButton.click();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'confirmation') {\r\n\t\t\t\teventCallback = cb;\r\n\r\n\t\t\t\teventConfirmationInput = false;\r\n\t\t\t\tshowEventConfirmation = true;\r\n\r\n\t\t\t\teventConfirmationTitle = data.title;\r\n\t\t\t\teventConfirmationMessage = data.message;\r\n\t\t\t} else if (type === 'input') {\r\n\t\t\t\teventCallback = cb;\r\n\r\n\t\t\t\teventConfirmationInput = true;\r\n\t\t\t\tshowEventConfirmation = true;\r\n\r\n\t\t\t\teventConfirmationTitle = data.title;\r\n\t\t\t\teventConfirmationMessage = data.message;\r\n\t\t\t\teventConfirmationInputPlaceholder = data.placeholder;\r\n\t\t\t\teventConfirmationInputValue = data?.value ?? '';\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log('Unknown message type', data);\r\n\t\t\t}\r\n\r\n\t\t\thistory.messages[event.message_id] = message;\r\n\t\t}\r\n\t};\r\n\r\n\tconst onMessageHandler = async (event: {\r\n\t\torigin: string;\r\n\t\tdata: { type: string; text: string };\r\n\t}) => {\r\n\t\tif (event.origin !== window.origin) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Replace with your iframe's origin\r\n\t\tif (event.data.type === 'input:prompt') {\r\n\t\t\tconsole.debug(event.data.text);\r\n\r\n\t\t\tconst inputElement = document.getElementById('chat-textarea');\r\n\r\n\t\t\tif (inputElement) {\r\n\t\t\t\tprompt = event.data.text;\r\n\t\t\t\tinputElement.focus();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (event.data.type === 'action:submit') {\r\n\t\t\tconsole.debug(event.data.text);\r\n\r\n\t\t\tif (prompt !== '') {\r\n\t\t\t\tawait tick();\r\n\t\t\t\tsubmitPrompt(prompt);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (event.data.type === 'input:prompt:submit') {\r\n\t\t\tconsole.debug(event.data.text);\r\n\r\n\t\t\tif (prompt !== '') {\r\n\t\t\t\tawait tick();\r\n\t\t\t\tsubmitPrompt(event.data.text);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\twindow.addEventListener('message', onMessageHandler);\r\n\t\t$socket?.on('chat-events', chatEventHandler);\r\n\r\n\t\tif (!$chatId) {\r\n\t\t\tchatIdUnsubscriber = chatId.subscribe(async (value) => {\r\n\t\t\t\tif (!value) {\r\n\t\t\t\t\tawait initNewChat();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif ($temporaryChatEnabled) {\r\n\t\t\t\tawait goto('/');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tshowControls.subscribe(async (value) => {\r\n\t\t\tif (controlPane && !$mobile) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\tconst currentSize = controlPane.getSize();\r\n\r\n\t\t\t\t\t\tif (currentSize === 0) {\r\n\t\t\t\t\t\t\tconst size = parseInt(localStorage?.chatControlsSize ?? '30');\r\n\t\t\t\t\t\t\tcontrolPane.resize(size ? size : 30);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcontrolPane.resize(0);\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\t// ignore\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!value) {\r\n\t\t\t\tshowCallOverlay.set(false);\r\n\t\t\t\tshowOverview.set(false);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst chatInput = document.getElementById('chat-textarea');\r\n\t\tchatInput?.focus();\r\n\r\n\t\tchats.subscribe(() => {});\r\n\t});\r\n\r\n\tonDestroy(() => {\r\n\t\tchatIdUnsubscriber?.();\r\n\t\twindow.removeEventListener('message', onMessageHandler);\r\n\t\t$socket?.off('chat-events');\r\n\t});\r\n\r\n\t//////////////////////////\r\n\t// Web functions\r\n\t//////////////////////////\r\n\r\n\tconst initNewChat = async () => {\r\n\t\tif ($page.url.pathname.includes('/c/')) {\r\n\t\t\twindow.history.replaceState(history.state, '', `/`);\r\n\t\t}\r\n\r\n\t\tautoScroll = true;\r\n\r\n\t\tawait chatId.set('');\r\n\t\tawait chatTitle.set('');\r\n\r\n\t\thistory = {\r\n\t\t\tmessages: {},\r\n\t\t\tcurrentId: null\r\n\t\t};\r\n\r\n\t\tchatFiles = [];\r\n\t\tparams = {};\r\n\r\n\t\tif ($page.url.searchParams.get('models')) {\r\n\t\t\tselectedModels = $page.url.searchParams.get('models')?.split(',');\r\n\t\t} else if ($page.url.searchParams.get('model')) {\r\n\t\t\tselectedModels = $page.url.searchParams.get('model')?.split(',');\r\n\t\t} else if ($settings?.models) {\r\n\t\t\tselectedModels = $settings?.models;\r\n\t\t} else if ($config?.default_models) {\r\n\t\t\tconsole.log($config?.default_models.split(',') ?? '');\r\n\t\t\tselectedModels = $config?.default_models.split(',');\r\n\t\t} else {\r\n\t\t\tselectedModels = [''];\r\n\t\t}\r\n\r\n\t\tif ($page.url.searchParams.get('web-search') === 'true') {\r\n\t\t\twebSearchEnabled = true;\r\n\t\t}\r\n\r\n\t\tif ($page.url.searchParams.get('q')) {\r\n\t\t\tprompt = $page.url.searchParams.get('q') ?? '';\r\n\t\t\tselectedToolIds = ($page.url.searchParams.get('tool_ids') ?? '')\r\n\t\t\t\t.split(',')\r\n\t\t\t\t.map((id) => id.trim())\r\n\t\t\t\t.filter((id) => id);\r\n\r\n\t\t\tif (prompt) {\r\n\t\t\t\tawait tick();\r\n\t\t\t\tsubmitPrompt(prompt);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ($page.url.searchParams.get('call') === 'true') {\r\n\t\t\tshowCallOverlay.set(true);\r\n\t\t\tshowControls.set(true);\r\n\t\t}\r\n\r\n\t\tselectedModels = selectedModels.map((modelId) =>\r\n\t\t\t$models.map((m) => m.id).includes(modelId) ? modelId : ''\r\n\t\t);\r\n\r\n\t\tconst userSettings = await getUserSettings(localStorage.token);\r\n\r\n\t\tif (userSettings) {\r\n\t\t\tsettings.set(userSettings.ui);\r\n\t\t} else {\r\n\t\t\tsettings.set(JSON.parse(localStorage.getItem('settings') ?? '{}'));\r\n\t\t}\r\n\r\n\t\tconst chatInput = document.getElementById('chat-textarea');\r\n\t\tsetTimeout(() => chatInput?.focus(), 0);\r\n\t};\r\n\r\n\tconst loadChat = async () => {\r\n\t\tchatId.set(chatIdProp);\r\n\t\tchat = await getChatById(localStorage.token, $chatId).catch(async (error) => {\r\n\t\t\tawait goto('/');\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (chat) {\r\n\t\t\ttags = await getTags();\r\n\t\t\tconst chatContent = chat.chat;\r\n\r\n\t\t\tif (chatContent) {\r\n\t\t\t\tconsole.log(chatContent);\r\n\r\n\t\t\t\tselectedModels =\r\n\t\t\t\t\t(chatContent?.models ?? undefined) !== undefined\r\n\t\t\t\t\t\t? chatContent.models\r\n\t\t\t\t\t\t: [chatContent.models ?? ''];\r\n\t\t\t\thistory =\r\n\t\t\t\t\t(chatContent?.history ?? undefined) !== undefined\r\n\t\t\t\t\t\t? chatContent.history\r\n\t\t\t\t\t\t: convertMessagesToHistory(chatContent.messages);\r\n\r\n\t\t\t\tchatTitle.set(chatContent.title);\r\n\r\n\t\t\t\tconst userSettings = await getUserSettings(localStorage.token);\r\n\r\n\t\t\t\tif (userSettings) {\r\n\t\t\t\t\tawait settings.set(userSettings.ui);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tawait settings.set(JSON.parse(localStorage.getItem('settings') ?? '{}'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tparams = chatContent?.params ?? {};\r\n\t\t\t\tchatFiles = chatContent?.files ?? [];\r\n\r\n\t\t\t\tautoScroll = true;\r\n\t\t\t\tawait tick();\r\n\r\n\t\t\t\tif (history.currentId) {\r\n\t\t\t\t\thistory.messages[history.currentId].done = true;\r\n\t\t\t\t}\r\n\t\t\t\tawait tick();\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst scrollToBottom = async () => {\r\n\t\tawait tick();\r\n\t\tif (messagesContainerElement) {\r\n\t\t\tmessagesContainerElement.scrollTop = messagesContainerElement.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\tconst createMessagesList = (responseMessageId) => {\r\n\t\tif (responseMessageId === null) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst message = history.messages[responseMessageId];\r\n\t\tif (message?.parentId) {\r\n\t\t\treturn [...createMessagesList(message.parentId), message];\r\n\t\t} else {\r\n\t\t\treturn [message];\r\n\t\t}\r\n\t};\r\n\r\n\tconst chatCompletedHandler = async (chatId, modelId, responseMessageId, messages) => {\r\n\t\tawait mermaid.run({\r\n\t\t\tquerySelector: '.mermaid'\r\n\t\t});\r\n\r\n\t\tconst res = await chatCompleted(localStorage.token, {\r\n\t\t\tmodel: modelId,\r\n\t\t\tmessages: messages.map((m) => ({\r\n\t\t\t\tid: m.id,\r\n\t\t\t\trole: m.role,\r\n\t\t\t\tcontent: m.content,\r\n\t\t\t\tinfo: m.info ? m.info : undefined,\r\n\t\t\t\ttimestamp: m.timestamp\r\n\t\t\t})),\r\n\t\t\tchat_id: chatId,\r\n\t\t\tsession_id: $socket?.id,\r\n\t\t\tid: responseMessageId\r\n\t\t}).catch((error) => {\r\n\t\t\ttoast.error(error);\r\n\t\t\tmessages.at(-1).error = { content: error };\r\n\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (res !== null) {\r\n\t\t\t// Update chat history with the new messages\r\n\t\t\tfor (const message of res.messages) {\r\n\t\t\t\thistory.messages[message.id] = {\r\n\t\t\t\t\t...history.messages[message.id],\r\n\t\t\t\t\t...(history.messages[message.id].content !== message.content\r\n\t\t\t\t\t\t? { originalContent: history.messages[message.id].content }\r\n\t\t\t\t\t\t: {}),\r\n\t\t\t\t\t...message\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tawait tick();\r\n\r\n\t\tif ($chatId == chatId) {\r\n\t\t\tif (!$temporaryChatEnabled) {\r\n\t\t\t\tchat = await updateChatById(localStorage.token, chatId, {\r\n\t\t\t\t\tmodels: selectedModels,\r\n\t\t\t\t\tmessages: messages,\r\n\t\t\t\t\thistory: history,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t\tfiles: chatFiles\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcurrentChatPage.set(1);\r\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst chatActionHandler = async (chatId, actionId, modelId, responseMessageId, event = null) => {\r\n\t\tconst messages = createMessagesList(responseMessageId);\r\n\r\n\t\tconst res = await chatAction(localStorage.token, actionId, {\r\n\t\t\tmodel: modelId,\r\n\t\t\tmessages: messages.map((m) => ({\r\n\t\t\t\tid: m.id,\r\n\t\t\t\trole: m.role,\r\n\t\t\t\tcontent: m.content,\r\n\t\t\t\tinfo: m.info ? m.info : undefined,\r\n\t\t\t\ttimestamp: m.timestamp\r\n\t\t\t})),\r\n\t\t\t...(event ? { event: event } : {}),\r\n\t\t\tchat_id: chatId,\r\n\t\t\tsession_id: $socket?.id,\r\n\t\t\tid: responseMessageId\r\n\t\t}).catch((error) => {\r\n\t\t\ttoast.error(error);\r\n\t\t\tmessages.at(-1).error = { content: error };\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (res !== null) {\r\n\t\t\t// Update chat history with the new messages\r\n\t\t\tfor (const message of res.messages) {\r\n\t\t\t\thistory.messages[message.id] = {\r\n\t\t\t\t\t...history.messages[message.id],\r\n\t\t\t\t\t...(history.messages[message.id].content !== message.content\r\n\t\t\t\t\t\t? { originalContent: history.messages[message.id].content }\r\n\t\t\t\t\t\t: {}),\r\n\t\t\t\t\t...message\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ($chatId == chatId) {\r\n\t\t\tif (!$temporaryChatEnabled) {\r\n\t\t\t\tchat = await updateChatById(localStorage.token, chatId, {\r\n\t\t\t\t\tmodels: selectedModels,\r\n\t\t\t\t\tmessages: messages,\r\n\t\t\t\t\thistory: history,\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t\tfiles: chatFiles\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcurrentChatPage.set(1);\r\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst getChatEventEmitter = async (modelId: string, chatId: string = '') => {\r\n\t\treturn setInterval(() => {\r\n\t\t\t$socket?.emit('usage', {\r\n\t\t\t\taction: 'chat',\r\n\t\t\t\tmodel: modelId,\r\n\t\t\t\tchat_id: chatId\r\n\t\t\t});\r\n\t\t}, 1000);\r\n\t};\r\n\r\n\tconst createMessagePair = async (userPrompt) => {\r\n\t\tprompt = '';\r\n\t\tif (selectedModels.length === 0) {\r\n\t\t\ttoast.error($i18n.t('Model not selected'));\r\n\t\t} else {\r\n\t\t\tconst modelId = selectedModels[0];\r\n\t\t\tconst model = $models.filter((m) => m.id === modelId).at(0);\r\n\r\n\t\t\tconst messages = createMessagesList(history.currentId);\r\n\t\t\tconst parentMessage = messages.length !== 0 ? messages.at(-1) : null;\r\n\r\n\t\t\tconst userMessageId = uuidv4();\r\n\t\t\tconst responseMessageId = uuidv4();\r\n\r\n\t\t\tconst userMessage = {\r\n\t\t\t\tid: userMessageId,\r\n\t\t\t\tparentId: parentMessage ? parentMessage.id : null,\r\n\t\t\t\tchildrenIds: [responseMessageId],\r\n\t\t\t\trole: 'user',\r\n\t\t\t\tcontent: userPrompt ? userPrompt : `[PROMPT] ${userMessageId}`,\r\n\t\t\t\ttimestamp: Math.floor(Date.now() / 1000)\r\n\t\t\t};\r\n\r\n\t\t\tconst responseMessage = {\r\n\t\t\t\tid: responseMessageId,\r\n\t\t\t\tparentId: userMessageId,\r\n\t\t\t\tchildrenIds: [],\r\n\t\t\t\trole: 'assistant',\r\n\t\t\t\tcontent: `[RESPONSE] ${responseMessageId}`,\r\n\t\t\t\tdone: true,\r\n\r\n\t\t\t\tmodel: modelId,\r\n\t\t\t\tmodelName: model.name ?? model.id,\r\n\t\t\t\tmodelIdx: 0,\r\n\t\t\t\ttimestamp: Math.floor(Date.now() / 1000)\r\n\t\t\t};\r\n\r\n\t\t\tif (parentMessage) {\r\n\t\t\t\tparentMessage.childrenIds.push(userMessageId);\r\n\t\t\t\thistory.messages[parentMessage.id] = parentMessage;\r\n\t\t\t}\r\n\t\t\thistory.messages[userMessageId] = userMessage;\r\n\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\t\thistory.currentId = responseMessageId;\r\n\r\n\t\t\tawait tick();\r\n\r\n\t\t\tif (autoScroll) {\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}\r\n\r\n\t\t\tif (messages.length === 0) {\r\n\t\t\t\tawait initChatHandler();\r\n\t\t\t} else {\r\n\t\t\t\tawait saveChatHandler($chatId);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t//////////////////////////\r\n\t// Chat functions\r\n\t//////////////////////////\r\n\r\n\tconst submitPrompt = async (userPrompt, { _raw = false } = {}) => {\r\n\t\tlet _responses = [];\r\n\t\tconsole.log('submitPrompt', $chatId);\r\n\t\tconst messages = createMessagesList(history.currentId);\r\n\r\n\t\tselectedModels = selectedModels.map((modelId) =>\r\n\t\t\t$models.map((m) => m.id).includes(modelId) ? modelId : ''\r\n\t\t);\r\n\r\n\t\tif (selectedModels.includes('')) {\r\n\t\t\ttoast.error($i18n.t('Model not selected'));\r\n\t\t} else if (messages.length != 0 && messages.at(-1).done != true) {\r\n\t\t\t// Response not done\r\n\t\t\tconsole.log('wait');\r\n\t\t} else if (messages.length != 0 && messages.at(-1).error) {\r\n\t\t\t// Error in response\r\n\t\t\ttoast.error(\r\n\t\t\t\t$i18n.t(\r\n\t\t\t\t\t`Oops! There was an error in the previous response. Please try again or contact admin.`\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t} else if (\r\n\t\t\tfiles.length > 0 &&\r\n\t\t\tfiles.filter((file) => file.type !== 'image' && file.status !== 'processed').length > 0\r\n\t\t) {\r\n\t\t\t// Upload not done\r\n\t\t\ttoast.error(\r\n\t\t\t\t$i18n.t(\r\n\t\t\t\t\t`Oops! Hold tight! Your files are still in the processing oven. We're cooking them up to perfection. Please be patient and we'll let you know once they're ready.`\r\n\t\t\t\t)\r\n\t\t\t);\r\n\t\t} else if (\r\n\t\t\t($config?.file?.max_count ?? null) !== null &&\r\n\t\t\tfiles.length + chatFiles.length > $config?.file?.max_count\r\n\t\t) {\r\n\t\t\tconsole.log(chatFiles.length, files.length);\r\n\t\t\ttoast.error(\r\n\t\t\t\t$i18n.t(`You can only chat with a maximum of {{maxCount}} file(s) at a time.`, {\r\n\t\t\t\t\tmaxCount: $config?.file?.max_count\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t} else {\r\n\t\t\t// Reset chat input textarea\r\n\t\t\tconst chatTextAreaElement = document.getElementById('chat-textarea');\r\n\r\n\t\t\tif (chatTextAreaElement) {\r\n\t\t\t\tchatTextAreaElement.value = '';\r\n\t\t\t\tchatTextAreaElement.style.height = '';\r\n\t\t\t}\r\n\r\n\t\t\tconst _files = JSON.parse(JSON.stringify(files));\r\n\t\t\tchatFiles.push(..._files.filter((item) => ['doc', 'file', 'collection'].includes(item.type)));\r\n\t\t\tchatFiles = chatFiles.filter(\r\n\t\t\t\t// Remove duplicates\r\n\t\t\t\t(item, index, array) =>\r\n\t\t\t\t\tarray.findIndex((i) => JSON.stringify(i) === JSON.stringify(item)) === index\r\n\t\t\t);\r\n\r\n\t\t\tfiles = [];\r\n\r\n\t\t\tprompt = '';\r\n\r\n\t\t\t// Create user message\r\n\t\t\tlet userMessageId = uuidv4();\r\n\t\t\tlet userMessage = {\r\n\t\t\t\tid: userMessageId,\r\n\t\t\t\tparentId: messages.length !== 0 ? messages.at(-1).id : null,\r\n\t\t\t\tchildrenIds: [],\r\n\t\t\t\trole: 'user',\r\n\t\t\t\tcontent: userPrompt,\r\n\t\t\t\tfiles: _files.length > 0 ? _files : undefined,\r\n\t\t\t\ttimestamp: Math.floor(Date.now() / 1000), // Unix epoch\r\n\t\t\t\tmodels: selectedModels\r\n\t\t\t};\r\n\r\n\t\t\t// Add message to history and Set currentId to messageId\r\n\t\t\thistory.messages[userMessageId] = userMessage;\r\n\t\t\thistory.currentId = userMessageId;\r\n\r\n\t\t\t// Append messageId to childrenIds of parent message\r\n\t\t\tif (messages.length !== 0) {\r\n\t\t\t\thistory.messages[messages.at(-1).id].childrenIds.push(userMessageId);\r\n\t\t\t}\r\n\r\n\t\t\t// Wait until history/message have been updated\r\n\t\t\tawait tick();\r\n\t\t\t_responses = await sendPrompt(userPrompt, userMessageId, { newChat: true });\r\n\t\t}\r\n\r\n\t\treturn _responses;\r\n\t};\r\n\r\n\tconst sendPrompt = async (\r\n\t\tprompt: string,\r\n\t\tparentId: string,\r\n\t\t{ modelId = null, modelIdx = null, newChat = false } = {}\r\n\t) => {\r\n\t\t// Create new chat if newChat is true and first user message\r\n\t\tif (\r\n\t\t\tnewChat &&\r\n\t\t\thistory.messages[history.currentId].parentId === null &&\r\n\t\t\thistory.messages[history.currentId].role === 'user'\r\n\t\t) {\r\n\t\t\tawait initChatHandler();\r\n\t\t}\r\n\r\n\t\tlet _responses: string[] = [];\r\n\t\t// If modelId is provided, use it, else use selected model\r\n\t\tlet selectedModelIds = modelId\r\n\t\t\t? [modelId]\r\n\t\t\t: atSelectedModel !== undefined\r\n\t\t\t\t? [atSelectedModel.id]\r\n\t\t\t\t: selectedModels;\r\n\r\n\t\t// Create response messages for each selected model\r\n\t\tconst responseMessageIds: Record<PropertyKey, string> = {};\r\n\t\tfor (const [_modelIdx, modelId] of selectedModelIds.entries()) {\r\n\t\t\tconst model = $models.filter((m) => m.id === modelId).at(0);\r\n\r\n\t\t\tif (model) {\r\n\t\t\t\tlet responseMessageId = uuidv4();\r\n\t\t\t\tlet responseMessage = {\r\n\t\t\t\t\tparentId: parentId,\r\n\t\t\t\t\tid: responseMessageId,\r\n\t\t\t\t\tchildrenIds: [],\r\n\t\t\t\t\trole: 'assistant',\r\n\t\t\t\t\tcontent: '',\r\n\t\t\t\t\tmodel: model.id,\r\n\t\t\t\t\tmodelName: model.name ?? model.id,\r\n\t\t\t\t\tmodelIdx: modelIdx ? modelIdx : _modelIdx,\r\n\t\t\t\t\tuserContext: null,\r\n\t\t\t\t\ttimestamp: Math.floor(Date.now() / 1000) // Unix epoch\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Add message to history and Set currentId to messageId\r\n\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t\t\thistory.currentId = responseMessageId;\r\n\r\n\t\t\t\t// Append messageId to childrenIds of parent message\r\n\t\t\t\tif (parentId !== null) {\r\n\t\t\t\t\thistory.messages[parentId].childrenIds = [\r\n\t\t\t\t\t\t...history.messages[parentId].childrenIds,\r\n\t\t\t\t\t\tresponseMessageId\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresponseMessageIds[`${modelId}-${modelIdx ? modelIdx : _modelIdx}`] = responseMessageId;\r\n\t\t\t}\r\n\t\t}\r\n\t\tawait tick();\r\n\r\n\t\tconst _chatId = JSON.parse(JSON.stringify($chatId));\r\n\t\tawait Promise.all(\r\n\t\t\tselectedModelIds.map(async (modelId, _modelIdx) => {\r\n\t\t\t\tconsole.log('modelId', modelId);\r\n\t\t\t\tconst model = $models.filter((m) => m.id === modelId).at(0);\r\n\r\n\t\t\t\tif (model) {\r\n\t\t\t\t\tconst messages = createMessagesList(parentId);\r\n\t\t\t\t\t// If there are image files, check if model is vision capable\r\n\t\t\t\t\tconst hasImages = messages.some((message) =>\r\n\t\t\t\t\t\tmessage.files?.some((file) => file.type === 'image')\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (hasImages && !(model.info?.meta?.capabilities?.vision ?? true)) {\r\n\t\t\t\t\t\ttoast.error(\r\n\t\t\t\t\t\t\t$i18n.t('Model {{modelName}} is not vision capable', {\r\n\t\t\t\t\t\t\t\tmodelName: model.name ?? model.id\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet responseMessageId =\r\n\t\t\t\t\t\tresponseMessageIds[`${modelId}-${modelIdx ? modelIdx : _modelIdx}`];\r\n\t\t\t\t\tlet responseMessage = history.messages[responseMessageId];\r\n\r\n\t\t\t\t\tlet userContext = null;\r\n\t\t\t\t\tif ($settings?.memory ?? false) {\r\n\t\t\t\t\t\tif (userContext === null) {\r\n\t\t\t\t\t\t\tconst res = await queryMemory(localStorage.token, prompt).catch((error) => {\r\n\t\t\t\t\t\t\t\ttoast.error(error);\r\n\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\t\t\tif (res.documents[0].length > 0) {\r\n\t\t\t\t\t\t\t\t\tuserContext = res.documents[0].reduce((acc, doc, index) => {\r\n\t\t\t\t\t\t\t\t\t\tconst createdAtTimestamp = res.metadatas[0][index].created_at;\r\n\t\t\t\t\t\t\t\t\t\tconst createdAtDate = new Date(createdAtTimestamp * 1000)\r\n\t\t\t\t\t\t\t\t\t\t\t.toISOString()\r\n\t\t\t\t\t\t\t\t\t\t\t.split('T')[0];\r\n\t\t\t\t\t\t\t\t\t\treturn `${acc}${index + 1}. [${createdAtDate}]. ${doc}\\n`;\r\n\t\t\t\t\t\t\t\t\t}, '');\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tconsole.log(userContext);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tresponseMessage.userContext = userContext;\r\n\r\n\t\t\t\t\tconst chatEventEmitter = await getChatEventEmitter(model.id, _chatId);\r\n\r\n\t\t\t\t\tscrollToBottom();\r\n\t\t\t\t\tif (webSearchEnabled) {\r\n\t\t\t\t\t\tawait getWebSearchResults(model.id, parentId, responseMessageId);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tlet _response = null;\r\n\t\t\t\t\tif (model?.owned_by === 'openai') {\r\n\t\t\t\t\t\t_response = await sendPromptOpenAI(model, prompt, responseMessageId, _chatId);\r\n\t\t\t\t\t} else if (model) {\r\n\t\t\t\t\t\t_response = await sendPromptOllama(model, prompt, responseMessageId, _chatId);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_responses.push(_response);\r\n\r\n\t\t\t\t\tif (chatEventEmitter) clearInterval(chatEventEmitter);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoast.error($i18n.t(`Model {{modelId}} not found`, { modelId }));\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tcurrentChatPage.set(1);\r\n\t\tchats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\r\n\t\treturn _responses;\r\n\t};\r\n\r\n\tconst sendPromptOllama = async (model, userPrompt, responseMessageId, _chatId) => {\r\n\t\tlet _response: string | null = null;\r\n\r\n\t\tconst responseMessage = history.messages[responseMessageId];\r\n\t\tconst userMessage = history.messages[responseMessage.parentId];\r\n\r\n\t\t// Wait until history/message have been updated\r\n\t\tawait tick();\r\n\r\n\t\t// Scroll down\r\n\t\tscrollToBottom();\r\n\r\n\t\tconst messagesBody = [\r\n\t\t\tparams?.system || $settings.system || (responseMessage?.userContext ?? null)\r\n\t\t\t\t? {\r\n\t\t\t\t\t\trole: 'system',\r\n\t\t\t\t\t\tcontent: `${promptTemplate(\r\n\t\t\t\t\t\t\tparams?.system ?? $settings?.system ?? '',\r\n\t\t\t\t\t\t\t$user.name,\r\n\t\t\t\t\t\t\t$settings?.userLocation\r\n\t\t\t\t\t\t\t\t? await getAndUpdateUserLocation(localStorage.token)\r\n\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t)}${\r\n\t\t\t\t\t\t\t(responseMessage?.userContext ?? null)\r\n\t\t\t\t\t\t\t\t? `\\n\\nUser Context:\\n${responseMessage?.userContext ?? ''}`\r\n\t\t\t\t\t\t\t\t: ''\r\n\t\t\t\t\t\t}`\r\n\t\t\t\t\t}\r\n\t\t\t\t: undefined,\r\n\t\t\t...createMessagesList(responseMessageId)\r\n\t\t]\r\n\t\t\t.filter((message) => message?.content?.trim())\r\n\t\t\t.map((message) => {\r\n\t\t\t\t// Prepare the base message object\r\n\t\t\t\tconst baseMessage = {\r\n\t\t\t\t\trole: message.role,\r\n\t\t\t\t\tcontent: message.content\r\n\t\t\t\t};\r\n\r\n\t\t\t\t// Extract and format image URLs if any exist\r\n\t\t\t\tconst imageUrls = message.files\r\n\t\t\t\t\t?.filter((file) => file.type === 'image')\r\n\t\t\t\t\t.map((file) => file.url.slice(file.url.indexOf(',') + 1));\r\n\r\n\t\t\t\t// Add images array only if it contains elements\r\n\t\t\t\tif (imageUrls && imageUrls.length > 0 && message.role === 'user') {\r\n\t\t\t\t\tbaseMessage.images = imageUrls;\r\n\t\t\t\t}\r\n\t\t\t\treturn baseMessage;\r\n\t\t\t});\r\n\r\n\t\tlet lastImageIndex = -1;\r\n\r\n\t\t// Find the index of the last object with images\r\n\t\tmessagesBody.forEach((item, index) => {\r\n\t\t\tif (item.images) {\r\n\t\t\t\tlastImageIndex = index;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// Remove images from all but the last one\r\n\t\tmessagesBody.forEach((item, index) => {\r\n\t\t\tif (index !== lastImageIndex) {\r\n\t\t\t\tdelete item.images;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tlet files = JSON.parse(JSON.stringify(chatFiles));\r\n\t\tif (model?.info?.meta?.knowledge ?? false) {\r\n\t\t\t// Only initialize and add status if knowledge exists\r\n\t\t\tresponseMessage.statusHistory = [\r\n\t\t\t\t{\r\n\t\t\t\t\taction: 'knowledge_search',\r\n\t\t\t\t\tdescription: $i18n.t(`Searching Knowledge for \"{{searchQuery}}\"`, {\r\n\t\t\t\t\t\tsearchQuery: userMessage.content\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tdone: false\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t\tfiles.push(...model.info.meta.knowledge);\r\n\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t}\r\n\t\tfiles.push(\r\n\t\t\t...(userMessage?.files ?? []).filter((item) =>\r\n\t\t\t\t['doc', 'file', 'collection'].includes(item.type)\r\n\t\t\t),\r\n\t\t\t...(responseMessage?.files ?? []).filter((item) => ['web_search_results'].includes(item.type))\r\n\t\t);\r\n\r\n\t\tscrollToBottom();\r\n\r\n\t\teventTarget.dispatchEvent(\r\n\t\t\tnew CustomEvent('chat:start', {\r\n\t\t\t\tdetail: {\r\n\t\t\t\t\tid: responseMessageId\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tawait tick();\r\n\r\n\t\tconst stream =\r\n\t\t\tmodel?.info?.params?.stream_response ??\r\n\t\t\t$settings?.params?.stream_response ??\r\n\t\t\tparams?.stream_response ??\r\n\t\t\ttrue;\r\n\t\tconst [res, controller] = await generateChatCompletion(localStorage.token, {\r\n\t\t\tstream: stream,\r\n\t\t\tmodel: model.id,\r\n\t\t\tmessages: messagesBody,\r\n\t\t\toptions: {\r\n\t\t\t\t...{ ...($settings?.params ?? {}), ...params },\r\n\t\t\t\tstop:\r\n\t\t\t\t\t(params?.stop ?? $settings?.params?.stop ?? undefined)\r\n\t\t\t\t\t\t? (params?.stop.split(',').map((token) => token.trim()) ?? $settings.params.stop).map(\r\n\t\t\t\t\t\t\t\t(str) => decodeURIComponent(JSON.parse('\"' + str.replace(/\\\"/g, '\\\\\"') + '\"'))\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t\tnum_predict: params?.max_tokens ?? $settings?.params?.max_tokens ?? undefined,\r\n\t\t\t\trepeat_penalty:\r\n\t\t\t\t\tparams?.frequency_penalty ?? $settings?.params?.frequency_penalty ?? undefined\r\n\t\t\t},\r\n\t\t\tformat: $settings.requestFormat ?? undefined,\r\n\t\t\tkeep_alive: $settings.keepAlive ?? undefined,\r\n\t\t\ttool_ids: selectedToolIds.length > 0 ? selectedToolIds : undefined,\r\n\t\t\tfiles: files.length > 0 ? files : undefined,\r\n\t\t\tsession_id: $socket?.id,\r\n\t\t\tchat_id: $chatId,\r\n\t\t\tid: responseMessageId\r\n\t\t});\r\n\r\n\t\tif (res && res.ok) {\r\n\t\t\tif (!stream) {\r\n\t\t\t\tconst response = await res.json();\r\n\t\t\t\tconsole.log(response);\r\n\r\n\t\t\t\tresponseMessage.content = response.message.content;\r\n\t\t\t\tresponseMessage.info = {\r\n\t\t\t\t\teval_count: response.eval_count,\r\n\t\t\t\t\teval_duration: response.eval_duration,\r\n\t\t\t\t\tload_duration: response.load_duration,\r\n\t\t\t\t\tprompt_eval_count: response.prompt_eval_count,\r\n\t\t\t\t\tprompt_eval_duration: response.prompt_eval_duration,\r\n\t\t\t\t\ttotal_duration: response.total_duration\r\n\t\t\t\t};\r\n\t\t\t\tresponseMessage.done = true;\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log('controller', controller);\r\n\r\n\t\t\t\tconst reader = res.body\r\n\t\t\t\t\t.pipeThrough(new TextDecoderStream())\r\n\t\t\t\t\t.pipeThrough(splitStream('\\n'))\r\n\t\t\t\t\t.getReader();\r\n\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\tconst { value, done } = await reader.read();\r\n\t\t\t\t\tif (done || stopResponseFlag || _chatId !== $chatId) {\r\n\t\t\t\t\t\tresponseMessage.done = true;\r\n\t\t\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\t\t\t\t\tif (stopResponseFlag) {\r\n\t\t\t\t\t\t\tcontroller.abort('User: Stop Response');\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_response = responseMessage.content;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tlet lines = value.split('\\n');\r\n\r\n\t\t\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\t\t\tif (line !== '') {\r\n\t\t\t\t\t\t\t\tconsole.log(line);\r\n\t\t\t\t\t\t\t\tlet data = JSON.parse(line);\r\n\r\n\t\t\t\t\t\t\t\tif ('citations' in data) {\r\n\t\t\t\t\t\t\t\t\tresponseMessage.citations = data.citations;\r\n\t\t\t\t\t\t\t\t\t// Only remove status if it was initially set\r\n\t\t\t\t\t\t\t\t\tif (model?.info?.meta?.knowledge ?? false) {\r\n\t\t\t\t\t\t\t\t\t\tresponseMessage.statusHistory = responseMessage.statusHistory.filter(\r\n\t\t\t\t\t\t\t\t\t\t\t(status) => status.action !== 'knowledge_search'\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif ('detail' in data) {\r\n\t\t\t\t\t\t\t\t\tthrow data;\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (data.done == false) {\r\n\t\t\t\t\t\t\t\t\tif (responseMessage.content == '' && data.message.content == '\\n') {\r\n\t\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tresponseMessage.content += data.message.content;\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (navigator.vibrate && ($settings?.hapticFeedback ?? false)) {\r\n\t\t\t\t\t\t\t\t\t\t\tnavigator.vibrate(5);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tconst messageContentParts = getMessageContentParts(\r\n\t\t\t\t\t\t\t\t\t\t\tresponseMessage.content,\r\n\t\t\t\t\t\t\t\t\t\t\t$config?.audio?.tts?.split_on ?? 'punctuation'\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\tmessageContentParts.pop();\r\n\r\n\t\t\t\t\t\t\t\t\t\t// dispatch only last sentence and make sure it hasn't been dispatched before\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\tmessageContentParts.length > 0 &&\r\n\t\t\t\t\t\t\t\t\t\t\tmessageContentParts[messageContentParts.length - 1] !==\r\n\t\t\t\t\t\t\t\t\t\t\t\tresponseMessage.lastSentence\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\tresponseMessage.lastSentence =\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessageContentParts[messageContentParts.length - 1];\r\n\t\t\t\t\t\t\t\t\t\t\teventTarget.dispatchEvent(\r\n\t\t\t\t\t\t\t\t\t\t\t\tnew CustomEvent('chat', {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdetail: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid: responseMessageId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: messageContentParts[messageContentParts.length - 1]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tresponseMessage.done = true;\r\n\r\n\t\t\t\t\t\t\t\t\tif (responseMessage.content == '') {\r\n\t\t\t\t\t\t\t\t\t\tresponseMessage.error = {\r\n\t\t\t\t\t\t\t\t\t\t\tcode: 400,\r\n\t\t\t\t\t\t\t\t\t\t\tcontent: `Oops! No text generated from Ollama, Please try again.`\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tresponseMessage.context = data.context ?? null;\r\n\t\t\t\t\t\t\t\t\tresponseMessage.info = {\r\n\t\t\t\t\t\t\t\t\t\ttotal_duration: data.total_duration,\r\n\t\t\t\t\t\t\t\t\t\tload_duration: data.load_duration,\r\n\t\t\t\t\t\t\t\t\t\tsample_count: data.sample_count,\r\n\t\t\t\t\t\t\t\t\t\tsample_duration: data.sample_duration,\r\n\t\t\t\t\t\t\t\t\t\tprompt_eval_count: data.prompt_eval_count,\r\n\t\t\t\t\t\t\t\t\t\tprompt_eval_duration: data.prompt_eval_duration,\r\n\t\t\t\t\t\t\t\t\t\teval_count: data.eval_count,\r\n\t\t\t\t\t\t\t\t\t\teval_duration: data.eval_duration\r\n\t\t\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\t\t\t\t\t\t\t\tif ($settings.notificationEnabled && !document.hasFocus()) {\r\n\t\t\t\t\t\t\t\t\t\tconst notification = new Notification(`${model.id}`, {\r\n\t\t\t\t\t\t\t\t\t\t\tbody: responseMessage.content,\r\n\t\t\t\t\t\t\t\t\t\t\ticon: `${WEBUI_BASE_URL}/static/favicon.png`\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif ($settings?.responseAutoCopy ?? false) {\r\n\t\t\t\t\t\t\t\t\t\tcopyToClipboard(responseMessage.content);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif ($settings.responseAutoPlayback && !$showCallOverlay) {\r\n\t\t\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\t\t\tdocument.getElementById(`speak-button-${responseMessage.id}`)?.click();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t\t\tif ('detail' in error) {\r\n\t\t\t\t\t\t\ttoast.error(error.detail);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (autoScroll) {\r\n\t\t\t\t\t\tscrollToBottom();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (res !== null) {\r\n\t\t\t\tconst error = await res.json();\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t\tif ('detail' in error) {\r\n\t\t\t\t\ttoast.error(error.detail);\r\n\t\t\t\t\tresponseMessage.error = { content: error.detail };\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttoast.error(error.error);\r\n\t\t\t\t\tresponseMessage.error = { content: error.error };\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ttoast.error(\r\n\t\t\t\t\t$i18n.t(`Uh-oh! There was an issue connecting to {{provider}}.`, { provider: 'Ollama' })\r\n\t\t\t\t);\r\n\t\t\t\tresponseMessage.error = {\r\n\t\t\t\t\tcontent: $i18n.t(`Uh-oh! There was an issue connecting to {{provider}}.`, {\r\n\t\t\t\t\t\tprovider: 'Ollama'\r\n\t\t\t\t\t})\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tresponseMessage.done = true;\r\n\r\n\t\t\tif (responseMessage.statusHistory) {\r\n\t\t\t\tresponseMessage.statusHistory = responseMessage.statusHistory.filter(\r\n\t\t\t\t\t(status) => status.action !== 'knowledge_search'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t\tawait saveChatHandler(_chatId);\r\n\r\n\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\tawait chatCompletedHandler(\r\n\t\t\t_chatId,\r\n\t\t\tmodel.id,\r\n\t\t\tresponseMessageId,\r\n\t\t\tcreateMessagesList(responseMessageId)\r\n\t\t);\r\n\r\n\t\tstopResponseFlag = false;\r\n\t\tawait tick();\r\n\r\n\t\tlet lastMessageContentPart =\r\n\t\t\tgetMessageContentParts(\r\n\t\t\t\tresponseMessage.content,\r\n\t\t\t\t$config?.audio?.tts?.split_on ?? 'punctuation'\r\n\t\t\t)?.at(-1) ?? '';\r\n\t\tif (lastMessageContentPart) {\r\n\t\t\teventTarget.dispatchEvent(\r\n\t\t\t\tnew CustomEvent('chat', {\r\n\t\t\t\t\tdetail: { id: responseMessageId, content: lastMessageContentPart }\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\teventTarget.dispatchEvent(\r\n\t\t\tnew CustomEvent('chat:finish', {\r\n\t\t\t\tdetail: {\r\n\t\t\t\t\tid: responseMessageId,\r\n\t\t\t\t\tcontent: responseMessage.content\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tif (autoScroll) {\r\n\t\t\tscrollToBottom();\r\n\t\t}\r\n\r\n\t\tconst messages = createMessagesList(responseMessageId);\r\n\t\tif (messages.length == 2 && messages.at(-1).content !== '' && selectedModels[0] === model.id) {\r\n\t\t\twindow.history.replaceState(history.state, '', `/c/${_chatId}`);\r\n\t\t\tconst title = await generateChatTitle(userPrompt);\r\n\t\t\tawait setChatTitle(_chatId, title);\r\n\t\t}\r\n\r\n\t\treturn _response;\r\n\t};\r\n\r\n\tconst sendPromptOpenAI = async (model, userPrompt, responseMessageId, _chatId) => {\r\n\t\tlet _response = null;\r\n\r\n\t\tconst responseMessage = history.messages[responseMessageId];\r\n\t\tconst userMessage = history.messages[responseMessage.parentId];\r\n\r\n\t\tlet files = JSON.parse(JSON.stringify(chatFiles));\r\n\t\tif (model?.info?.meta?.knowledge ?? false) {\r\n\t\t\t// Only initialize and add status if knowledge exists\r\n\t\t\tresponseMessage.statusHistory = [\r\n\t\t\t\t{\r\n\t\t\t\t\taction: 'knowledge_search',\r\n\t\t\t\t\tdescription: $i18n.t(`Searching Knowledge for \"{{searchQuery}}\"`, {\r\n\t\t\t\t\t\tsearchQuery: userMessage.content\r\n\t\t\t\t\t}),\r\n\t\t\t\t\tdone: false\r\n\t\t\t\t}\r\n\t\t\t];\r\n\t\t\tfiles.push(...model.info.meta.knowledge);\r\n\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t}\r\n\t\tfiles.push(\r\n\t\t\t...(userMessage?.files ?? []).filter((item) =>\r\n\t\t\t\t['doc', 'file', 'collection'].includes(item.type)\r\n\t\t\t),\r\n\t\t\t...(responseMessage?.files ?? []).filter((item) => ['web_search_results'].includes(item.type))\r\n\t\t);\r\n\r\n\t\tscrollToBottom();\r\n\r\n\t\teventTarget.dispatchEvent(\r\n\t\t\tnew CustomEvent('chat:start', {\r\n\t\t\t\tdetail: {\r\n\t\t\t\t\tid: responseMessageId\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\t\tawait tick();\r\n\r\n\t\ttry {\r\n\t\t\tconst stream =\r\n\t\t\t\tmodel?.info?.params?.stream_response ??\r\n\t\t\t\t$settings?.params?.stream_response ??\r\n\t\t\t\tparams?.stream_response ??\r\n\t\t\t\ttrue;\r\n\r\n\t\t\tconst [res, controller] = await generateOpenAIChatCompletion(\r\n\t\t\t\tlocalStorage.token,\r\n\t\t\t\t{\r\n\t\t\t\t\tstream: stream,\r\n\t\t\t\t\tmodel: model.id,\r\n\t\t\t\t\t...(stream && (model.info?.meta?.capabilities?.usage ?? false)\r\n\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\tstream_options: {\r\n\t\t\t\t\t\t\t\t\tinclude_usage: true\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t: {}),\r\n\t\t\t\t\tmessages: [\r\n\t\t\t\t\t\tparams?.system || $settings.system || (responseMessage?.userContext ?? null)\r\n\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\trole: 'system',\r\n\t\t\t\t\t\t\t\t\tcontent: `${promptTemplate(\r\n\t\t\t\t\t\t\t\t\t\tparams?.system ?? $settings?.system ?? '',\r\n\t\t\t\t\t\t\t\t\t\t$user.name,\r\n\t\t\t\t\t\t\t\t\t\t$settings?.userLocation\r\n\t\t\t\t\t\t\t\t\t\t\t? await getAndUpdateUserLocation(localStorage.token)\r\n\t\t\t\t\t\t\t\t\t\t\t: undefined\r\n\t\t\t\t\t\t\t\t\t)}${\r\n\t\t\t\t\t\t\t\t\t\t(responseMessage?.userContext ?? null)\r\n\t\t\t\t\t\t\t\t\t\t\t? `\\n\\nUser Context:\\n${responseMessage?.userContext ?? ''}`\r\n\t\t\t\t\t\t\t\t\t\t\t: ''\r\n\t\t\t\t\t\t\t\t\t}`\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\t\t...createMessagesList(responseMessageId)\r\n\t\t\t\t\t]\r\n\t\t\t\t\t\t.filter((message) => message?.content?.trim())\r\n\t\t\t\t\t\t.map((message, idx, arr) => ({\r\n\t\t\t\t\t\t\trole: message.role,\r\n\t\t\t\t\t\t\t...((message.files?.filter((file) => file.type === 'image').length > 0 ?? false) &&\r\n\t\t\t\t\t\t\tmessage.role === 'user'\r\n\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\tcontent: [\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype: 'text',\r\n\t\t\t\t\t\t\t\t\t\t\t\ttext:\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tarr.length - 1 !== idx\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? message.content\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: (message?.raContent ?? message.content)\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t\t...message.files\r\n\t\t\t\t\t\t\t\t\t\t\t\t.filter((file) => file.type === 'image')\r\n\t\t\t\t\t\t\t\t\t\t\t\t.map((file) => ({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype: 'image_url',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\timage_url: {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\turl: file.url\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t: {\r\n\t\t\t\t\t\t\t\t\t\tcontent:\r\n\t\t\t\t\t\t\t\t\t\t\tarr.length - 1 !== idx\r\n\t\t\t\t\t\t\t\t\t\t\t\t? message.content\r\n\t\t\t\t\t\t\t\t\t\t\t\t: (message?.raContent ?? message.content)\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t})),\r\n\t\t\t\t\tseed: params?.seed ?? $settings?.params?.seed ?? undefined,\r\n\t\t\t\t\tstop:\r\n\t\t\t\t\t\t(params?.stop ?? $settings?.params?.stop ?? undefined)\r\n\t\t\t\t\t\t\t? (params?.stop.split(',').map((token) => token.trim()) ?? $settings.params.stop).map(\r\n\t\t\t\t\t\t\t\t\t(str) => decodeURIComponent(JSON.parse('\"' + str.replace(/\\\"/g, '\\\\\"') + '\"'))\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\ttemperature: params?.temperature ?? $settings?.params?.temperature ?? undefined,\r\n\t\t\t\t\ttop_p: params?.top_p ?? $settings?.params?.top_p ?? undefined,\r\n\t\t\t\t\tfrequency_penalty:\r\n\t\t\t\t\t\tparams?.frequency_penalty ?? $settings?.params?.frequency_penalty ?? undefined,\r\n\t\t\t\t\tmax_tokens: params?.max_tokens ?? $settings?.params?.max_tokens ?? undefined,\r\n\t\t\t\t\ttool_ids: selectedToolIds.length > 0 ? selectedToolIds : undefined,\r\n\t\t\t\t\tfiles: files.length > 0 ? files : undefined,\r\n\t\t\t\t\tsession_id: $socket?.id,\r\n\t\t\t\t\tchat_id: $chatId,\r\n\t\t\t\t\tid: responseMessageId\r\n\t\t\t\t},\r\n\t\t\t\t`${WEBUI_BASE_URL}/api`\r\n\t\t\t);\r\n\r\n\t\t\t// Wait until history/message have been updated\r\n\t\t\tawait tick();\r\n\r\n\t\t\tscrollToBottom();\r\n\r\n\t\t\tif (res && res.ok && res.body) {\r\n\t\t\t\tif (!stream) {\r\n\t\t\t\t\tconst response = await res.json();\r\n\t\t\t\t\tconsole.log(response);\r\n\r\n\t\t\t\t\tresponseMessage.content = response.choices[0].message.content;\r\n\t\t\t\t\tresponseMessage.info = { ...response.usage, openai: true };\r\n\t\t\t\t\tresponseMessage.done = true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst textStream = await createOpenAITextStream(res.body, $settings.splitLargeChunks);\r\n\r\n\t\t\t\t\tfor await (const update of textStream) {\r\n\t\t\t\t\t\tconst { value, done, citations, error, usage } = update;\r\n\t\t\t\t\t\tif (error) {\r\n\t\t\t\t\t\t\tawait handleOpenAIError(error, null, model, responseMessage);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (done || stopResponseFlag || _chatId !== $chatId) {\r\n\t\t\t\t\t\t\tresponseMessage.done = true;\r\n\t\t\t\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\t\t\t\t\t\tif (stopResponseFlag) {\r\n\t\t\t\t\t\t\t\tcontroller.abort('User: Stop Response');\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t_response = responseMessage.content;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (usage) {\r\n\t\t\t\t\t\t\tresponseMessage.info = { ...usage, openai: true };\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (citations) {\r\n\t\t\t\t\t\t\tresponseMessage.citations = citations;\r\n\t\t\t\t\t\t\t// Only remove status if it was initially set\r\n\t\t\t\t\t\t\tif (model?.info?.meta?.knowledge ?? false) {\r\n\t\t\t\t\t\t\t\tresponseMessage.statusHistory = responseMessage.statusHistory.filter(\r\n\t\t\t\t\t\t\t\t\t(status) => status.action !== 'knowledge_search'\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (responseMessage.content == '' && value == '\\n') {\r\n\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresponseMessage.content += value;\r\n\r\n\t\t\t\t\t\t\tif (navigator.vibrate && ($settings?.hapticFeedback ?? false)) {\r\n\t\t\t\t\t\t\t\tnavigator.vibrate(5);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tconst messageContentParts = getMessageContentParts(\r\n\t\t\t\t\t\t\t\tresponseMessage.content,\r\n\t\t\t\t\t\t\t\t$config?.audio?.tts?.split_on ?? 'punctuation'\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tmessageContentParts.pop();\r\n\r\n\t\t\t\t\t\t\t// dispatch only last sentence and make sure it hasn't been dispatched before\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tmessageContentParts.length > 0 &&\r\n\t\t\t\t\t\t\t\tmessageContentParts[messageContentParts.length - 1] !== responseMessage.lastSentence\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tresponseMessage.lastSentence = messageContentParts[messageContentParts.length - 1];\r\n\t\t\t\t\t\t\t\teventTarget.dispatchEvent(\r\n\t\t\t\t\t\t\t\t\tnew CustomEvent('chat', {\r\n\t\t\t\t\t\t\t\t\t\tdetail: {\r\n\t\t\t\t\t\t\t\t\t\t\tid: responseMessageId,\r\n\t\t\t\t\t\t\t\t\t\t\tcontent: messageContentParts[messageContentParts.length - 1]\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (autoScroll) {\r\n\t\t\t\t\t\t\tscrollToBottom();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($settings.notificationEnabled && !document.hasFocus()) {\r\n\t\t\t\t\tconst notification = new Notification(`${model.id}`, {\r\n\t\t\t\t\t\tbody: responseMessage.content,\r\n\t\t\t\t\t\ticon: `${WEBUI_BASE_URL}/static/favicon.png`\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($settings.responseAutoCopy) {\r\n\t\t\t\t\tcopyToClipboard(responseMessage.content);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($settings.responseAutoPlayback && !$showCallOverlay) {\r\n\t\t\t\t\tawait tick();\r\n\r\n\t\t\t\t\tdocument.getElementById(`speak-button-${responseMessage.id}`)?.click();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tawait handleOpenAIError(null, res, model, responseMessage);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tawait handleOpenAIError(error, null, model, responseMessage);\r\n\t\t}\r\n\r\n\t\tawait saveChatHandler(_chatId);\r\n\r\n\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\tawait chatCompletedHandler(\r\n\t\t\t_chatId,\r\n\t\t\tmodel.id,\r\n\t\t\tresponseMessageId,\r\n\t\t\tcreateMessagesList(responseMessageId)\r\n\t\t);\r\n\r\n\t\tstopResponseFlag = false;\r\n\t\tawait tick();\r\n\r\n\t\tlet lastMessageContentPart =\r\n\t\t\tgetMessageContentParts(\r\n\t\t\t\tresponseMessage.content,\r\n\t\t\t\t$config?.audio?.tts?.split_on ?? 'punctuation'\r\n\t\t\t)?.at(-1) ?? '';\r\n\t\tif (lastMessageContentPart) {\r\n\t\t\teventTarget.dispatchEvent(\r\n\t\t\t\tnew CustomEvent('chat', {\r\n\t\t\t\t\tdetail: { id: responseMessageId, content: lastMessageContentPart }\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\teventTarget.dispatchEvent(\r\n\t\t\tnew CustomEvent('chat:finish', {\r\n\t\t\t\tdetail: {\r\n\t\t\t\t\tid: responseMessageId,\r\n\t\t\t\t\tcontent: responseMessage.content\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tif (autoScroll) {\r\n\t\t\tscrollToBottom();\r\n\t\t}\r\n\r\n\t\tconst messages = createMessagesList(responseMessageId);\r\n\t\tif (messages.length == 2 && selectedModels[0] === model.id) {\r\n\t\t\twindow.history.replaceState(history.state, '', `/c/${_chatId}`);\r\n\t\t\tconst title = await generateChatTitle(userPrompt);\r\n\t\t\tawait setChatTitle(_chatId, title);\r\n\t\t}\r\n\r\n\t\treturn _response;\r\n\t};\r\n\r\n\tconst handleOpenAIError = async (error, res: Response | null, model, responseMessage) => {\r\n\t\tlet errorMessage = '';\r\n\t\tlet innerError;\r\n\r\n\t\tif (error) {\r\n\t\t\tinnerError = error;\r\n\t\t} else if (res !== null) {\r\n\t\t\tinnerError = await res.json();\r\n\t\t}\r\n\t\tconsole.error(innerError);\r\n\t\tif ('detail' in innerError) {\r\n\t\t\ttoast.error(innerError.detail);\r\n\t\t\terrorMessage = innerError.detail;\r\n\t\t} else if ('error' in innerError) {\r\n\t\t\tif ('message' in innerError.error) {\r\n\t\t\t\ttoast.error(innerError.error.message);\r\n\t\t\t\terrorMessage = innerError.error.message;\r\n\t\t\t} else {\r\n\t\t\t\ttoast.error(innerError.error);\r\n\t\t\t\terrorMessage = innerError.error;\r\n\t\t\t}\r\n\t\t} else if ('message' in innerError) {\r\n\t\t\ttoast.error(innerError.message);\r\n\t\t\terrorMessage = innerError.message;\r\n\t\t}\r\n\r\n\t\tresponseMessage.error = {\r\n\t\t\tcontent:\r\n\t\t\t\t$i18n.t(`Uh-oh! There was an issue connecting to {{provider}}.`, {\r\n\t\t\t\t\tprovider: model.name ?? model.id\r\n\t\t\t\t}) +\r\n\t\t\t\t'\\n' +\r\n\t\t\t\terrorMessage\r\n\t\t};\r\n\t\tresponseMessage.done = true;\r\n\r\n\t\tif (responseMessage.statusHistory) {\r\n\t\t\tresponseMessage.statusHistory = responseMessage.statusHistory.filter(\r\n\t\t\t\t(status) => status.action !== 'knowledge_search'\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\thistory.messages[responseMessage.id] = responseMessage;\r\n\t};\r\n\r\n\tconst stopResponse = () => {\r\n\t\tstopResponseFlag = true;\r\n\t\tconsole.log('stopResponse');\r\n\t};\r\n\r\n\tconst regenerateResponse = async (message) => {\r\n\t\tconsole.log('regenerateResponse');\r\n\r\n\t\tif (history.currentId) {\r\n\t\t\tlet userMessage = history.messages[message.parentId];\r\n\t\t\tlet userPrompt = userMessage.content;\r\n\r\n\t\t\tif ((userMessage?.models ?? [...selectedModels]).length == 1) {\r\n\t\t\t\t// If user message has only one model selected, sendPrompt automatically selects it for regeneration\r\n\t\t\t\tawait sendPrompt(userPrompt, userMessage.id);\r\n\t\t\t} else {\r\n\t\t\t\t// If there are multiple models selected, use the model of the response message for regeneration\r\n\t\t\t\t// e.g. many model chat\r\n\t\t\t\tawait sendPrompt(userPrompt, userMessage.id, {\r\n\t\t\t\t\tmodelId: message.model,\r\n\t\t\t\t\tmodelIdx: message.modelIdx\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst continueResponse = async () => {\r\n\t\tconsole.log('continueResponse');\r\n\t\tconst _chatId = JSON.parse(JSON.stringify($chatId));\r\n\r\n\t\tif (history.currentId && history.messages[history.currentId].done == true) {\r\n\t\t\tconst responseMessage = history.messages[history.currentId];\r\n\t\t\tresponseMessage.done = false;\r\n\t\t\tawait tick();\r\n\r\n\t\t\tconst model = $models.filter((m) => m.id === responseMessage.model).at(0);\r\n\r\n\t\t\tif (model) {\r\n\t\t\t\tif (model?.owned_by === 'openai') {\r\n\t\t\t\t\tawait sendPromptOpenAI(\r\n\t\t\t\t\t\tmodel,\r\n\t\t\t\t\t\thistory.messages[responseMessage.parentId].content,\r\n\t\t\t\t\t\tresponseMessage.id,\r\n\t\t\t\t\t\t_chatId\r\n\t\t\t\t\t);\r\n\t\t\t\t} else\r\n\t\t\t\t\tawait sendPromptOllama(\r\n\t\t\t\t\t\tmodel,\r\n\t\t\t\t\t\thistory.messages[responseMessage.parentId].content,\r\n\t\t\t\t\t\tresponseMessage.id,\r\n\t\t\t\t\t\t_chatId\r\n\t\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttoast.error($i18n.t(`Model {{modelId}} not found`, { modelId }));\r\n\t\t}\r\n\t};\r\n\r\n\tconst mergeResponses = async (messageId, responses, _chatId) => {\r\n\t\tconsole.log('mergeResponses', messageId, responses);\r\n\t\tconst message = history.messages[messageId];\r\n\t\tconst mergedResponse = {\r\n\t\t\tstatus: true,\r\n\t\t\tcontent: ''\r\n\t\t};\r\n\t\tmessage.merged = mergedResponse;\r\n\t\thistory.messages[messageId] = message;\r\n\r\n\t\ttry {\r\n\t\t\tconst [res, controller] = await generateMoACompletion(\r\n\t\t\t\tlocalStorage.token,\r\n\t\t\t\tmessage.model,\r\n\t\t\t\thistory.messages[message.parentId].content,\r\n\t\t\t\tresponses\r\n\t\t\t);\r\n\r\n\t\t\tif (res && res.ok && res.body) {\r\n\t\t\t\tconst textStream = await createOpenAITextStream(res.body, $settings.splitLargeChunks);\r\n\t\t\t\tfor await (const update of textStream) {\r\n\t\t\t\t\tconst { value, done, citations, error, usage } = update;\r\n\t\t\t\t\tif (error || done) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (mergedResponse.content == '' && value == '\\n') {\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tmergedResponse.content += value;\r\n\t\t\t\t\t\thistory.messages[messageId] = message;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (autoScroll) {\r\n\t\t\t\t\t\tscrollToBottom();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tawait saveChatHandler(_chatId);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error(res);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(e);\r\n\t\t}\r\n\t};\r\n\r\n\tconst generateChatTitle = async (userPrompt) => {\r\n\t\tif ($settings?.title?.auto ?? true) {\r\n\t\t\tconst title = await generateTitle(\r\n\t\t\t\tlocalStorage.token,\r\n\t\t\t\tselectedModels[0],\r\n\t\t\t\tuserPrompt,\r\n\t\t\t\t$chatId\r\n\t\t\t).catch((error) => {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t\treturn 'New Chat';\r\n\t\t\t});\r\n\r\n\t\t\treturn title;\r\n\t\t} else {\r\n\t\t\treturn `${userPrompt}`;\r\n\t\t}\r\n\t};\r\n\r\n\tconst setChatTitle = async (_chatId, title) => {\r\n\t\tif (_chatId === $chatId) {\r\n\t\t\tchatTitle.set(title);\r\n\t\t}\r\n\r\n\t\tif (!$temporaryChatEnabled) {\r\n\t\t\tchat = await updateChatById(localStorage.token, _chatId, { title: title });\r\n\r\n\t\t\tcurrentChatPage.set(1);\r\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\t\t}\r\n\t};\r\n\r\n\tconst getWebSearchResults = async (\r\n\t\tmodel: string,\r\n\t\tparentId: string,\r\n\t\tresponseMessageId: string\r\n\t) => {\r\n\t\tconst responseMessage = history.messages[responseMessageId];\r\n\t\tconst userMessage = history.messages[parentId];\r\n\t\tconst messages = createMessagesList(history.currentId);\r\n\r\n\t\tresponseMessage.statusHistory = [\r\n\t\t\t{\r\n\t\t\t\tdone: false,\r\n\t\t\t\taction: 'web_search',\r\n\t\t\t\tdescription: $i18n.t('Generating search query')\r\n\t\t\t}\r\n\t\t];\r\n\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\tconst prompt = userMessage.content;\r\n\t\tlet searchQuery = await generateSearchQuery(\r\n\t\t\tlocalStorage.token,\r\n\t\t\tmodel,\r\n\t\t\tmessages.filter((message) => message?.content?.trim()),\r\n\t\t\tprompt\r\n\t\t).catch((error) => {\r\n\t\t\tconsole.log(error);\r\n\t\t\treturn prompt;\r\n\t\t});\r\n\r\n\t\tif (!searchQuery || searchQuery == '') {\r\n\t\t\tresponseMessage.statusHistory.push({\r\n\t\t\t\tdone: true,\r\n\t\t\t\terror: true,\r\n\t\t\t\taction: 'web_search',\r\n\t\t\t\tdescription: $i18n.t('No search query generated')\r\n\t\t\t});\r\n\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tresponseMessage.statusHistory.push({\r\n\t\t\tdone: false,\r\n\t\t\taction: 'web_search',\r\n\t\t\tdescription: $i18n.t(`Searching \"{{searchQuery}}\"`, { searchQuery })\r\n\t\t});\r\n\t\thistory.messages[responseMessageId] = responseMessage;\r\n\r\n\t\tconst results = await runWebSearch(localStorage.token, searchQuery).catch((error) => {\r\n\t\t\tconsole.log(error);\r\n\t\t\ttoast.error(error);\r\n\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (results) {\r\n\t\t\tresponseMessage.statusHistory.push({\r\n\t\t\t\tdone: true,\r\n\t\t\t\taction: 'web_search',\r\n\t\t\t\tdescription: $i18n.t('Searched {{count}} sites', { count: results.filenames.length }),\r\n\t\t\t\tquery: searchQuery,\r\n\t\t\t\turls: results.filenames\r\n\t\t\t});\r\n\r\n\t\t\tif (responseMessage?.files ?? undefined === undefined) {\r\n\t\t\t\tresponseMessage.files = [];\r\n\t\t\t}\r\n\r\n\t\t\tresponseMessage.files.push({\r\n\t\t\t\tcollection_name: results.collection_name,\r\n\t\t\t\tname: searchQuery,\r\n\t\t\t\ttype: 'web_search_results',\r\n\t\t\t\turls: results.filenames\r\n\t\t\t});\r\n\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t} else {\r\n\t\t\tresponseMessage.statusHistory.push({\r\n\t\t\t\tdone: true,\r\n\t\t\t\terror: true,\r\n\t\t\t\taction: 'web_search',\r\n\t\t\t\tdescription: 'No search results found'\r\n\t\t\t});\r\n\t\t\thistory.messages[responseMessageId] = responseMessage;\r\n\t\t}\r\n\t};\r\n\r\n\tconst getTags = async () => {\r\n\t\treturn await getTagsById(localStorage.token, $chatId).catch(async (error) => {\r\n\t\t\treturn [];\r\n\t\t});\r\n\t};\r\n\r\n\tconst initChatHandler = async () => {\r\n\t\tif (!$temporaryChatEnabled) {\r\n\t\t\tchat = await createNewChat(localStorage.token, {\r\n\t\t\t\tid: $chatId,\r\n\t\t\t\ttitle: $i18n.t('New Chat'),\r\n\t\t\t\tmodels: selectedModels,\r\n\t\t\t\tsystem: $settings.system ?? undefined,\r\n\t\t\t\tparams: params,\r\n\t\t\t\thistory: history,\r\n\t\t\t\ttags: [],\r\n\t\t\t\ttimestamp: Date.now()\r\n\t\t\t});\r\n\r\n\t\t\tcurrentChatPage.set(1);\r\n\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\t\t\tawait chatId.set(chat.id);\r\n\t\t} else {\r\n\t\t\tawait chatId.set('local');\r\n\t\t}\r\n\t\tawait tick();\r\n\t};\r\n\r\n\tconst saveChatHandler = async (_chatId) => {\r\n\t\tif ($chatId == _chatId) {\r\n\t\t\tif (!$temporaryChatEnabled) {\r\n\t\t\t\tchat = await updateChatById(localStorage.token, _chatId, {\r\n\t\t\t\t\tmodels: selectedModels,\r\n\t\t\t\t\thistory: history,\r\n\t\t\t\t\tmessages: createMessagesList(history.currentId),\r\n\t\t\t\t\tparams: params,\r\n\t\t\t\t\tfiles: chatFiles\r\n\t\t\t\t});\r\n\r\n\t\t\t\tcurrentChatPage.set(1);\r\n\t\t\t\tawait chats.set(await getChatList(localStorage.token, $currentChatPage));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<svelte:head>\r\n\t<title>\r\n\t\t{$chatTitle\r\n\t\t\t? `${$chatTitle.length > 30 ? `${$chatTitle.slice(0, 30)}...` : $chatTitle} | ${$WEBUI_NAME}`\r\n\t\t\t: `${$WEBUI_NAME}`}\r\n\t</title>\r\n</svelte:head>\r\n\r\n<audio id=\"audioElement\" src=\"\" style=\"display: none;\" />\r\n\r\n<EventConfirmDialog\r\n\tbind:show={showEventConfirmation}\r\n\ttitle={eventConfirmationTitle}\r\n\tmessage={eventConfirmationMessage}\r\n\tinput={eventConfirmationInput}\r\n\tinputPlaceholder={eventConfirmationInputPlaceholder}\r\n\tinputValue={eventConfirmationInputValue}\r\n\ton:confirm={(e) => {\r\n\t\tif (e.detail) {\r\n\t\t\teventCallback(e.detail);\r\n\t\t} else {\r\n\t\t\teventCallback(true);\r\n\t\t}\r\n\t}}\r\n\ton:cancel={() => {\r\n\t\teventCallback(false);\r\n\t}}\r\n/>\r\n\r\n{#if !chatIdProp || (loaded && chatIdProp)}\r\n\t<div\r\n\t\tclass=\"h-screen max-h-[100dvh] {$showSidebar\r\n\t\t\t? 'md:max-w-[calc(100%-260px)]'\r\n\t\t\t: ''} w-full max-w-full flex flex-col\"\r\n\t>\r\n\t\t{#if $settings?.backgroundImageUrl ?? null}\r\n\t\t\t<div\r\n\t\t\t\tclass=\"absolute {$showSidebar\r\n\t\t\t\t\t? 'md:max-w-[calc(100%-260px)] md:translate-x-[260px]'\r\n\t\t\t\t\t: ''} top-0 left-0 w-full h-full bg-cover bg-center bg-no-repeat\"\r\n\t\t\t\tstyle=\"background-image: url({$settings.backgroundImageUrl})  \"\r\n\t\t\t/>\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\"absolute top-0 left-0 w-full h-full bg-gradient-to-t from-white to-white/85 dark:from-gray-900 dark:to-[#171717]/90 z-0\"\r\n\t\t\t/>\r\n\t\t{/if}\r\n\r\n\t\t<Navbar\r\n\t\t\t{chat}\r\n\t\t\ttitle={$chatTitle}\r\n\t\t\tbind:selectedModels\r\n\t\t\tshareEnabled={!!history.currentId}\r\n\t\t\t{initNewChat}\r\n\t\t/>\r\n\r\n\t\t<PaneGroup direction=\"horizontal\" class=\"w-full h-full\">\r\n\t\t\t<Pane defaultSize={50} class=\"h-full flex w-full relative\">\r\n\t\t\t\t{#if $banners.length > 0 && !history.currentId && !$chatId && selectedModels.length <= 1}\r\n\t\t\t\t\t<div class=\"absolute top-3 left-0 right-0 w-full z-20\">\r\n\t\t\t\t\t\t<div class=\" flex flex-col gap-1 w-full\">\r\n\t\t\t\t\t\t\t{#each $banners.filter( (b) => (b.dismissible ? !JSON.parse(localStorage.getItem('dismissedBannerIds') ?? '[]').includes(b.id) : true) ) as banner}\r\n\t\t\t\t\t\t\t\t<Banner\r\n\t\t\t\t\t\t\t\t\t{banner}\r\n\t\t\t\t\t\t\t\t\ton:dismiss={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tconst bannerId = e.detail;\r\n\r\n\t\t\t\t\t\t\t\t\t\tlocalStorage.setItem(\r\n\t\t\t\t\t\t\t\t\t\t\t'dismissedBannerIds',\r\n\t\t\t\t\t\t\t\t\t\t\tJSON.stringify(\r\n\t\t\t\t\t\t\t\t\t\t\t\t[\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tbannerId,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t...JSON.parse(localStorage.getItem('dismissedBannerIds') ?? '[]')\r\n\t\t\t\t\t\t\t\t\t\t\t\t].filter((id) => $banners.find((b) => b.id === id))\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{/each}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/if}\r\n\r\n\t\t\t\t<div class=\"flex flex-col flex-auto z-10 w-full\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclass=\" pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0 max-w-full z-10 scrollbar-hidden\"\r\n\t\t\t\t\t\tid=\"messages-container\"\r\n\t\t\t\t\t\tbind:this={messagesContainerElement}\r\n\t\t\t\t\t\ton:scroll={(e) => {\r\n\t\t\t\t\t\t\tautoScroll =\r\n\t\t\t\t\t\t\t\tmessagesContainerElement.scrollHeight - messagesContainerElement.scrollTop <=\r\n\t\t\t\t\t\t\t\tmessagesContainerElement.clientHeight + 5;\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div class=\" h-full w-full flex flex-col {chatIdProp ? 'py-4' : 'pt-2 pb-4'}\">\r\n\t\t\t\t\t\t\t<Messages\r\n\t\t\t\t\t\t\t\tchatId={$chatId}\r\n\t\t\t\t\t\t\t\tbind:history\r\n\t\t\t\t\t\t\t\tbind:autoScroll\r\n\t\t\t\t\t\t\t\tbind:prompt\r\n\t\t\t\t\t\t\t\t{selectedModels}\r\n\t\t\t\t\t\t\t\t{sendPrompt}\r\n\t\t\t\t\t\t\t\t{showMessage}\r\n\t\t\t\t\t\t\t\t{continueResponse}\r\n\t\t\t\t\t\t\t\t{regenerateResponse}\r\n\t\t\t\t\t\t\t\t{mergeResponses}\r\n\t\t\t\t\t\t\t\t{chatActionHandler}\r\n\t\t\t\t\t\t\t\tbottomPadding={files.length > 0}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"\">\r\n\t\t\t\t\t\t<MessageInput\r\n\t\t\t\t\t\t\t{history}\r\n\t\t\t\t\t\t\tbind:files\r\n\t\t\t\t\t\t\tbind:prompt\r\n\t\t\t\t\t\t\tbind:autoScroll\r\n\t\t\t\t\t\t\tbind:selectedToolIds\r\n\t\t\t\t\t\t\tbind:webSearchEnabled\r\n\t\t\t\t\t\t\tbind:atSelectedModel\r\n\t\t\t\t\t\t\t{selectedModels}\r\n\t\t\t\t\t\t\tavailableToolIds={selectedModelIds.reduce((a, e, i, arr) => {\r\n\t\t\t\t\t\t\t\tconst model = $models.find((m) => m.id === e);\r\n\t\t\t\t\t\t\t\tif (model?.info?.meta?.toolIds ?? false) {\r\n\t\t\t\t\t\t\t\t\treturn [...new Set([...a, ...model.info.meta.toolIds])];\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn a;\r\n\t\t\t\t\t\t\t}, [])}\r\n\t\t\t\t\t\t\ttransparentBackground={$settings?.backgroundImageUrl ?? false}\r\n\t\t\t\t\t\t\t{submitPrompt}\r\n\t\t\t\t\t\t\t{stopResponse}\r\n\t\t\t\t\t\t\t{createMessagePair}\r\n\t\t\t\t\t\t\ton:call={async () => {\r\n\t\t\t\t\t\t\t\tawait showControls.set(true);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</Pane>\r\n\r\n\t\t\t<ChatControls\r\n\t\t\t\tbind:history\r\n\t\t\t\tbind:chatFiles\r\n\t\t\t\tbind:params\r\n\t\t\t\tbind:files\r\n\t\t\t\tbind:pane={controlPane}\r\n\t\t\t\tchatId={$chatId}\r\n\t\t\t\tmodelId={selectedModelIds?.at(0) ?? null}\r\n\t\t\t\tmodels={selectedModelIds.reduce((a, e, i, arr) => {\r\n\t\t\t\t\tconst model = $models.find((m) => m.id === e);\r\n\t\t\t\t\tif (model) {\r\n\t\t\t\t\t\treturn [...a, model];\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn a;\r\n\t\t\t\t}, [])}\r\n\t\t\t\t{submitPrompt}\r\n\t\t\t\t{stopResponse}\r\n\t\t\t\t{showMessage}\r\n\t\t\t\t{eventTarget}\r\n\t\t\t/>\r\n\t\t</PaneGroup>\r\n\t</div>\r\n{/if}\r\n","<script lang=\"ts\">\r\n\timport { getContext } from 'svelte';\r\n\timport Modal from '../common/Modal.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let show = false;\r\n</script>\r\n\r\n<Modal bind:show>\r\n\t<div class=\"text-gray-700 dark:text-gray-100\">\r\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5 pt-4\">\r\n\t\t\t<div class=\" text-lg font-medium self-center\">{$i18n.t('Keyboard shortcuts')}</div>\r\n\t\t\t<button\r\n\t\t\t\tclass=\"self-center\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tshow = false;\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<svg\r\n\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\tviewBox=\"0 0 20 20\"\r\n\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<path\r\n\t\t\t\t\t\td=\"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</svg>\r\n\t\t\t</button>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200\">\r\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\r\n\t\t\t\t<div class=\"flex flex-col space-y-3 w-full self-start\">\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Open new chat')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCtrl/⌘\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tShift\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tO\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Focus chat input')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tShift\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tEsc\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Copy last code block')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCtrl/⌘\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tShift\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t;\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Copy last response')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCtrl/⌘\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tShift\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tC\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"flex flex-col space-y-3 w-full self-start\">\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Toggle settings')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCtrl/⌘\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t.\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Toggle sidebar')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCtrl/⌘\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tShift\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tS\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Delete chat')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCtrl/⌘\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tShift\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t⌫\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">{$i18n.t('Show shortcuts')}</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCtrl/⌘\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t/\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\" flex justify-between dark:text-gray-300 px-5\">\r\n\t\t\t<div class=\" text-lg font-medium self-center\">{$i18n.t('Input commands')}</div>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flex flex-col md:flex-row w-full p-5 md:space-x-4 dark:text-gray-200\">\r\n\t\t\t<div class=\" flex flex-col w-full sm:flex-row sm:justify-center sm:space-x-6\">\r\n\t\t\t\t<div class=\"flex flex-col space-y-3 w-full self-start\">\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">\r\n\t\t\t\t\t\t\t{$i18n.t('Attach file')}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t#\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">\r\n\t\t\t\t\t\t\t{$i18n.t('Add custom prompt')}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t/\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"w-full flex justify-between items-center\">\r\n\t\t\t\t\t\t<div class=\" text-sm\">\r\n\t\t\t\t\t\t\t{$i18n.t('Select model')}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div class=\"flex space-x-1 text-xs\">\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclass=\" h-fit py-1 px-2 flex items-center justify-center rounded border border-black/10 capitalize text-gray-600 dark:border-white/10 dark:text-gray-300\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t@\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</Modal>\r\n\r\n<style>\r\n\tinput::-webkit-outer-spin-button,\r\n\tinput::-webkit-inner-spin-button {\r\n\t\t/* display: none; <- Crashes Chrome on hover */\r\n\t\t-webkit-appearance: none;\r\n\t\tmargin: 0; /* <-- Apparently some margin are still there even though it's hidden */\r\n\t}\r\n\r\n\t.tabs::-webkit-scrollbar {\r\n\t\tdisplay: none; /* for Chrome, Safari and Opera */\r\n\t}\r\n\r\n\t.tabs {\r\n\t\t-ms-overflow-style: none; /* IE and Edge */\r\n\t\tscrollbar-width: none; /* Firefox */\r\n\t}\r\n\r\n\tinput[type='number'] {\r\n\t\t-moz-appearance: textfield; /* Firefox */\r\n\t}\r\n</style>\r\n","<script lang=\"ts\">\r\n\texport let className = 'w-4 h-4';\r\n\texport let strokeWidth = '2';\r\n</script>\r\n\r\n<svg\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"none\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tstroke=\"currentColor\"\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tstroke-linecap=\"round\"\r\n\t\tstroke-linejoin=\"round\"\r\n\t\td=\"M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\texport let className = 'size-4';\r\n\texport let strokeWidth = '2';\r\n</script>\r\n\r\n<svg\r\n\taria-hidden=\"true\"\r\n\txmlns=\"http://www.w3.org/2000/svg\"\r\n\tfill=\"currentColor\"\r\n\tviewBox=\"0 0 24 24\"\r\n\tstroke-width={strokeWidth}\r\n\tclass={className}\r\n>\r\n\t<path\r\n\t\tfill-rule=\"evenodd\"\r\n\t\td=\"M2 7a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7Zm5.01 1H5v2.01h2.01V8Zm3 0H8v2.01h2.01V8Zm3 0H11v2.01h2.01V8Zm3 0H14v2.01h2.01V8Zm3 0H17v2.01h2.01V8Zm-12 3H5v2.01h2.01V11Zm3 0H8v2.01h2.01V11Zm3 0H11v2.01h2.01V11Zm3 0H14v2.01h2.01V11Zm3 0H17v2.01h2.01V11Zm-12 3H5v2.01h2.01V14ZM8 14l-.001 2 8.011.01V14H8Zm11.01 0H17v2.01h2.01V14Z\"\r\n\t\tclip-rule=\"evenodd\"\r\n\t/>\r\n</svg>\r\n","<script lang=\"ts\">\r\n\timport { DropdownMenu } from 'bits-ui';\r\n\timport { getContext } from 'svelte';\r\n\r\n\timport { showSettings } from '$lib/stores';\r\n\timport { flyAndScale } from '$lib/utils/transitions';\r\n\r\n\timport Dropdown from '$lib/components/common/Dropdown.svelte';\r\n\timport QuestionMarkCircle from '$lib/components/icons/QuestionMarkCircle.svelte';\r\n\timport Lifebuoy from '$lib/components/icons/Lifebuoy.svelte';\r\n\timport Keyboard from '$lib/components/icons/Keyboard.svelte';\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let showDocsHandler: Function;\r\n\texport let showShortcutsHandler: Function;\r\n\r\n\texport let onClose: Function = () => {};\r\n</script>\r\n\r\n<Dropdown\r\n\ton:change={(e) => {\r\n\t\tif (e.detail === false) {\r\n\t\t\tonClose();\r\n\t\t}\r\n\t}}\r\n>\r\n\t<slot />\r\n\r\n\t<div slot=\"content\">\r\n\t\t<DropdownMenu.Content\r\n\t\t\tclass=\"w-full max-w-[200px] rounded-xl px-1 py-1.5 border border-gray-300/30 dark:border-gray-700/50 z-50 bg-white dark:bg-gray-850 dark:text-white shadow-lg\"\r\n\t\t\tsideOffset={4}\r\n\t\t\tside=\"top\"\r\n\t\t\talign=\"end\"\r\n\t\t\ttransition={flyAndScale}\r\n\t\t>\r\n\t\t\t<DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\tid=\"chat-share-button\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\twindow.open('https://docs.openwebui.com', '_blank');\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<QuestionMarkCircle className=\"size-5\" />\r\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Documentation')}</div>\r\n\t\t\t</DropdownMenu.Item>\r\n\r\n\t\t\t<DropdownMenu.Item\r\n\t\t\t\tclass=\"flex gap-2 items-center px-3 py-2 text-sm  cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800 rounded-md\"\r\n\t\t\t\tid=\"chat-share-button\"\r\n\t\t\t\ton:click={() => {\r\n\t\t\t\t\tshowShortcutsHandler();\r\n\t\t\t\t}}\r\n\t\t\t>\r\n\t\t\t\t<Keyboard className=\"size-5\" />\r\n\t\t\t\t<div class=\"flex items-center\">{$i18n.t('Keyboard shortcuts')}</div>\r\n\t\t\t</DropdownMenu.Item>\r\n\t\t</DropdownMenu.Content>\r\n\t</div>\r\n</Dropdown>\r\n","<script lang=\"ts\">\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport ShortcutsModal from '../chat/ShortcutsModal.svelte';\r\n\timport Tooltip from '../common/Tooltip.svelte';\r\n\timport HelpMenu from './Help/HelpMenu.svelte';\r\n\r\n\tlet showShortcuts = false;\r\n</script>\r\n\r\n<div class=\" hidden lg:flex fixed bottom-0 right-0 px-2 py-2 z-20\">\r\n\t<button\r\n\t\tid=\"show-shortcuts-button\"\r\n\t\tclass=\"hidden\"\r\n\t\ton:click={() => {\r\n\t\t\tshowShortcuts = !showShortcuts;\r\n\t\t}}\r\n\t/>\r\n\r\n\t<HelpMenu\r\n\t\tshowDocsHandler={() => {\r\n\t\t\tshowShortcuts = !showShortcuts;\r\n\t\t}}\r\n\t\tshowShortcutsHandler={() => {\r\n\t\t\tshowShortcuts = !showShortcuts;\r\n\t\t}}\r\n\t>\r\n\t\t<Tooltip content={$i18n.t('Help')} placement=\"left\">\r\n\t\t\t<button\r\n\t\t\t\tclass=\"text-gray-600 dark:text-gray-300 bg-gray-300/20 size-5 flex items-center justify-center text-[0.7rem] rounded-full\"\r\n\t\t\t>\r\n\t\t\t\t?\r\n\t\t\t</button>\r\n\t\t</Tooltip>\r\n\t</HelpMenu>\r\n</div>\r\n\r\n<ShortcutsModal bind:show={showShortcuts} />\r\n"],"names":["sourceEvent","event","pointer","node","svg","point","rect","nonpassive","nonpassivecapture","nopropagation","noevent$1","dragDisable","view","root","selection","select","noevent","yesdrag","noclick","constant$1","x","DragEvent","type","subject","target","identifier","active","y","dx","dy","dispatch","value","defaultFilter","defaultContainer","defaultSubject","d","defaultTouchable","drag$1","filter","container","touchable","gestures","listeners","mousedownx","mousedowny","mousemoving","touchending","clickDistance2","drag","mousedowned","touchstarted","touchmoved","touchended","gesture","beforestart","mousemoved","mouseupped","nodrag","touches","c","n","i","that","touch","p","s","p0","_","constant","epsilon2","cosh","sinh","tanh","interpolateZoom","zoomRho","rho","rho2","rho4","zoom","p1","ux0","uy0","w0","ux1","uy1","w1","d2","S","t","d1","b0","b1","r0","r1","coshr0","u","_1","_2","_4","ZoomEvent","transform","defaultExtent","e","defaultTransform","identity","defaultWheelDelta","defaultConstrain","extent","translateExtent","dx0","dx1","dy0","dy1","zoom$1","constrain","wheelDelta","scaleExtent","duration","interpolate","touchstarting","touchfirst","touchDelay","wheelDelay","tapDistance","wheeled","dblclicked","collection","schedule","k","k0","k1","t0","centroid","translate","scale","Transform","transition","args","g","w","a","b","l","clean","Gesture","key","interrupt","wheelidled","currentTarget","v","x0","y0","dragEnable","t1","started","l0","l1","dp","dl","ctx","disabled","$$props","open","onOpenChange","updateOption","ids","subOpen","setSubMenuCtx","next","$$invalidate","idValues","derived","$menuId","$triggerId","div_levels","insert_hydration","div","anchor","transitionConfig","inTransition","inTransitionConfig","outTransition","outTransitionConfig","asChild","id","side","align","sideOffset","alignOffset","collisionPadding","avoidCollisions","collisionBoundary","sameWidth","fitViewport","strategy","overlap","el","subMenu","getAttrs","getSubmenuCtx","createDispatcher","attrs","$$value","builder","$subMenu","updateSubPositioning","subTrigger","options","getSubTrigger","disabledStore","$subTrigger","disabledAttrs","$disabledStore","safeOnDestroy","fn","onDestroy","derivedWithUnsubscribe","stores","unsubscribers","onUnsubscribe","cb","unsubscribe","derivedStore","$storeValues","unsub","clientEffect","isBrowser","returned","toWritableStores","properties","result","propertyKey","writable","getOptionUpdater","store","styleToString","style","str","currentState","element","getCursorStyle","state","resetGlobalCursorStyle","setGlobalCursorStyle","computePaneFlexBoxStyle","defaultSize","dragState","layout","paneData","paneIndex","precision","size","flexGrow","calculateAriaValues","panesArray","pivotIndices","currentMinSize","currentMaxSize","totalMinSize","totalMaxSize","firstIndex","constraints","maxSize","minSize","valueMax","valueMin","valueNow","generateId","idFromProps","nanoid","LOCAL_STORAGE_DEBOUNCE_INTERVAL","PRECISION","initializeStorage","storageObject","name","err","getPaneGroupKey","autoSaveId","getPaneKey","panes","pane","idIsFromProps","order","loadSerializedPaneGroupState","storage","paneGroupKey","serialized","parsed","loadPaneGroupState","paneKey","savePaneGroupState","paneSizesBeforeCollapse","sizes","error","debounceMap","debounce","callback","durationMs","timeoutId","updateStorageValues","paneDataArrayStore","paneSizeBeforeCollapseStore","$paneDataArray","get","debouncedSave","clonedPaneDataArray","$paneSizeBeforeCollapse","clonedPaneSizesBeforeCollapse","removeUndefined","obj","chain","callbacks","addEventListener","handler","events","_event","areNumbersAlmostEqual","actual","expected","fractionDigits","compareNumbersWithTolerance","roundedActual","roundTo","roundedExpected","areArraysEqual","arrA","arrB","index","decimals","assert","expectedCondition","message","resizePane","paneConstraintsArray","initialSize","paneConstraints","collapsedSize","collapsible","newSize","getAdjustedSizeForCollapsible","halfwayPoint","adjustLayoutByDelta","delta","prevLayout","trigger","nextLayout","firstPivotIndex","secondPivotIndex","deltaApplied","prevSize","localDelta","increment","maxAvailableDelta","minAbsDelta","deltaRemaining","unsafeSize","safeSize","pivotIndex","totalSize","total","isHTMLElement","isKeyDown","isMouseEvent","isTouchEvent","defaultStorage","defaultProps","createPaneForge","props","withDefaults","direction","keyboardResizeBy","onLayout","groupId","paneDataArray","paneDataArrayChanged","paneIdToLastNotifiedSizeMap","paneSizeBeforeCollapseMap","prevDelta","$groupId","$layout","updateResizeHandleAriaValues","onMount","setResizeHandlerEventListeners","$autoSaveId","$storage","collapsePane","$prevLayout","paneSize","paneDataHelper","curr","findPaneDataIndex","$onLayout","callPaneCallbacks","getPaneSize","getPaneStyle","$dragState","isPaneExpanded","registerPane","newArr","paneA","paneB","orderA","orderB","$paneDataArrayChanged","unsafeLayout","getUnsafeDefaultLayout","validatePaneGroupLayout","registerResizeHandle","dragHandleId","$direction","$keyboardResizeBy","initialLayout","getPivotIndices","getDeltaPercentage","isHorizontal","layoutChanged","unsafePaneSize","paneConstraintsArr","startDragging","handleElement","getResizeHandleElement","initialCursorPosition","getResizeEventCursorPosition","stopDragging","unregisterPane","isPaneCollapsed","expandPane","prevPaneSize","baseSize","paneGroupStyle","paneGroupSelectors","paneGroupAttrs","$style","$selectors","unsubHandlers","getResizeHandleElementsForGroup","handle","handleId","noop","idBefore","idAfter","getResizeHandlePaneIds","unsubListener","setLayout","newLayout","getLayout","resizeHandleElements","resizeHandleEl","resizeHandleElement","getPaneGroupElement","handles","_a","_b","getResizeHandleElementIndex","prevPaneData","paneArray","paneId","lastNotifiedSize","onCollapse","onExpand","onResize","numPanesWithSizes","remainingSize","numRemainingPanes","nextLayoutTotalSize","accumulated","current","dir","initialDragState","movement","getDragOffsetPercentage","cursorPosition","groupElement","groupRect","groupSizeInPixels","firstTouch","PF_GROUP_CTX","setCtx","paneForge","ctxValue","setContext","getCtx","componentName","hasContext","getContext","onLayoutChange","paneGroup","styleFromProps","$paneGroupStyle","getSize","isCollapsed","isExpanded","$getPaneStyle","resizeHandleAction","params","update","resizeHandler","isDragging","onDragging","onMove","onMouseLeave","stopDraggingAndBlur","onDraggingChange","tabIndex","resizeHandleId","isFocused","handleKeydown","nextIndex","blur_handler","focus_handler","createParser","onParse","isFirstChunk","buffer","startingPosition","startingFieldLength","eventId","eventName","data","reset","feed","chunk","hasBom","BOM","length","position","discardTrailingNewline","lineLength","fieldLength","character","parseEventStreamLine","lineBuffer","noValue","field","step","valueLength","retry","charCode","EventSourceParserStream","parser","controller","createOpenAITextStream","responseBody","splitLargeDeltas","eventStream","iterator","openAIStreamToIterator","streamLargeDeltasAsRandomChunks","reader","done","parsedData","_c","textStreamUpdate","content","chunkSize","sleep","ms","resolve","create_if_block_1","t0_value","t3_value","if_block0","create_if_block_4","if_block1","create_if_block_3","if_block2","create_if_block_2","attr","div0","div0_class_value","div5","append_hydration","div3","div1","div2","div4","dirty","set_data","t3","div5_transition","create_bidirectional_transition","fade","button","create_if_block","createEventDispatcher","banner","dismissed","mounted","classNames","dismiss","path0","path1","className","path","hr","each_blocks","t_value","tooltip_changes","t1_value","show_if","flyAndScale","i18n","uploadFilesHandler","selectedToolIds","webSearchEnabled","tools","onClose","show","toolId","strokeWidth","set_style","t2_value","div6","t2","VISUALIZER_BUFFER_LENGTH","recording","loading","confirmed","durationSeconds","durationCounter","transcription","startDurationCounter","stopDurationCounter","formatSeconds","seconds","minutes","remainingSeconds","formattedSeconds","stream","speechRecognition","mediaRecorder","audioChunks","MIN_DECIBELS","visualizerData","calculateRMS","sumSquares","normalizedValue","normalizeRMS","rms","scaledRMS","analyseAudio","audioContext","audioStreamSource","analyser","bufferLength","domainData","timeDomainData","processFrame","rmsLevel","transcribeHandler","audioBlob","tick","file","blobToFile","res","transcribeAudio","toast","startRecording","$settings","$config","inactivityTimeout","transcript","confirmRecording","$i18n","stopRecording","track","overlayElement","div8","div7","t4","t4_value","button_class_value","files","prompt","command","selectedPromptIdx","filteredPrompts","selectUp","selectDown","confirmPrompt","text","clipboardText","clipboardItems","imageUrl","item","blob","location","getUserPosition","language","date","getFormattedDate","time","getFormattedTime","dateTime","getCurrentDateTime","timezone","getUserTimezone","weekday","getWeekday","chatInputElement","words","findWordIndices","word","promptIdx","$prompts","func","show_if_1","t6_value","t6","selectedIdx","filteredItems","filteredDocs","collections","findByName","confirmSelect","doc","removeLastWordFromString","confirmSelectWeb","url","confirmSelectYoutube","docIdx","isValidHttpUrl","$documents","arr","tag","filteredCollections","src_url_equal","img","img_src_value","img_alt_value","_d","filteredModels","model","modelIdx","$models","show_if_2","commandElement","uploadWeb","uploadWebToVectorDB","f","uploadYoutubeTranscription","uploadYoutubeTranscriptionToVectorDB","WEBUI_BASE_URL","span","textarea","textarea_placeholder_value","form","inputmenu_changes","fileitem_changes","create_if_block_6","button_disabled_value","create_if_block_8","create_if_block_7","input","transparentBackground","submitPrompt","createMessagePair","stopResponse","autoScroll","atSelectedModel","selectedModels","chatTextAreaElement","filesInputElement","commandsElement","inputFiles","dragged","user","history","availableToolIds","visionCapableModels","scrollToBottom","uploadFileHandler","fileItem","uploadedFile","uploadFile","WEBUI_API_BASE_URL","SUPPORTED_FILE_TYPE","SUPPORTED_FILE_EXTENSIONS","processFileItem","processDocToVectorDB","inputFilesHandler","dropZone","handleKeyDown","onDragOver","onDragLeave","onDrop","_inputFiles","response","func_1","fileIdx","func_2","$_user","$mobile","isCtrlPressed","commandsContainerElement","regenerateButton","userMessageElement","editButton","commandOptionButton","fullPrompt","clipboardData","showCallOverlay","m","selector_changes","showSetDefault","saveDefaultModel","it","settings","updateUserSettings","selectedModelIdx","tags","Tags","tags_changes","saveAs","fileSaver","shareEnabled","shareHandler","downloadHandler","chat","getChatAsText","_chat","createMessagesList","downloadTxt","chatText","downloadPdf","messages","downloadChatAsPDF","downloadJSONExport","showControls","showOverview","copyToClipboard","usermenu_changes","if_block3","nav","initNewChat","title","$WEBUI_NAME","showModelSelector","showShareChatModal","showDownloadChatModal","showSidebar","$showSidebar","$showControls","showArchivedChats","cc","names","out","tmp","errorMessages","nodeType","handleType","sourceHandle","targetHandle","edgeType","lib","infiniteExtent","ConnectionMode","PanOnScrollMode","SelectionMode","initialConnection","ConnectionLineType","MarkerType","Position","oppositePosition","areConnectionMapsEqual","handleConnectionChange","diff","connection","getConnectionStatus","isValid","isEdgeBase","isNodeBase","isInternalNodeBase","getNodePositionWithOrigin","nodeOrigin","width","height","getNodeDimensions","origin","offsetX","offsetY","getNodesBounds","nodes","box","currBox","nodeOrId","isId","currentNode","nodeBox","nodeToBox","getBoundsOfBoxes","boxToRect","getInternalNodesBounds","nodeLookup","getNodesInside","tx","ty","tScale","partially","excludeNonSelectableNodes","paneRect","pointToRendererPoint","visibleNodes","measured","selectable","hidden","overlappingArea","getOverlappingArea","nodeToRect","area","partiallyVisible","getConnectedEdges","edges","nodeIds","edge","getFitViewNodes","fitViewNodes","optionNodeIds","fitView","panZoom","minZoom","maxZoom","bounds","viewport","getViewportForBounds","calculateNodePosition","nodeId","nextPosition","nodeExtent","onError","parentNode","parentX","parentY","parentWidth","parentHeight","isCoordinateExtent","positionAbsolute","clampPosition","getElementsToRemove","nodesToRemove","edgesToRemove","onBeforeDelete","matchingNodes","isIncluded","parentHit","edgeIds","deletableEdges","matchingEdges","onBeforeDeleteResult","clamp","val","min","max","dimensions","clampPositionToParent","childPosition","childDimensions","parent","calcAutoPanVelocity","calcAutoPan","pos","speed","distance","xMovement","yMovement","box1","box2","rectToBox","x2","y2","getBoundsOfRects","rect1","rect2","rectA","rectB","xOverlap","yOverlap","isRectObject","isNumeric","devWarn","snapPosition","snapGrid","snapToGrid","rendererPointToPoint","padding","xZoom","yZoom","clampedZoom","boundsCenterX","boundsCenterY","isMacOs","nodeHasDimensions","evaluateAbsolutePosition","parentId","nextParentId","getPointerPosition","getEventPosition","pointerPos","xSnapped","ySnapped","getDimensions","getHostForElement","inputTags","isInputDOMNode","isMouse","evtX","evtY","getHandleBounds","nodeElement","nodeBounds","handleBounds","getBezierEdgeCenter","sourceX","sourceY","targetX","targetY","sourceControlX","sourceControlY","targetControlX","targetControlY","centerX","centerY","calculateControlOffset","curvature","getControlWithCurvature","x1","y1","getBezierPath","sourcePosition","targetPosition","labelX","labelY","getEdgeCenter","xOffset","yOffset","getElevatedEdgeZIndex","sourceNode","targetNode","selected","zIndex","elevateOnSelect","edgeOrConnectedNodeSelected","selectedZIndex","isEdgeVisible","edgeBox","viewRect","getEdgeId","source","connectionExists","addEdge","edgeParams","getStraightPath","handleDirections","getDirection","getPoints","center","offset","sourceDir","targetDir","sourceGapped","targetGapped","dirAccessor","currDir","points","sourceGapOffset","targetGapOffset","defaultCenterX","defaultCenterY","defaultOffsetX","defaultOffsetY","verticalSplit","horizontalSplit","sourceTarget","targetSource","gapOffset","dirAccessorOpposite","isSameDir","sourceGtTargetOppo","sourceLtTargetOppo","sourceGapPoint","targetGapPoint","maxXDistance","maxYDistance","getBend","bendSize","xDir","yDir","getSmoothStepPath","borderRadius","segment","isNodeInitialized","getEdgePosition","sourceHandleBounds","toHandleBounds","targetHandleBounds","getHandle$1","getHandlePosition","fallbackPosition","getMarkerId","marker","createMarkerIds","defaultColor","defaultMarkerStart","defaultMarkerEnd","markers","markerId","defaultOptions","adoptUserNodesDefaultOptions","mergeObjects","base","incoming","adoptUserNodes","parentLookup","_options","tmpLookup","selectedNodeZ","userNode","internalNode","positionWithOrigin","clampedPosition","calculateZ","updateChildNode","updateParentLookup","childNodes","elevateNodesOnSelect","z","calculateChildXYZ","positionChanged","childNode","absolutePosition","childZ","parentZ","handleExpandParent","children","changes","parentExpansions","child","parentRect","expandedRect","xChange","yChange","newWidth","newHeight","widthChange","heightChange","updateNodeInternals","updates","domNode","viewportNode","updatedInternals","parentExpandChildren","dimensionChanged","parentExpandChanges","panBy","nextViewport","transformChanged","updateConnectionLookup","connectionLookup","edgeLookup","sourceKey","targetKey","prevSource","prevTarget","isParentSelected","hasSelector","selector","getDragItems","nodesDraggable","mousePos","dragItems","getEventHandlerParams","dragging","nodesFromDragItems","dragItem","XYDrag","onNodeMouseDown","getStoreItems","onDragStart","onDrag","onDragStop","lastPos","autoPanId","autoPanStarted","mousePosition","containerBounds","dragStarted","d3Selection","abortDrag","noDragClassName","handleSelector","isSelectable","nodeClickDistance","updateNodes","dragEvent","onNodeDrag","onSelectionDrag","updateNodePositions","hasChange","nodesBox","adjustedNodeExtent","currentNodes","autoPan","autoPanSpeed","startDrag","multiSelectionActive","selectNodesOnDrag","onNodeDragStart","onSelectionDragStart","unselectNodesAndEdges","d3DragInstance","nodeDragThreshold","autoPanOnNodeDrag","onNodeDragStop","onSelectionDragStop","destroy","getNodesWithinDistance","ADDITIONAL_DISTANCE","getClosestHandle","connectionRadius","fromHandle","closestHandles","minDistance","closeNodes","allHandles","oppositeHandleType","getHandle","connectionMode","withAbsolutePosition","getHandleType","edgeUpdaterType","handleDomNode","isConnectionValid","isInsideConnectionRadius","isHandleValid","alwaysValid","onPointerDown","isTarget","autoPanOnConnect","flowId","cancelConnection","onConnectStart","onConnect","onConnectEnd","isValidConnection","onReconnectEnd","updateConnection","getTransform","getFromHandle","closestHandle","clickedHandle","fromHandleInternal","fromNodeInternal","newConnection","previousConnection","onPointerMove","onPointerUp","isValidHandle","inProgress","connectionState","finalConnectionState","fromNodeId","fromHandleId","fromType","handleBelow","handleToCheck","handleNodeId","connectable","connectableEnd","XYHandle","viewChanged","prevViewport","eventViewport","transformToViewport","viewportToTransform","zoomIdentity","isWrappedWithClass","isRightClickPan","panOnDrag","usedButton","getD3Transition","onEnd","hasDuration","factor","createPanOnScrollHandler","zoomPanValues","noWheelClassName","d3Zoom","panOnScrollMode","panOnScrollSpeed","zoomOnPinch","onPanZoomStart","onPanZoom","onPanZoomEnd","currentZoom","pinchDelta","deltaNormalize","deltaX","deltaY","createZoomOnScrollHandler","preventScrolling","d3ZoomHandler","createPanZoomStartHandler","createPanZoomHandler","onPaneContextMenu","onTransformChange","createPanZoomEndHandler","panOnScroll","createFilter","zoomActivationKeyPressed","zoomOnScroll","zoomOnDoubleClick","userSelectionActive","noPanClassName","zoomScroll","pinchZoom","buttonAllowed","XYPanZoom","paneClickDistance","bbox","d3ZoomInstance","setViewportConstrained","d3DblClickZoomHandler","setTransform","wheelHandler","startHandler","panZoomHandler","panZoomEndHandler","nextTransform","contrainedTransform","setViewport","syncViewport","currentTransform","getViewport","zoomTransform","scaleTo","scaleBy","setScaleExtent","setTranslateExtent","setClickDistance","validDistance","ResizeControlVariant","div_data_id_value","onconnect","ondisconnect","isConnectableProp","useStore","isValidConnectionStore","onedgecreate","onConnectAction","onConnectStartAction","onConnectEndAction","isMouseTriggered","$connectionRadius","$domNode","$nodeLookup","$connectionMode","$lib","$autoPanOnConnect","$flowId","$isValidConnectionStore","$onedgecreate","$onConnectAction","startParams","$onConnectStartAction","$onConnectEndAction","$viewport","$connection","prevConnections","connections","isConnectable","$connectable","$connectionLookup","_connections","connectionInProcess","connectingFrom","connectingTo","_e","_f","isPossibleEndHandle","_g","_h","_i","valid","tryToMount","targetEl","portal","useHandleEdgeSelect","selectionRect","selectionRectMode","multiselectionKeyPressed","addSelectedEdges","elementsSelectable","style_transform","div_style_value","style_changed","handleEdgeSelect","path_1","label","labelStyle","markerStart","markerEnd","interactionWidth","interactionWidthValue","syncNodeStores","nodesStore","userNodesStore","nodesStoreSetter","userNodesStoreSetter","currentNodesStore","currentUserNodesStore","_set","nds","updatedNodes","syncEdgeStores","edgesStore","userEdgesStore","userEdgesStoreSetter","eds","syncViewportStores","panZoomStore","viewportStore","userViewportStore","viewportStoreSetter","userViewportStoreSetter","vp","createNodesStore","subscribe","set","defaults","_update","setDefaultOptions","setOptions","createEdgesStore","nextEdges","initialNodeTypes","InputNode","OutputNode","DefaultNode","GroupNode","initialEdgeTypes","StraightEdgeInternal","SmoothStepEdgeInternal","BezierEdgeInternal","StepEdgeInternal","getInitialStore","storeNodeOrigin","storeNodeExtent","readable","getVisibleEdges","visibleEdges","onlyRenderVisibleElements","onerror","edgePosition","getVisibleNodes","createStore","fitViewOnCreate","setNodeTypes","nodeTypes","setEdgeTypes","edgeTypes","addEdgeUtil","nodeDragItems","updateNodeInternalsSystem","fitViewOptions","fitViewOnInitDone","fitViewSync","change","fitViewSystem","zoomBy","zoomIn","zoomOut","setMinZoom","setMaxZoom","resetSelectedElements","elements","elementsChanged","setPaneClickDistance","deleteKeyPressed","selectedNodes","selectedEdges","mN","mE","addSelectedNodes","isMultiSelection","ns","nodeWillBeSelected","es","edgeWillBeSelected","handleNodeSelection","panBySystem","_connection","initialized","initialNodesLength","initialEdgesLength","nodesInitialized","edgesInitialized","viewportInitialized","createStoreContext","initialViewport","panZoomInstance","currentViewport","onMoveStart","onMoveEnd","panActivationKeyPressed","set_store_value","$viewportInitialized","viewPort","_panOnDrag","$panActivationKeyPressed","_panOnScroll","toggle_class","wrapHandler","toggleSelected","isSelected","selectionOnDrag","selectionKeyPressed","selectionMode","selectionInProgress","onClick","isSelecting","$selectionRect","startX","startY","nextUserSelectRect","prevSelectedNodeIds","prevSelectedEdgeIds","$edges","$selectionMode","selectedEdgeIds","selectedNodeIds","$selectionRectMode","$selectionKeyPressed","onContextMenu","hasActiveSelection","$elementsSelectable","dragInstance","updateDrag","getNodeInlineStyleDimensions","initialWidth","initialHeight","measuredWidth","measuredHeight","styleWidth","styleHeight","draggable","deletable","resizeObserver","isParent","positionX","positionY","dragHandle","nodeRef","prevNodeRef","dispatchNodeEvent","connectableStore","prevType","prevSourcePosition","prevTargetPosition","onSelectNodeHandler","drag_function","drag_function_1","drag_function_2","mouseenter_handler","mouseleave_handler","mousemove_handler","contextmenu_handler","nodeTypeValid","$nodeTypes","nodeComponent","inlineStyleDimensions","nodewrapper_changes","get_key","nodesConnectable","entries","entry","g_aria_label_value","switch_instance_changes","animated","ariaLabel","$edgeLookup","onMouseEvent","edgeComponent","$edgeTypes","markerStartUrl","markerEndUrl","_onMount","_onDestroy","defs","polyline","markerUnits","orient","color","edgewrapper_changes","defaultEdgeOptions","$edgesInitialized","isVisible","selection_changes","$nodes","__","shortcut","param","enabled","normalizedTriggers","modifiedMap","mergedTrigger","modifier","preventDefault","triggerEnabled","def","detail","newEnabled","newType","getShortcutTrigger","isKeyObject","getModifier","getKeyString","_key","keyString","selectionKey","multiSelectionKey","deleteKey","panActivationKey","zoomActivationKey","resetKeysAndSelection","if_block","containerStyle","isCustomComponent","connectionLineType","from","to","fromPosition","toPosition","pathParams","$connectionLineType","div_class_value","positionClasses","proOptions","updateStore","getKeys","updateStoreByKeys","keys","prop","getMediaQuery","useColorModeClass","colorMode","mediaQuery","updateColorModeClass","connectionline_changes","pane_changes","zoom_changes","connectionLineStyle","connectionLineContainerStyle","ondelete","attributionPosition","onconnectstart","onconnectend","onbeforedelete","oninit","defaultMarkerColor","clientWidth","clientHeight","initViewport","onInitCalled","$initialized","$$subscribe_colorModeClass","colorModeClass","initialNodes","initialEdges","bgColor","bgColorHover","colorHover","borderColor","panel_changes","showZoom","showFitView","showLock","buttonBgColor","buttonBgColorHover","buttonColor","buttonColorHover","buttonBorderColor","orientation","buttonProps","onZoomInHandler","onZoomOutHandler","onFitViewHandler","onToggleInteractivity","isInteractive","$nodesDraggable","$nodesConnectable","minZoomReached","$minZoom","maxZoomReached","$maxZoom","orientationClass","BackgroundVariant","circle","circle_class_value","radius","path_d_value","lineWidth","variant","dotpattern_changes","pattern","pattern_x_value","pattern_y_value","pattern_width_value","pattern_height_value","pattern_patternTransform_value","gap","patternColor","patternClass","patternSize","isDots","isCross","gapXY","patternId","scaledGap","scaledSize","patternDimensions","patternOffset","isNode","useSvelteFlow","getNodeRect","nodeToUse","nodeWithPosition","updateNode","nodeUpdate","nextNode","getInternalNode","getElements","zoomLevel","currentPanZoom","nextZoom","nodeOrRect","nodesToIntersect","isRect","nodeRect","currNodeRect","_domNode","_snapGrid","domX","domY","correctedPosition","rendererPosition","dataUpdate","nextData","_nodeLookup","_nodeOrigin","lookup","useNodesInitialized","option","option_value_value","add_render_callback","select0","select1","option0","option1","tab","selectedId","valvesSpec","valves","debounceTimer","debounceSubmitHandler","submitHandler","getUserValves","getToolUserValvesById","getToolUserValvesSpecById","getFunctionUserValvesById","getFunctionUserValvesSpecById","property","updateToolUserValvesById","updateFunctionUserValvesById","select_value","set_input_value","hr0","hr1","models","chatFiles","devices","device","button0","button1","create_if_block_9","circle0","circle1","circle2","video","canvas","create_if_block_5","eventTarget","chatId","modelId","wakeLock","assistantSpeaking","emoji","camera","cameraStream","chatStreaming","hasStartedSpeaking","audioStream","videoInputDevices","selectedVideoInputDeviceId","getVideoInputDevices","startCamera","startVideoStream","stopVideoStream","takeScreenshot","context","dataURL","stopCamera","_responses","stopRecordingCallback","_continue","$showCallOverlay","_audioChunks","stopAudioStream","lastSoundTime","stopAllAudio","finishedMessages","currentMessageId","currentUtterance","speakSpeechSynthesisHandler","voices","getVoicesLoop","voice","r","playAudio","audio","audioElement","audioAbortController","audioCache","emojiCache","fetchAudio","generateEmoji","synthesizeOpenAISpeech","blobUrl","monitorAndPlayAudio","signal","chatStartHandler","chatEventHandler","chatFinishHandler","setWakeLock","div1_intro","create_in_transition","fly","modalElement","isTopModal","modals","_j","_l","_k","profileimagebase_changes","nodeclick_handler","selectedMessageId","CustomNode","focusNode","drawFlow","nodeList","edgeList","positionMap","layerWidths","level","$user","recurseCheckChild","currentId","showMessage","largeScreen","handleMediaQuery","navbar_changes","each_value","ensure_array_like","messageinput_changes","chatcontrols_changes","chatIdProp","loaded","controlPane","stopResponseFlag","messagesContainerElement","showEventConfirmation","eventConfirmationTitle","eventConfirmationMessage","eventConfirmationInput","eventConfirmationInputPlaceholder","eventConfirmationInputValue","eventCallback","chatIdUnsubscriber","selectedModelIds","_chatId","$chatId","_messageId","messageChildrenIds","messageElement","saveChatHandler","continueButton","onMessageHandler","inputElement","$socket","$temporaryChatEnabled","goto","chatInput","chats","$page","chatTitle","userSettings","getUserSettings","loadChat","getChatById","getTags","chatContent","convertMessagesToHistory","responseMessageId","chatCompletedHandler","mermaid","chatCompleted","updateChatById","currentChatPage","getChatList","$currentChatPage","chatActionHandler","actionId","chatAction","getChatEventEmitter","userPrompt","parentMessage","userMessageId","uuidv4","userMessage","responseMessage","initChatHandler","_raw","_files","array","sendPrompt","newChat","responseMessageIds","_modelIdx","userContext","queryMemory","acc","createdAtTimestamp","createdAtDate","chatEventEmitter","getWebSearchResults","_response","sendPromptOpenAI","sendPromptOllama","messagesBody","promptTemplate","getAndUpdateUserLocation","baseMessage","imageUrls","lastImageIndex","generateChatCompletion","token","splitStream","lines","line","status","messageContentParts","getMessageContentParts","notification","_m","lastMessageContentPart","_p","_o","_n","generateChatTitle","setChatTitle","generateOpenAIChatCompletion","idx","textStream","citations","usage","handleOpenAIError","_r","_q","_s","_v","_u","_t","errorMessage","innerError","regenerateResponse","continueResponse","mergeResponses","messageId","responses","mergedResponse","generateMoACompletion","generateTitle","searchQuery","generateSearchQuery","results","runWebSearch","getTagsById","createNewChat","bannerId","$banners","div68","div50","div49","div25","div12","div11","div18","div13","div17","div24","div19","div23","div48","div30","div26","div29","div36","div31","div35","div42","div37","div41","div47","div43","div46","div52","div51","div67","div66","div65","div56","div53","div55","div60","div57","div59","div64","div61","div63","t11","t11_value","t17","t17_value","t25","t25_value","t33","t33_value","t39","t39_value","t47","t47_value","t55","t55_value","t61","t61_value","t63","t63_value","t67","t67_value","t71","t71_value","showDocsHandler","showShortcutsHandler","showShortcuts"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116]}