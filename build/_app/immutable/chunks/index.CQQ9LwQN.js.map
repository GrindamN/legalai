{"version":3,"file":"index.CQQ9LwQN.js","sources":["../../../../../../src/lib/apis/documents/index.ts"],"sourcesContent":["import { WEBUI_API_BASE_URL } from '$lib/constants';\r\n\r\nexport const createNewDoc = async (\r\n\ttoken: string,\r\n\tcollection_name: string,\r\n\tfilename: string,\r\n\tname: string,\r\n\ttitle: string,\r\n\tcontent: object | null = null\r\n) => {\r\n\tlet error = null;\r\n\r\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/documents/create`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAccept: 'application/json',\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tauthorization: `Bearer ${token}`\r\n\t\t},\r\n\t\tbody: JSON.stringify({\r\n\t\t\tcollection_name: collection_name,\r\n\t\t\tfilename: filename,\r\n\t\t\tname: name,\r\n\t\t\ttitle: title,\r\n\t\t\t...(content ? { content: JSON.stringify(content) } : {})\r\n\t\t})\r\n\t})\r\n\t\t.then(async (res) => {\r\n\t\t\tif (!res.ok) throw await res.json();\r\n\t\t\treturn res.json();\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\terror = err.detail;\r\n\t\t\tconsole.log(err);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\tif (error) {\r\n\t\tthrow error;\r\n\t}\r\n\r\n\treturn res;\r\n};\r\n\r\nexport const getDocs = async (token: string = '') => {\r\n\tlet error = null;\r\n\r\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/documents/`, {\r\n\t\tmethod: 'GET',\r\n\t\theaders: {\r\n\t\t\tAccept: 'application/json',\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tauthorization: `Bearer ${token}`\r\n\t\t}\r\n\t})\r\n\t\t.then(async (res) => {\r\n\t\t\tif (!res.ok) throw await res.json();\r\n\t\t\treturn res.json();\r\n\t\t})\r\n\t\t.then((json) => {\r\n\t\t\treturn json;\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\terror = err.detail;\r\n\t\t\tconsole.log(err);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\tif (error) {\r\n\t\tthrow error;\r\n\t}\r\n\r\n\treturn res;\r\n};\r\n\r\nexport const getDocByName = async (token: string, name: string) => {\r\n\tlet error = null;\r\n\r\n\tconst searchParams = new URLSearchParams();\r\n\tsearchParams.append('name', name);\r\n\r\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/documents/docs?${searchParams.toString()}`, {\r\n\t\tmethod: 'GET',\r\n\t\theaders: {\r\n\t\t\tAccept: 'application/json',\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tauthorization: `Bearer ${token}`\r\n\t\t}\r\n\t})\r\n\t\t.then(async (res) => {\r\n\t\t\tif (!res.ok) throw await res.json();\r\n\t\t\treturn res.json();\r\n\t\t})\r\n\t\t.then((json) => {\r\n\t\t\treturn json;\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\terror = err.detail;\r\n\r\n\t\t\tconsole.log(err);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\tif (error) {\r\n\t\tthrow error;\r\n\t}\r\n\r\n\treturn res;\r\n};\r\n\r\ntype DocUpdateForm = {\r\n\tname: string;\r\n\ttitle: string;\r\n};\r\n\r\nexport const updateDocByName = async (token: string, name: string, form: DocUpdateForm) => {\r\n\tlet error = null;\r\n\r\n\tconst searchParams = new URLSearchParams();\r\n\tsearchParams.append('name', name);\r\n\r\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/documents/doc/update?${searchParams.toString()}`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAccept: 'application/json',\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tauthorization: `Bearer ${token}`\r\n\t\t},\r\n\t\tbody: JSON.stringify({\r\n\t\t\tname: form.name,\r\n\t\t\ttitle: form.title\r\n\t\t})\r\n\t})\r\n\t\t.then(async (res) => {\r\n\t\t\tif (!res.ok) throw await res.json();\r\n\t\t\treturn res.json();\r\n\t\t})\r\n\t\t.then((json) => {\r\n\t\t\treturn json;\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\terror = err.detail;\r\n\r\n\t\t\tconsole.log(err);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\tif (error) {\r\n\t\tthrow error;\r\n\t}\r\n\r\n\treturn res;\r\n};\r\n\r\ntype TagDocForm = {\r\n\tname: string;\r\n\ttags: string[];\r\n};\r\n\r\nexport const tagDocByName = async (token: string, name: string, form: TagDocForm) => {\r\n\tlet error = null;\r\n\r\n\tconst searchParams = new URLSearchParams();\r\n\tsearchParams.append('name', name);\r\n\r\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/documents/doc/tags?${searchParams.toString()}`, {\r\n\t\tmethod: 'POST',\r\n\t\theaders: {\r\n\t\t\tAccept: 'application/json',\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tauthorization: `Bearer ${token}`\r\n\t\t},\r\n\t\tbody: JSON.stringify({\r\n\t\t\tname: form.name,\r\n\t\t\ttags: form.tags\r\n\t\t})\r\n\t})\r\n\t\t.then(async (res) => {\r\n\t\t\tif (!res.ok) throw await res.json();\r\n\t\t\treturn res.json();\r\n\t\t})\r\n\t\t.then((json) => {\r\n\t\t\treturn json;\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\terror = err.detail;\r\n\r\n\t\t\tconsole.log(err);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\tif (error) {\r\n\t\tthrow error;\r\n\t}\r\n\r\n\treturn res;\r\n};\r\n\r\nexport const deleteDocByName = async (token: string, name: string) => {\r\n\tlet error = null;\r\n\r\n\tconst searchParams = new URLSearchParams();\r\n\tsearchParams.append('name', name);\r\n\r\n\tconst res = await fetch(`${WEBUI_API_BASE_URL}/documents/doc/delete?${searchParams.toString()}`, {\r\n\t\tmethod: 'DELETE',\r\n\t\theaders: {\r\n\t\t\tAccept: 'application/json',\r\n\t\t\t'Content-Type': 'application/json',\r\n\t\t\tauthorization: `Bearer ${token}`\r\n\t\t}\r\n\t})\r\n\t\t.then(async (res) => {\r\n\t\t\tif (!res.ok) throw await res.json();\r\n\t\t\treturn res.json();\r\n\t\t})\r\n\t\t.then((json) => {\r\n\t\t\treturn json;\r\n\t\t})\r\n\t\t.catch((err) => {\r\n\t\t\terror = err.detail;\r\n\r\n\t\t\tconsole.log(err);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\tif (error) {\r\n\t\tthrow error;\r\n\t}\r\n\r\n\treturn res;\r\n};\r\n"],"names":["createNewDoc","token","collection_name","filename","name","title","content","error","res","WEBUI_API_BASE_URL","err","getDocs","json","updateDocByName","form","searchParams","tagDocByName","deleteDocByName"],"mappings":"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"}