{"version":3,"file":"10.CH28w1VP.js","sources":["../../../../../../src/lib/components/playground/ChatCompletion.svelte","../../../../../../src/lib/components/playground/Playground.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n\timport { onMount, getContext } from 'svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\texport let messages = [];\r\n\tlet textAreaElement: HTMLTextAreaElement;\r\n\tonMount(() => {\r\n\t\tmessages.forEach((message, idx) => {\r\n\t\t\ttextAreaElement.style.height = '';\r\n\t\t\ttextAreaElement.style.height = textAreaElement.scrollHeight + 'px';\r\n\t\t});\r\n\t});\r\n</script>\r\n\r\n<div class=\"py-3 space-y-3\">\r\n\t{#each messages as message, idx}\r\n\t\t<div class=\"flex gap-2 group\">\r\n\t\t\t<div class=\"flex items-start pt-1\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\"px-2 py-1 text-sm font-semibold uppercase min-w-[6rem] text-left dark:group-hover:bg-gray-800 rounded-lg transition\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tmessage.role = message.role === 'user' ? 'assistant' : 'user';\r\n\t\t\t\t\t}}>{$i18n.t(message.role)}</button\r\n\t\t\t\t>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"flex-1\">\r\n\t\t\t\t<!-- $i18n.t('a user') -->\r\n\t\t\t\t<!-- $i18n.t('an assistant') -->\r\n\t\t\t\t<textarea\r\n\t\t\t\t\tid=\"{message.role}-{idx}-textarea\"\r\n\t\t\t\t\tbind:this={textAreaElement}\r\n\t\t\t\t\tclass=\"w-full bg-transparent outline-none rounded-lg p-2 text-sm resize-none overflow-hidden\"\r\n\t\t\t\t\tplaceholder={$i18n.t(`Enter {{role}} message here`, {\r\n\t\t\t\t\t\trole: message.role === 'user' ? $i18n.t('a user') : $i18n.t('an assistant')\r\n\t\t\t\t\t})}\r\n\t\t\t\t\trows=\"1\"\r\n\t\t\t\t\ton:input={(e) => {\r\n\t\t\t\t\t\ttextAreaElement.style.height = '';\r\n\t\t\t\t\t\ttextAreaElement.style.height = textAreaElement.scrollHeight + 'px';\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ton:focus={(e) => {\r\n\t\t\t\t\t\ttextAreaElement.style.height = '';\r\n\t\t\t\t\t\ttextAreaElement.style.height = textAreaElement.scrollHeight + 'px';\r\n\r\n\t\t\t\t\t\t// e.target.style.height = Math.min(e.target.scrollHeight, 200) + 'px';\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tbind:value={message.content}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\" pt-1\">\r\n\t\t\t\t<button\r\n\t\t\t\t\tclass=\" group-hover:text-gray-500 dark:text-gray-900 dark:hover:text-gray-300 transition\"\r\n\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\tmessages = messages.filter((message, messageIdx) => messageIdx !== idx);\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<svg\r\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\tstroke-width=\"2\"\r\n\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\td=\"M15 12H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</svg>\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t\t<hr class=\" dark:border-gray-800\" />\r\n\t{/each}\r\n\r\n\t<button\r\n\t\tclass=\"flex items-center gap-2 px-2 py-1\"\r\n\t\ton:click={() => {\r\n\t\t\tconsole.log(messages.at(-1));\r\n\t\t\tmessages.push({\r\n\t\t\t\trole: (messages.at(-1)?.role ?? 'assistant') === 'user' ? 'assistant' : 'user',\r\n\t\t\t\tcontent: ''\r\n\t\t\t});\r\n\t\t\tmessages = messages;\r\n\t\t}}\r\n\t>\r\n\t\t<div>\r\n\t\t\t<svg\r\n\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\tfill=\"none\"\r\n\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\tclass=\"w-5 h-5\"\r\n\t\t\t>\r\n\t\t\t\t<path\r\n\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\td=\"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z\"\r\n\t\t\t\t/>\r\n\t\t\t</svg>\r\n\t\t</div>\r\n\r\n\t\t<div class=\" text-sm font-medium\">{$i18n.t('Add message')}</div>\r\n\t</button>\r\n</div>\r\n","<script lang=\"ts\">\r\n\timport { goto } from '$app/navigation';\r\n\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\r\n\timport { toast } from 'svelte-sonner';\r\n\r\n\timport { OLLAMA_API_BASE_URL, OPENAI_API_BASE_URL, WEBUI_API_BASE_URL } from '$lib/constants';\r\n\timport { WEBUI_NAME, config, user, models, settings } from '$lib/stores';\r\n\r\n\timport { generateChatCompletion } from '$lib/apis/ollama';\r\n\timport { generateOpenAIChatCompletion } from '$lib/apis/openai';\r\n\r\n\timport { splitStream } from '$lib/utils';\r\n\timport ChatCompletion from '$lib/components/playground/ChatCompletion.svelte';\r\n\timport Selector from '$lib/components/chat/ModelSelector/Selector.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tlet mode = 'chat';\r\n\tlet loaded = false;\r\n\tlet text = '';\r\n\r\n\tlet selectedModelId = '';\r\n\r\n\tlet loading = false;\r\n\tlet stopResponseFlag = false;\r\n\r\n\tlet messagesContainerElement: HTMLDivElement;\r\n\tlet textCompletionAreaElement: HTMLTextAreaElement;\r\n\r\n\tlet system = '';\r\n\tlet messages = [\r\n\t\t{\r\n\t\t\trole: 'user',\r\n\t\t\tcontent: ''\r\n\t\t}\r\n\t];\r\n\r\n\tconst scrollToBottom = () => {\r\n\t\tconst element = mode === 'chat' ? messagesContainerElement : textCompletionAreaElement;\r\n\r\n\t\tif (element) {\r\n\t\t\telement.scrollTop = element?.scrollHeight;\r\n\t\t}\r\n\t};\r\n\r\n\tconst stopResponse = () => {\r\n\t\tstopResponseFlag = true;\r\n\t\tconsole.log('stopResponse');\r\n\t};\r\n\r\n\tconst textCompletionHandler = async () => {\r\n\t\tconst model = $models.find((model) => model.id === selectedModelId);\r\n\r\n\t\tconst [res, controller] = await generateOpenAIChatCompletion(\r\n\t\t\tlocalStorage.token,\r\n\t\t\t{\r\n\t\t\t\tmodel: model.id,\r\n\t\t\t\tstream: true,\r\n\t\t\t\tmessages: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\trole: 'assistant',\r\n\t\t\t\t\t\tcontent: text\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t},\r\n\t\t\tmodel?.owned_by === 'openai' ? `${OPENAI_API_BASE_URL}` : `${OLLAMA_API_BASE_URL}/v1`\r\n\t\t);\r\n\r\n\t\tif (res && res.ok) {\r\n\t\t\tconst reader = res.body\r\n\t\t\t\t.pipeThrough(new TextDecoderStream())\r\n\t\t\t\t.pipeThrough(splitStream('\\n'))\r\n\t\t\t\t.getReader();\r\n\r\n\t\t\twhile (true) {\r\n\t\t\t\tconst { value, done } = await reader.read();\r\n\t\t\t\tif (done || stopResponseFlag) {\r\n\t\t\t\t\tif (stopResponseFlag) {\r\n\t\t\t\t\t\tcontroller.abort('User: Stop Response');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet lines = value.split('\\n');\r\n\r\n\t\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\t\tif (line !== '') {\r\n\t\t\t\t\t\t\tif (line === 'data: [DONE]') {\r\n\t\t\t\t\t\t\t\t// responseMessage.done = true;\r\n\t\t\t\t\t\t\t\tconsole.log('done');\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tlet data = JSON.parse(line.replace(/^data: /, ''));\r\n\t\t\t\t\t\t\t\tconsole.log(data);\r\n\r\n\t\t\t\t\t\t\t\ttext += data.choices[0].delta.content ?? '';\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst chatCompletionHandler = async () => {\r\n\t\tconst model = $models.find((model) => model.id === selectedModelId);\r\n\r\n\t\tconst [res, controller] = await generateOpenAIChatCompletion(\r\n\t\t\tlocalStorage.token,\r\n\t\t\t{\r\n\t\t\t\tmodel: model.id,\r\n\t\t\t\tstream: true,\r\n\t\t\t\tmessages: [\r\n\t\t\t\t\tsystem\r\n\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\trole: 'system',\r\n\t\t\t\t\t\t\t\tcontent: system\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t: undefined,\r\n\t\t\t\t\t...messages\r\n\t\t\t\t].filter((message) => message)\r\n\t\t\t},\r\n\t\t\tmodel?.owned_by === 'openai' ? `${OPENAI_API_BASE_URL}` : `${OLLAMA_API_BASE_URL}/v1`\r\n\t\t);\r\n\r\n\t\tlet responseMessage;\r\n\t\tif (messages.at(-1)?.role === 'assistant') {\r\n\t\t\tresponseMessage = messages.at(-1);\r\n\t\t} else {\r\n\t\t\tresponseMessage = {\r\n\t\t\t\trole: 'assistant',\r\n\t\t\t\tcontent: ''\r\n\t\t\t};\r\n\t\t\tmessages.push(responseMessage);\r\n\t\t\tmessages = messages;\r\n\t\t}\r\n\r\n\t\tawait tick();\r\n\t\tconst textareaElement = document.getElementById(`assistant-${messages.length - 1}-textarea`);\r\n\r\n\t\tif (res && res.ok) {\r\n\t\t\tconst reader = res.body\r\n\t\t\t\t.pipeThrough(new TextDecoderStream())\r\n\t\t\t\t.pipeThrough(splitStream('\\n'))\r\n\t\t\t\t.getReader();\r\n\r\n\t\t\twhile (true) {\r\n\t\t\t\tconst { value, done } = await reader.read();\r\n\t\t\t\tif (done || stopResponseFlag) {\r\n\t\t\t\t\tif (stopResponseFlag) {\r\n\t\t\t\t\t\tcontroller.abort('User: Stop Response');\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tlet lines = value.split('\\n');\r\n\r\n\t\t\t\t\tfor (const line of lines) {\r\n\t\t\t\t\t\tif (line !== '') {\r\n\t\t\t\t\t\t\tconsole.log(line);\r\n\t\t\t\t\t\t\tif (line === 'data: [DONE]') {\r\n\t\t\t\t\t\t\t\t// responseMessage.done = true;\r\n\t\t\t\t\t\t\t\tmessages = messages;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tlet data = JSON.parse(line.replace(/^data: /, ''));\r\n\t\t\t\t\t\t\t\tconsole.log(data);\r\n\r\n\t\t\t\t\t\t\t\tif (responseMessage.content == '' && data.choices[0].delta.content == '\\n') {\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\ttextareaElement.style.height = textareaElement.scrollHeight + 'px';\r\n\r\n\t\t\t\t\t\t\t\t\tresponseMessage.content += data.choices[0].delta.content ?? '';\r\n\t\t\t\t\t\t\t\t\tmessages = messages;\r\n\r\n\t\t\t\t\t\t\t\t\ttextareaElement.style.height = textareaElement.scrollHeight + 'px';\r\n\r\n\t\t\t\t\t\t\t\t\tawait tick();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.log(error);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscrollToBottom();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst submitHandler = async () => {\r\n\t\tif (selectedModelId) {\r\n\t\t\tloading = true;\r\n\r\n\t\t\tif (mode === 'complete') {\r\n\t\t\t\tawait textCompletionHandler();\r\n\t\t\t} else if (mode === 'chat') {\r\n\t\t\t\tawait chatCompletionHandler();\r\n\t\t\t}\r\n\r\n\t\t\tloading = false;\r\n\t\t\tstopResponseFlag = false;\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\tif ($user?.role !== 'admin') {\r\n\t\t\tawait goto('/');\r\n\t\t}\r\n\r\n\t\tif ($settings?.models) {\r\n\t\t\tselectedModelId = $settings?.models[0];\r\n\t\t} else if ($config?.default_models) {\r\n\t\t\tselectedModelId = $config?.default_models.split(',')[0];\r\n\t\t} else {\r\n\t\t\tselectedModelId = '';\r\n\t\t}\r\n\t\tloaded = true;\r\n\t});\r\n</script>\r\n\r\n<svelte:head>\r\n\t<title>\r\n\t\t{$i18n.t('Playground')} | {$WEBUI_NAME}\r\n\t</title>\r\n</svelte:head>\r\n\r\n<div class=\" flex flex-col justify-between w-full overflow-y-auto h-full\">\r\n\t<div class=\"mx-auto w-full md:px-0 h-full\">\r\n\t\t<div class=\" flex flex-col h-full\">\r\n\t\t\t<div class=\"flex flex-col justify-between mb-2.5 gap-1\">\r\n\t\t\t\t<div class=\"flex justify-between items-center gap-2\">\r\n\t\t\t\t\t<div class=\" text-lg font-semibold self-center flex\">\r\n\t\t\t\t\t\t{$i18n.t('Playground')}\r\n\t\t\t\t\t\t<span class=\" text-xs text-gray-500 self-center ml-1\">{$i18n.t('(Beta)')}</span>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclass=\" flex items-center gap-0.5 text-xs px-2.5 py-0.5 rounded-lg {mode === 'chat' &&\r\n\t\t\t\t\t\t\t\t'text-sky-600 dark:text-sky-200 bg-sky-200/30'} {mode === 'complete' &&\r\n\t\t\t\t\t\t\t\t'text-green-600 dark:text-green-200 bg-green-200/30'} \"\r\n\t\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\t\tif (mode === 'complete') {\r\n\t\t\t\t\t\t\t\t\tmode = 'chat';\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tmode = 'complete';\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{#if mode === 'complete'}\r\n\t\t\t\t\t\t\t\t{$i18n.t('Text Completion')}\r\n\t\t\t\t\t\t\t{:else if mode === 'chat'}\r\n\t\t\t\t\t\t\t\t{$i18n.t('Chat')}\r\n\t\t\t\t\t\t\t{/if}\r\n\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\t\tviewBox=\"0 0 16 16\"\r\n\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\tclass=\"w-3 h-3\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\t\tfill-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t\td=\"M5.22 10.22a.75.75 0 0 1 1.06 0L8 11.94l1.72-1.72a.75.75 0 1 1 1.06 1.06l-2.25 2.25a.75.75 0 0 1-1.06 0l-2.25-2.25a.75.75 0 0 1 0-1.06ZM10.78 5.78a.75.75 0 0 1-1.06 0L8 4.06 6.28 5.78a.75.75 0 0 1-1.06-1.06l2.25-2.25a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1 0 1.06Z\"\r\n\t\t\t\t\t\t\t\t\t\tclip-rule=\"evenodd\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"flex flex-col gap-1 w-full\">\r\n\t\t\t\t\t<div class=\"flex w-full\">\r\n\t\t\t\t\t\t<div class=\"overflow-hidden w-full\">\r\n\t\t\t\t\t\t\t<div class=\"max-w-full\">\r\n\t\t\t\t\t\t\t\t<Selector\r\n\t\t\t\t\t\t\t\t\tplaceholder={$i18n.t('Select a model')}\r\n\t\t\t\t\t\t\t\t\titems={$models.map((model) => ({\r\n\t\t\t\t\t\t\t\t\t\tvalue: model.id,\r\n\t\t\t\t\t\t\t\t\t\tlabel: model.name,\r\n\t\t\t\t\t\t\t\t\t\tmodel: model\r\n\t\t\t\t\t\t\t\t\t}))}\r\n\t\t\t\t\t\t\t\t\tbind:value={selectedModelId}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<!-- <button\r\n\t\t\t\t\t\t\tclass=\" self-center dark:hover:text-gray-300\"\r\n\t\t\t\t\t\t\tid=\"open-settings-button\"\r\n\t\t\t\t\t\t\ton:click={async () => {}}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\r\n\t\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\t\tstroke-width=\"1.5\"\r\n\t\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t\t\tclass=\"w-4 h-4\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\td=\"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\r\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\r\n\t\t\t\t\t\t\t\t\td=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t\t</button> -->\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{#if mode === 'chat'}\r\n\t\t\t\t<div class=\"p-1\">\r\n\t\t\t\t\t<div class=\"p-3 outline outline-1 outline-gray-200 dark:outline-gray-800 rounded-lg\">\r\n\t\t\t\t\t\t<div class=\" text-sm font-medium\">{$i18n.t('System')}</div>\r\n\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\tid=\"system-textarea\"\r\n\t\t\t\t\t\t\tclass=\"w-full h-full bg-transparent resize-none outline-none text-sm\"\r\n\t\t\t\t\t\t\tbind:value={system}\r\n\t\t\t\t\t\t\tplaceholder={$i18n.t(\"You're a helpful assistant.\")}\r\n\t\t\t\t\t\t\trows=\"4\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<div\r\n\t\t\t\tclass=\" pb-2.5 flex flex-col justify-between w-full flex-auto overflow-auto h-0\"\r\n\t\t\t\tid=\"messages-container\"\r\n\t\t\t\tbind:this={messagesContainerElement}\r\n\t\t\t>\r\n\t\t\t\t<div class=\" h-full w-full flex flex-col\">\r\n\t\t\t\t\t<div class=\"flex-1 p-1\">\r\n\t\t\t\t\t\t{#if mode === 'complete'}\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tid=\"text-completion-textarea\"\r\n\t\t\t\t\t\t\t\tbind:this={textCompletionAreaElement}\r\n\t\t\t\t\t\t\t\tclass=\"w-full h-full p-3 bg-transparent outline outline-1 outline-gray-200 dark:outline-gray-800 resize-none rounded-lg text-sm\"\r\n\t\t\t\t\t\t\t\tbind:value={text}\r\n\t\t\t\t\t\t\t\tplaceholder={$i18n.t(\"You're a helpful assistant.\")}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{:else if mode === 'chat'}\r\n\t\t\t\t\t\t\t<ChatCompletion bind:messages />\r\n\t\t\t\t\t\t{/if}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t<div class=\"pb-3\">\r\n\t\t\t\t{#if !loading}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"px-3 py-1.5 text-sm font-medium bg-emerald-600 hover:bg-emerald-700 text-gray-50 transition rounded-lg\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tsubmitHandler();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{$i18n.t('Submit')}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{:else}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclass=\"px-3 py-1.5 text-sm font-medium bg-gray-100 hover:bg-gray-200 text-gray-900 transition rounded-lg\"\r\n\t\t\t\t\t\ton:click={() => {\r\n\t\t\t\t\t\t\tstopResponse();\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{$i18n.t('Cancel')}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t{/if}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<style>\r\n\t.scrollbar-hidden::-webkit-scrollbar {\r\n\t\tdisplay: none; /* for Chrome, Safari and Opera */\r\n\t}\r\n\r\n\t.scrollbar-hidden {\r\n\t\t-ms-overflow-style: none; /* IE and Edge */\r\n\t\tscrollbar-width: none; /* Firefox */\r\n\t}\r\n</style>\r\n"],"names":["t0_value","ctx","attr","textarea","textarea_placeholder_value","insert_hydration","target","div3","anchor","append_hydration","div0","button0","div1","set_input_value","div2","button1","hr","dirty","set_data","t0","button","i","t2","t2_value","i18n","getContext","messages","$$props","textAreaElement","onMount","message","idx","$$invalidate","$$value","e","messageIdx","_a","t","t_value","document_1","title_value","create_if_block_4","create_if_block_5","func","if_block1","create_if_block_3","create_if_block","div15","div14","div13","div8","span","div7","div6","div5","div4","div11","div10","div9","div12","current","t1","t1_value","t3","t3_value","selector_changes","model","mode","text","selectedModelId","loading","stopResponseFlag","messagesContainerElement","textCompletionAreaElement","system","scrollToBottom","element","stopResponse","textCompletionHandler","$models","res","controller","generateOpenAIChatCompletion","OPENAI_API_BASE_URL","OLLAMA_API_BASE_URL","reader","splitStream","value","done","lines","line","data","error","chatCompletionHandler","responseMessage","tick","textareaElement","submitHandler","$user","goto","$settings","$config"],"mappings":"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"}